(()=>{var e,s,t,a={75888:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>n});var a=t(84125);class r extends a.y{getBaseURL(){return"/usage-logs"}async getStats(){return await this.axios.get("/stats")}async getMonthlyPlans(){return await this.axios.get("/monthly-plans")}async getCurrentUsage(){return await this.axios.get("/current-usage")}async getPricingAndSubscription(){return await this.axios.get("/pricing-and-subscription")}getUserStats(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r={};return s&&t&&(r.start_date=s.toISOString(),r.end_date=t.toISOString()),a&&(r.workspace_id=a),this.axios.get(`/user-stats/${e}`,{params:r})}getUserWorkspacesWithDetails(e){return this.axios.get(`/user-workspaces-with-details/${e}`)}getCurrentIntegrationUsage(){return this.axios.get("/current-integration-usage")}}const n=new r},73215:(e,s,t)=>{"use strict";t.d(s,{Ay:()=>v,Vp:()=>x,bx:()=>f,r8:()=>p,xL:()=>m,yI:()=>d});var a=t(29246),r=t(41397),n=t.n(r),l=t(23046),i=t(6221),o=t(15255);let c={};function d(e,s){c[e]=s}function m(e){delete c[e]}let u=[];function x(e){u.push(e)}let h=()=>null;function p(e){h=e}let g=()=>null;function f(e){g=e}function v(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=!(arguments.length>3&&void 0!==arguments[3])||arguments[3],d=!(arguments.length>4&&void 0!==arguments[4])||arguments[4];const m=a.A.create();let x;return x=e.startsWith("/")?(0,l.Gt)()+e:e,m.defaults.baseURL=x,r&&(m.defaults.headers.common["Content-Type"]="application/json",m.defaults.headers.common.Accept="application/json"),Object.keys(s).forEach((e=>{m.defaults.headers.common[e]=s[e]})),m.interceptors.request.use((s=>{s.headers=n().merge(n().cloneDeep(c),s.headers),s.headers["X-Socket-Id"]=i.A.getSocketId(),s.headers["X-Origin-URL"]=window.location.href;const a=h();a&&(s.headers["X-Active-Workspace-Id"]=a);const r=g();r&&(s.headers["X-Active-App-Id"]=r);const l=(0,o.A)();if(s.requestId=l,t)try{window.parent.postMessage({type:"api-request-start",requestId:l,data:{url:e+s.url,method:s.method,body:s.data instanceof FormData?"[FormData object]":s.data}},"*")}catch(d){}return s}),(e=>Promise.reject(e))),m.interceptors.response.use((e=>{if(t)try{window.parent.postMessage({type:"api-request-end",requestId:e.config.requestId,data:{statusCode:e.status,response:e.data}},"*")}catch(s){}return r?e.data:e}),(e=>{var s,t,a,r,n;null!==(s=e.config)&&void 0!==s&&s.requestId&&window.parent.postMessage({type:"api-request-end",requestId:e.config.requestId,data:{statusCode:(null===(r=e.response)||void 0===r?void 0:r.status)||0,response:(null===(n=e.response)||void 0===n?void 0:n.data)||{error:e.message}}},"*");if(d)for(const l of u)l(e);if(null!==(t=e.response)&&void 0!==t&&null!==(a=t.data)&&void 0!==a&&a.traceback);return Promise.reject(e)})),m}},84125:(e,s,t)=>{"use strict";t.d(s,{H:()=>n,y:()=>l});var a=t(73215),r=t(6221);class n{constructor(){this.axios=this.getClient()}getBaseURL(){return"/"}getClient(){return(0,a.Ay)(this.getBaseURL())}}class l extends n{parseInstance(e){return e}list(e,s,t,a){let r={};return e&&(r.sort=e),s&&(r.limit=s),t&&(r.skip=t),a&&(r.fields=a),this.axios.get("",{params:r}).then((e=>e.map(this.parseInstance)))}filter(e,s,t,a,r){let n={q:JSON.stringify(e)};return s&&(n.sort=s),t&&(n.limit=t),a&&(n.skip=a),r&&(n.fields=r),this.axios.get("",{params:n}).then((e=>e.map(this.parseInstance)))}get(e){return this.axios.get(`/${e}`).then(this.parseInstance)}async subscribe(e,s,t){const a=this;t(this.parseInstance(s));const n=this.getBaseURL()+"/"+e;return r.A.addListener(n,(e=>{s={...s,...e},t(this.parseInstance(s),Object.keys(e))}),(async()=>{const s=await a.get(e);t(this.parseInstance(s),Object.keys(s))}))}async fetchAndSubscribe(e,s){let t=await this.get(e);return this.subscribe(e,t,s)}schema(){return this.axios.get("/schema")}create(e){return this.axios.post("",e).then(this.parseInstance)}update(e,s){return this.axios.put(`/${e}`,s).then(this.parseInstance).then((t=>{const a=r.A.getListeners(this.getBaseURL()+"/"+e)||[];return Object.values(a).forEach((e=>e.callback(t,Object.keys(s)))),t}))}delete(e){return this.axios.delete(`/${e}`)}deleteMany(e){return this.axios.delete("",{data:e})}}},69783:(e,s,t)=>{"use strict";t.d(s,{A:()=>o});var a=t(53705),r=t(41397),n=t.n(r),l=t(23046),i=t(53637);class o{constructor(){this._roomToListeners=void 0,this.historicalSocketIds=void 0,this.socket=void 0,this.tokenUnsubscribe=null,this._roomToListeners={},this.historicalSocketIds=[],this.initializeSocket(),this.setupTokenListener()}setupTokenListener(){this.tokenUnsubscribe=i.b3.addListener((e=>{"token_changed"===e&&this.reconnectWithAuth()}))}getMountPath(){throw new Error("Not implemented")}getSocketQuery(){return{token:i.b3.getToken()}}initializeSocket(){const e={path:this.getMountPath(),transports:["websocket"]};e.query=this.getSocketQuery(),this.socket=(0,a.io)((0,l.wE)(),e),this.socket.on("connect",(()=>{this.historicalSocketIds=n().uniq(this.historicalSocketIds.concat([this.socket.id])),this.reconnectAllRooms()})),this.socket.on("disconnect",(()=>{})),this.socket.on("update_model",(e=>this.onUpdateModel(e))),this.socket.on("user_joined",(e=>{})),this.socket.on("user_left",(e=>{})),this.socket.on("error",(e=>{"Authentication required to join rooms"===e.message||"Access denied to this room"===e.message||e.message})),this.socket.on("*",(e=>{}))}reconnectWithAuth(){this.socket&&this.socket.disconnect(),this.initializeSocket()}getSocketId(){return this.socket.id}reconnectAllRooms(){Object.keys(this._roomToListeners).forEach((e=>{this.joinRoom(e),Object.values(this._roomToListeners[e]).forEach((e=>{let{reconnectCallback:s}=e;s&&s()}))}))}hasListeners(e){return Object.keys(this._roomToListeners[e]||{}).length>0}joinRoom(e){this.socket.emit("join",e)}leaveRoom(e){this.socket.emit("leave",e)}addListener(e,s,t){this.hasListeners(e)||(this.joinRoom(e),this._roomToListeners[e]={});const a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var s=16*Math.random()|0;return("x"===e?s:3&s|8).toString(16)}));this._roomToListeners[e][a]={callback:s,reconnectCallback:t};const r=this;return()=>{r.removeListener(a)}}getListeners(e){return this._roomToListeners[e]}removeListener(e){Object.keys(this._roomToListeners).forEach((s=>{this._roomToListeners[s][e]&&(delete this._roomToListeners[s][e],0===Object.keys(this._roomToListeners[s]).length&&(this.leaveRoom(s),delete this._roomToListeners[s]))}))}onUpdateModel(e){const s=e.room,t=JSON.parse(e.data);this._roomToListeners[s]&&Object.values(this._roomToListeners[s]).forEach((e=>{let{callback:s}=e;s(t)}))}cleanup(){this.tokenUnsubscribe&&(this.tokenUnsubscribe(),this.tokenUnsubscribe=null),this.socket&&this.socket.disconnect()}}},6221:(e,s,t)=>{"use strict";t.d(s,{A:()=>n});var a=t(69783);class r extends a.A{getMountPath(){return"/ws/socket.io/"}}const n=new r},53637:(e,s,t)=>{"use strict";t.d(s,{VO:()=>l,QF:()=>o,O5:()=>i,b3:()=>n});var a=t(73215),r=t(12055);const n=new class{constructor(){this.listeners=new Set,setTimeout((()=>{this.processSSOTokensFromURL()}),0)}getToken(){return this.fetchToken(!1)||localStorage.getItem("token")||localStorage.getItem("base44_access_token")}fetchToken(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const s=new URLSearchParams(window.location.search),t=s.get("access_token")||localStorage.getItem("token")||localStorage.getItem("base44_access_token");return e&&s.has("access_token")&&(0,r.V)("access_token"),t}setToken(e){e?(localStorage.setItem("token",e),localStorage.setItem("base44_access_token",e),(0,a.yI)("Authorization",`Bearer ${e}`)):(localStorage.removeItem("token"),localStorage.removeItem("base44_access_token"),(0,a.xL)("Authorization")),this.notifyListeners("token_changed",{token:e})}addListener(e){return this.listeners.add(e),()=>this.listeners.delete(e)}notifyListeners(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};this.listeners.forEach((t=>{try{t(e,s)}catch(a){}}))}processSSOTokensFromURL(){const e=new URLSearchParams(window.location.search);if(e.get("sso_access_token")){const s={sso_access_token:e.get("sso_access_token"),sso_token_type:e.get("sso_token_type"),sso_expires_at:e.get("sso_expires_at"),sso_scope:e.get("sso_scope"),sso_provider:e.get("sso_provider"),sso_id_token:e.get("sso_id_token")};this.setSSOTokens(s);["sso_access_token","sso_token_type","sso_expires_at","sso_scope","sso_provider","sso_id_token"].forEach((s=>{e.delete(s)}));const t=window.location.pathname+(e.toString()?"?"+e.toString():"");window.history.replaceState({},"",t),this.notifyListeners("sso_tokens_updated",{tokens:this.getSSOTokens()})}}setSSOTokens(e){const s={access_token:e.sso_access_token,token_type:e.sso_token_type,expires_at:e.sso_expires_at,scope:e.sso_scope,provider:e.sso_provider,id_token:e.sso_id_token,stored_at:Date.now()},t=Object.fromEntries(Object.entries(s).filter((e=>{let[s,t]=e;return null!=t})));if(localStorage.setItem("sso_tokens",JSON.stringify(t)),t.access_token)try{(0,a.yI)("SSO_AUTHORIZATION",`${t.token_type} ${t.access_token}`)}catch(r){setTimeout((()=>{try{(0,a.yI)("SSO_AUTHORIZATION",`${t.token_type} ${t.access_token}`)}catch(e){}}),100)}}getSSOTokens(){try{const e=localStorage.getItem("sso_tokens");if(!e)return null;const s=JSON.parse(e);return s.expires_at&&new Date(1e3*s.expires_at)<=new Date?(this.clearSSOTokens(),null):s}catch(e){return this.clearSSOTokens(),null}}clearSSOTokens(){localStorage.removeItem("sso_tokens");try{(0,a.xL)("SSO_AUTHORIZATION")}catch(e){setTimeout((()=>{try{(0,a.xL)("SSO_AUTHORIZATION")}catch(e){}}),100)}this.notifyListeners("sso_tokens_cleared")}getSSOAuthHeader(){const e=this.getSSOTokens();return e&&e.access_token?{SSO_AUTHORIZATION:`${e.token_type} ${e.access_token}`}:null}async fetchWithSSO(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const t=this.getSSOAuthHeader();if(!t)throw new Error("No valid SSO tokens available");const a={...t,"Content-Type":"application/json",...s.headers};return fetch(e,{...s,headers:a})}debugSSOTokens(){const e=localStorage.getItem("sso_tokens");if(e)try{const s=JSON.parse(e);if(s.expires_at){new Date(1e3*s.expires_at)}}catch(s){}}};function l(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return n.fetchToken(e)}function i(e){n.setToken(e)}function o(){n.setToken(null)}},12055:(e,s,t)=>{"use strict";function a(e){const s=new URLSearchParams(window.location.search);s.delete(e);const t=window.location.pathname+(s.toString()?"?"+s.toString():"");window.history.replaceState({},"",t)}t.d(s,{V:()=>a})},23046:(e,s,t)=>{"use strict";t.d(s,{Gt:()=>r,Zk:()=>n,wE:()=>a});const a=()=>"https://app.base44.com";function r(){return a()+"/api"}function n(){return r()}},44644:(e,s,t)=>{"use strict";var a={};t.r(a),t.d(a,{cn:()=>ns});var r={};t.r(r),t.d(r,{Alert:()=>is,AlertDescription:()=>cs,AlertTitle:()=>os});var n={};t.r(n),t.d(n,{Tooltip:()=>ks,TooltipContent:()=>Ss,TooltipProvider:()=>ws,TooltipTrigger:()=>_s});var l={};t.r(l),t.d(l,{Button:()=>Rs,buttonVariants:()=>Os});var i={};t.r(i),t.d(i,{Badge:()=>qs,badgeVariants:()=>Ws});var o={};t.r(o),t.d(o,{Card:()=>Vs,CardContent:()=>Js,CardDescription:()=>Gs,CardFooter:()=>Zs,CardHeader:()=>Ys,CardTitle:()=>Hs});var c={};t.r(c),t.d(c,{Separator:()=>Xs});var d={};t.r(d),t.d(d,{Input:()=>Qs});var m={};t.r(m),t.d(m,{Label:()=>at});var u={};t.r(u),t.d(u,{RadioGroup:()=>lt,RadioGroupItem:()=>it});var x={};t.r(x),t.d(x,{Select:()=>ut,SelectContent:()=>vt,SelectGroup:()=>xt,SelectItem:()=>bt,SelectLabel:()=>jt,SelectScrollDownButton:()=>ft,SelectScrollUpButton:()=>gt,SelectSeparator:()=>yt,SelectTrigger:()=>pt,SelectValue:()=>ht});var h={};t.r(h),t.d(h,{Avatar:()=>qt,AvatarFallback:()=>Yt,AvatarImage:()=>Vt});var p={};t.r(p),t.d(p,{Dialog:()=>na,DialogClose:()=>oa,DialogContent:()=>da,DialogDescription:()=>ha,DialogFooter:()=>ua,DialogHeader:()=>ma,DialogOverlay:()=>ca,DialogPortal:()=>ia,DialogTitle:()=>xa,DialogTrigger:()=>la});var g={};t.r(g),t.d(g,{Table:()=>Ia,TableBody:()=>Ta,TableCaption:()=>Oa,TableCell:()=>Ma,TableFooter:()=>$a,TableHead:()=>Pa,TableHeader:()=>La,TableRow:()=>Da});var f={};t.r(f),t.d(f,{Tabs:()=>lr,TabsContent:()=>cr,TabsList:()=>ir,TabsTrigger:()=>or});var v={};t.r(v),t.d(v,{DropdownMenu:()=>gr,DropdownMenuCheckboxItem:()=>Sr,DropdownMenuContent:()=>kr,DropdownMenuGroup:()=>vr,DropdownMenuItem:()=>_r,DropdownMenuLabel:()=>Ar,DropdownMenuPortal:()=>jr,DropdownMenuRadioGroup:()=>yr,DropdownMenuRadioItem:()=>Cr,DropdownMenuSeparator:()=>Er,DropdownMenuShortcut:()=>Ir,DropdownMenuSub:()=>br,DropdownMenuSubContent:()=>wr,DropdownMenuSubTrigger:()=>Nr,DropdownMenuTrigger:()=>fr});var j={};t.r(j),t.d(j,{reducer:()=>Mn,toast:()=>zn,useToast:()=>Un});var b={};t.r(b),t.d(b,{Checkbox:()=>zi});var y={};t.r(y),t.d(y,{Textarea:()=>Ui});var N={};t.r(N),t.d(N,{ScrollArea:()=>Wi,ScrollBar:()=>qi});var w={};t.r(w),t.d(w,{Collapsible:()=>oo,CollapsibleContent:()=>mo,CollapsibleTrigger:()=>co});var k={};t.r(k),t.d(k,{Command:()=>yo,CommandDialog:()=>No,CommandEmpty:()=>_o,CommandGroup:()=>So,CommandInput:()=>wo,CommandItem:()=>Ao,CommandList:()=>ko,CommandSeparator:()=>Co,CommandShortcut:()=>Eo});var _={};t.r(_),t.d(_,{Calendar:()=>$o});var S={};t.r(S),t.d(S,{Popover:()=>Mo,PopoverContent:()=>Ro,PopoverTrigger:()=>Oo});var C={};t.r(C),t.d(C,{Sheet:()=>dc,SheetClose:()=>uc,SheetContent:()=>gc,SheetDescription:()=>bc,SheetFooter:()=>vc,SheetHeader:()=>fc,SheetOverlay:()=>hc,SheetPortal:()=>xc,SheetTitle:()=>jc,SheetTrigger:()=>mc});var A={};t.r(A),t.d(A,{Switch:()=>Lc});var E={};t.r(E),t.d(E,{Skeleton:()=>md});var I={};t.r(I),t.d(I,{Toast:()=>pm,ToastAction:()=>gm,ToastClose:()=>fm,ToastDescription:()=>jm,ToastProvider:()=>um,ToastTitle:()=>vm,ToastViewport:()=>xm});var L={};t.r(L),t.d(L,{Toaster:()=>bm});var T={};t.r(T),t.d(T,{AlertDialog:()=>Bm,AlertDialogAction:()=>Km,AlertDialogCancel:()=>Xm,AlertDialogContent:()=>Ym,AlertDialogDescription:()=>Zm,AlertDialogFooter:()=>Gm,AlertDialogHeader:()=>Hm,AlertDialogOverlay:()=>Vm,AlertDialogPortal:()=>qm,AlertDialogTitle:()=>Jm,AlertDialogTrigger:()=>Wm});var $={};t.r($),t.d($,{Progress:()=>Sh});var D={};t.r(D),t.d(D,{Accordion:()=>bj,AccordionContent:()=>wj,AccordionItem:()=>yj,AccordionTrigger:()=>Nj});var P={};t.r(P),t.d(P,{AspectRatio:()=>kj});var M={};t.r(M),t.d(M,{Carousel:()=>Aj,CarouselContent:()=>Ej,CarouselItem:()=>Ij,CarouselNext:()=>Tj,CarouselPrevious:()=>Lj});var O={};t.r(O),t.d(O,{ContextMenu:()=>Dj,ContextMenuCheckboxItem:()=>qj,ContextMenuContent:()=>Bj,ContextMenuGroup:()=>Mj,ContextMenuItem:()=>Wj,ContextMenuLabel:()=>Yj,ContextMenuPortal:()=>Oj,ContextMenuRadioGroup:()=>Fj,ContextMenuRadioItem:()=>Vj,ContextMenuSeparator:()=>Hj,ContextMenuShortcut:()=>Gj,ContextMenuSub:()=>Rj,ContextMenuSubContent:()=>Uj,ContextMenuSubTrigger:()=>zj,ContextMenuTrigger:()=>Pj});var R={};t.r(R),t.d(R,{Form:()=>Jj,FormControl:()=>tb,FormDescription:()=>ab,FormField:()=>Kj,FormItem:()=>eb,FormLabel:()=>sb,FormMessage:()=>rb,useFormField:()=>Xj});var F={};t.r(F),t.d(F,{HoverCard:()=>lb,HoverCardContent:()=>ob,HoverCardTrigger:()=>ib});var z={};t.r(z),t.d(z,{Menubar:()=>pb,MenubarCheckboxItem:()=>yb,MenubarContent:()=>jb,MenubarGroup:()=>mb,MenubarItem:()=>bb,MenubarLabel:()=>wb,MenubarMenu:()=>db,MenubarPortal:()=>ub,MenubarRadioGroup:()=>hb,MenubarRadioItem:()=>Nb,MenubarSeparator:()=>kb,MenubarShortcut:()=>_b,MenubarSub:()=>xb,MenubarSubContent:()=>vb,MenubarSubTrigger:()=>fb,MenubarTrigger:()=>gb});var U={};t.r(U),t.d(U,{NavigationMenu:()=>Cb,NavigationMenuContent:()=>Tb,NavigationMenuIndicator:()=>Pb,NavigationMenuItem:()=>Eb,NavigationMenuLink:()=>$b,NavigationMenuList:()=>Ab,NavigationMenuTrigger:()=>Lb,NavigationMenuViewport:()=>Db,navigationMenuTriggerStyle:()=>Ib});var B={};t.r(B),t.d(B,{Slider:()=>Ob});var W={};t.r(W),t.d(W,{Toggle:()=>zb,toggleVariants:()=>Fb});var q={};t.r(q),t.d(q,{Toaster:()=>Bb});var V={};t.r(V),t.d(V,{Sidebar:()=>Hb,SidebarContent:()=>sy,SidebarFooter:()=>Qb,SidebarGroup:()=>ty,SidebarGroupAction:()=>ry,SidebarGroupContent:()=>ny,SidebarGroupLabel:()=>ay,SidebarHeader:()=>Xb,SidebarInput:()=>Kb,SidebarInset:()=>Zb,SidebarMenu:()=>ly,SidebarMenuAction:()=>dy,SidebarMenuBadge:()=>my,SidebarMenuButton:()=>cy,SidebarMenuItem:()=>iy,SidebarMenuSkeleton:()=>uy,SidebarMenuSub:()=>xy,SidebarMenuSubButton:()=>py,SidebarMenuSubItem:()=>hy,SidebarProvider:()=>Yb,SidebarRail:()=>Jb,SidebarSeparator:()=>ey,SidebarTrigger:()=>Gb,useSidebar:()=>Vb});var Y=t(9950),H=t(1352),G=t.t(H,2),J=t(42074),Z=t(28429),K=t(84125);class X extends K.y{getBaseURL(){return"/auth"}getCurrentUser(){return this.axios.get("/me")}regenerateApiKey(){return this.axios.post("/regenerate_api_key")}updateUser(e,s){return this.axios.post(`/${e}/update-user`,{...s})}listUsers(e){return this.axios.get("/list-users",{params:e})}login(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={email:e,password:s};return t&&(a.turnstile_token=t),this.axios.post("/login",a)}register(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={email:e,password:s};return t&&(a.turnstile_token=t),this.axios.post("/register",a)}verifyOtp(e,s){return this.axios.post("/verify-otp",{email:e,otp_code:s})}resendOtp(e){return this.axios.post("/resend-otp",{email:e})}resetPasswordRequest(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const t={email:e};return s&&(t.turnstile_token=s),this.axios.post("/reset-password-request",t)}resetPassword(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={reset_token:e,new_password:s};return t&&(a.turnstile_token=t),this.axios.post("/reset-password",a)}changePassword(e,s,t){return this.axios.post("/change-password",{user_id:e,current_password:s,new_password:t})}}const Q=new X;var ee=t(73215),se=t(53637),te=t(44414);const ae=(0,Y.createContext)(),re=e=>{let{children:s}=e;const[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)(!1),[l,i]=(0,Y.useState)(!0);(0,Y.useEffect)((()=>{const e=(0,se.VO)(!0);e?(localStorage.setItem("token",e),(0,ee.yI)("Authorization",`Bearer ${e}`),c()):i(!1),(0,ee.Vp)((e=>{e.response&&401===e.response.status&&o()}))}),[]);const o=()=>{localStorage.removeItem("token"),(0,ee.xL)("Authorization"),a(null),n(!1),i(!1)},c=async()=>{try{i(!0);const e=await Q.getCurrentUser();return a(e),n(!0),i(!1),e}catch(e){i(!1),o()}},d=(0,Y.useCallback)((async()=>{const e=await Q.getCurrentUser();e&&a(e)}),[]);return(0,te.jsx)(ae.Provider,{value:{user:t,isAuthenticated:r,logout:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(o(),n(!1),a(null),e){const e=encodeURIComponent(window.location.href);window.location.href="/login?from_url="+e}},isLoadingAuth:l,updateUser:e=>{a(e)},reloadUser:d},children:s})},ne=()=>(0,Y.useContext)(ae);var le=t(6221);class ie extends K.H{getBaseURL(){return"/workspace/invitations"}inviteUser(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"member",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=t?{workspaceId:t}:{};return this.axios.post("/invite",{email:e,role:s},{params:a})}bulkInviteUsers(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const t=s?{workspaceId:s}:{};return this.axios.post("/bulk-invite",{invitations:e},{params:t})}getInvitationDetails(e){return this.axios.get(`/${e}`)}acceptInvitation(e){return this.axios.post(`/${e}/accept`)}declineInvitation(e){return this.axios.post(`/${e}/decline`)}}const oe=new ie;class ce extends K.H{getBaseURL(){return"/workspace"}getWorkspaces(){return this.axios.get("/workspaces")}getAvailablePlans(){return this.axios.get("/available-plans")}createWorkspace(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return this.axios.post("/workspaces",{name:e,domain:s})}getDashboard(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=e?{workspaceId:e}:{};return this.axios.get("",{params:s})}subscribeToDashboard(e,s,t){const a=`workspace/${e}/dashboard`;return t(s),le.A.addListener(a,(e=>{s={...s,...e},t(s,Object.keys(e))}),(async()=>{try{const s=await this.getDashboard(e);t(s,Object.keys(s))}catch(s){}}))}updateWorkspace(e,s){const t=e?{workspaceId:e}:{};return this.axios.put("/update",s,{params:t})}inviteUser(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"member",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;return oe.inviteUser(e,s,t)}bulkInviteUsers(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return oe.bulkInviteUsers(e,s)}buySeats(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=t?{workspaceId:t}:{};return this.axios.post("/buy-seats",{plan:e,count:s},{params:a})}removeSeats(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=t?{workspaceId:t}:{};return this.axios.post("/remove-seats",{plan:e,count:s},{params:a})}updateMemberRole(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a=t?{workspaceId:t}:{};return this.axios.put(`/members/${e}/role`,{role:s},{params:a})}updateMemberSeat(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;const r=t?{workspaceId:t}:{},n={seat_type:s};return null!==a&&(n.seat_id=a),this.axios.put(`/members/${e}/seat`,n,{params:r})}removeMember(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const t=s?{workspaceId:s}:{};return this.axios.delete(`/members/${e}`,{params:t})}getMySeatInfo(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=e?{workspaceId:e}:{};return this.axios.get("/my-seat",{params:s})}getSeatUsage(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;const t=s?{workspaceId:s}:{};return this.axios.get(`/seats/${e}/usage`,{params:t})}getWorkspaceInvoices(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=e?{workspaceId:e}:{};return this.axios.get("/invoices",{params:s})}getInvitationDetails(e){return oe.getInvitationDetails(e)}acceptInvitation(e){return oe.acceptInvitation(e)}declineInvitation(e){return oe.declineInvitation(e)}createWorkspacePortalSession(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;const s=e?{workspaceId:e}:{};return this.axios.post("/create-portal-session",{},{params:s})}}const de=new ce,me=(0,Y.createContext)();function ue(e){let{children:s}=e;const[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)([]),[l,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(!0),[d,m]=(0,Y.useState)(null),{reloadUser:u,isAuthenticated:x}=ne(),h=(0,Y.useMemo)((()=>{if(!t||!r.length)return null;return r.find((e=>e.id===t))||null}),[t,r]);(0,Y.useEffect)((()=>((0,ee.r8)((()=>t)),x&&u(),()=>{(0,ee.r8)((()=>null)),x&&u()})),[t,x,u]),(0,Y.useEffect)((()=>{const e=localStorage.getItem("activeWorkspaceId");if(e)try{a(e)}catch(d){localStorage.removeItem("activeWorkspaceId")}i(!1)}),[]),(0,Y.useEffect)((()=>{t?localStorage.setItem("activeWorkspaceId",t):localStorage.removeItem("activeWorkspaceId")}),[t]);const p=(0,Y.useCallback)((async()=>{try{c(!0),m(null);const e=await de.getWorkspaces();n(e.workspaces||e||[])}catch(e){m(e),n([])}finally{c(!1)}}),[]);(0,Y.useEffect)((()=>{p()}),[p]);const g=(0,Y.useCallback)((e=>{const s="string"==typeof e?e:null==e?void 0:e.id;a(s)}),[]),f=(0,Y.useCallback)((()=>{a(null)}),[]),v={activeWorkspace:h,activeWorkspaceId:t,workspaces:r,isLoading:l,isLoadingWorkspaces:o,error:d,switchActiveWorkspace:g,clearActiveWorkspace:f,refetchWorkspaces:p};return(0,te.jsx)(me.Provider,{value:v,children:s})}function xe(){const e=(0,Y.useContext)(me);if(void 0===e)throw new Error("useWorkspace must be used within a WorkspaceProvider");return e}class he extends K.y{getBaseURL(){return"/apps"}addMessage(e,s){return this.axios.post(`/${e}/chat/message`,s)}undoMessage(e,s){return this.axios.post(`/${e}/chat/message/${s}/undo`)}inviteUser(e,s,t){return this.axios.post(`/${e}/users/invite-user`,{user_email:s,role:t})}remixApp(e,s){return this.axios.post(`/${e}/remix`,s)}remixAppRequirements(e){return this.axios.get(`/${e}/remix/requirements`)}updateLogo(e,s){return this.axios.post(`/${e}/metadata/update-logo`,s)}stopChat(e){return this.axios.post(`/${e}/chat/stop`)}getDomainAppId(e){return this.axios.get(`/public/prod/domain/${e}`)}getRuntimeAuthToken(e,s){return this.axios.get(`/${e}/auth/token`)}getLoginInfoBySlug(e){return this.axios.get(`/public/login-info/by-slug/${e}`)}getLoginInfoById(e){return this.axios.get(`/public/login-info/by-id/${e}`)}getSuggestions(e){return this.axios.post(`/${e}/chat/generate-suggestions`)}deployApp(e){return this.axios.post(`/${e}/deploy`)}installIntegration(e,s,t){return this.axios.post(`/${e}/install-integration/${s}/${t}`)}deleteIntegration(e,s,t){return this.axios.post(`/${e}/delete-integration/${s}/${t}`)}redeployFunction(e,s,t){return this.axios.post(`/${e}/coding/redeploy-function/${s}`,{code:t})}}const pe=new he;var ge=t(74925);const fe="mixpanel_utm_params",ve="mixpanel_utm_timestamp",je=["utm_source","utm_medium","utm_campaign","utm_content","utm_term","utm_id","utm_campaign_id","utm_source_platform","utm_creative_format","utm_marketing_tactic","impact_click_id"],be=()=>{try{const e=localStorage.getItem(fe),s=localStorage.getItem(ve);return{params:e?JSON.parse(e):{},timestamp:s?parseInt(s):null}}catch(e){return{params:{},timestamp:null}}},ye={signup:{src:189,evid:1204},login:{src:189,evid:1200}};const Ne=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"signup",t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};try{if(!e)return;const a=ye[s];if(!a)return;const r=function(e){const s=`; ${document.cookie}`.split(`; ${e}=`);return 2===s.length?s.pop().split(";").shift():null}("_wixCIDX")||"no-cookie-found",n=e||"no-user-id",l={dt:0,e:[{dt:0,f:{src:a.src,evid:a.evid}}],g:{uuid:n,client_id:r}};Object.keys(t).length>0&&(l.additional_data=t),fetch("https://frog.wix.com/base44",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(l)}).then((e=>{if(!e.ok)throw new Error(`Frog service responded with status: ${e.status}`);return e.text()})).then((e=>{})).catch((e=>{}))}catch(a){}},we=e=>{const s={event_type:"signup",timestamp:(new Date).toISOString()};Ne(e,"signup",s)},ke=[];function _e(e,s){ge.A.track(e,s)}const Se=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};ge.A.__loaded?_e(e,s):ke.push((()=>_e(e,s)))};function Ce(){const{user:e,isLoadingAuth:s}=ne();return(0,Y.useEffect)((()=>{if(s)return;ge.A.init("eff913a25a5a2642acc7794bb28dc621",{debug:!1,opt_out_tracking_by_default:!1,ignore_dnt:!0,loaded:()=>{ge.A.__loaded=!0;const{params:s}=be();if(Object.keys(s).length>0&&ge.A.register(s),e){t=e.id,ge.A.__loaded?ge.A.identify(t):ke.push((()=>ge.A.identify(t)));const a={};for(Object.assign(a,s),e.feature_flags&&Array.isArray(e.feature_flags)&&(a.feature_flags=e.feature_flags,e.feature_flags.forEach((e=>{a[`ff_${e}`]=!0}))),((e,s)=>{ge.A.__loaded?(ge.A.identify(e),ge.A.people.set(s)):ke.push((()=>{ge.A.identify(e),ge.A.people.set(s)}))})(e.id,a),Se("User Login",s),(e=>{const s={event_type:"login",timestamp:(new Date).toISOString()};Ne(e,"login",s)})(e.id);ke.length>0;){ke.shift()()}}var t}})}),[s,e]),null}const Ae={signup:{src:189,evid:1204},login:{src:189,evid:1200},message_sent:{src:189,evid:1020},message_completed:{src:189,evid:1019},page_view:{src:189,evid:1023},user_clicked:{src:189,evid:1021}};function Ee(e){return Ae[e]||null}async function Ie(e,s){let{timeoutMs:t=2500}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=JSON.stringify(s),r=fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:a}),n=await function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:2500;return new Promise(((t,a)=>{const r=setTimeout((()=>a(new Error("timeout"))),s);e.then((e=>{clearTimeout(r),t(e)}),(e=>{clearTimeout(r),a(e)}))}))}(r,t);if(!n.ok)throw new Error(`HTTP ${n.status}`);return n}function Le(e,s){try{const t=new Blob([JSON.stringify(s)],{type:"application/json"});return navigator.sendBeacon(e,t)}catch(t){return!1}}const Te="https://frog.wix.com/base44";const $e=new class{constructor(){this._ready=!1,this._readyPromise=null,this._eventQueue=[],this._flushTimer=null,this._isFlushInProgress=!1,this.BATCH_SIZE=10,this.FLUSH_INTERVAL=2e3,this.MAX_QUEUE_SIZE=100}getCookie(e){var s;if("undefined"==typeof document)return null;const t=`; ${document.cookie}`.split(`; ${e}=`);return 2===t.length&&(null===(s=t.pop())||void 0===s?void 0:s.split(";").shift())||null}getClientId(){return this.getCookie("_wixCIDX")||"no-cookie-found"}async ensureReady(){if(!this._ready)return this._readyPromise||(this._readyPromise=(async()=>{this._ready=!0})()),this._readyPromise}async track(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};try{await this.ensureReady();if(!Ee(e))return;let n;try{n=await t}catch(r){n={}}const l=Date.now();if(a.immediate||a.useBeacon)return this._sendImmediately(e,s,n,l,a);const i={eventKey:e,session:s,additionalData:n,timestamp:l,useBeacon:a.useBeacon};if(this._eventQueue.push(i),this._eventQueue.length>this.MAX_QUEUE_SIZE&&this._eventQueue.shift(),this._eventQueue.length>=this.BATCH_SIZE)try{await this._flush()}catch(r){}else this._scheduleFlush()}catch(r){}}async flush(){try{return await this._flush()}catch(e){}}async _sendImmediately(e,s,t,a,r){try{const n=Ee(e),l={dt:0,e:[{dt:0,f:{src:n.src,evid:n.evid,timestamp:a,...t,...s}}],g:{uuid:s.user_id||"no-user-id",client_id:this.getClientId()}};if(r.useBeacon){if(Le(Te,l))return}await Ie(Te,l,{timeoutMs:2500})}catch(n){}}async _flush(){if(!this._isFlushInProgress&&0!==this._eventQueue.length){this._isFlushInProgress=!0;try{this._flushTimer&&(clearTimeout(this._flushTimer),this._flushTimer=null);const s=this._eventQueue.splice(0,this.BATCH_SIZE);let t;try{t=this._groupEventsBySession(s)}catch(e){return}try{await Promise.all(t.map((e=>this._sendEventBatch(e))))}catch(e){}}catch(e){}finally{this._isFlushInProgress=!1,this._eventQueue.length>0&&this._scheduleFlush()}}}_groupEventsBySession(e){const s=new Map;for(const t of e){const e=(null==t?void 0:t.session)||{},a=`${"object"==typeof e&&null!==e&&e.user_id||"no-user"}-${"object"==typeof e&&null!==e&&e.app_id||"no-app"}-${"object"==typeof e&&null!==e&&e.conversation_id||"no-conversation"}`;s.has(a)||s.set(a,[]),s.get(a).push(t)}return Array.from(s.values())}_scheduleFlush(){this._flushTimer&&(clearTimeout(this._flushTimer),this._flushTimer=null),this._flushTimer=setTimeout((async()=>{try{await this._flush()}catch(e){}}),this.FLUSH_INTERVAL)}async _sendEventBatch(e){if(0!==e.length)try{var s,t;const a=e.some((e=>e.useBeacon)),r={dt:0,e:e.map((s=>{const t=Ee(s.eventKey);return{dt:s.timestamp-e[0].timestamp,f:{src:t.src,evid:t.evid,timestamp:s.timestamp,...s.additionalData,...s.session}}})),g:{uuid:(null===(s=e[0])||void 0===s||null===(t=s.session)||void 0===t?void 0:t.user_id)||"no-user-id",client_id:this.getClientId(),batch_size:e.length}};if(a){if(!Le(Te,r))throw new Error("Beacon send failed")}else await Ie(Te,r,{timeoutMs:2500})}catch(a){}}destroy(){this._flushTimer&&(clearTimeout(this._flushTimer),this._flushTimer=null),this._eventQueue.length>0&&this._flush().catch((e=>{}))}};async function De(){try{const e=await Promise.resolve().then(t.bind(t,75888));return await e.default.getCurrentUsage()}catch(e){return{daily_limit:null,daily_usage:null,monthly_limit:null,monthly_usage:null}}}async function Pe(){return function(e){if(!e)return null;const s="number"==typeof e.daily_limit?e.daily_limit:void 0,t="number"==typeof e.daily_usage?Math.round(e.daily_usage):void 0,a="number"==typeof e.monthly_limit?e.monthly_limit:void 0,r="number"==typeof e.monthly_usage?Math.round(e.monthly_usage):void 0;return"number"==typeof s?"number"!=typeof t?null:Math.max(0,s-t):"number"==typeof a?"number"!=typeof r?null:Math.max(0,a-r):null}(await De())}function Me(e,s,t){$e.track("message_sent",e,function(e){return{user_message:String(e.user_message||""),has_files:Boolean(e.has_files),is_initial_creation_message:Boolean(e.is_initial_creation_message)}}(s),t)}function Oe(e,s,t){$e.track("message_completed",e,async function(e){var s,t,a,r,n;const l=null!==(s=e.tokens_left)&&void 0!==s?s:await Pe();return{message_id:null!==(t=e.message_id)&&void 0!==t?t:null,user_message:String(e.user_message||""),agent_message:null!==(a=e.agent_message)&&void 0!==a?a:null,was_successful:Boolean(e.was_successful),tokens_left:l,duration:null!==(r=e.duration)&&void 0!==r?r:null,has_files:Boolean(e.has_files),error_message:null!==(n=e.error_message)&&void 0!==n?n:null}}(s),t)}function Re(e,s,t){$e.track("page_view",e,function(e){return{page_name:String(e.page_name||"")}}(s),t)}function Fe(e,s,t){$e.track("user_clicked",e,function(e){return{...e}}(s),t)}"undefined"!=typeof window&&window.addEventListener("beforeunload",(()=>{$e.destroy()}));const ze=(e,s)=>{try{const l=e||[];if(null!=s)for(let e=l.length-1;e>=0;e--){var t,a;const r=l[e];if("user"===(null==r?void 0:r.role)&&String(null!==(t=null==r?void 0:r.content)&&void 0!==t?t:"")===String(null!==(a=s)&&void 0!==a?a:""))return(null==r?void 0:r.id)||null}for(let e=l.length-1;e>=0;e--){var r,n;if("user"===(null===(r=l[e])||void 0===r?void 0:r.role))return(null===(n=l[e])||void 0===n?void 0:n.id)||null}return null}catch(l){return null}},Ue=e=>{try{const a=e||[];for(let e=a.length-1;e>=0;e--){var s,t;if("assistant"===(null===(s=a[e])||void 0===s?void 0:s.role))return String((null===(t=a[e])||void 0===t?void 0:t.content)||"")}return null}catch(a){return null}},Be=e=>{var s,t,a;let{startTime:r,body:n,updatedApp:l=null,userMessageId:i=null,agentMessage:o=null,wasSuccessful:c,error:d=null,userId:m=null,appId:u=null}=e;const x=Date.now()-r,h=(null==l||null===(s=l.conversation)||void 0===s?void 0:s.id)||null,p={app_id:u,conversation_id:h,message_id:i,message:String((null==n?void 0:n.content)||""),has_files:((null===(t=n.file_urls)||void 0===t?void 0:t.length)||0)>0,user_id:m,was_successful:c};if(!c&&d){var g,f;const e=d;p.error_message=(null==e||null===(g=e.response)||void 0===g||null===(f=g.data)||void 0===f?void 0:f.message)||(null==e?void 0:e.message)||"unknown"}Se("Message Completed",p),Oe({user_id:m,app_id:u,conversation_id:h},{message_id:i,user_message:String((null==n?void 0:n.content)||""),agent_message:o,was_successful:c,duration:x,has_files:((null===(a=n.file_urls)||void 0===a?void 0:a.length)||0)>0,...p.error_message?{error_message:String(p.error_message)}:{}})},We=e=>{var s,t;let{body:a,userId:r=null,appId:n=null,conversationId:l=null,isInitialCreation:i=!1}=e;const o={app_id:n,conversation_id:l,user_id:r,message:String((null==a?void 0:a.content)||""),has_files:((null===(s=a.file_urls)||void 0===s?void 0:s.length)||0)>0,is_initial_creation_message:i};Se("Message Sent",o),Me({user_id:r,app_id:n,conversation_id:l},{user_message:String((null==a?void 0:a.content)||""),has_files:((null===(t=a.file_urls)||void 0===t?void 0:t.length)||0)>0,is_initial_creation_message:i})};async function qe(e){let{appId:s,body:t,app:a=null,user:r=null,onSuccess:n,onError:l}=e;const i=Date.now();try{var o,c,d,m,u,x;We({body:t,userId:(null==r?void 0:r.id)||null,appId:s||null,conversationId:(null==a||null===(o=a.conversation)||void 0===o?void 0:o.id)||null,isInitialCreation:0===((null==a||null===(c=a.conversation)||void 0===c||null===(d=c.messages)||void 0===d?void 0:d.length)||0)});const e=await pe.addMessage(s,t),l=ze((null==e||null===(m=e.conversation)||void 0===m?void 0:m.messages)||null,null==t?void 0:t.content),h=Ue((null==e||null===(u=e.conversation)||void 0===u?void 0:u.messages)||null),p=null!=e&&null!==(x=e.conversation)&&void 0!==x&&x.id?e:a;return Be({startTime:i,body:t,updatedApp:p||null,userMessageId:l,agentMessage:h,wasSuccessful:!0,userId:(null==r?void 0:r.id)||null,appId:s||null}),n&&await n(e),e}catch(h){throw Be({startTime:i,body:t,updatedApp:a||null,userMessageId:null,agentMessage:null,wasSuccessful:!1,error:h,userId:(null==r?void 0:r.id)||null,appId:s||null}),l&&await l(h),h}}async function Ve(e,s){return qe({appId:e,body:s,user:{id:arguments.length>2&&void 0!==arguments[2]?arguments[2]:null},onError:e=>{}})}const Ye=t.p+"static/media/logo_v3.bc182c1c9f0bff68838e.png";var He=t(34700),Ge=t(67143),Je=t(42989),Ze=t(61041),Ke=t(52828),Xe=t(31115),Qe=t(75888),es=t(41397),ss=t.n(es),ts=t(94364),as=t(72004),rs=t(79800);function ns(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,rs.QP)((0,as.$)(s))}const ls=(0,ts.cva)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),is=Y.forwardRef(((e,s)=>{let{className:t,variant:a,...r}=e;return(0,te.jsx)("div",{ref:s,role:"alert",className:ns(ls({variant:a}),t),...r})}));is.displayName="Alert";const os=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("h5",{ref:s,className:ns("mb-1 font-medium leading-none tracking-tight",t),...a})}));os.displayName="AlertTitle";const cs=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("text-sm [&_p]:leading-relaxed",t),...a})}));cs.displayName="AlertDescription";class ds extends K.H{getBaseURL(){return"/apps"}write(e,s,t){return this.axios.post(`/${e}/coding/write`,{file_path:s,content:t})}exportToGithub(e){return this.axios.post(`/${e}/coding/export-to-github`)}updateGithubRepo(e){return this.axios.post(`/${e}/coding/update-github-repo`)}exportToZip(e){return this.axios.get(`/${e}/coding/export-to-zip`,{responseType:"blob"})}inviteCollaborator(e,s){return this.axios.post(`/${e}/coding/invite-collaborator`,{collaborator_username:s})}searchGithubUsers(e,s){return this.axios.post(`/${e}/coding/search-github-users`,{query:s})}}const ms=new ds;class us extends K.y{getBaseURL(){return"/apps"}updateSecrets(e,s){return this.axios.post(`/${e}/secrets`,s)}deleteSecret(e,s){return this.axios.delete(`/${e}/secrets/${s}`)}getSecrets(e){return this.axios.get(`/${e}/secrets`)}getGeneralSecrets(e){return(0,ee.Ay)("/secrets").get(e)}}const xs=new us;function hs(e,s,t){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};class r extends K.y{constructor(){super(),this.axios.interceptors.response.use((e=>e),(e=>{var a,r;const n=`error trying to call ${s.name} entity api: ${e.config.url}`;let l=e.config.data;try{"string"!=typeof l&&(l=JSON.stringify(l)),l&&l.length>1e3&&(l=l.substring(0,997)+"...")}catch(m){l=String(l)}let i="";try{var o;i=JSON.stringify(null===(o=e.response)||void 0===o?void 0:o.data),i&&i.length>1e3&&(i=i.substring(0,997)+"...")}catch(m){var c;i=String((null===(c=e.response)||void 0===c?void 0:c.data)||"")}const d=`When using the app, on url ${window.location.href} the following entity api call failed: \nentity: ${s.name}\nurl: ${e.config.baseURL}${e.config.url}\nmethod: ${e.config.method}\ndata: ${l}\nerror:${(null===(a=e.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||e.message}\nfulljson:${i}`;return t(n,d),Promise.reject(e)}))}getBaseURL(){return`https://base44.app/api/apps/${e}/entities/${s.name}`}getClient(){return(0,ee.Ay)(this.getBaseURL(),a,!0,!0)}schema(){return s}bulkCreate(e){return this.axios.post("/bulk",e)}importEntities(e){const s=new FormData;return s.append("file",e,e.name),this.axios.post("/import",s,{headers:{"Content-Type":"multipart/form-data"}})}}return new r}function ps(e,s,t){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},r={};return Object.keys(e.entities).forEach((t=>{r[t]=hs(e.id,e.entities[t],s,a)})),r.User=hs(e.id,e.user_entity,s,a),r.User.updateMyUserData=async function(e){return await t.updateMyUserData(e)},r.User.me=async function(){return await t.getMyUserInfo()},r.User.logout=async function(){return await t.logout()},r.User.login=async function(){return await t.login()},r.User.loginWithRedirect=async function(e){return await t.loginWithRedirect(e)},r.User.isUserAuthenticated=function(){return t.isUserAuthenticated()},r}const gs=(0,Y.createContext)(),fs=e=>{let{children:s}=e;const{user:t,reloadUser:a,isAuthenticated:r}=ne(),{appId:n,pageName:l}=(0,Z.g)(),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(!0),[m,u]=(0,Y.useState)(null),[x,h]=(0,Y.useState)([]),[p,g]=(0,Y.useState)(null),[f,v]=(0,Y.useState)(null),[j,b]=(0,Y.useState)([]),[y,N]=(0,Y.useState)(null),[w,k]=(0,Y.useState)(!1),[_,S]=(0,Y.useState)(!1),[C,A]=(0,Y.useState)(null);(0,Y.useEffect)((()=>((0,ee.bx)((()=>n)),r&&a(),()=>{(0,ee.bx)((()=>null)),r&&a()})),[n,r]),(0,Y.useEffect)((()=>{(!i||n&&(null==i?void 0:i.id)!==n)&&(async()=>{try{d(!0);let e=n;await pe.fetchAndSubscribe(e,((e,s)=>{if(s&&s.includes("_last_msg")){const s=(e=ss().cloneDeep(e)).conversation.messages.findIndex((s=>s.id===e._last_msg.id));-1!==s?e.conversation.messages[s]=e._last_msg:e.conversation.messages.push(e._last_msg)}o(e),h([])}));const[s,a]=await Promise.all([Qe.default.getCurrentUsage(),pe.getRuntimeAuthToken(n,t.api_key)]);v(s),L(e),I(e),N(a.token)}catch(s){var e;u("Failed to load app  : "+((null===(e=s.response.data)||void 0===e?void 0:e.message)||s.message))}finally{d(!1)}})()}),[n]);let E=null;l?E=null!=i&&i.pages[l]?{name:l,code:null==i?void 0:i.pages[l]}:null:null!=i&&i.pages&&(E={name:Object.keys(null==i?void 0:i.pages)[0],code:null==i?void 0:i.pages[Object.keys(null==i?void 0:i.pages)[0]]});const I=async e=>{const s=await xs.getSecrets(e);b(Object.keys(s))},L=async e=>{if(!window.location.href.includes("/editor/"))return;const s=await pe.getSuggestions((null==i?void 0:i.id)||e);g(s)};let T=s;return c?T=(0,te.jsx)("div",{className:"fixed inset-0 flex justify-center items-center",children:(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin"})}):m?T=(0,te.jsx)("div",{className:"p-8",children:(0,te.jsx)(is,{variant:"destructive",children:(0,te.jsxs)(cs,{children:[m,(0,te.jsx)("div",{className:"mt-2 text-sm",children:"Please try refreshing the page. If the problem persists, please contact our support team."}),(0,te.jsx)("button",{type:"button",onClick:()=>window.open("/support","_blank"),className:"underline text-primary hover:text-orange-500 transition-colors",children:"support system"})]})})}):i||(T=(0,te.jsx)(is,{variant:"destructive",children:(0,te.jsx)(cs,{children:"App not found"})})),(0,te.jsx)(gs.Provider,{value:{app:i,setApp:o,updateApp:async e=>{const s=await pe.update(i.id,e);h([]),o(s)},isLoading:c,error:m,getEntitiesSDK:function(e){return ps(i,e,null,{Authorization:`Bearer ${y}`})},appErrors:x,setAppErrors:h,onAppError:(e,s,t)=>{let a;a=ss().isObject(e)?{title:e.title||e.message||e.toString(),details:e.details||e.stack||e.toString(),componentName:t||l}:{title:e,details:s,componentName:t||l},h((e=>{if(!e.some((e=>e.title===a.title)))return[...e,a];{const s=e.find((e=>e.title===a.title));s&&i&&(i.components&&i.components[a.componentName]&&!i.components[s.componentName]||i.pages&&i.pages[a.componentName]&&!i.pages[s.componentName]&&!i.components[s.componentName])&&(s.componentName=a.componentName)}return e}))},addChatMessage:async e=>{C&&(e.custom_context=[{type:"element",data:{element_tag_name:C.tagName,filename:C.dataset.filename,linenumber:C.dataset.linenumber},message:`User has selected an element to edit, here's the element's code position: file: ${C.dataset.filename}, line number: ${C.dataset.linenumber}`}],A(null),S(!1)),e.additional_message_params=e.additional_message_params||{},E&&(e.additional_message_params.current_page=E.name),i.conversation.messages.push({...e,role:"user"});try{await qe({appId:n,body:e,app:i,user:t,onSuccess:async e=>{o(e),"pending"!==i.app_stage&&L(),await(async()=>{const e=await Qe.default.getCurrentUsage();v(e)})()},onError:e=>{}})}catch(s){}},undoMessage:async e=>{try{const s=await pe.undoMessage(n,e);o(s)}catch(a){var s,t;if(403===(null===(s=a.response)||void 0===s?void 0:s.status))u("You do not have access to this app");else u("Failed to undo message: "+((null===(t=a.response.data)||void 0===t?void 0:t.message)||a.message))}},currentPage:E,stopChat:async()=>{const e=await pe.stopChat(i.id);o(e)},suggestions:p,currentUsage:f,isSelectingDivMode:w,setIsSelectingDivMode:k,isElementMode:_,setIsElementMode:S,selectedElement:C,setSelectedElement:A,writeCodeToFile:async(e,s)=>{const t=await ms.write(i.id,e,s);h([]),o(t)},existingSecretNames:j,updateSecrets:async e=>{await xs.updateSecrets(n,e),await I(n)},runtimeAuthToken:y},children:T})},vs=()=>(0,Y.useContext)(gs);class js extends K.H{getBaseURL(){return"/files"}uploadFile(e){const s=new FormData;return s.append("file",e),this.axios.post("/",s,{headers:{"Content-Type":"multipart/form-data"}})}uploadAppFile(e,s){const t=new FormData;return t.append("file",e),this.axios.post(`/apps/${s}/upload`,t,{headers:{"Content-Type":"multipart/form-data"}})}}const bs=new js;var ys=t(52607),Ns=t(40578);const ws=Ns.Kq,ks=Ns.bL,_s=Ns.l9,Ss=Y.forwardRef(((e,s)=>{let{className:t,sideOffset:a=4,...r}=e;return(0,te.jsx)(Ns.UC,{ref:s,sideOffset:a,className:ns("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...r})}));function Cs(e){let{onFileUploadClick:s,customButtomRight:t,customButtomLeft:a,variant:r="default"}=e;const[n,l]=(0,Y.useState)(!0),i=(0,Y.useRef)(null);(0,Y.useEffect)((()=>{const e=()=>{if(i.current){const e=i.current.getBoundingClientRect().width;l(e>400)}};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const o="home"===r?"flex justify-between text-sm p-2 bg-gray-50/50 rounded-b-xl":"flex justify-between text-sm p-2",c="home"===r?"flex items-center gap-1 px-2 py-1 rounded-md text-xs text-cyan-700 hover:bg-cyan-50/80":"flex items-center gap-1 px-1 py-1 rounded-md text-xs text-black hover:bg-gray-100",d=(0,te.jsx)(ws,{children:(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)("button",{onClick:s,className:c,children:(0,te.jsx)(ys.A,{className:"h-4 w-4"})})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Upload files"})})]})});return(0,te.jsxs)("div",{className:o,ref:i,children:[(0,te.jsx)("div",{className:"flex gap-1 items-center",children:a?a(d):d}),(0,te.jsx)("div",{className:"flex gap-1 items-center",children:t})]})}Ss.displayName=Ns.UC.displayName;var As=t(59680);function Es(e){let{files:s,uploadingFiles:t,onRemoveFile:a}=e;const[r,n]=(0,Y.useState)({});return 0===s.length&&0===t.length?null:(0,te.jsxs)("div",{className:"flex flex-wrap gap-4 p-4 border-b",children:[s.map(((e,s)=>(0,te.jsx)("div",{className:"relative",children:e.match(/\.(jpg|jpeg|png|gif)$/i)?(0,te.jsxs)("div",{className:"relative group",children:[!r[e]&&(0,te.jsx)("div",{className:"w-[120px] h-[120px] flex items-center justify-center bg-gray-100 rounded-lg",children:(0,te.jsx)(As.A,{className:"w-4 h-4 animate-spin text-gray-500"})}),(0,te.jsx)("img",{src:e,alt:"Attached content",className:"max-w-[120px] max-h-[120px] object-contain rounded-lg border border-gray-200 shadow-sm "+(r[e]?"":"hidden"),onLoad:()=>(e=>{n((s=>({...s,[e]:!0})))})(e)}),(0,te.jsx)("button",{onClick:()=>a(e),className:"absolute top-1 right-1 bg-white/80 text-gray-500 hover:text-gray-700 rounded-full p-1",children:"\xd7"})]}):(0,te.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-white rounded-lg border border-gray-200 group relative",children:[(0,te.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-500",children:[(0,te.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,te.jsx)("polyline",{points:"14 2 14 8 20 8"})]}),(0,te.jsx)("span",{className:"truncate max-w-[150px]",children:e.split("/").pop()}),(0,te.jsx)("button",{onClick:()=>a(e),className:"text-gray-500 hover:text-gray-700",children:"\xd7"})]})},s))),t.map(((e,s)=>(0,te.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-white rounded-lg border border-gray-200",children:[(0,te.jsx)(As.A,{className:"w-4 h-4 animate-spin text-gray-500"}),(0,te.jsxs)("span",{className:"truncate max-w-[150px] text-gray-500 text-sm",children:["Uploading ",e,"..."]})]},s)))]})}var Is=t(19900),Ls=t(88276),Ts=t(53034);function $s(e){let{value:s,onValueChange:t,onKeyDown:a,onPaste:r,placeholder:n,disabled:l,isProcessing:i,onStop:o,onSend:c,isVisualEditMode:d,isDiscussionMode:m,variant:u="default"}=e;const x=(0,Y.useRef)(null);(0,Y.useEffect)((()=>{x.current&&"default"===u&&(x.current.style.height="auto",x.current.scrollHeight>400?x.current.style.height="400px":x.current.style.height=x.current.scrollHeight+"px")}),[s]);const h="home"===u?"w-full pl-4 pt-4 pr-16 text-base resize-none overflow-auto focus:outline-none bg-transparent placeholder:text-slate-400":"w-full pl-4 pt-4 pr-16 text-sm resize-none overflow-auto focus:outline-none bg-transparent rounded-t-lg",p="home"===u?"absolute flex justify-center items-center top-4 right-4 p-1 bg-orange-500 hover:bg-orange-600 text-white rounded-md w-[34px] h-[34px] transition-colors":`absolute flex justify-center items-center top-4 w-[30px] h-[30px] right-4 p-1 ${m?l?"bg-violet-300":"bg-violet-600 hover:bg-violet-800":d?l?"bg-blue-300":"bg-blue-600 hover:bg-blue-800":"bg-gray-900 hover:bg-gray-800"} text-white rounded-lg transition-colors`;return(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)("textarea",{ref:x,value:s,onChange:e=>t(e.target.value),onKeyDown:a,onPaste:r,placeholder:n,disabled:l,className:h,style:{default:{height:"auto",minHeight:"100px",maxHeight:"400px"},home:{height:"110px",minHeight:"110px",maxHeight:"200px"}}[u],onInput:e=>{}}),c&&(0,te.jsx)("button",{onClick:()=>{i?o&&o():c&&c()},className:`${p} ${s||i?"":"opacity-50 cursor-not-allowed"}`,"aria-label":i?"Stop processing":"Send message",title:i?"Stop processing":"Send message",disabled:!s&&!i,children:i?(0,te.jsx)(Is.A,{className:"w-4 h-4"}):l?(0,te.jsx)(Ls.A,{className:"w-4 h-4"}):(0,te.jsx)(Ts.A,{className:"w-4 h-4"})})]})}var Ds=t(96479);function Ps(e){let{value:s,files:t=[],onSend:a,placeholder:r,disabled:n,isProcessing:l,onValueChange:i,onFilesChange:o,onStop:c,customButtomRight:d,customButtomLeft:m,variant:u="default",isAdminMode:x=!1,isDiscussionMode:h=!1,isVisualEditMode:p=!1,isOutOfCredits:g=!1}=e;const f=vs(),v=(0,Y.useRef)(),j=(0,Xe.Ub)({maxWidth:767}),[b,y]=(0,Y.useState)([]),[N,w]=(0,Y.useState)(null),k=()=>{a&&(a({text:s,files:t}),i(""),o([]),w(null))},_=async e=>{try{const{valid:t,error:a}=function(e){const s="."+e.name.split(".").pop().toLowerCase();if(![".jpg",".jpeg",".png",".pdf",".txt",".html"].includes(s))return{valid:!1,error:`File type "${e.name.split(".").pop()}" is not supported. Supported types: jpg, jpeg, png, pdf, txt, html.`};const t=".pdf"===s,a=[".jpg",".jpeg",".png"].includes(s)?41943040:t?10485760:5242880;if(e.size>a){const s=a/1048576;return{valid:!1,error:`File "${e.name}" exceeds the maximum allowed size of ${s}MB.`}}return{valid:!0,error:null}}(e);if(!t)return w(a),null;let r=e;if(e.type.startsWith("image/")){y((s=>[...s,`${e.name} (processing...)`]));try{r=(await async function(e){if(!e.type.startsWith("image/"))return{file:e,mimeType:e.type};const s=1024,t=2097152,r="image/png"===e.type,n=r?"image/png":"image/jpeg",l=r?".png":".jpg";return new Promise(((i,o)=>{const c=new FileReader;c.readAsDataURL(e),c.onload=c=>{const d=new Image;d.src=c.target.result,d.onload=()=>{try{let{width:c,height:m}=d;const u=c>s||m>s;if(e.size<=t&&!u)return void i({file:e,mimeType:e.type});u&&(c>m?(m=Math.round(m*s/c),c=s):(c=Math.round(c*s/m),m=s));const x=document.createElement("canvas");x.width=c,x.height=m;const h=x.getContext("2d");r?h.clearRect(0,0,x.width,x.height):(h.fillStyle="white",h.fillRect(0,0,x.width,x.height)),h.drawImage(d,0,0,c,m);const p=s=>{try{x.toBlob((r=>{if(r)if(r.size<=t)try{const s=e.name,t=s.substring(0,s.lastIndexOf("."))||s,a=new File([r],t+l,{type:n,lastModified:Date.now()});i({file:a,mimeType:n})}catch(a){i({file:e,mimeType:e.type})}else if(s>.55)p(s-.1);else try{const s=e.name,t=s.substring(0,s.lastIndexOf("."))||s,a=new File([r],t+l,{type:n,lastModified:Date.now()});i({file:a,mimeType:n})}catch(a){i({file:e,mimeType:e.type})}else o(new Error("Failed to create image blob"))}),n,r?null:s)}catch(a){i({file:e,mimeType:e.type})}};p(.85)}catch(a){i({file:e,mimeType:e.type})}},d.onerror=s=>{i({file:e,mimeType:e.type})}},c.onerror=s=>{i({file:e,mimeType:e.type})}}))}(e)).file}catch(s){}}y((s=>s.filter((s=>s!==`${e.name} (processing...)`)))),y((s=>[...s,e.name]));const n=null!=f&&f.app?await bs.uploadAppFile(r,f.app.id):await bs.uploadFile(r);return y((s=>s.filter((s=>s!==e.name)))),w(null),n.url}catch(t){return y((s=>s.filter((s=>s!==e.name)))),null}},S="home"===u?`w-full relative ${!n&&"shadow-md"} border border-slate-200 rounded-xl bg-white/90 backdrop-blur`:`w-full relative ${!n&&"shadow-sm shadow-[0_-10px_20px_8px_rgba(248,250,252,1)]"} border border-gray-200 rounded-[16px] bg-white/80 backdrop-blur`;return(0,te.jsxs)("div",{className:S,onDrop:async e=>{e.preventDefault();const s=Array.from(e.dataTransfer.files).map((e=>_(e))),a=(await Promise.all(s)).filter((e=>null!==e));a.length>0&&o([...t,...a])},onDragOver:e=>{e.preventDefault()},children:[(0,te.jsx)(Es,{files:t,uploadingFiles:b,onRemoveFile:e=>o(t.filter((s=>s!==e)))}),N&&(0,te.jsx)("div",{className:"px-4 py-2",children:(0,te.jsxs)(is,{variant:"destructive",className:"flex items-center justify-between",children:[(0,te.jsxs)(cs,{children:[N,(0,te.jsxs)("div",{className:"mt-1 text-xs",children:["Please request support for additional file types at ",(0,te.jsx)("a",{href:"https://feedback.base44.com",target:"_blank",rel:"noopener noreferrer",className:"underline hover:text-destructive-foreground/80",children:"feedback.base44.com"})]})]}),(0,te.jsx)("button",{onClick:()=>w(null),className:"ml-2 inline-flex h-5 w-5 items-center justify-center rounded-full bg-destructive/10 hover:bg-destructive/20",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]})}),(0,te.jsx)($s,{value:s,onValueChange:i,onKeyDown:e=>{x?"Enter"===e.key&&(e.ctrlKey||e.metaKey)&&(e.preventDefault(),k()):"Enter"!==e.key||e.shiftKey||(e.preventDefault(),k())},onPaste:async e=>{var s,a;const r=null===(s=e.clipboardData||(null===(a=e.originalEvent)||void 0===a?void 0:a.clipboardData))||void 0===s?void 0:s.items;if(!r)return;const n=[];for(let t of r)if("file"===t.kind){const e=t.getAsFile();e&&n.push(_(e))}const l=(await Promise.all(n)).filter((e=>null!==e));l.length>0&&o([...t,...l])},placeholder:r,disabled:n,isProcessing:l,onStop:c,onSend:a?k:null,variant:u,isAdminMode:x,isDiscussionMode:h,isVisualEditMode:p}),(0,te.jsx)("input",{ref:v,type:"file",id:"chat-file-upload",className:"hidden",multiple:!0,onChange:async e=>{const s=Array.from(e.target.files),a=[];for(let t of s){const e=await _(t);e&&a.push(e)}o([...t,...a]),v.current.value=""},accept:".jpg,.jpeg,.png,.pdf,.txt,.html"}),(0,te.jsx)(Cs,{onFileUploadClick:()=>document.getElementById("chat-file-upload").click(),value:s,isMobile:j,customButtomLeft:m,customButtomRight:d,variant:u})]})}var Ms=t(42678);const Os=(0,ts.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),Rs=Y.forwardRef(((e,s)=>{let{className:t,variant:a,size:r,asChild:n=!1,...l}=e;const i=n?Ms.DX:"button";return(0,te.jsx)(i,{className:ns(Os({variant:a,size:r,className:t})),ref:s,...l})}));Rs.displayName="Button";const Fs=[{id:"neo-brutalism",name:"Neo-Brutalism",description:'Bold colors, high contrast, thick borders, raw functionality, and intentionally "undesigned" aesthetics with rough edges.',features:["High contrast colors","Thick borders","Harsh shadows","Raw typography","Unconventional layouts"],brands:["Figma","Gumroad","Stripe Press"],color:"bg-yellow-400",textColor:"text-black",buttonColor:"bg-red-500",buttonTextColor:"text-white",borderColor:"border-black",prompt:'Use a Neo-Brutalism style with bold colors, high contrast, thick black borders (3-4px), and harsh drop shadows. Create an intentionally "undesigned" aesthetic with raw typography and slightly asymmetrical layouts. Buttons should have thick borders and strong color contrast. Avoid gradients and subtle shadows in favor of stark, bold design elements.'},{id:"neumorphism",name:"Neumorphism",description:"Soft, extruded UI elements that appear to push through the surface, using subtle shadows to create a physical, tactile feel.",features:["Subtle shadows","Soft UI","Monochromatic palette","Minimal depth","Light/dark versions"],brands:["Apple (iOS)","Tesla UI","Samsung One UI"],color:"bg-gray-200",textColor:"text-gray-700",buttonColor:"bg-gray-200",buttonTextColor:"text-gray-700",borderColor:"border-gray-300",prompt:"Create a Neumorphic UI with soft, extruded elements that appear to push through the surface. Use subtle dual shadows (both light and dark) to create a physical, tactile feel. Elements should use a monochromatic color palette with minimal depth and no hard borders. Buttons should have a soft pressed effect on interaction. The background should be a soft light gray (#e0e0e0) or very light color, and UI elements should appear to be carved from the same material as the background."},{id:"glassmorphism",name:"Glassmorphism",description:"Frosted glass effect with transparency, blur, and subtle borders that create depth and layering.",features:["Backdrop blur","Transparency","Subtle borders","Light reflections","Layered interfaces"],brands:["Apple (macOS)","Microsoft (Windows 11)","Spotify"],color:"bg-gradient-to-r from-purple-500 via-pink-500 to-red-500",textColor:"text-white",buttonColor:"bg-white/30",buttonTextColor:"text-white",borderColor:"border-white/50",prompt:"Design with a Glassmorphism style using frosted glass effects with transparency and backdrop blur. Elements should have subtle light borders (1px) and slight transparency. Create depth through layering of translucent elements. Use colorful backgrounds (gradients work well) with frosted glass UI elements on top. Apply backdrop-blur CSS properties and use RGBA colors with alpha transparency. Aim for a modern, clean aesthetic with subtle light reflections and shadows. The design should be unique, beautiful and detailed. the colors should work well together."},{id:"material-design",name:"Material Design",description:"Google's design language using grid-based layouts, responsive animations, padding, and depth effects like lighting and shadows.",features:["Paper metaphor","Bold colors","Grid system","Responsive animations","Elevation shadow system"],brands:["Google","Android","YouTube"],color:"bg-white",textColor:"text-gray-800",buttonColor:"bg-blue-500",buttonTextColor:"text-white",borderColor:"border-gray-200",prompt:"Follow Google's Material Design principles with paper-like cards, bold colors, and responsive animations. Use elevation shadows to indicate hierarchy and focus. Implement a consistent grid system with proper spacing and alignment. Buttons should be flat with hover effects and ripple animations on click. Use Google's typeface recommendations and follow Material color palette guidelines. Add subtle transitions between states and responsive micro-interactions."},{id:"claymorphism",name:"Claymorphism",description:"Soft, puffy, rounded UI elements that appear like clay, with soft shadows and pastel colors.",features:["Soft shadows","Rounded corners","Pastel colors","Puffy appearance","Playful feel"],brands:["Headspace","Duolingo","Clubhouse"],color:"bg-purple-100",textColor:"text-purple-700",buttonColor:"bg-purple-300",buttonTextColor:"text-purple-700",borderColor:"border-purple-200",prompt:"Design with Claymorphism using soft, puffy UI elements that appear like clay. Use large border radius (16-20px), soft inner and outer shadows, and pastel colors. Elements should look soft and squeezable with a playful feel. Implement soft shadows both inside and outside elements to create dimension. Use gentle pastel colors like lavender, mint green, and baby blue. Avoid hard edges and sharp contrasts in favor of soft, rounded corners and gentle color transitions. The design should be unique, beautiful and detailed. the colors should work well together."}];function zs(e){let{onSelectStyle:s}=e;const[t,a]=(0,Y.useState)({}),[r,n]=(0,Y.useState)({}),[l,i]=(0,Y.useState)(!0),o=e=>{n((s=>({...s,[e]:(s[e]||0)+1}))),a((s=>({...s,[e]:!0}))),setTimeout((()=>{a((s=>({...s,[e]:!1})))}),1e3)};return l?(0,te.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,te.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl w-11/12 max-w-6xl max-h-[90vh] overflow-y-auto",children:[(0,te.jsxs)("div",{className:"sticky top-0 bg-white p-4 border-b flex justify-between items-center z-10",children:[(0,te.jsx)("h1",{className:"text-2xl font-bold text-gray-800",children:"Add styling instructions"}),(0,te.jsx)("button",{onClick:()=>i(!1),className:"text-gray-500 hover:text-gray-700",children:(0,te.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:(0,te.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),(0,te.jsx)("div",{className:"p-4",children:Fs.map((e=>(0,te.jsx)("section",{id:e.id,className:"mb-16 scroll-mt-32 rounded-xl overflow-hidden bg-white shadow-lg transition-colors duration-300",children:(0,te.jsxs)("div",{className:"flex flex-col md:flex-row",children:[(0,te.jsxs)("div",{className:"md:w-1/3 p-6",children:[(0,te.jsx)("h2",{className:"text-2xl font-bold mb-2 text-gray-800",children:e.name}),(0,te.jsx)("p",{className:"mb-6 text-gray-600",children:e.description}),(0,te.jsxs)("div",{className:"mb-6",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-800",children:"Key Features"}),(0,te.jsx)("ul",{className:"list-disc list-inside text-gray-600",children:e.features.map(((e,s)=>(0,te.jsx)("li",{className:"mb-1",children:e},s)))})]}),(0,te.jsxs)("div",{className:"mb-6",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold mb-2 text-gray-800",children:"Used By"}),(0,te.jsx)("div",{className:"flex flex-wrap gap-2",children:e.brands.map(((e,s)=>(0,te.jsx)("span",{className:"inline-block px-3 py-1 rounded-full text-sm bg-gray-100 text-gray-700",children:e},s)))})]}),(0,te.jsx)("button",{onClick:()=>{return t=e.id,s(t),void i(!1);var t},className:"w-full py-2 px-4 bg-gray-800 text-white font-medium rounded-lg hover:bg-black hover:shadow-sm transition-all duration-200 border border-transparent hover:border-gray-700",children:"Add Style Instructions"})]}),(0,te.jsx)("div",{className:"md:w-2/3",children:(0,te.jsx)("div",{className:`p-6 h-full flex items-center justify-center ${"neo-brutalism"===e.id?"bg-yellow-50":"neumorphism"===e.id?"bg-gray-100":"glassmorphism"===e.id?e.color:"material-design"===e.id?"bg-gray-50":"bg-purple-50"}`,children:(0,te.jsxs)("div",{className:"w-full max-w-lg",children:["neo-brutalism"===e.id&&(0,te.jsxs)("div",{className:"bg-yellow-400 p-6 border-4 border-black shadow-[8px_8px_0px_0px_rgba(0,0,0,1)] transform -rotate-1",children:[(0,te.jsx)("h3",{className:"text-xl font-bold mb-4 font-mono text-black",children:"Raw. Unfiltered. Brutal."}),(0,te.jsx)("p",{className:"mb-4 text-black",children:"Neo-Brutalism embraces imperfection and raw expression."}),(0,te.jsx)("button",{className:`bg-red-500 text-white font-bold py-2 px-4 border-4 border-black ${t[e.id]?"animate-bounce":""} hover:bg-red-600 transform hover:-translate-y-1 transition-transform`,onClick:()=>o(e.id),children:"CLICK ME"}),(0,te.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-3",children:[(0,te.jsx)("div",{className:"bg-blue-500 border-4 border-black p-2",children:(0,te.jsx)("p",{className:"text-white text-sm font-bold",children:"Bold"})}),(0,te.jsx)("div",{className:"bg-green-500 border-4 border-black p-2",children:(0,te.jsx)("p",{className:"text-black text-sm font-bold",children:"Raw"})}),(0,te.jsx)("div",{className:"bg-purple-500 border-4 border-black p-2",children:(0,te.jsx)("p",{className:"text-white text-sm font-bold",children:"Expressive"})})]})]}),"neumorphism"===e.id&&(0,te.jsx)("div",{className:"bg-gray-200 p-6 rounded-xl",children:(0,te.jsxs)("div",{className:"bg-gray-200 p-6 rounded-xl shadow-[5px_5px_10px_rgba(0,0,0,0.1),_-5px_-5px_10px_rgba(255,255,255,0.8)]",children:[(0,te.jsx)("h3",{className:"text-xl font-medium mb-4 text-gray-700",children:"Soft & Tactile"}),(0,te.jsx)("p",{className:"mb-4 text-gray-600",children:"Neumorphism creates a soft UI that appears to extrude from the background."}),(0,te.jsx)("button",{className:`bg-gray-200 text-gray-700 font-medium py-2 px-4 rounded-xl ${t[e.id]?"shadow-[inset_5px_5px_10px_rgba(0,0,0,0.1),_inset_-5px_-5px_10px_rgba(255,255,255,0.8)]":"shadow-[5px_5px_10px_rgba(0,0,0,0.1),_-5px_-5px_10px_rgba(255,255,255,0.8)]"} hover:shadow-[inset_5px_5px_10px_rgba(0,0,0,0.1),_inset_-5px_-5px_10px_rgba(255,255,255,0.8)] transition-shadow`,onClick:()=>o(e.id),children:"Soft Press"}),(0,te.jsx)("div",{className:"mt-4",children:(0,te.jsxs)("div",{className:"flex items-center justify-between bg-gray-200 p-3 rounded-xl shadow-[inset_3px_3px_6px_rgba(0,0,0,0.1),_inset_-3px_-3px_6px_rgba(255,255,255,0.8)]",children:[(0,te.jsx)("p",{className:"text-gray-700 font-medium",children:"Volume"}),(0,te.jsx)("div",{className:"w-32 h-4 bg-gray-200 rounded-full shadow-[inset_3px_3px_6px_rgba(0,0,0,0.1),_inset_-3px_-3px_6px_rgba(255,255,255,0.8)]",children:(0,te.jsx)("div",{className:"h-4 bg-blue-400 rounded-full transition-all duration-300",style:{width:10*(r[e.id]||0)+"%"}})})]})})]})}),"glassmorphism"===e.id&&(0,te.jsxs)("div",{className:"relative min-h-64 p-6 rounded-xl overflow-hidden",children:[(0,te.jsx)("div",{className:"absolute inset-0 flex justify-around items-center",children:[...Array(5)].map(((s,a)=>(0,te.jsx)("div",{className:"bg-white rounded-full w-16 h-16 opacity-20 "+(t[e.id]?"animate-pulse":"")},a)))}),(0,te.jsx)("div",{className:"relative z-10",children:(0,te.jsxs)("div",{className:"backdrop-blur-xl bg-white/30 p-6 rounded-xl border border-white/50 shadow-lg",children:[(0,te.jsx)("h3",{className:"text-xl font-medium mb-4 text-white",children:"Transparent & Blurred"}),(0,te.jsx)("p",{className:"mb-4 text-white/90",children:"Glassmorphism creates a frosted glass effect that adds depth and elegance."}),(0,te.jsx)("button",{className:"backdrop-blur-sm bg-white/30 text-white font-medium py-2 px-4 rounded-xl border border-white/50 hover:bg-white/40 transition-colors",onClick:()=>o(e.id),children:"See Through"}),(0,te.jsxs)("div",{className:"mt-4 flex space-x-2",children:[(0,te.jsx)("div",{className:"backdrop-blur-xl bg-white/20 p-2 rounded-xl border border-white/50 shadow-lg flex-1 text-center",children:(0,te.jsx)("p",{className:"text-white text-sm font-medium",children:"Layer 1"})}),(0,te.jsx)("div",{className:"backdrop-blur-xl bg-white/30 p-2 rounded-xl border border-white/50 shadow-lg flex-1 text-center",children:(0,te.jsx)("p",{className:"text-white text-sm font-medium",children:"Layer 2"})}),(0,te.jsx)("div",{className:"backdrop-blur-xl bg-white/40 p-2 rounded-xl border border-white/50 shadow-lg flex-1 text-center",children:(0,te.jsx)("p",{className:"text-white text-sm font-medium",children:"Layer 3"})})]})]})})]}),"material-design"===e.id&&(0,te.jsx)("div",{className:"bg-white p-6 rounded-lg shadow-lg",children:(0,te.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow-md",children:[(0,te.jsx)("h3",{className:"text-xl font-medium mb-4 text-gray-800",children:"Elevated & Structured"}),(0,te.jsx)("p",{className:"mb-4 text-gray-600",children:"Material Design uses physics-inspired animations and layered interfaces."}),(0,te.jsx)("button",{className:`bg-blue-500 text-white font-medium py-2 px-4 rounded shadow-md ${t[e.id]?"shadow-xl -translate-y-1":""} hover:shadow-lg hover:-translate-y-1 transition-all`,onClick:()=>o(e.id),children:"ELEVATE"}),(0,te.jsxs)("div",{className:"mt-4 grid grid-cols-2 gap-4",children:[(0,te.jsx)("div",{className:"bg-red-500 p-3 rounded shadow-md",children:(0,te.jsx)("p",{className:"text-white text-sm font-medium",children:"Cards"})}),(0,te.jsx)("div",{className:"bg-white p-3 rounded shadow-md",children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("p",{className:"text-gray-700 text-sm font-medium",children:"Toggle"}),(0,te.jsx)("div",{className:`w-10 h-5 ${(r[e.id]||0)%2==0?"bg-gray-300":"bg-green-500"} rounded-full shadow-inner flex items-center transition-colors duration-300`,children:(0,te.jsx)("div",{className:"w-5 h-5 bg-white rounded-full shadow-md transform transition-transform duration-300 "+((r[e.id]||0)%2==0?"translate-x-0":"translate-x-5")})})]})})]})]})}),"claymorphism"===e.id&&(0,te.jsx)("div",{className:"bg-purple-100 p-6 rounded-3xl shadow-lg",children:(0,te.jsxs)("div",{className:"bg-blue-100 p-6 rounded-3xl shadow-[6px_6px_12px_rgba(0,0,0,0.1),_-6px_-6px_12px_rgba(255,255,255,0.8),_inset_1px_1px_2px_rgba(255,255,255,0.8)]",children:[(0,te.jsx)("h3",{className:"text-xl font-medium mb-4 text-blue-700",children:"Soft & Puffy"}),(0,te.jsx)("p",{className:"mb-4 text-blue-600",children:"Claymorphism creates a soft, puffy, and playful interface that looks like clay."}),(0,te.jsx)("button",{className:`bg-purple-300 text-purple-700 font-medium py-2 px-4 rounded-2xl \n                                ${t[e.id]?"shadow-[inset_4px_4px_8px_rgba(0,0,0,0.1),_inset_-4px_-4px_8px_rgba(255,255,255,0.5)]":"shadow-[4px_4px_8px_rgba(0,0,0,0.1),_-4px_-4px_8px_rgba(255,255,255,0.5)]"} \n                                hover:shadow-[inset_4px_4px_8px_rgba(0,0,0,0.1),_inset_-4px_-4px_8px_rgba(255,255,255,0.5)] transition-shadow`,onClick:()=>o(e.id),children:"Squish Me"}),(0,te.jsxs)("div",{className:"mt-4 grid grid-cols-3 gap-2",children:[(0,te.jsx)("div",{className:"bg-green-100 p-2 rounded-2xl shadow-[6px_6px_12px_rgba(0,0,0,0.1),_-6px_-6px_12px_rgba(255,255,255,0.8),_inset_1px_1px_2px_rgba(255,255,255,0.8)]",children:(0,te.jsx)("p",{className:"text-green-600 text-sm font-medium text-center",children:"Soft"})}),(0,te.jsx)("div",{className:"bg-yellow-100 p-2 rounded-2xl shadow-[6px_6px_12px_rgba(0,0,0,0.1),_-6px_-6px_12px_rgba(255,255,255,0.8),_inset_1px_1px_2px_rgba(255,255,255,0.8)]",children:(0,te.jsx)("p",{className:"text-yellow-600 text-sm font-medium text-center",children:"Puffy"})}),(0,te.jsx)("div",{className:"bg-pink-100 p-2 rounded-2xl shadow-[6px_6px_12px_rgba(0,0,0,0.1),_-6px_-6px_12px_rgba(255,255,255,0.8),_inset_1px_1px_2px_rgba(255,255,255,0.8)]",children:(0,te.jsx)("p",{className:"text-pink-600 text-sm font-medium text-center",children:"Playful"})})]})]})})]})})})]})},e.id)))})]})}):null}class Us extends K.y{listCatalogItems(){let{limit:e,skip:s,sort_by:t,...a}=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const r={};return Object.keys(a).length>0&&(r.q=JSON.stringify(a)),e&&(r.limit=e),s&&(r.skip=s),t&&(r.sort_by=t),this.axios.get("/catalog",Object.keys(r).length?{params:r}:void 0)}getCatalogItem(e){return this.axios.get(`/catalog/${e}`)}submitItem(e){return this.axios.post("/catalog",e)}upvoteItem(e){return this.axios.post(`/catalog/${e}/upvote`)}approveItem(e,s){const t=s?{language:s}:void 0;return this.axios.post(`/catalog/${e}/approve`,t)}declineItem(e,s){const t=s?{reason:s}:void 0;return this.axios.post(`/catalog/${e}/decline`,t)}archiveItem(e){return this.axios.post(`/catalog/${e}/archive`)}inviteAdmin(e,s){return this.axios.post(`/catalog/${e}/invite`,{email:s})}}const Bs=new class extends Us{getBaseURL(){return"/integration-catalog-items"}},Ws=(0,ts.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function qs(e){let{className:s,variant:t,...a}=e;return(0,te.jsx)("div",{className:ns(Ws({variant:t}),s),...a})}const Vs=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})}));Vs.displayName="Card";const Ys=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("flex flex-col space-y-1.5 p-6",t),...a})}));Ys.displayName="CardHeader";const Hs=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("h3",{ref:s,className:ns("text-2xl font-semibold leading-none tracking-tight",t),...a})}));Hs.displayName="CardTitle";const Gs=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("p",{ref:s,className:ns("text-sm text-muted-foreground",t),...a})}));Gs.displayName="CardDescription";const Js=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("p-6 pt-0",t),...a})}));Js.displayName="CardContent";const Zs=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("flex items-center p-6 pt-0",t),...a})}));Zs.displayName="CardFooter";var Ks=t(22180);const Xs=Y.forwardRef(((e,s)=>{let{className:t,orientation:a="horizontal",decorative:r=!0,...n}=e;return(0,te.jsx)(Ks.b,{ref:s,decorative:r,orientation:a,className:ns("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",t),...n})}));Xs.displayName=Ks.b.displayName;const Qs=Y.forwardRef(((e,s)=>{let{className:t,type:a,...r}=e;return(0,te.jsx)("input",{type:a,className:ns("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r})}));Qs.displayName="Input";var et=t(4321),st=t(48971);const tt=(0,ts.cva)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),at=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(st.b,{ref:s,className:ns(tt(),t),...a})}));at.displayName=st.b.displayName;var rt=t(99426),nt=t(25675);const lt=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(rt.bL,{className:ns("grid gap-2",t),...a,ref:s})}));lt.displayName=rt.bL.displayName;const it=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(rt.q7,{ref:s,className:ns("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,te.jsx)(rt.C1,{className:"flex items-center justify-center",children:(0,te.jsx)(nt.A,{className:"h-2.5 w-2.5 fill-current text-current"})})})}));it.displayName=rt.q7.displayName;var ot=t(41953),ct=t(27453),dt=t(17684),mt=t(86311);const ut=ot.bL,xt=ot.YJ,ht=ot.WT,pt=Y.forwardRef(((e,s)=>{let{className:t,children:a,advancedDropdown:r=!1,...n}=e;return(0,te.jsxs)(ot.l9,{ref:s,className:ns(`flex h-10 w-full items-center justify-between ${r?"rounded-lg":"rounded-md"} border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring  disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1`,t),...n,children:[r?(0,te.jsx)("div",{className:"flex-1 min-w-0",children:a}):a,(0,te.jsx)(ot.In,{asChild:!0,children:(0,te.jsx)(ct.A,{className:ns("h-4 w-4 opacity-50",r?"flex-shrink-0 ml-2":"")})})]})}));pt.displayName=ot.l9.displayName;const gt=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ot.PP,{ref:s,className:ns("flex cursor-default items-center justify-center py-1",t),...a,children:(0,te.jsx)(dt.A,{className:"h-4 w-4"})})}));gt.displayName=ot.PP.displayName;const ft=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ot.wn,{ref:s,className:ns("flex cursor-default items-center justify-center py-1",t),...a,children:(0,te.jsx)(ct.A,{className:"h-4 w-4"})})}));ft.displayName=ot.wn.displayName;const vt=Y.forwardRef(((e,s)=>{let{className:t,children:a,position:r="popper",...n}=e;return(0,te.jsx)(ot.ZL,{children:(0,te.jsxs)(ot.UC,{ref:s,className:ns("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,te.jsx)(gt,{}),(0,te.jsx)(ot.LM,{className:ns("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,te.jsx)(ft,{})]})})}));vt.displayName=ot.UC.displayName;const jt=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ot.JU,{ref:s,className:ns("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...a})}));jt.displayName=ot.JU.displayName;const bt=Y.forwardRef(((e,s)=>{let{className:t,children:a,hideCheckIcon:r=!1,...n}=e;return(0,te.jsxs)(ot.q7,{ref:s,className:ns("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r?"pl-2 pr-2":"pl-8 pr-2",t),...n,children:[!r&&(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)(ot.VF,{children:(0,te.jsx)(mt.A,{className:"h-4 w-4"})})}),(0,te.jsx)(ot.p4,{children:a})]})}));bt.displayName=ot.q7.displayName;const yt=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ot.wv,{ref:s,className:ns("-mx-1 my-1 h-px bg-muted",t),...a})}));function Nt(e){let{secret:s,value:t,onChange:a}=e;const{user:r}=ne(),{name:n,description:l}=s,[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)(!0),[m,u]=(0,Y.useState)((null==t?void 0:t.type)||"value"),[x,h]=(0,Y.useState)((null==t?void 0:t.value)||""),[p,g]=(0,Y.useState)("clone"===(null==t?void 0:t.type)?t.value:"");(0,Y.useEffect)((()=>{(async()=>{try{const e=await xs.getGeneralSecrets(n);o(e||[])}catch(e){o([])}finally{d(!1)}})()}),[n]),(0,Y.useEffect)((()=>{"value"===m?a(n,{type:"value",value:x}):"clone"===m&&p&&a(n,{type:"clone",value:p})}),[m,x,p,n,a]);return(0,te.jsxs)("div",{className:"mb-8 pb-6 border-b border-gray-200 last:border-0 last:mb-0 last:pb-0",children:[(0,te.jsx)("div",{className:"flex items-center mb-4",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(et.A,{className:"h-4 w-4 text-gray-500"}),(0,te.jsx)(at,{className:"text-sm font-medium",children:n})]})}),(0,te.jsxs)(lt,{value:m,onValueChange:u,className:"flex gap-8 mb-4",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(it,{value:"value",id:`value-${n}`,className:"h-4 w-4"}),(0,te.jsx)(at,{htmlFor:`value-${n}`,className:"text-xs cursor-pointer",children:"New value"})]}),"platform_admin"===(null==r?void 0:r.platform_role)&&(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(it,{value:"clone",id:`clone-${n}`,className:"h-4 w-4"}),(0,te.jsx)(at,{htmlFor:`clone-${n}`,className:"text-xs cursor-pointer",children:"Reuse existing"})]})]}),"value"===m?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Qs,{type:"password",placeholder:`Enter ${n}`,value:x,onChange:e=>{h(e.target.value)},className:"h-9 text-sm mt-3 transition-all focus:ring-2 focus:ring-offset-1 focus:ring-blue-500"}),l&&(0,te.jsx)("p",{className:"text-xs text-gray-500 mt-2 ml-1",children:l})]}):(0,te.jsxs)(te.Fragment,{children:[c?(0,te.jsxs)("div",{className:"flex items-center h-9 text-xs text-gray-500 mt-3 bg-gray-50 rounded-md px-3",children:[(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin mr-2"}),"Loading existing secrets..."]}):i.length>0?(0,te.jsxs)(ut,{value:p,onValueChange:e=>{g(e)},children:[(0,te.jsx)(pt,{className:"h-9 text-sm mt-3",children:(0,te.jsx)(ht,{placeholder:"Select an existing secret"})}),(0,te.jsx)(vt,{className:"max-h-[200px] overflow-y-auto",children:i.map((e=>(0,te.jsxs)(bt,{value:e.id,className:"text-xs py-3",children:[e.app_name||"Unnamed App"," (",e.secret_name,")"]},e.id)))})]}):(0,te.jsxs)("div",{className:"flex items-center h-9 text-xs text-gray-500 mt-3 bg-gray-50 rounded-md px-3",children:["No existing secrets found for ",n]}),l&&(0,te.jsx)("p",{className:"text-xs text-gray-500 mt-2 ml-1",children:l})]})]})}function wt(e){let{secretNames:s,value:t={},onChange:a}=e;const r=(e,s)=>{a({...t,[e]:s})};return(0,te.jsx)("div",{className:"text-sm px-5 py-7",children:s.map(((e,s)=>(0,te.jsx)("div",{className:"mb-6 last:mb-0",children:(0,te.jsx)(Nt,{secret:e,value:t[e.name],onChange:r})},s)))})}yt.displayName=ot.wv.displayName;const kt=e=>{let{integration:s,secrets:t,onSecretsChange:a,onRemove:r}=e;const{item:n}=s,l=n.required_secrets&&n.required_secrets.length>0,i=!(!l||n.required_secrets.every((e=>{const s=t[e.name];return!!s&&!!("value"!==s.type||s.value&&""!==s.value.trim())&&!!("clone"!==s.type||s.value&&""!==s.value.trim())})));return(0,te.jsx)(Vs,{className:"mt-4 border-slate-200 overflow-hidden "+(i?"border-red-200":""),children:(0,te.jsxs)(Js,{className:"p-0",children:[(0,te.jsx)("div",{className:"flex flex-col sm:flex-row",children:(0,te.jsxs)("div",{className:"flex-1 p-4",children:[(0,te.jsxs)("div",{className:"flex justify-between items-start",children:[(0,te.jsxs)("div",{className:"flex gap-3 items-center mb-2",children:[(0,te.jsx)("div",{className:"h-10 w-10 rounded-md border border-slate-200 flex-shrink-0 overflow-hidden bg-slate-50",children:n.image_url?(0,te.jsx)("img",{src:n.image_url,alt:n.name,className:"h-full w-full object-contain",onError:e=>{e.target.src="",e.target.parentElement.classList.add("bg-gradient-to-br","from-blue-100","to-teal-100"),e.target.parentElement.innerHTML=`<span class="text-teal-600 text-lg font-semibold flex h-full w-full items-center justify-center">${n.name.charAt(0).toUpperCase()}</span>`}}):(0,te.jsx)("div",{className:"h-full w-full bg-gradient-to-br from-blue-100 to-teal-100 flex items-center justify-center",children:(0,te.jsx)("span",{className:"text-teal-600 text-lg font-semibold",children:n.name.charAt(0).toUpperCase()})})}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"font-semibold text-slate-800",children:n.name}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[n.official&&(0,te.jsx)(qs,{className:"bg-blue-50 text-blue-700 border-blue-100 hover:bg-blue-100 text-xs",children:"Official"}),n.requires_backend_functions&&(0,te.jsx)("span",{className:"text-xs text-slate-500",children:"Requires backend functions"})]})]})]}),(0,te.jsx)("button",{className:"text-slate-400 hover:text-slate-600 hover:bg-slate-100 p-1.5 rounded-md transition-colors",onClick:()=>r(s.item.id),title:"Remove integration","aria-label":"Remove integration",children:(0,te.jsx)(Ds.A,{className:"h-4 w-4"})})]}),n.description&&(0,te.jsx)("p",{className:"text-sm text-slate-600 mt-1",children:n.description})]})}),l&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Xs,{className:"my-1"}),(0,te.jsxs)("div",{className:"p-4 pt-3 bg-slate-50",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsx)("h4",{className:"text-xs uppercase tracking-wide text-slate-500 font-medium mb-3",children:"Required API Keys"}),i&&(0,te.jsxs)("div",{className:"flex items-center text-red-500 text-xs mb-3",children:[(0,te.jsx)(Ke.A,{className:"h-3 w-3 mr-1"}),(0,te.jsx)("span",{children:"Missing required keys"})]})]}),(0,te.jsx)(wt,{secretNames:n.required_secrets,value:t,onChange:a})]})]})]})})};var _t=t(38554),St=t(77737),Ct=t(27304),At=t(19201),Et=t(18635),It=t(67637),Lt=t(99438),Tt=t(29126),$t=t(68108);const Dt={CRM:[{title:"CRM for Artists",description:"Create a CRM for artists - should be tailored for visual artists to manage artworks, exhibitions, and clients. I want features to include saving images of sold artwork, custom fields for medium and price, inventory management for available pieces, exhibition schedules, and segmentation of client profiles."},{title:"CRM for Real Estate Agents",description:"Design a CRM for real estate agents - should manage property listings and client interactions. Include features like property images and descriptions, automatic reminders for contract renewals and viewings, integration with property portals, commission tracking, and geolocation mapping for properties."},{title:"CRM for Lawyers/Legal Practices",description:"Develop a CRM for law firms - should help manage cases, track billable hours, and store legal documents. Include features for case management, time tracking, legal workflows, team task delegation, client profiles with case history, and court date reminders."},{title:"CRM for Photographers",description:"Build a CRM for photographers - should handle client galleries and bookings. Include features for gallery management, photoshoot booking with reminders, file delivery systems, pricing packages, and client referral tracking for expanding the business."},{title:"CRM for Healthcare Practices",description:"Create a CRM for healthcare providers - should support clinics with patient management and compliance. Include features for medical history tracking, HIPAA-compliant communications, prescription tracking, billing integration with insurance claims, and patient satisfaction surveys."},{title:"CRM for Influencers/Content Creators",description:"Design a CRM for influencers - should help manage partnerships and content. Include features for campaign management, brand partnership tracking, content scheduling, revenue tracking from posts and merchandise, and audience segmentation by platform."},{title:"CRM for Wedding Planners",description:"Develop a CRM for wedding planners - should help manage tasks, budgets, and events. Include features for task management, client profiles segmented by couples and vendors, budget tracking, event timelines, and visual planning tools like seating arrangements."},{title:"CRM for Fitness Trainers/Gyms",description:"Build a CRM for fitness professionals - should track client progress and manage schedules. Include features for client progress tracking, integration with wearable devices, personalized workout plans, session reminders, and social tracking for referrals."},{title:"CRM for Musicians/Bands",description:"Create a CRM for musicians and bands - should handle events and fan interactions. Include features for event management, fan segmentation, music catalog management, collaboration tools, and tracking of streaming revenue and merchandise sales."},{title:"CRM for Construction Contractors",description:"Design a CRM for contractors - should manage projects, timelines, and resources. Include features for project milestones, resource tracking for materials and subcontractors, budget management, document storage for plans and permits, and client updates on project progress."}],"Dev productivity":[{title:"Online JSON Viewer",description:"Create an online JSON viewer - should allow users to view and format JSON data. Include features for syntax highlighting, collapsible tree structure, JSON validation, and the ability to upload or paste raw JSON for easy analysis."},{title:"Markdown to HTML Converter",description:"Develop a Markdown to HTML converter - should quickly convert Markdown text into HTML. Include features for live preview, support for common Markdown syntax (headings, links, code blocks), and export options to download the resulting HTML."},{title:"Regex Tester",description:"Build a regex tester tool - should help users test and refine regular expressions. Include features for real-time regex evaluation, examples, syntax highlighting, error notifications, and a library of commonly used regex patterns."},{title:"Code Diff Checker",description:"Create a code diff checker - should compare two code snippets side by side to highlight differences. Include features for line-by-line comparison, syntax highlighting for multiple programming languages, and exportable diff reports."},{title:"REST API Tester",description:"Design a REST API tester - should allow testing of API endpoints with customizable HTTP requests. Include features to set headers, body, and query parameters, store test cases, and view response details like headers and status codes."},{title:"Cron Expression Generator",description:"Develop a cron expression generator - should help create cron job expressions for scheduling tasks. Include an intuitive UI to select time intervals, a preview of the generated cron expression, and descriptions of each component of the expression."},{title:"Base64 Encoder/Decoder",description:"Build a Base64 encoder/decoder - should encode or decode text into Base64 format. Include support for large text blocks, file encoding/decoding, and one-click conversion between Base64 and plain text."},{title:"UUID Generator",description:"Create a UUID generator - should generate Universally Unique Identifiers (UUIDs) for use in applications. Include options for different UUID versions, batch generation, and the ability to copy or export UUIDs in bulk."},{title:"Color Palette Generator",description:"Design a color palette generator - should create and visualize color palettes for web design. Include hex and RGB code conversion, color harmonies (complementary, triadic), and the ability to save and export color schemes."}],Educational:[{title:"Interactive Flashcard Creator",description:"Develop an interactive flashcard creator - should allow users to create and study digital flashcards with spaced repetition algorithms for efficient learning."},{title:"Quiz Generator",description:"Build a quiz generator - should create quizzes from custom content or pre-existing question banks for various subjects."},{title:"Language Learning Games",description:"Design language learning games - should be fun and interactive, aimed at improving vocabulary, grammar, and pronunciation in foreign languages."},{title:"Math Problem Solver",description:"Create a math problem solver - should provide step-by-step solutions with explanations for various difficulty levels of math problems."},{title:"Historical Timeline Maker",description:"Develop a historical timeline maker - should allow users to create visual timelines of historical events with customizable layouts and multimedia integration."}],"Content Generation and Editing":[{title:"AI-Powered Writing Assistant",description:"Build an AI-powered writing assistant - should help improve writing with suggestions for grammar, style, and clarity using AI algorithms."},{title:"Social Media Post Generator",description:"Create a social media post generator - should produce engaging posts with customizable templates and trending hashtags."},{title:"Meme Creator",description:"Design an easy-to-use meme creator - should include a library of popular templates and a custom image upload option."},{title:"Infographic Maker",description:"Develop an infographic maker - should be a design tool for creating visually appealing infographics with pre-made templates and icons."},{title:"Resume Builder",description:"Build a resume builder - should craft professional resumes with industry-specific templates and content suggestions."}],"Personal Finance":[{title:"Budget Planner",description:"Create a budget planner - should help users create and manage personal or household budgets with customizable categories."},{title:"Expense Tracker",description:"Develop an expense tracker - should log and categorize expenses, providing insights and reports on spending habits."},{title:"Investment Calculator",description:"Build an investment calculator - should calculate potential returns on investments based on various parameters and market scenarios."},{title:"Debt Repayment Planner",description:"Design a debt repayment planner - should create strategies for efficient debt repayment, including snowball and avalanche methods."},{title:"Currency Converter",description:"Create a currency converter - should provide real-time currency conversion with historical rate charts and rate alerts."}],"Health and Wellness":[{title:"Meal Planner and Recipe Finder",description:"Develop a meal planner and recipe finder - should plan balanced meals and suggest recipes based on dietary preferences and restrictions."},{title:"Workout Routine Generator",description:"Build a workout routine generator - should create personalized workout plans based on fitness goals, equipment availability, and time constraints."},{title:"Meditation Timer and Guide",description:"Create a meditation timer and guide - should offer guided meditations and customizable meditation timers with ambient sounds."},{title:"Sleep Cycle Analyzer",description:"Design a sleep cycle analyzer - should track sleep patterns and provide insights for improving sleep quality."},{title:"Water Intake Tracker",description:"Develop a water intake tracker - should monitor daily water consumption and send reminders to stay hydrated."}],Productivity:[{title:"Pomodoro Timer",description:"Create a Pomodoro timer - should implement the Pomodoro Technique with customizable work and break intervals."},{title:"To-Do List Organizer",description:"Build a to-do list organizer - should manage tasks with priority levels, due dates, and collaboration features."},{title:"Mind Mapping Tool",description:"Design a mind mapping tool - should create visual mind maps for brainstorming and organizing ideas."},{title:"Goal Tracker",description:"Develop a goal tracker - should help set and track personal or professional goals with progress visualization."},{title:"Habit Formation Assistant",description:"Create a habit formation assistant - should help users build and maintain positive habits through reminders and streak tracking."}],"Travel Planning":[{title:"Itinerary Builder",description:"Build an itinerary builder - should create detailed travel itineraries with attractions, reservations, and transportation details."},{title:"Packing List Generator",description:"Develop a packing list generator - should generate customized packing lists based on destination, duration, and activities."},{title:"Flight Delay Predictor",description:"Create a flight delay predictor - should estimate the likelihood of flight delays based on historical data and current conditions."},{title:"Local Currency Converter",description:"Design a local currency converter - should convert currencies with offline support for travelers without constant internet access."},{title:"Travel Phrase Translator",description:"Build a travel phrase translator - should translate common travel phrases with audio pronunciation guides."}],Entertainment:[{title:"Movie Recommendation Engine",description:"Create a movie recommendation engine - should suggest movies based on user preferences, ratings, and viewing history."},{title:"Book Discovery Tool",description:"Develop a book discovery tool - should recommend books across genres based on reading preferences and past favorites."},{title:"Podcast Finder",description:"Build a podcast finder - should discover new podcasts based on topics of interest and listening habits."},{title:"TV Show Episode Tracker",description:"Design a TV show episode tracker - should keep track of watched episodes and provide notifications for new releases."},{title:"Random Activity Generator",description:"Create a random activity generator - should suggest random activities or hobbies to try when bored or looking for inspiration."}],Environmental:[{title:"Carbon Footprint Calculator",description:"Develop a carbon footprint calculator - should estimate personal or household carbon footprint and suggest reduction strategies."},{title:"Recycling Guide",description:"Build a recycling guide - should provide location-specific information on how to properly recycle various items."},{title:"Sustainable Product Finder",description:"Create a sustainable product finder - should help users find eco-friendly alternatives to common products."},{title:"Energy Usage Monitor",description:"Design an energy usage monitor - should track and analyze home energy consumption, offering tips for reduction."},{title:"Local Eco-Event Finder",description:"Develop a local eco-event finder - should locate and promote environmental events and volunteer opportunities in the user's area."}],"Home Management":[{title:"Home Inventory Tracker",description:"Create a home inventory tracker - should catalog household items for insurance purposes or organization."},{title:"Chore Scheduler",description:"Build a chore scheduler - should assign and rotate household chores among family members or roommates."},{title:"Plant Care Reminder",description:"Design a plant care reminder - should send reminders for watering and caring for house plants based on species and season."},{title:"DIY Project Planner",description:"Develop a DIY project planner - should help plan and track home improvement projects with material lists and tutorials."},{title:"Smart Home Device Dashboard",description:"Create a smart home device dashboard - should centralize control and monitoring of various smart home devices."}],"Creative Tools":[{title:"Color Scheme Generator",description:"Build a color scheme generator - should create harmonious color palettes for design projects with export options."},{title:"Font Pairing Assistant",description:"Design a font pairing assistant - should suggest complementary font combinations for typography projects."},{title:"Logo Maker",description:"Create a logo maker - should design simple logos using pre-made elements and customization options."},{title:"Music Chord Progression Generator",description:"Develop a music chord progression generator - should create chord progressions for songwriting inspiration across various genres."},{title:"Digital Art Sketchpad",description:"Build a digital art sketchpad - should provide a simple drawing interface with basic tools for digital sketching and doodling."}]};class Pt extends K.H{getBaseURL(){return"/"}getAppSuggestions(){return this.axios.get("/app-suggestions")}}const Mt=new Pt,Ot={accentTealMuted:"text-cyan-600",accentTealBgLight:"bg-cyan-50 text-cyan-700 border-cyan-100"};function Rt(e){let{onSetPrompt:s}=e;const[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)(!0);(0,Y.useEffect)((()=>{(async()=>{try{i(!0);const e=await Mt.getAppSuggestions();n(e)}catch(e){n(null)}finally{i(!1)}})()}),[]);const o=e=>{s(e)},c=()=>{a(null)},d=e=>({Business:(0,te.jsx)(Et.A,{size:18,className:Ot.accentTealMuted}),Productivity:(0,te.jsx)(St.A,{size:18,className:Ot.accentTealMuted}),Entertainment:(0,te.jsx)(Ct.A,{size:18,className:Ot.accentTealMuted}),Finance:(0,te.jsx)(Ze.A,{size:18,className:Ot.accentTealMuted}),Education:(0,te.jsx)(It.A,{size:18,className:Ot.accentTealMuted}),"E-commerce":(0,te.jsx)(Lt.A,{size:18,className:Ot.accentTealMuted}),Social:(0,te.jsx)(Tt.A,{size:18,className:Ot.accentTealMuted})}[e]||(0,te.jsx)(_t.A,{size:18,className:Ot.accentTealMuted}));return l?(0,te.jsx)("div",{className:"text-sm text-slate-500 mt-4",children:"Loading suggestions..."}):(0,te.jsxs)("div",{className:"mt-10",children:[(0,te.jsx)("h3",{className:"text-slate-700 text-sm font-medium mb-3",children:"Some ideas to get started:"}),r?(()=>{if(!r)return null;const e=[{title:r.app_suggestion_1.title,prompt:r.app_suggestion_1.prompt},{title:r.app_suggestion_2.title,prompt:r.app_suggestion_2.prompt},{title:r.app_suggestion_3.title,prompt:r.app_suggestion_3.prompt},{title:r.app_suggestion_4.title,prompt:r.app_suggestion_4.prompt},{title:r.app_suggestion_5.title,prompt:r.app_suggestion_5.prompt}];return(0,te.jsx)("div",{className:"flex flex-wrap gap-2.5",children:e.map(((e,s)=>(0,te.jsx)("button",{onClick:()=>o(e.prompt),className:`rounded-lg px-3.5 py-2 text-sm font-medium border flex items-center transition-all \n                            ${Ot.accentTealBgLight} hover:bg-cyan-100/70 bg-white/70 hover:shadow-sm`,children:e.title},s)))})})():t?(0,te.jsxs)("div",{children:[(0,te.jsxs)(Rs,{onClick:c,variant:"ghost",size:"sm",className:"mb-2 text-cyan-700 hover:text-cyan-800 hover:bg-cyan-50/50",children:[(0,te.jsx)($t.A,{className:"h-4 w-4 mr-2"}),"Back to categories"]}),(0,te.jsxs)("h3",{className:"text-slate-700 text-sm font-medium mb-3",children:[t," Ideas:"]}),(0,te.jsx)("div",{className:"flex flex-wrap gap-2.5",children:Dt[t].map(((e,s)=>(0,te.jsxs)("button",{onClick:()=>o(e.description),className:`rounded-lg px-3.5 py-2 text-sm font-medium border flex items-center transition-all \n                                ${Ot.accentTealBgLight} hover:bg-cyan-100/70 bg-white/70 hover:shadow-sm`,children:[(0,te.jsx)("span",{className:"mr-1.5",children:d(t)}),e.title]},s)))})]}):(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-slate-700 text-sm font-medium mb-3",children:"App Categories:"}),(0,te.jsx)("div",{className:"flex flex-wrap gap-2.5",children:Object.keys(Dt).map(((e,s)=>(0,te.jsxs)("button",{onClick:()=>(e=>{a(e)})(e),className:`rounded-lg px-3.5 py-2 text-sm font-medium border flex items-center transition-all \n                                ${Ot.accentTealBgLight} hover:bg-cyan-100/70 bg-white/70 hover:shadow-sm`,children:[(0,te.jsx)("span",{className:"mr-1.5",children:d(e)}),e]},s)))})]})]})}function Ft(e){let{onStart:s,loading:t}=e;const[a,r]=(0,Y.useState)(""),[n,l]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(null),[x]=(0,J.useSearchParams)(),h=(0,Z.Zp)(),[p,g]=(0,Y.useState)([]),[f,v]=(0,Y.useState)(!1),[j,b]=(0,Y.useState)({}),[y,N]=(0,Y.useState)(!1),[w,k]=(0,Y.useState)(!1),[_,S]=(0,Y.useState)(!1),[C,A]=(0,Y.useState)(!0);(0,Y.useEffect)((()=>{(async()=>{try{A(!0);const e=await Qe.default.getCurrentUsage();k(e.is_over_limit),S(e.past_due)}catch(e){}finally{A(!1)}})()}),[]),(0,Y.useEffect)((()=>{const e=x.get("integrations");if(e){const s=e.split(",");v(!0),Promise.all(s.map((e=>Bs.getCatalogItem(e)))).then((e=>{const s=e.map((e=>e));g(s)})).catch((e=>{})).finally((()=>{v(!1)}))}}),[]);const E=()=>0===p.length||p.every((e=>{const s=e.item;return!s.required_secrets||0===s.required_secrets.length||s.required_secrets.every((e=>{const s=j[e.name];return!!s&&(!!("value"!==s.type||s.value&&""!==s.value.trim())&&!!("clone"!==s.type||s.value&&""!==s.value.trim()))}))})),I=e=>{if(1===p.length)return r(""),l([]),u(null),o(!1),g([]),b({}),N(!1),void h("/");const s=p.filter((s=>s.item.id!==e));g(s);const t=s.map((e=>e.item.id)).join(",");h(t?`/?integrations=${t}`:"/");const a={...j},n=p.find((s=>s.item.id===e));n&&n.item.required_secrets&&(n.item.required_secrets.forEach((e=>{delete a[e.name]})),b(a)),N(!1)},L=()=>{h("/billing")},T=e=>{if(b(e),y){E()&&N(!1)}},$=()=>{var e;const s=m?(null===(e=Fs.find((e=>e.id===m)))||void 0===e?void 0:e.name)||m:null;return(0,te.jsx)(ws,{children:(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsxs)("button",{onClick:()=>d(!0),className:"flex items-center gap-1 px-2 py-1 rounded-md text-xs "+(m?"bg-purple-100 text-purple-700":"text-gray-600 hover:bg-gray-100"),children:[(0,te.jsx)(He.A,{className:"h-3 w-3"}),(0,te.jsx)("span",{children:s?`Style: ${s}`:"Styling Instructions"})]})}),(0,te.jsx)(Ss,{side:"top",className:"bg-slate-800 text-white p-3 rounded-lg border-0 shadow-xl max-w-[300px]",children:(0,te.jsx)("div",{className:"space-y-2",children:(0,te.jsx)("p",{className:"text-xs leading-relaxed",children:"Select a UI style for your application. This will influence the visual design and components."})})})]})})},D=()=>0===p.length?null:(0,te.jsx)(ws,{children:(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 rounded-md text-xs bg-green-100 text-green-700",children:[(0,te.jsx)(Ge.A,{className:"h-3 w-3"}),(0,te.jsxs)("span",{children:["Integrations: ",p.length]})]})}),(0,te.jsx)(Ss,{side:"top",className:"bg-slate-800 text-white p-3 rounded-lg border-0 shadow-xl max-w-[300px]",children:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{className:"text-xs font-medium",children:"Selected Integrations:"}),(0,te.jsx)("div",{className:"flex flex-wrap gap-1",children:p.map((e=>(0,te.jsx)(qs,{className:"bg-green-700 text-xs",children:e.item.name},e.item.id)))})]})})]})});return(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"relative",children:[_&&(0,te.jsxs)("div",{className:"mb-3 p-4 bg-yellow-50 border border-yellow-200 rounded-md text-yellow-800 flex flex-col gap-3",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Ze.A,{className:"h-5 w-5 mr-2 flex-shrink-0"}),(0,te.jsx)("span",{className:"font-medium",children:"Subscription payment overdue"})]}),(0,te.jsx)("p",{className:"text-sm",children:"Your subscription payment is overdue, Access to some features is currently limited. Please update your payment method to regain full access."}),(0,te.jsx)("div",{children:(0,te.jsx)(Rs,{onClick:L,className:"bg-amber-600 hover:bg-amber-700 text-white",size:"sm",children:"Go to Billing"})})]}),!_&&w&&(0,te.jsxs)("div",{className:"mb-3 p-4 bg-amber-50 border border-amber-200 rounded-md text-amber-800 flex flex-col gap-3",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Ze.A,{className:"h-5 w-5 mr-2 flex-shrink-0"}),(0,te.jsx)("span",{className:"font-medium",children:"You've reached your usage limit"})]}),(0,te.jsx)("p",{className:"text-sm",children:"You need to upgrade your plan to continue creating apps."}),(0,te.jsx)("div",{children:(0,te.jsx)(Rs,{onClick:L,className:"bg-amber-600 hover:bg-amber-700 text-white",size:"sm",children:"Go to Billing"})})]}),y&&(0,te.jsxs)("div",{className:"mb-3 p-3 bg-red-50 border border-red-200 rounded-md text-red-600 text-sm flex items-center",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4 mr-2 flex-shrink-0"}),(0,te.jsx)("span",{children:"Please fill in all required API keys before submitting."})]}),(0,te.jsx)(Ps,{value:a,files:n,onSend:()=>{const e=a.trim();if(e){if(w)return;if(!E())return void N(!0);s({text:e,files:n,deep_coding_mode:i,integrations:p.map((e=>e.item.id)),secrets:j}),r(""),l([]),u(null),N(!1)}},placeholder:"Describe the app you want to create...",disabled:t||w||C,isProcessing:t||C,onValueChange:r,onFilesChange:l,variant:"home",customButtomLeft:e=>(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[e,(0,te.jsx)($,{}),(0,te.jsx)(D,{})]})})]}),f?(0,te.jsxs)("div",{className:"mt-4 flex items-center justify-center p-4 bg-slate-50 rounded-lg border border-slate-200",children:[(0,te.jsx)(Je.A,{className:"h-5 w-5 text-slate-400 animate-spin mr-3"}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"Loading integration..."})]}):p.length>0?(0,te.jsx)("div",{children:p.map(((e,s)=>(0,te.jsx)(kt,{integration:e,secrets:j,onSecretsChange:T,onRemove:I},s)))}):(0,te.jsx)(te.Fragment,{children:!w&&(0,te.jsx)(Rt,{onSetPrompt:e=>{r(e)}})}),c&&(0,te.jsx)(zs,{onSelectStyle:e=>{u(e),d(!1);const s=Fs.find((s=>s.id===e));s&&r((e=>{const t=e.trim();return t?`${t}\n------\n${s.prompt}`:s.prompt}))}})]})}var zt=t(13052),Ut=t(59051),Bt=t.n(Ut),Wt=t(98950);const qt=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Wt.bL,{ref:s,className:ns("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...a})}));qt.displayName=Wt.bL.displayName;const Vt=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Wt._V,{ref:s,className:ns("aspect-square h-full w-full",t),...a})}));Vt.displayName=Wt._V.displayName;const Yt=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Wt.H4,{ref:s,className:ns("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...a})}));Yt.displayName=Wt.H4.displayName;var Ht=t(52257);function Gt(){const e="https://app.base44.com";return e||"app.base44.com"}function Jt(e){return e===function(){const e=Gt();return new URL(e).host}()}function Zt(e){return Kt(e.slug)}function Kt(e){const s="base44.app";var t;return`${(t=s).includes("localhost")||t.includes("127.0.0.1")?"http":"https"}://${e}.${s}`}const Xt=function(e){let{app:s,linkToBuilder:t=!0}=e;const{user:a}=ne(),r=t?`/apps/${s.id}/editor/preview`:Zt(s);return(0,te.jsx)(J.Link,{to:r,className:"block h-full",title:`Open ${s.name}`,children:(0,te.jsxs)("div",{className:"bg-white rounded-xl overflow-hidden h-full border border-slate-200 hover:border-orange-200 hover:shadow-md transition-all duration-300 flex flex-col",children:[(0,te.jsxs)("div",{className:"p-4 pb-3 flex items-center gap-3",children:[(0,te.jsxs)(qt,{className:"h-12 w-12 rounded-lg shadow-sm",children:[(0,te.jsx)(Vt,{src:s.logo_url,alt:`${s.name} Logo`}),(0,te.jsx)(Yt,{className:"bg-gradient-to-br from-orange-100 to-orange-50 text-orange-500 rounded-lg",children:(e=>{if(!e)return"?";const s=e.trim().split(" ");return 1===s.length?e.charAt(0).toUpperCase():(s[0].charAt(0)+s[1].charAt(0)).toUpperCase()})(s.name)})]}),(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsx)("h3",{className:"font-medium text-slate-800 truncate",children:s.name}),"platform_admin"===a.platform_role&&(0,te.jsxs)("p",{className:"text-xs text-slate-500 truncate",children:["by ",s.created_by]})]})]}),(0,te.jsx)("div",{className:"px-4 py-2 flex-1",children:(0,te.jsx)("p",{className:"text-sm text-slate-600 line-clamp-2",children:s.user_description||"No description available"})}),(0,te.jsx)("div",{className:"px-4 py-3 bg-slate-50/50 border-t border-slate-100 mt-auto",children:(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsxs)("div",{className:"flex items-center text-xs text-slate-500",children:[(0,te.jsx)(St.A,{size:12,className:"mr-1 text-slate-400"}),(0,te.jsxs)("span",{children:["Updated ",(n=s.updated_date,Bt().utc(n,Bt().ISO_8601).fromNow())]})]}),(0,te.jsx)("span",{className:"text-orange-500 opacity-0 group-hover:opacity-100 transition-opacity duration-300",children:(0,te.jsx)(Ht.A,{size:16})})]})})]})});var n};const Qt=function(){const[e,s]=(0,Y.useState)([]),[t,a]=(0,Y.useState)(!0),r=(0,Z.Zp)(),{activeWorkspaceId:n}=xe();(0,Y.useEffect)((()=>{l()}),[n]);const l=async()=>{a(!0);try{const e=await pe.list("-updated_date",9,0,["id","name","user_description","status","updated_date","logo_url","created_date","created_by"].join(","));s(e)}catch(e){}finally{a(!1)}},i=()=>{r("/"),window.scrollTo({top:0,behavior:"smooth"})};return(0,te.jsxs)("div",{className:"fade-in",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)("h2",{className:"text-xl font-bold text-slate-900",children:"My Recent Apps"}),(0,te.jsx)("div",{className:"absolute -bottom-2.5 left-0 w-12 h-0.5 bg-orange-500 rounded-full"})]}),e.length>6&&(0,te.jsx)("button",{onClick:()=>{r("/apps")},className:"text-sm text-orange-600 hover:text-orange-700 font-medium",children:"View all"})]}),t?(0,te.jsx)("div",{className:"flex justify-center py-12",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}):e.length>0?(0,te.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-5 slide-up",children:[e.map(((e,s)=>(0,te.jsx)("div",{className:"animate-in",style:{animationDelay:80*s+"ms"},children:(0,te.jsx)(Xt,{app:e})},e.id))),(0,te.jsx)("div",{className:"border-2 border-dashed border-slate-200 rounded-xl flex items-center justify-center h-[188px] hover:border-orange-300 transition-colors",children:(0,te.jsxs)("button",{onClick:i,className:"flex flex-col items-center text-slate-400 hover:text-orange-600 transition-colors p-4",children:[(0,te.jsx)(zt.A,{size:28,className:"mb-2.5"}),(0,te.jsx)("span",{className:"font-medium text-sm",children:"Create New App"})]})})]}):(0,te.jsxs)("div",{className:"text-center py-12 border-2 border-dashed border-slate-200 rounded-xl fade-in p-8",children:[(0,te.jsx)("h3",{className:"text-xl mb-4 text-slate-800",children:"You haven't created any apps yet."}),(0,te.jsx)("p",{className:"text-slate-600 mb-6",children:"Create your first app using the form above!"}),(0,te.jsxs)("button",{onClick:i,className:"inline-flex items-center text-white bg-orange-500 hover:bg-orange-600 transition-colors px-4 py-2 rounded-lg font-medium",children:[(0,te.jsx)(zt.A,{size:18,className:"mr-2"}),"Create New App"]})]}),(0,te.jsx)("style",{jsx:!0,global:!0,children:"\n                .fade-in {\n                    animation: fadeIn 0.5s ease-out;\n                }\n                \n                .slide-up > * {\n                    opacity: 0;\n                    transform: translateY(15px);\n                }\n                \n                .animate-in {\n                    animation: slideUp 0.4s ease-out forwards;\n                }\n                \n                @keyframes fadeIn {\n                    from { opacity: 0; }\n                    to { opacity: 1; }\n                }\n                \n                @keyframes slideUp {\n                    from { \n                        opacity: 0;\n                        transform: translateY(15px);\n                    }\n                    to { \n                        opacity: 1;\n                        transform: translateY(0);\n                    }\n                }\n            "})]})};var ea=t(6890);class sa extends K.H{getBaseURL(){return"/app-logs"}fetchLogs(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return this.axios.get(`/${e}`,{params:s})}logUserInApp(e,s){return this.axios.post(`/${e}/log-user-in-app/${s}`)}getStats(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return"all"===e?this.axios.get("/platform-admin/platform-stats",{params:s}):this.axios.get(`/${e}/stats`,{params:s})}getUserStats(e){return this.axios.get(`/user-stats/${e}`)}getTrendingApps(){return(0,ee.Ay)("/apps/public").get("/trending")}}const ta=new sa;function aa(){const[e,s]=(0,Y.useState)([]),[t,a]=(0,Y.useState)(!0);return(0,Y.useEffect)((()=>{(async()=>{try{const e=await ta.getTrendingApps();s(e.trending_apps.map((e=>({...e,created_by:"Community"}))))}catch(e){}finally{a(!1)}})()}),[]),t?(0,te.jsxs)("div",{className:"mt-12",children:[(0,te.jsxs)("h2",{className:"text-2xl font-bold mb-6 flex items-center",children:[(0,te.jsx)(ea.A,{className:"w-6 h-6 mr-2"}),"Trending Apps"]}),(0,te.jsx)("div",{className:"flex justify-center",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-primary"})})]}):e.length?(0,te.jsx)("div",{className:"mt-12",children:(0,te.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 gap-6",children:e.map((e=>(0,te.jsx)(Xt,{app:e,linkToBuilder:!1},e.id)))})}):null}var ra=t(28362);const na=ra.Root,la=ra.Trigger,ia=ra.Portal,oa=ra.Close,ca=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ra.Overlay,{ref:s,className:ns("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a})}));ca.displayName=ra.Overlay.displayName;const da=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsxs)(ia,{children:[(0,te.jsx)(ca,{}),(0,te.jsxs)(ra.Content,{ref:s,className:ns("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[a,(0,te.jsxs)(ra.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,te.jsx)(Ds.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}));da.displayName=ra.Content.displayName;const ma=e=>{let{className:s,...t}=e;return(0,te.jsx)("div",{className:ns("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};ma.displayName="DialogHeader";const ua=e=>{let{className:s,...t}=e;return(0,te.jsx)("div",{className:ns("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};ua.displayName="DialogFooter";const xa=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ra.Title,{ref:s,className:ns("text-lg font-semibold leading-none tracking-tight",t),...a})}));xa.displayName=ra.Title.displayName;const ha=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ra.Description,{ref:s,className:ns("text-sm text-muted-foreground",t),...a})}));ha.displayName=ra.Description.displayName;var pa=t(68935),ga=t(6285),fa=t(72916);class va extends K.y{getBaseURL(){return"/custom-domains"}refreshStatus(e){return this.axios.post(`/${e}/status`)}verify(e){return this.axios.post(`/${e}/verify`)}unlink(e){return this.axios.post(`/${e}/unlink`)}link(e){return this.axios.post(`/${e}/link`)}getEntriToken(e){let{appId:s,appName:t}=e;return(0,ee.Ay)("/apps/buy_domain").post("/start",{appId:s,appName:t})}}const ja=new va,ba=e=>{let{app:s,isOpen:t,onClose:a}=e;const[r,n]=(0,Y.useState)([]);(0,Y.useEffect)((()=>{(async()=>{if(t&&s)try{const e=await ja.filter({app_id:s.id});n(e)}catch(e){}})()}),[t,null==s?void 0:s.id]);const l=e=>{const t=s?`I've built ${s.name} with @base_44!`:"Check out what I built with @base_44!",a=s&&r.length>0?`https://${r[0].domain}`:s?Zt(s):window.location.href;"twitter"===e?window.open(`https://x.com/intent/tweet?text=${encodeURIComponent(t)}`):"linkedin"===e&&window.open(`https://www.linkedin.com/sharing/share-offsite/?url=${encodeURIComponent(a)}`)};return(0,te.jsx)(na,{open:t,onOpenChange:a,children:(0,te.jsxs)(da,{className:"sm:max-w-[625px]",children:[(0,te.jsxs)(ma,{children:[(0,te.jsx)("div",{className:"flex justify-between items-center",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(pa.A,{className:"h-5 w-5 text-primary"}),(0,te.jsx)(xa,{className:"text-xl",children:s?`Share ${s.name}`:"Share Project"})]})}),(0,te.jsx)(ha,{className:"text-sm text-muted-foreground",children:"Share your project and earn 20 free credits to keep building!"})]}),(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsxs)("div",{className:"bg-secondary/20 p-4 rounded-lg space-y-3 border border-border",children:[(0,te.jsx)("h3",{className:"font-medium text-sm",children:"Sharing Guidelines"}),(0,te.jsxs)("ul",{className:"space-y-2.5 text-sm text-muted-foreground",children:[(0,te.jsxs)("li",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Tag ",(0,te.jsx)("span",{className:"font-medium text-foreground",children:"@base_44"})]}),(0,te.jsxs)("li",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Write at least 200 characters about your experience building with Base44"]}),(0,te.jsxs)("li",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Account must have over 100 followers"]}),(0,te.jsxs)("li",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Add a screenshot or video of your project (optional)"]}),(0,te.jsxs)("li",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Add a link to your project (optional)"]}),(0,te.jsxs)("li",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-primary/70"}),"Open a ticket, at ",(0,te.jsx)("button",{type:"button",onClick:()=>{const e=null!=s&&s.id?`/support?appId=${s.id}`:"/support";window.open(e,"_blank")},className:"underline text-primary hover:text-orange-500 transition-colors",children:"support system"}),", with the link to your post"]})]})]}),(0,te.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,te.jsxs)(Rs,{variant:"outline",className:"w-full justify-start gap-2 font-normal",onClick:()=>l("linkedin"),children:[(0,te.jsx)(ga.A,{className:"h-4 w-4"}),"Share on LinkedIn"]}),(0,te.jsxs)(Rs,{variant:"outline",className:"w-full justify-start gap-2 font-normal",onClick:()=>l("twitter"),children:[(0,te.jsx)(fa.A,{className:"h-4 w-4"}),"Share on X (Twitter)"]})]})]})]})})};const ya=function(){const[e,s]=(0,Y.useState)(!1),[t,a]=(0,Y.useState)("my-apps"),[r,n]=(0,Y.useState)(!1),[l,i]=(0,Y.useState)(!0),o=(0,Z.Zp)(),c=(0,Z.zy)(),{user:d}=ne();return(0,te.jsx)("div",{className:"min-h-screen",children:(0,te.jsxs)("main",{className:"relative z-10 max-w-screen-xl mx-auto px-4 sm:px-6 lg:px-8 pt-8 pb-12",children:[(0,te.jsx)("div",{className:"flex justify-center mb-12 sm:mb-12",children:(0,te.jsx)("img",{src:Ye,alt:"Apper Logo",className:"h-10"})}),(0,te.jsxs)("div",{className:"mb-12 sm:mb-16 relative",children:[(0,te.jsxs)("div",{className:"max-w-3xl mx-auto text-center mb-8",children:[(0,te.jsx)("h1",{className:"text-3xl sm:text-4xl font-bold tracking-tight text-slate-900 mb-3",children:"What would you build today?"}),(0,te.jsx)("p",{className:"text-slate-600 text-base sm:text-lg",children:"Describe your app idea below or get inspired by our templates."})]}),(0,te.jsx)("div",{className:"max-w-3xl mx-auto",children:(0,te.jsx)(Ft,{onStart:async e=>{let{text:t,files:a,deep_coding_mode:r,integrations:n,secrets:l}=e;if(t.trim()){s(!0);try{const e=new URLSearchParams(c.search).get("app_platform_version"),s={deep_coding_mode:!!r,status:{state:"processing",details:"Starting conversation..."},integrations:n,secrets:l};e&&(s.platform_version=parseInt(e,10));const i=await pe.create(s);Ve(i.id,{content:t,file_urls:a},null==d?void 0:d.id),o(`/apps/${i.id}/editor/preview`)}catch(i){alert("Failed to create app. Please try again.")}finally{s(!1)}}else alert("Please enter an app description")},loading:e})})]}),(0,te.jsxs)("div",{className:"transition-opacity duration-200 pb-12",children:["my-apps"===t&&(0,te.jsx)(Qt,{}),"trending"===t&&(0,te.jsx)(aa,{})]}),(0,te.jsx)(ba,{isOpen:r,onClose:()=>n(!1)})]})})};var Na=t(13147),wa=t(2263),ka=t(82407),_a=t(24990),Sa=t(46327),Ca=t(12550),Aa=t(39193),Ea=t(9072);const Ia=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{className:"relative w-full overflow-auto",children:(0,te.jsx)("table",{ref:s,className:ns("w-full caption-bottom text-sm",t),...a})})}));Ia.displayName="Table";const La=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("thead",{ref:s,className:ns("[&_tr]:border-b",t),...a})}));La.displayName="TableHeader";const Ta=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("tbody",{ref:s,className:ns("[&_tr:last-child]:border-0",t),...a})}));Ta.displayName="TableBody";const $a=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("tfoot",{ref:s,className:ns("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})}));$a.displayName="TableFooter";const Da=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("tr",{ref:s,className:ns("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a})}));Da.displayName="TableRow";const Pa=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("th",{ref:s,className:ns("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})}));Pa.displayName="TableHead";const Ma=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("td",{ref:s,className:ns("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})}));Ma.displayName="TableCell";const Oa=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("caption",{ref:s,className:ns("mt-4 text-sm text-muted-foreground",t),...a})}));Oa.displayName="TableCaption";const Ra=function(){const{user:e}=ne(),[s,t]=(0,Y.useState)([]),[a,r]=(0,Y.useState)(!0),[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)("desc"),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(1),[p,g]=(0,Y.useState)(!0),[f,v]=(0,Y.useState)("grid"),j="grid"===f?24:100,{activeWorkspaceId:b}=((0,Z.Zp)(),xe());(0,Y.useEffect)((()=>{y()}),[x,i,c,n,f,b]);const y=async()=>{try{const s="desc"===i?"-":"";let a={};c&&(a.created_by=e.email),n&&(a.$or=[{name:{$regex:n,$options:"i"}},{user_description:{$regex:n,$options:"i"}},{created_by:{$regex:n,$options:"i"}}]);const l=await pe.filter(a,`${s}updated_date`,j,(x-1)*j,["id","name","logo_url","user_description","created_by","created_date","updated_date","is_starred"].join(","));t((e=>1===x?l:[...e,...l])),g(l.length===j),r(!1)}catch(s){r(!1)}},N=s.filter((e=>!m||e.is_starred));return a&&1===x?(0,te.jsx)("div",{className:"flex justify-center items-center h-full",children:(0,te.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})}):(0,te.jsx)("div",{className:"p-6 min-h-full",children:(0,te.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,te.jsxs)("div",{className:"flex flex-col md:flex-row justify-between items-start md:items-center gap-4 mb-8",children:[(0,te.jsx)("h2",{className:"text-3xl font-bold",children:"Apps"}),(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 w-full md:w-auto",children:[(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Na.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground h-4 w-4"}),(0,te.jsx)(Qs,{type:"text",placeholder:"Search apps...",className:"pl-10 w-full sm:w-80",value:n,onChange:e=>{l(e.target.value),h(1),t([])}})]}),(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsx)(Rs,{variant:c?"default":"outline",onClick:()=>{d(!c),h(1),t([])},children:c?"My Apps":"All Apps"}),(0,te.jsx)(Rs,{variant:m?"default":"outline",onClick:()=>u(!m),children:(0,te.jsx)(wa.A,{className:"h-4 w-4 "+(m?"fill-current":"")})}),(0,te.jsx)(Rs,{variant:"outline",onClick:()=>{o("desc"===i?"asc":"desc"),h(1),t([])},children:"desc"===i?(0,te.jsx)(ka.A,{className:"h-4 w-4"}):(0,te.jsx)(_a.A,{className:"h-4 w-4"})}),(0,te.jsx)(Rs,{variant:"outline",onClick:()=>{v((e=>"grid"===e?"table":"grid")),h(1),t([])},children:"grid"===f?(0,te.jsx)(Sa.A,{className:"h-4 w-4"}):(0,te.jsx)(Ca.A,{className:"h-4 w-4"})})]})]})]}),"grid"===f?(0,te.jsx)("div",{className:"grid gap-4 sm:grid-cols-2 lg:grid-cols-3",children:N.map((e=>(0,te.jsx)(J.Link,{to:`/apps/${e.id}/editor/preview`,className:"block hover:shadow-lg transition-all duration-300",children:(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsxs)("div",{className:"flex items-center gap-4",children:[(0,te.jsx)(qt,{className:"h-12 w-12 rounded-xl",children:e.logo_url?(0,te.jsx)(Vt,{src:e.logo_url,alt:`${e.name} logo`}):(0,te.jsx)(Yt,{className:"bg-primary/10",children:(0,te.jsx)(Aa.A,{className:"h-6 w-6 text-primary"})})}),(0,te.jsx)("h3",{className:"font-semibold text-lg line-clamp-2",children:e.name})]})}),(0,te.jsxs)(Js,{children:[(0,te.jsxs)("p",{className:"text-muted-foreground mb-3 line-clamp-2",children:[e.user_description||"No description",e.user_description&&e.user_description.length>100&&(0,te.jsx)(Ea.A,{className:"inline ml-1 h-4 w-4"})]}),(0,te.jsxs)("div",{className:"text-xs text-muted-foreground flex flex-wrap gap-2",children:[(0,te.jsxs)("span",{children:["By ",e.created_by]}),(0,te.jsx)(Xs,{orientation:"vertical",className:"h-4"}),(0,te.jsxs)("span",{children:["Created ",Bt().utc(e.created_date).fromNow()]})]})]})]})},e.id)))}):(0,te.jsx)(Vs,{children:(0,te.jsx)(Js,{className:"p-0",children:(0,te.jsxs)(Ia,{children:[(0,te.jsx)(La,{children:(0,te.jsxs)(Da,{children:[(0,te.jsx)(Pa,{className:"w-16"})," ",(0,te.jsx)(Pa,{children:"Name"}),(0,te.jsx)(Pa,{children:"Description"}),(0,te.jsx)(Pa,{children:"Created By"}),(0,te.jsx)(Pa,{children:"Last Updated"}),(0,te.jsx)(Pa,{className:"text-right",children:"Actions"})]})}),(0,te.jsx)(Ta,{children:N.map((e=>(0,te.jsxs)(Da,{children:[(0,te.jsx)(Ma,{className:"p-2",children:(0,te.jsx)(qt,{className:"h-10 w-10 rounded-md",children:e.logo_url?(0,te.jsx)(Vt,{src:e.logo_url,alt:`${e.name} logo`}):(0,te.jsx)(Yt,{className:"bg-primary/10 rounded-md",children:(0,te.jsx)(Aa.A,{className:"h-5 w-5 text-primary"})})})}),(0,te.jsx)(Ma,{className:"font-medium py-2 pr-2",children:(0,te.jsx)(J.Link,{to:`/apps/${e.id}/editor/preview`,className:"hover:underline line-clamp-2",children:e.name})}),(0,te.jsx)(Ma,{className:"text-muted-foreground py-2 pr-2 line-clamp-2",children:e.user_description||"-"}),(0,te.jsx)(Ma,{className:"text-muted-foreground py-2 pr-2 whitespace-nowrap",children:e.created_by}),(0,te.jsx)(Ma,{className:"text-muted-foreground py-2 pr-2 whitespace-nowrap",children:Bt().utc(e.updated_date).fromNow()}),(0,te.jsx)(Ma,{className:"py-2 pl-2 text-right",children:(0,te.jsx)(Rs,{variant:"ghost",size:"icon",onClick:s=>{s.stopPropagation(),alert(`Actions for ${e.name}`)},children:(0,te.jsx)(Ea.A,{className:"h-4 w-4"})})})]},e.id)))})]})})}),0===N.length&&!a&&(0,te.jsx)("div",{className:"text-center py-12 text-muted-foreground",children:"No apps found matching your criteria"}),N.length>0&&(0,te.jsxs)("div",{className:"flex justify-center gap-2 mt-8",children:[(0,te.jsx)(Rs,{variant:"outline",onClick:()=>h((e=>Math.max(1,e-1))),disabled:1===x,children:"Previous"}),(0,te.jsx)(Rs,{variant:"outline",onClick:()=>h((e=>e+1)),disabled:!p,children:"Next"})]}),a&&x>1&&(0,te.jsx)("div",{className:"flex justify-center items-center py-4",children:(0,te.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-primary border-t-transparent rounded-full"})})]})})};var Fa=t(32443),za=t(86805),Ua=t(74878),Ba=t(40978),Wa=t(29975),qa=t(78419),Va=t(65330);function Ya(e){let{children:s}=e;const{app:t,isLoading:a}=vs(),[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)([]),[o,c]=(0,Y.useState)(!0),[d,m]=(0,Y.useState)(!0),[u,x]=(0,Y.useState)(null),h=(0,Y.useMemo)((()=>(null==t?void 0:t.organization_id)||null),[null==t?void 0:t.organization_id]),p=(0,Y.useMemo)((()=>{if(!h||!l.length)return null;return l.find((e=>e.id===h))||null}),[h,l]);(0,Y.useEffect)((()=>((0,ee.r8)((()=>h)),()=>{(0,ee.r8)((()=>null))})),[h]),(0,Y.useEffect)((()=>{n(p)}),[p]);const g=(0,Y.useCallback)((async()=>{try{m(!0),x(null);const e=await de.getWorkspaces();i(e.workspaces||e||[])}catch(e){x(e),i([])}finally{m(!1)}}),[]);(0,Y.useEffect)((()=>{g()}),[g]),(0,Y.useEffect)((()=>{c(a||d)}),[a,d]);const f=(0,Y.useCallback)((e=>{}),[]),v=(0,Y.useCallback)((()=>{}),[]),j={activeWorkspace:r,activeWorkspaceId:h,workspaces:l,isLoading:o,isLoadingWorkspaces:d,error:u,switchActiveWorkspace:f,clearActiveWorkspace:v,refetchWorkspaces:g};return(0,te.jsx)(me.Provider,{value:j,children:s})}var Ha=t(81830),Ga=t(35887),Ja=t(79072),Za=t(24546),Ka=t(17665),Xa=t(10743),Qa=t(70446);function er(e,s){const t=[];let a=0;const r=`<${s} `,n=`</${s}>`;for(;-1!==e.indexOf(r,a);){const s=e.indexOf(r,a);let l=e.indexOf(">",s)+1;0===l&&(l=e.length);const i=e.slice(s,l),o=e.indexOf(n,l);if(-1===o){t.push({openingTagIndex:s,closingTagIndex:null,openingTag:i,content:e.slice(l)});break}t.push({openingTagIndex:s,closingTagIndex:o,openingTag:i,content:e.slice(l,o)}),a=o+n.length}return t}function sr(e,s){const t=e.match(new RegExp(`${s}="([^"]*)"`,"i"));return t?t[1]:void 0}class tr extends K.H{getBaseURL(){return"/apps"}getCheckpointFileTree(e,s){return this.axios.get(`/${e}/app-checkpoints/${s}/file-tree`)}listCheckpoints(e){return this.axios.get(`/${e}/app-checkpoints`)}loadCheckpoint(e,s){return this.axios.post(`/${e}/app-checkpoints/${s}/load`)}}const ar=new tr;var rr=t(35023),nr=t(93477);const lr=nr.bL,ir=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(nr.B8,{ref:s,className:ns("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})}));ir.displayName=nr.B8.displayName;const or=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(nr.l9,{ref:s,className:ns("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})}));or.displayName=nr.l9.displayName;const cr=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(nr.UC,{ref:s,className:ns("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})}));cr.displayName=nr.UC.displayName;const dr=e=>{let{originalCode:s="",modifiedCode:t="",language:a="javascript",title:r="Code Comparison",diffViewStyle:n="default"}=e;const l={readOnly:!0,renderSideBySide:!0,wordWrap:"on",scrollBeyondLastLine:!1,minimap:{enabled:!1},lineNumbers:"on",diffWordWrap:"on"},i="github"===n?"light":"vs";return(0,te.jsxs)(Vs,{className:"w-full shadow-md",children:[(0,te.jsx)(Ys,{className:"pb-2",children:(0,te.jsx)(Hs,{className:"text-lg font-medium",children:r})}),(0,te.jsx)(Js,{children:(0,te.jsxs)(lr,{defaultValue:"diff",className:"w-full",children:[(0,te.jsxs)(ir,{className:"mb-2",children:[(0,te.jsx)(or,{value:"diff",children:"Diff View"}),(0,te.jsx)(or,{value:"original",children:"Original"}),(0,te.jsx)(or,{value:"modified",children:"Modified"})]}),(0,te.jsx)(cr,{value:"diff",className:"w-full",children:(0,te.jsx)("div",{className:"h-[500px] border rounded-md overflow-hidden",children:(0,te.jsx)(rr.zC,{height:"100%",language:a,original:s,modified:t,options:l,theme:i})})}),(0,te.jsx)(cr,{value:"original",children:(0,te.jsx)("div",{className:"h-[500px] border rounded-md overflow-hidden",children:(0,te.jsx)(rr.zC,{height:"100%",language:a,original:s,modified:s,options:{...l,renderSideBySide:!1},theme:i})})}),(0,te.jsx)(cr,{value:"modified",children:(0,te.jsx)("div",{className:"h-[500px] border rounded-md overflow-hidden",children:(0,te.jsx)(rr.zC,{height:"100%",language:a,original:t,modified:t,options:{...l,renderSideBySide:!1},theme:i})})})]})})]})};var mr=t(61878),ur=t(31641);function xr(e){let{msgId:s,isOpen:t,onClose:a}=e;const{user:r}=ne(),{app:n}=vs(),[l,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!0),[d,m]=(0,Y.useState)("diff"),[u,x]=(0,Y.useState)(!1),h=n.conversation.messages.findIndex((e=>e.id===s)),p=n.conversation.messages[h],g=null!=p&&p.content?er(p.content,"action"):[],f=async e=>{try{return await ar.getCheckpointFileTree(n.id,e)}catch(s){return null}};(0,Y.useEffect)((()=>{(async()=>{c(!0);const e=n.conversation.messages.slice(0,h).reverse().find((e=>e.checkpoint_id));if(!p.checkpoint_id)return void c(!1);const s=await f(p.checkpoint_id);let t=null;e&&e.checkpoint_id&&(t=await f(e.checkpoint_id));const a={};s&&t?(Object.entries(s.files).forEach((e=>{let[s,r]=e;const n=t.files[s];n&&JSON.stringify(n)===JSON.stringify(r)||(a[s]={original:n?"string"==typeof n?n:JSON.stringify(n,null,2):"",modified:"string"==typeof r?r:JSON.stringify(r,null,2),type:n?"modified":"added"})})),Object.keys(t.files).forEach((e=>{if(!s.files[e]){const s=t.files[e];a[e]={original:"string"==typeof s?s:JSON.stringify(s,null,2),modified:"",type:"deleted"}}}))):s&&Object.entries(s.files).forEach((e=>{let[s,t]=e;a[s]={original:"",modified:"string"==typeof t?t:JSON.stringify(t,null,2),type:"added"}})),i(a),c(!1)})()}),[s,n.id,h]);const v=p.metadata.created_date,j=p.metadata.created_by_email,b=Bt().utc(v),y=b.clone().subtract(5,"minutes").format(),N=b.clone().add(5,"minutes").format(),w=`https://cloud.langfuse.com/project/cm23r6fre000rr9hhpjkrzoqx/traces?filter=${encodeURIComponent(`userId;string;;=;${j}`)},${encodeURIComponent(`timestamp;datetime;;>;${y},timestamp;datetime;;<;${N}`)}`,k=()=>{null!=p&&p.content&&(navigator.clipboard.writeText(p.content),x(!0),setTimeout((()=>x(!1)),2e3))};return(0,te.jsx)(na,{open:t,onOpenChange:a,children:(0,te.jsxs)(da,{className:"max-w-5xl max-h-[95vh] p-0 overflow-hidden flex flex-col border border-gray-200 rounded-md",children:[(0,te.jsx)(ma,{className:"px-4 py-3 border-b border-gray-200 bg-gray-50 flex flex-row items-center justify-between",children:(0,te.jsx)(xa,{className:"text-base font-medium",children:"Message Details"})}),(0,te.jsxs)(lr,{defaultValue:"diff",className:"flex-1 flex flex-col overflow-hidden",onValueChange:m,children:[(0,te.jsxs)(ir,{className:"px-4 pt-2 bg-white border-b border-gray-200",children:[(0,te.jsxs)(or,{value:"diff",className:"flex items-center",children:[(0,te.jsx)(Ua.A,{className:"h-4 w-4 mr-2"}),"Code Changes"]}),"platform_admin"===r.platform_role&&(0,te.jsxs)(or,{value:"info",className:"flex items-center",children:[(0,te.jsx)(mr.A,{className:"h-4 w-4 mr-2"}),"Message Info"]})]}),(0,te.jsx)(cr,{value:"diff",className:"flex-1 overflow-auto p-0 m-0",children:o?(0,te.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,te.jsx)(Je.A,{className:"h-6 w-6 animate-spin text-gray-500"}),(0,te.jsx)("span",{className:"ml-2 text-gray-600",children:"Loading changes..."})]}):l&&0!==Object.keys(l).length?(0,te.jsx)("div",{className:"divide-y divide-gray-200",children:Object.entries(l).map(((e,s)=>{let[t,a]=e;return(0,te.jsxs)("div",{className:"bg-white",children:[(0,te.jsxs)("div",{className:"flex items-center px-4 py-2 bg-gray-50 border-b border-gray-200",children:[(0,te.jsx)(It.A,{className:"h-4 w-4 mr-2 text-gray-600"}),(0,te.jsx)("span",{className:"font-medium text-sm text-gray-700",children:t}),(0,te.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full "+("added"===a.type?"bg-green-50 text-green-600 border border-green-100":"deleted"===a.type?"bg-red-50 text-red-600 border border-red-100":"bg-blue-50 text-blue-600 border border-blue-100"),children:a.type})]}),(0,te.jsx)("div",{className:"px-0",children:(0,te.jsx)(dr,{originalCode:a.original,modifiedCode:a.modified,language:t.endsWith(".css")?"css":"javascript",title:t,diffViewStyle:"github"})})]},s)}))}):(0,te.jsxs)("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[(0,te.jsx)(Ke.A,{className:"h-10 w-10 mb-3 text-gray-400"}),(0,te.jsx)("p",{children:"No file changes detected for this message."})]})}),"platform_admin"===r.platform_role&&(0,te.jsx)(cr,{value:"info",className:"flex-1 overflow-auto p-0 m-0",children:p?p?(0,te.jsxs)("div",{className:"p-4 space-y-4",children:[(0,te.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white",children:[(0,te.jsxs)("div",{className:"bg-gray-50 p-3 border-b border-gray-200 flex justify-between items-center",children:[(0,te.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Message Attributes"}),(0,te.jsx)("button",{onClick:k,className:"flex items-center text-xs text-gray-600 hover:text-gray-900 bg-white hover:bg-gray-100 border border-gray-200 rounded px-2 py-1 transition-colors",children:u?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(mt.A,{className:"h-3.5 w-3.5 mr-1"}),"Copied!"]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Ha.A,{className:"h-3.5 w-3.5 mr-1"}),"Copy Content"]})})]}),(0,te.jsx)("div",{className:"p-4 space-y-2",children:Object.entries(p).filter((e=>{let[s]=e;return"content"!==s})).map((e=>{let[s,t]=e;return(0,te.jsxs)("div",{className:"flex",children:[(0,te.jsxs)("span",{className:"font-medium text-gray-700 min-w-[120px]",children:[s,":"]}),(0,te.jsx)("span",{className:"text-gray-600 break-all",children:"object"==typeof t?JSON.stringify(t):String(t)})]},s)}))})]}),(0,te.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white",children:[(0,te.jsx)("div",{className:"bg-gray-50 p-3 border-b border-gray-200",children:(0,te.jsx)("h3",{className:"text-sm font-medium text-gray-700",children:"Langfuse Trace"})}),(0,te.jsx)("div",{className:"p-4",children:(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)("span",{className:"text-gray-600",children:"View trace in Langfuse:"}),(0,te.jsxs)("a",{href:w,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 hover:underline flex items-center",children:[w.substring(0,60),"...",(0,te.jsx)(ur.A,{className:"h-4 w-4 ml-1"})]})]})})]}),(0,te.jsxs)("div",{className:"rounded-lg border border-gray-200 bg-white",children:[(0,te.jsx)("div",{className:"bg-gray-50 p-3 border-b border-gray-200",children:(0,te.jsxs)("h3",{className:"text-sm font-medium text-gray-700",children:["Actions (",g.length,")"]})}),(0,te.jsx)("div",{className:"divide-y divide-gray-200",children:0===g.length?(0,te.jsx)("div",{className:"p-4 text-gray-500 text-center",children:"No actions found in this message"}):g.map(((e,s)=>{const t=e.openingTag.match(/action-type="([^"]*)"/)||e.openingTag.match(/type="([^"]*)"/),a=t?t[1]:"Unknown";return(0,te.jsxs)("div",{className:"p-4",children:[(0,te.jsxs)("div",{className:"mb-2",children:[(0,te.jsxs)("span",{className:"font-medium text-gray-700",children:["Action ",s+1,":"]}),(0,te.jsx)("span",{className:"ml-2 px-2 py-0.5 text-xs rounded-full bg-blue-50 text-blue-600 border border-blue-100",children:a})]}),(0,te.jsxs)("div",{className:"mt-2",children:[(0,te.jsx)("div",{className:"font-medium text-sm text-gray-700 mb-1",children:"Content:"}),(0,te.jsx)("pre",{className:"bg-gray-50 p-2 rounded text-xs overflow-x-auto",children:e.content})]})]},s)}))})]})]}):null:(0,te.jsxs)("div",{className:"flex justify-center items-center h-64",children:[(0,te.jsx)(Ke.A,{className:"h-10 w-10 mb-3 text-gray-400"}),(0,te.jsx)("span",{className:"ml-2 text-gray-600",children:"Message not found"})]})})]})]})})}var hr=t(12266),pr=t(90983);const gr=hr.bL,fr=hr.l9,vr=hr.YJ,jr=hr.ZL,br=hr.Pb,yr=hr.z6,Nr=Y.forwardRef(((e,s)=>{let{className:t,inset:a,children:r,...n}=e;return(0,te.jsxs)(hr.ZP,{ref:s,className:ns("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",t),...n,children:[r,(0,te.jsx)(pr.A,{className:"ml-auto h-4 w-4"})]})}));Nr.displayName=hr.ZP.displayName;const wr=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(hr.G5,{ref:s,className:ns("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})}));wr.displayName=hr.G5.displayName;const kr=Y.forwardRef(((e,s)=>{let{className:t,sideOffset:a=4,...r}=e;return(0,te.jsx)(hr.ZL,{children:(0,te.jsx)(hr.UC,{ref:s,sideOffset:a,className:ns("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})}));kr.displayName=hr.UC.displayName;const _r=Y.forwardRef(((e,s)=>{let{className:t,inset:a,...r}=e;return(0,te.jsx)(hr.q7,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",t),...r})}));_r.displayName=hr.q7.displayName;const Sr=Y.forwardRef(((e,s)=>{let{className:t,children:a,checked:r,...n}=e;return(0,te.jsxs)(hr.H_,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...n,children:[(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)(hr.VF,{children:(0,te.jsx)(mt.A,{className:"h-4 w-4"})})}),a]})}));Sr.displayName=hr.H_.displayName;const Cr=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsxs)(hr.hN,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)(hr.VF,{children:(0,te.jsx)(nt.A,{className:"h-2 w-2 fill-current"})})}),a]})}));Cr.displayName=hr.hN.displayName;const Ar=Y.forwardRef(((e,s)=>{let{className:t,inset:a,...r}=e;return(0,te.jsx)(hr.JU,{ref:s,className:ns("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...r})}));Ar.displayName=hr.JU.displayName;const Er=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(hr.wv,{ref:s,className:ns("-mx-1 my-1 h-px bg-muted",t),...a})}));Er.displayName=hr.wv.displayName;const Ir=e=>{let{className:s,...t}=e;return(0,te.jsx)("span",{className:ns("ml-auto text-xs tracking-widest opacity-60",s),...t})};Ir.displayName="DropdownMenuShortcut";let Lr=0;const Tr=new Map,$r=e=>{if(Tr.has(e))return;const s=setTimeout((()=>{Tr.delete(e),Or({type:"REMOVE_TOAST",toastId:e})}),1e6);Tr.set(e,s)},Dr=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map((e=>e.id===s.toast.id?{...e,...s.toast}:e))};case"DISMISS_TOAST":{const{toastId:t}=s;return t?$r(t):e.toasts.forEach((e=>{$r(e.id)})),{...e,toasts:e.toasts.map((e=>e.id===t||void 0===t?{...e,open:!1}:e))}}case"REMOVE_TOAST":return void 0===s.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter((e=>e.id!==s.toastId))}}},Pr=[];let Mr={toasts:[]};function Or(e){Mr=Dr(Mr,e),Pr.forEach((e=>{e(Mr)}))}function Rr(e){let{...s}=e;const t=(Lr=(Lr+1)%Number.MAX_SAFE_INTEGER,Lr.toString()),a=()=>Or({type:"DISMISS_TOAST",toastId:t});return Or({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>Or({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function Fr(){const[e,s]=Y.useState(Mr);return Y.useEffect((()=>(Pr.push(s),()=>{const e=Pr.indexOf(s);e>-1&&Pr.splice(e,1)})),[e]),{...e,toast:Rr,dismiss:e=>Or({type:"DISMISS_TOAST",toastId:e})}}var zr=t(22796);const Ur=e=>{let{content:s}=e;const{updateSecrets:t,existingSecretNames:a,addChatMessage:r}=vs(),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)({}),[c,d]=(0,Y.useState)(!1),{toast:m}=Fr(),u=Array.isArray(s)?s:[],x=u.map((e=>e.secretName)).filter(Boolean),h=x.filter((e=>a&&a.includes(e))),p=h.length===x.length&&x.length>0,g=h.length>0&&h.length<x.length;if(!u.length)return null;return(0,te.jsxs)(na,{open:n,onOpenChange:e=>{l(e),e||o({})},children:[(0,te.jsx)(la,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"outline",size:"sm",className:"flex items-center gap-2 "+(p?"text-teal-600 border-teal-200 hover:bg-teal-50 hover:text-teal-700":g?"text-amber-600 border-amber-200 hover:bg-amber-50 hover:text-amber-700":"text-blue-600 border-blue-200 hover:bg-blue-50 hover:text-blue-700"),children:[p?(0,te.jsx)(Qa.A,{size:16}):(0,te.jsx)(zr.A,{size:16}),g&&(0,te.jsx)(Ke.A,{size:16}),(()=>{const e=p?"Update":"Set";if(1===x.length){return`${a&&a.includes(x[0])?"Update":"Set"} ${x[0]} secret`}return`${e} secrets: ${x.join(", ")}`})(),g&&` (${h.length}/${x.length} set)`]})}),(0,te.jsxs)(da,{className:"sm:max-w-md",children:[(0,te.jsxs)(ma,{children:[(0,te.jsxs)(xa,{className:"text-teal-700",children:[p?"Update":"Set"," ",x.length>1?"Secrets":`${x[0]} Secret`]}),(0,te.jsx)(ha,{children:"Enter the values for the required secrets."})]}),(0,te.jsxs)("form",{onSubmit:async e=>{e.preventDefault();if(Object.values(i).some((e=>!e.trim())))m({variant:"destructive",title:"Secret values required",description:"Please enter values for all secrets"});else{d(!0);try{await t(i);const e=Object.keys(i).filter((e=>!a.includes(e)));if(e.length>0){const s=e.join(", ");r({role:"user",content:`I've added ${s} secrets`})}l(!1),o({}),m({title:"Secrets updated successfully",description:"The secrets have been set."})}catch(s){m({variant:"destructive",title:"Failed to set secrets",description:s.message||"An error occurred while setting the secrets"})}finally{d(!1)}}},children:[(0,te.jsx)("div",{className:"grid gap-6 py-4",children:u.map(((e,s)=>(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:`secret-${s}`,className:"block font-medium text-slate-700",children:e.secretName}),(0,te.jsx)(Qs,{id:`secret-${s}`,type:"password",value:i[e.secretName]||"",onChange:s=>{return t=e.secretName,a=s.target.value,void o((e=>({...e,[t]:a})));var t,a},className:"w-full",placeholder:e.description||`Enter ${e.secretName} value`,autoComplete:"off"}),e.description&&(0,te.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:e.description})]},s)))}),(0,te.jsxs)(ua,{className:"gap-2 sm:gap-0",children:[(0,te.jsx)(Rs,{type:"button",variant:"outline",onClick:()=>l(!1),disabled:c,className:"border-slate-300 text-slate-700",children:"Cancel"}),(0,te.jsx)(Rs,{type:"submit",disabled:c,className:"bg-teal-600 hover:bg-teal-700 text-white",children:c?"Saving...":"Save Secrets"})]})]})]})]})};function Br(e){let{msgId:s,title:t,children:a}=e;const[r,n]=(0,Y.useState)(!1);return(0,te.jsxs)("div",{className:"action-component action-group bg-white rounded-lg shadow-sm border border-gray-200 p-4 my-4 cursor-pointer","data-title":t,children:[(0,te.jsxs)("div",{className:"flex items-center justify-between gap-2 mb-4 pb-2 border-b border-gray-100",children:[(0,te.jsx)("h3",{className:"font-medium text-gray-800",children:t}),(0,te.jsx)("div",{className:"flex items-center",children:(0,te.jsxs)(gr,{children:[(0,te.jsx)(fr,{className:"flex items-center justify-center p-1.5 text-gray-500 hover:text-gray-700 hover:bg-gray-50 rounded-md transition-colors",children:(0,te.jsx)(Xa.A,{size:16})}),(0,te.jsx)(kr,{align:"end",children:(0,te.jsxs)(_r,{onClick:e=>{e.stopPropagation(),n(!0)},className:"flex items-center gap-2 cursor-pointer",children:[(0,te.jsx)(It.A,{size:14,className:"text-gray-400"}),(0,te.jsx)("span",{children:"View Changes"})]})})]})})]}),(0,te.jsx)("div",{className:"space-y-3",children:a}),r&&(0,te.jsx)(xr,{msgId:s,isOpen:r,onClose:e=>n(!1)})]})}function Wr(e){let{title:s,details:t,componentName:a}=e;const[r,n]=Y.useState(!1),l=null==s?void 0:s.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;/g,"'").replace(/&apos;/g,"'"),i=null==t?void 0:t.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;/g,"'").replace(/&apos;/g,"'"),o=null==a?void 0:a.replace(/&quot;/g,'"').replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&#39;/g,"'").replace(/&apos;/g,"'");return(0,te.jsxs)("div",{className:"my-4 rounded-lg border border-red-200 bg-red-50",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3 p-4 cursor-pointer",onClick:()=>n(!r),children:[(0,te.jsx)("div",{className:"text-red-500",children:(0,te.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"20",height:"20",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,te.jsx)("circle",{cx:"12",cy:"12",r:"10"}),(0,te.jsx)("line",{x1:"12",y1:"8",x2:"12",y2:"12"}),(0,te.jsx)("line",{x1:"12",y1:"16",x2:"12.01",y2:"16"})]})}),(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("h3",{className:"font-medium text-red-700",children:l}),o&&(0,te.jsxs)("p",{className:"text-sm text-red-600",children:["in ",o]})]}),(0,te.jsx)("div",{className:"transition-transform "+(r?"rotate-180":""),children:(0,te.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,te.jsx)("polyline",{points:"6 9 12 15 18 9"})})})]}),r&&i&&(0,te.jsx)("div",{className:"px-4 pb-4 pt-0",children:(0,te.jsx)("div",{className:"p-3 bg-white rounded border border-red-100 font-mono text-sm text-red-800 whitespace-pre-wrap",children:i})})]})}const qr=e=>{const s=e.split("/"),t=s[0];let a=s[s.length-1];return a.includes(".")&&(a=a.split(".").slice(0,-1).join(" ")),{name:a,artifactType:t}},Vr=e=>{const{name:s,artifactType:t}=qr(e);return"components"===t?`${s} component`:"pages"===t?`${s} page`:"entities"===t?`${s} entity`:s.toLowerCase().includes("layout")?"Layout":`${t} - ${s}`};function Yr(e){let{node:s}=e;const{app:t}=vs(),a=(0,Z.Zp)(),r=s.properties["action-type"]||s.properties.type;if("requestsecrets"===(null==r?void 0:r.toLowerCase())){let e;try{e=JSON.parse(atob(s.properties.dataContent))}catch(m){e=[]}return(0,te.jsx)(Ur,{content:e})}let n=(null==r?void 0:r.replace(/(_)/g," ").replace(/\b\w/g,(e=>e.toUpperCase())))||"";"file"===r&&s.properties.filepath&&(n=Vr(s.properties.filepath)),"insertentityrecords"===(null==r?void 0:r.toLowerCase())&&s.properties.dataInsertRecordsLength&&(n=`Insert ${s.properties.dataInsertRecordsLength} ${s.properties.dataEntityName} Records`);const l=!0===s.properties.dataIsComplete||"true"===s.properties.dataIsComplete,i=s.properties.dataContentLength;let o=l?100:0;if(!l&&"file"===r&&s.properties.filepath){var c,d;const e=s.properties.filepath,{name:a,artifactType:r}=qr(e),n=(null===(c=t[r])||void 0===c||null===(d=c[a])||void 0===d?void 0:d.length)||15e3;o=Math.round(i/n*100),o=o>100?100:o}return(0,te.jsxs)("div",{className:"action-component action-step flex flex-col px-3 py-2 rounded-md hover:bg-gray-100 transition-colors","data-type":s.properties.dataActionType,"data-title":s.properties.dataTitle,onClick:()=>{if("file"===r&&s.properties.filepath){const e=s.properties.filepath;if(e.startsWith("agents/")){let s=e.split("/").pop();s.endsWith(".json")&&(s=s.slice(0,-5)),a(`/apps/${t.id}/editor/workspace/agents?agent=${s}`)}else a(`/apps/${t.id}/editor/workspace/code?filePath=${s.properties.filepath}`)}},children:[(0,te.jsxs)("div",{className:"flex items-center justify-between gap-2",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[!0===l||"true"===l?(0,te.jsx)(Qa.A,{className:"w-4 h-4 text-green-500"}):(0,te.jsx)("div",{className:"relative w-4 h-4",children:(0,te.jsxs)("svg",{className:"w-4 h-4",viewBox:"0 0 24 24",children:[(0,te.jsx)("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"#e5e7eb",strokeWidth:"2"}),(0,te.jsx)("circle",{cx:"12",cy:"12",r:"10",fill:"none",stroke:"#3b82f6",strokeWidth:"2",strokeDasharray:""+2*Math.PI*10,strokeDashoffset:""+2*Math.PI*10*(1-o/100),transform:"rotate(-90 12 12)",style:{transition:"stroke-dashoffset 0.3s ease"}})]})}),(0,te.jsx)("span",{className:"text-sm text-gray-700",children:s.properties.title||"Editing "+n})]}),"file"===r&&s.properties.filepath&&s.properties.filepath.startsWith("functions/")&&(0,te.jsx)("div",{className:"text-gray-400",children:(0,te.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,te.jsx)("path",{d:"m9 18 6-6-6-6"})})})]}),(0,te.jsx)("span",{className:"text-xs text-gray-400 ml-6",children:n})]})}function Hr(e){let{content:s,msgId:t,role:a}=e;const{user:r}=ne(),{app:n}=vs(),l=function(e){let s=e;const t=er(e,"action");for(let r=t.length-1;r>=0;r--){const e=t[r];let n=s.slice(0,e.openingTagIndex);if(e.closingTagIndex||e.openingTag.includes(">")){let t={"data-content-length":e.content.length,"data-is-complete":e.closingTagIndex?"true":"false"};const r=sr(e.openingTag,"action-type")||sr(e.openingTag,"type");if((null==r?void 0:r.toLowerCase())==="insertEntityRecords".toLowerCase()){if(t["data-entity-name"]=sr(e.openingTag,"entity-name"),t.title=`Insert ${t["data-entity-name"]} Records`,e.closingTagIndex)try{const s=JSON.parse(e.content);t["data-insert-records-length"]=s.length}catch(a){}}else if((null==r?void 0:r.toLowerCase())==="requestsecrets".toLowerCase())try{t["data-content"]=btoa(e.content)}catch(a){}e.openingTag.slice(0,-1).includes(">");const l=`${e.openingTag.slice(0,-1)} ${Object.entries(t).map((e=>{let[s,t]=e;return`${s}="${t}"`})).join(" ")}></action>`;s=n+l+(e.closingTagIndex?s.slice(e.closingTagIndex+9):"")}else s=n}return s=s.replace(/<action_group/g,'<div class="action-component action-group"'),s=s.replace(/<\/action_group>/g,"</div>"),s=s.replace(/<error/g,'<div class="error-component"'),s=s.replace(/<\/error>/g,"</div>"),s}(s),i={div:e=>{var s;let{node:a,...r}=e,n=(null===(s=a.properties)||void 0===s?void 0:s.className)||"";if(Array.isArray(n)&&(n=n.join(" ")),"string"==typeof n&&n.includes("action-component")){if(n.includes("action-group"))return(0,te.jsx)(Br,{msgId:t,title:a.properties.dataTitle,...r});if(n.includes("action-single"))return(0,te.jsx)(Yr,{node:a,...r})}return n.includes("error-component")?(0,te.jsx)(Wr,{...r}):(0,te.jsx)("div",{...r})},action:e=>{let{node:s,...t}=e;return(0,te.jsx)(Yr,{node:s,...t})},diff:e=>{let{node:s,...t}=e;return(0,te.jsx)("code",{...t})}};return(0,te.jsx)("div",{className:"prose dark:prose-invert max-w-none base44-markdown relative",children:(0,te.jsx)(Za.o,{rehypePlugins:"user"!==a||s.includes("<error")?[Ka.A]:[],remarkPlugins:"user"!==a||s.includes("<error")?[Ja.A]:[],components:i,children:l.replace(/ref=/g,"ref__=")})})}const Gr=Y.memo(Hr);function Jr(e){let{title:s,children:t}=e;const[a,r]=(0,Y.useState)(!1);return(0,te.jsxs)("div",{className:"w-full max-w-md mx-auto border border-base-300 w-full p-4 bg-gray-50 rounded-lg hover:bg-gray-200 my-2",children:[(0,te.jsxs)("button",{className:"flex justify-between items-center transition-colors duration-200 w-full",onClick:()=>r(!a),children:[(0,te.jsx)("span",{className:"font-medium",children:s}),a?(0,te.jsx)(dt.A,{className:"h-5 w-5 text-gray-500"}):(0,te.jsx)(ct.A,{className:"h-5 w-5 text-gray-500"})]}),a&&(0,te.jsx)("div",{className:"mt-2 p-2 rounded-lg transition-all duration-300 ease-in-out overflow-hidden "+(a?"opacity-100":"max-h-0 opacity-0"),children:t})]})}var Zr=t(40602);function Kr(e){let{toolCall:s}=e;return(0,te.jsx)(Jr,{title:(0,te.jsxs)("div",{className:"font-small flex items-center",children:[(0,te.jsx)(Zr.A,{className:"w-4 h-4 mr-2"}),(0,te.jsxs)("span",{className:"font-semibold",children:["Action: ",s.name]})]}),children:(0,te.jsx)("div",{className:"ml-2 text-gray-700",children:(t=s.arguments,"object"==typeof t&&null!==t?Object.entries(t).map((e=>{let[s,t]=e;const a="object"==typeof t?JSON.stringify(t):t.toString();return(0,te.jsxs)("div",{className:"mb-1 text-sm",children:[(0,te.jsxs)("span",{className:"font-semibold",children:[s,":"]})," ",a.split("\n").map(((e,s)=>(0,te.jsxs)("span",{children:[s>0&&(0,te.jsx)("br",{}),e]},s)))]},s)})):t)})});var t}function Xr(e){let{toolResults:s}=e;const t=s.display_results;if(ss().isObject(t)){const{widget:e,data:s}=t;if("table"===e)return(0,te.jsx)("div",{className:"overflow-x-auto",children:(0,te.jsxs)("table",{className:"table w-full bg-white",children:[(0,te.jsx)("thead",{children:(0,te.jsx)("tr",{children:s.columns.map(((e,s)=>(0,te.jsx)("th",{children:e},s)))})}),(0,te.jsx)("tbody",{children:s.rows.map(((e,t)=>(0,te.jsx)("tr",{children:s.columns.map(((s,t)=>(0,te.jsx)("td",{children:e[s]},t)))},t)))})]})})}return(0,te.jsx)(Jr,{title:(0,te.jsx)("div",{className:"font-semibold",children:"Action Results"}),children:(0,te.jsxs)("div",{className:"text-gray-700",children:[(0,te.jsx)("p",{children:s.results}),(0,te.jsx)("div",{className:"text-xs text-gray-500 mt-1",children:"(This is the result of a tool execution, not the AI's response)"})]})})}const Qr=function(e){let{message:s}=e;const[t,a]=(0,Y.useState)(!1);return(0,te.jsxs)("div",{className:"text-sm p-4 bg-white mx-auto mb-6 rounded-lg mb-6 border border-gray-300",children:[(0,te.jsxs)("div",{className:"text-gray-700",children:["Some errors were detected, base44 will try to fix them automatically."," ",(0,te.jsx)("div",{className:"mt-2",children:(0,te.jsx)("a",{className:"text-teal-900/70 hover:underline cursor-pointer",onClick:()=>a(!t),children:t?"hide errors":"see errors"})})]}),t&&(0,te.jsx)("div",{className:"mt-4",children:(0,te.jsx)(Gr,{content:s.content})})]})};var en=t(50270),sn=t(78968),tn=t(97820),an=t(26209);const rn={div:(0,te.jsx)(en.A,{className:"h-3 w-3"}),button:(0,te.jsx)(sn.A,{className:"h-3 w-3"}),p:(0,te.jsx)(tn.A,{className:"h-3 w-3"}),h1:(0,te.jsx)(an.A,{className:"h-3 w-3"}),h2:(0,te.jsx)(an.A,{className:"h-3 w-3"}),h3:(0,te.jsx)(an.A,{className:"h-3 w-3"}),h4:(0,te.jsx)(an.A,{className:"h-3 w-3"}),h5:(0,te.jsx)(an.A,{className:"h-3 w-3"})};var nn=t(21570);const ln=function(e){let{message:s}=e;const{app:t}=vs(),{user:a}=ne(),[r,n]=(0,Y.useState)(!1);return(0,te.jsxs)("div",{className:"text-sm p-4 bg-white mx-auto mb-6 rounded-lg mb-6 border border-gray-300 relative",children:[(0,te.jsxs)("div",{className:"text-gray-700",children:["Files have been manually edited."," ",(0,te.jsx)("div",{className:"mt-2",children:(0,te.jsx)("a",{className:"text-teal-900/70 hover:underline cursor-pointer",onClick:()=>n(!r),children:r?"hide details":"see details"})})]}),r&&(0,te.jsx)("div",{className:"mt-4",children:(0,te.jsx)(Gr,{content:s.content})}),(0,te.jsx)("div",{className:"cursor-pointer absolute bottom-[-10px] right-0 bg-white border border-gray-200 rounded-md p-1 text-xs text-gray-400",children:(0,te.jsxs)("a",{onClick:async()=>{var e;window.confirm("Are you sure you want to revert these manual edits? This will undo all changes made in this edit.")&&(Se("User clicked - revert this",{app_id:null==t?void 0:t.id,message_id:s.id}),Fe({user_id:null==a?void 0:a.id,app_id:null==t?void 0:t.id,conversation_id:null==t||null===(e=t.conversation)||void 0===e?void 0:e.id},{cta:"revert this",origin:"manual_editing_message",message_id:s.id,target_route:null}),await pe.undoMessage(t.id,s.id))},className:"flex items-center gap-1",children:[(0,te.jsx)(nn.A,{className:"h-3 w-3"}),"Revert this"]})})]})},on=e=>{let{reasoning:s}=e;const[t,a]=(0,Y.useState)(!1);if(!s)return null;const r=null!==s.end_date&&void 0!==s.end_date,n=(()=>{if(!r)return null;const e=Bt()(s.start_date),t=Bt()(s.end_date),a=Bt().duration(t.diff(e));if(a.asSeconds()<1)return"less than a second";if(a.asSeconds()<60){return`${Math.round(a.asSeconds())}s`}if(a.asMinutes()<60){return`${Math.round(a.asMinutes())}m`}return`${Math.round(a.asHours())}h`})();return(0,te.jsxs)("div",{className:"mb-3",children:[(0,te.jsx)("div",{className:"inline-flex items-start gap-2",children:(0,te.jsx)("button",{onClick:()=>a(!t),className:"flex items-center gap-1.5 px-2.5 py-1 rounded-md transition-all "+(r?"bg-slate-50 hover:bg-slate-100 text-slate-600":"bg-gradient-to-r from-slate-50 to-slate-100 text-slate-600"),disabled:!r||!s.content,children:r?(0,te.jsxs)(te.Fragment,{children:[s.content&&(t?(0,te.jsx)(ct.A,{className:"h-3 w-3"}):(0,te.jsx)(pr.A,{className:"h-3 w-3"})),(0,te.jsxs)("span",{className:"text-xs font-medium",children:["Thought ",n&&(0,te.jsxs)("span",{className:"text-xs text-slate-500",children:["for ",n]})]})]}):(0,te.jsx)(te.Fragment,{children:(0,te.jsx)("span",{className:"text-xs font-medium animate-pulse",children:"Planning next steps..."})})})}),r&&s.content&&t&&(0,te.jsx)("div",{className:"mt-2 ml-0 animate-in slide-in-from-top-1 duration-200",children:(0,te.jsxs)("div",{className:"relative pl-4 py-2 pr-3 rounded-md bg-gradient-to-r from-slate-50 to-transparent",children:[(0,te.jsx)("div",{className:"absolute left-0 top-0 bottom-0 w-0.5 bg-gradient-to-b from-orange-300 to-teal-300 rounded-full"}),(0,te.jsx)("p",{className:"text-xs text-slate-600 leading-relaxed whitespace-pre-wrap",children:s.content})]})})]})},cn=e=>{let{files:s}=e;const[t,a]=(0,Y.useState)(!1);if(!s||0===s.length)return null;const r=s.reduce(((e,s)=>(s.startsWith("entities/")?e.entities.push(s):s.startsWith("pages/")||s.startsWith("components/")||s.startsWith("layout")?e.code.push(s):e.other.push(s),e)),{entities:[],code:[],other:[]});return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"text-xs text-gray-400 cursor-pointer hover:underline",onClick:()=>a(!0),children:(0,te.jsxs)("span",{className:"flex items-center gap-1",children:[(0,te.jsx)(It.A,{className:"h-3 w-3"}),"see context"]})}),t&&(0,te.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,te.jsxs)("div",{className:"bg-white dark:bg-gray-800 rounded-lg shadow-lg max-w-2xl w-full max-h-[80vh] flex flex-col",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center p-4 border-b dark:border-gray-700",children:[(0,te.jsx)("h3",{className:"font-medium text-lg",children:"Files Selected for Context"}),(0,te.jsx)("button",{onClick:()=>a(!1),className:"text-gray-500 hover:text-gray-700 dark:hover:text-gray-300 transition-colors",children:(0,te.jsx)(Ds.A,{className:"h-5 w-5"})})]}),(0,te.jsxs)("div",{className:"p-5 overflow-y-auto flex-1",children:[(0,te.jsxs)("p",{className:"text-sm text-gray-600 dark:text-gray-300 mb-5",children:["In complex projects, for every user message, the platform automatically selects which code files ",(0,te.jsx)("b",{children:"might"})," be relevant for potential changes."]}),(0,te.jsxs)("p",{className:"text-sm text-teal-700 dark:text-teal-400 mb-5 border-l-2 border-teal-600 pl-3",children:[(0,te.jsx)("b",{children:"Important:"})," If you intended to modify a file that doesn't appear in this list, the AI might get confused and make changes in the wrong place or not make the changes at all. Consider mentioning the specific file path in your message for better results."]}),r.code.length>0&&(0,te.jsxs)("div",{className:"mb-5",children:[(0,te.jsxs)("h4",{className:"text-sm font-semibold mb-2 flex items-center gap-2",children:[(0,te.jsx)(Ua.A,{className:"h-4 w-4"}),"Code Files"]}),(0,te.jsx)("div",{className:"space-y-1 pl-2",children:r.code.map(((e,s)=>(0,te.jsx)("div",{className:"text-sm py-1.5 px-3 bg-blue-50 dark:bg-blue-900/20 rounded border border-blue-100 dark:border-blue-800 text-gray-800 dark:text-gray-200",children:e},s)))})]}),r.entities.length>0&&(0,te.jsxs)("div",{className:"mb-5",children:[(0,te.jsxs)("h4",{className:"text-sm font-semibold mb-2 flex items-center gap-2",children:[(0,te.jsx)(wa.A,{className:"h-4 w-4"}),"Entity Files"]}),(0,te.jsx)("div",{className:"space-y-1 pl-2",children:r.entities.map(((e,s)=>(0,te.jsx)("div",{className:"text-sm py-1.5 px-3 bg-purple-50 dark:bg-purple-900/20 rounded border border-purple-100 dark:border-purple-800 text-gray-800 dark:text-gray-200",children:e},s)))})]}),r.other.length>0&&(0,te.jsxs)("div",{children:[(0,te.jsxs)("h4",{className:"text-sm font-semibold mb-2 flex items-center gap-2",children:[(0,te.jsx)(It.A,{className:"h-4 w-4"}),"Other Files"]}),(0,te.jsx)("div",{className:"space-y-1 pl-2",children:r.other.map(((e,s)=>(0,te.jsx)("div",{className:"text-sm py-1.5 px-3 bg-gray-50 dark:bg-gray-700 rounded border border-gray-100 dark:border-gray-600 text-gray-800 dark:text-gray-200",children:e},s)))})]})]}),(0,te.jsx)("div",{className:"p-4 border-t dark:border-gray-700 flex justify-end",children:(0,te.jsx)("button",{onClick:()=>a(!1),className:"px-4 py-2 bg-gray-100 hover:bg-gray-200 dark:bg-gray-700 dark:hover:bg-gray-600 rounded text-sm font-medium transition-colors",children:"Close"})})]})})]})};function dn(e){var s,t,a,r,n;let{item:l,undoMessage:i,itemIndex:o}=e;const{user:c}=ne(),{app:d}=vs();if(null===(s=l.additional_message_params)||void 0===s?void 0:s.automated_fix)return(0,te.jsx)("div",{className:"mb-6 relative",children:(0,te.jsx)(Qr,{message:l})});if(null===(t=l.additional_message_params)||void 0===t?void 0:t.diff_message)return(0,te.jsx)("div",{className:"mb-6 relative",children:(0,te.jsx)(ln,{message:l})});const m=null===(a=l.custom_context)||void 0===a?void 0:a.find((e=>{var s;return"files"===e.type&&(null===(s=e.data)||void 0===s?void 0:s.files)})),u=(null==m||null===(r=m.data)||void 0===r?void 0:r.files)||[],x="user"===l.role;return(0,te.jsxs)("div",{className:"mb-6 relative "+(x?"flex justify-end":""),children:["assistant"===l.role&&(0,te.jsxs)("div",{className:"flex items-center gap-2  mb-2",children:[(0,te.jsx)("img",{src:"https://base44.app/logo_v3.png",alt:"Base44 AI",className:"w-6 h-6 object-cover rounded-full opacity-75"}),(0,te.jsx)("span",{className:"text-xs text-gray-500",children:"Base44"})]}),(0,te.jsx)(on,{reasoning:l.reasoning}),(0,te.jsx)("div",{className:"text-sm ps-4 rounded-lg "+(x?"pr-4 bg-slate-200 max-w-[85%] py-4":"pl-8"),children:(0,te.jsxs)("div",{children:["tool"===l.role?l.tool_results.map(((e,s)=>(0,te.jsx)(Xr,{toolResults:e},s))):(0,te.jsxs)(te.Fragment,{children:[l.custom_context&&l.custom_context.map(((e,s)=>{var t;if("element"===e.type&&null!==(t=e.data)&&void 0!==t&&t.element_tag_name){const t=e.data.element_tag_name.toLowerCase(),a=rn[t]||(0,te.jsx)(Ua.A,{className:"h-3 w-3"});return(0,te.jsx)("div",{className:"mb-2 flex items-center gap-2 text-xs",children:(0,te.jsxs)("div",{className:"flex items-center gap-1 px-2 py-1 bg-gray-900 text-white rounded-md",children:[a,(0,te.jsx)("span",{children:t})]})},s)}return null})),l.file_urls&&l.file_urls.length>0&&(0,te.jsx)("div",{className:"mb-4 flex flex-wrap gap-4",children:l.file_urls.map(((e,s)=>(0,te.jsx)("div",{className:"relative",children:e.match(/\.(jpg|jpeg|png|gif)$/i)?(0,te.jsx)("img",{src:e,alt:"Attached content",className:"max-w-[300px] max-h-[300px] rounded-lg border border-gray-200 shadow-sm"}):(0,te.jsxs)("div",{className:"flex items-center gap-2 p-2 bg-white rounded-lg border border-gray-200",children:[(0,te.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"text-gray-500",children:[(0,te.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,te.jsx)("polyline",{points:"14 2 14 8 20 8"})]}),(0,te.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Attached file"})]})},s)))}),(0,te.jsx)(Gr,{content:l.content,msgId:l.id,role:l.role}),l.tool_calls&&l.tool_calls.map(((e,s)=>(0,te.jsx)(Kr,{toolCall:e},s)))]}),(null===(n=l.metadata)||void 0===n?void 0:n.created_date)&&(0,te.jsxs)("div",{className:"text-xs text-gray-400 mt-2 flex items-center",children:[Bt().utc(l.metadata.created_date,Bt().ISO_8601).fromNow(),"user"===l.role&&u.length>0&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("span",{className:"mx-2",children:"\u2022"}),(0,te.jsx)(cn,{files:u})]})]})]})}),"user"===l.role&&o>0&&l.checkpoint_id&&(0,te.jsx)("div",{className:"cursor-pointer absolute bottom-[-10px] right-0 bg-white border border-gray-200 rounded-md p-1 text-xs text-gray-400",children:(0,te.jsxs)("a",{onClick:()=>{var e;window.confirm("Are you sure you want to undo this message? This will load the state of the app before this message.")&&(Se("User clicked - revert this",{app_id:null==d?void 0:d.id,message_id:l.id}),Fe({user_id:null==c?void 0:c.id,app_id:null==d?void 0:d.id,conversation_id:null==d||null===(e=d.conversation)||void 0===e?void 0:e.id},{cta:"revert this",origin:"chat_message",message_id:l.id,target_route:null}),i(l.id))},className:"flex items-center gap-1",children:[(0,te.jsx)(nn.A,{className:"h-3 w-3"}),"Revert this"]})})]})}class mn extends Y.Component{constructor(e){super(e),this.state={hasError:!1,error:null}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}componentDidCatch(e,s){}render(){return this.state.hasError?(0,te.jsx)("div",{className:"mx-4 my-3 px-6 py-4 rounded-lg bg-slate-50 border border-slate-200 text-slate-600 text-base",children:(0,te.jsx)("p",{className:"text-sm",children:"Could not render this message. It might contain special characters."})}):this.props.children}}const un=e=>{let{messages:s,undoMessage:t}=e;const[a,r]=(0,Y.useState)(20),[n,l]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(!1),c=(0,Y.useRef)(null),d=(0,Y.useRef)(s.length);(0,Y.useEffect)((()=>{0===d.current&&s.length>0?(r(20),l(s.length>20),o(!1)):i?(r(s.length),l(!1)):r((e=>{const t=Math.min(20,s.length);return l(s.length>t),t})),d.current=s.length}),[s.length,i]),(0,Y.useEffect)((()=>{const e=new URLSearchParams(window.location.search).get("msgId");e&&setTimeout((()=>{const s=document.getElementById(`message-${e}`);s&&(s.scrollIntoView({behavior:"smooth"}),s.classList.add("border-2"),s.classList.add("border-black"),s.classList.add("font-medium"))}),1e3)}),[]);const m=s.slice(-a);return(0,te.jsxs)("div",{ref:c,className:"relative",children:[n&&(0,te.jsx)("div",{className:"flex justify-center py-2",children:(0,te.jsx)("button",{onClick:()=>{const e=c.current,t=e.scrollHeight-e.scrollTop;r(s.length),l(!1),o(!0),setTimeout((()=>{e.scrollTop=e.scrollHeight-t}),0)},className:"text-sm text-blue-500 hover:text-blue-600 hover:underline",children:"Load entire conversation"})}),m.slice(0,m.length).map(((e,s)=>(0,te.jsx)("div",{id:`message-${e.id}`,children:(0,te.jsx)(mn,{children:(0,te.jsx)(dn,{item:e,itemIndex:s,undoMessage:t})})},e.id||s)))]})};var xn=t(53291),hn=t(52229);function pn(e){let{status:s,typingSpeed:t=40,className:a=""}=e;const[r,n]=(0,Y.useState)(""),[l,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(0),d=(0,Y.useRef)(s||""),m=(0,Y.useRef)(null);return(0,Y.useEffect)((()=>{s===d.current&&l||(c((e=>e+1)),i(!0),n(""),d.current=s||"")}),[s]),(0,Y.useEffect)((()=>{if(l&&d.current&&r.length<d.current.length)return m.current&&clearTimeout(m.current),m.current=setTimeout((()=>{n(d.current.substring(0,r.length+1))}),t),()=>clearTimeout(m.current);l&&d.current&&r.length===d.current.length&&i(!1)}),[r,l,t]),(0,te.jsxs)("div",{className:"flex items-center h-[1.5em] sm:h-[2em]",children:[" ",(0,te.jsx)(xn.N,{mode:"wait",children:(0,te.jsxs)(hn.P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2},className:`text-slate-700 tracking-normal ${a}`,children:[r,l?(0,te.jsx)(hn.P.span,{initial:{opacity:1},animate:{opacity:0},transition:{duration:.5,repeat:1/0,repeatType:"reverse"},className:"inline-block w-[2px] h-[1.1em] sm:h-[1.2em] bg-slate-600 ml-[1px] align-middle"}):(0,te.jsx)(hn.P.span,{initial:{opacity:0},animate:{opacity:[0,1,0]},transition:{duration:1.2,repeat:1/0,ease:"easeInOut",delay:.2},className:"inline-block w-[0.5em] sm:w-[0.55em] h-[1em] sm:h-[1.1em] bg-slate-600 ml-[2px] align-[-0.1em] sm:align-[-0.15em]"})]},o)})]})}const gn=e=>{let{status:s}=e;return(0,te.jsx)("div",{className:"mx-4 my-3 px-4 py-3 rounded-lg bg-red-50 border border-red-200 text-red-700 text-sm flex items-center",children:(0,te.jsx)("div",{className:"flex-1",children:s.details})})};function fn(e){let{status:s,messages:t}=e;const[a,r]=(0,Y.useState)(new Date),[n,l]=(0,Y.useState)(window.innerWidth<=768);(0,Y.useEffect)((()=>{const e=()=>{l(window.innerWidth<=768)};return window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)}),[]),(0,Y.useEffect)((()=>{r(s.last_updated_date)}),[s.details]);const i=a<new Date(Date.now()-6e5)&&(null==t?void 0:t.length)>0,o=n||(null==t?void 0:t.length)>2;return(0,te.jsxs)("div",{children:["error"===s.state&&(0,te.jsx)(gn,{status:s}),"processing"===s.state&&(0,te.jsxs)("div",{className:"",children:[i&&(0,te.jsxs)("div",{className:"text-xs text-gray-500 mt-2",children:["This has been running for a while. It might be stuck.",(0,te.jsxs)("div",{className:"mt-1",children:["If this persists, try to stop the chat, *revert your last message* and try again, or ",(0,te.jsx)("button",{type:"button",onClick:()=>window.open("/support","_blank"),className:"underline text-primary hover:text-orange-500 transition-colors",children:"contact support"}),"."]})]}),o&&(0,te.jsxs)("div",{className:"text-gray-500 mt-2 flex items-center gap-2",children:[(0,te.jsx)("img",{src:Ye,alt:"Logo",className:"w-4 h-4 grayscale"}),(0,te.jsx)(pn,{status:s.details,className:"text-xs"})]})]})]})}function vn(e){if(!e)return"0";const s=parseInt(e.toString(),10);return s>=1e3?`${(s/1e3).toFixed(s%1e3==0?0:1)}k`:s.toString()}function jn(e){return Boolean(e&&e.endsWith("_yearly"))}function bn(e){return e&&e.endsWith("_yearly")?e.replace("_yearly",""):e||""}function yn(e){return`${e}_yearly`}function Nn(e){return e?e.replace(/\s*(yearly|Yearly)\s*/gi,"").replace(/\s*plan\s*/gi,"").replace(/\s*\.\.\.\s*/g,"").replace(/\s+/g," ").trim():""}const wn=["starter","builder","pro","elite","elite_2","elite_3"];function kn(e){return e&&"free"!==e.toLowerCase()?jn(e)?"yearly":"monthly":"yearly"}function _n(e){if(!e||"free"===e.toLowerCase())return"starter";const s=bn(e),t=wn.indexOf(s);return-1===t||t===wn.length-1?null:wn[t+1]}function Sn(e){if(null==e||!e.metadata)return{messageCredits:0,integrationCredits:0};return{messageCredits:parseInt(e.metadata.monthly_message_limit||"0",10),integrationCredits:parseInt(e.metadata.monthly_integration_credits||"0",10)}}function Cn(e){return vn(e)}function An(e){if(!e)return"";return{starter:"Starter",builder:"Builder",pro:"Pro",elite:"Elite",elite_2:"Elite 2",elite_3:"Elite 3"}[e]||e}function En(e,s){const t=kn(e),a=_n(e),r=function(e,s){if(null==s||!s.pricing)return null;const t=_n(e);return t&&("yearly"===kn(e)?s.pricing.yearly:s.pricing.monthly)[t]||null}(e,s);return{currentTier:e||"free",nextTier:a,billingPeriod:t,nextPlan:r}}function In(e,s){const t=function(e){let{currentUsage:s,stats:t}=e;const[a,r]=(0,Y.useState)(!0),[n,l]=(0,Y.useState)(null),i=(0,Y.useMemo)((()=>{if(!s||!t)return{currentPlan:null,nextPlan:null,billingPeriod:"yearly"};try{var e;const a=En(s.tier,t);return{currentPlan:null!==(e=t.stripe_subscription)&&void 0!==e&&e.plan&&Object.values(t.pricing.monthly).concat(Object.values(t.pricing.yearly)).find((e=>{var s,a;return e.id===(null===(s=t.stripe_subscription)||void 0===s||null===(a=s.plan)||void 0===a?void 0:a.id)}))||null,nextPlan:a.nextPlan,billingPeriod:a.billingPeriod}}catch(a){return l("Failed to calculate billing information"),{currentPlan:null,nextPlan:null,billingPeriod:"yearly"}}}),[s,t]);return(0,Y.useEffect)((()=>{null!==s&&null!==t?(r(!1),l(null)):r(!0)}),[s,t]),{currentPlan:i.currentPlan,nextPlan:i.nextPlan,billingPeriod:i.billingPeriod,isLoading:a,error:n}}({currentUsage:e,stats:s}),a=(0,Y.useMemo)((()=>t.nextPlan?Sn(t.nextPlan):{messageCredits:0,integrationCredits:0}),[t.nextPlan]);return{...t,nextPlanCredits:a,hasNextPlan:null!==t.nextPlan}}class Ln extends K.H{getBaseURL(){return"/billing"}createCheckoutSession(e){return this.axios.post(`/create-checkout-session/${e}`)}createPortalSession(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"default";return this.axios.post("/create-portal-session",{},{params:{flow_type:e}})}updateSubscription(e){return this.axios.post(`/update-subscription/${e}`)}cancelSchedule(){return this.axios.delete("/cancel-schedule")}createWorkspaceCheckoutSession(e,s){return this.axios.post("/create-workspace-checkout-session",{workspace_id:e,pending_changes:s})}getInvoices(){return this.axios.get("/invoices")}}const Tn=new Ln;let $n=0;const Dn=new Map,Pn=e=>{if(Dn.has(e))return;const s=setTimeout((()=>{Dn.delete(e),Fn({type:"REMOVE_TOAST",toastId:e})}),1e6);Dn.set(e,s)},Mn=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map((e=>e.id===s.toast.id?{...e,...s.toast}:e))};case"DISMISS_TOAST":{const{toastId:t}=s;return t?Pn(t):e.toasts.forEach((e=>{Pn(e.id)})),{...e,toasts:e.toasts.map((e=>e.id===t||void 0===t?{...e,open:!1}:e))}}case"REMOVE_TOAST":return void 0===s.toastId?{...e,toasts:[]}:{...e,toasts:e.toasts.filter((e=>e.id!==s.toastId))}}},On=[];let Rn={toasts:[]};function Fn(e){Rn=Mn(Rn,e),On.forEach((e=>{e(Rn)}))}function zn(e){let{...s}=e;const t=($n=($n+1)%Number.MAX_SAFE_INTEGER,$n.toString()),a=()=>Fn({type:"DISMISS_TOAST",toastId:t});return Fn({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>Fn({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function Un(){const[e,s]=Y.useState(Rn);return Y.useEffect((()=>(On.push(s),()=>{const e=On.indexOf(s);e>-1&&On.splice(e,1)})),[e]),{...e,toast:zn,dismiss:e=>Fn({type:"DISMISS_TOAST",toastId:e})}}const Bn=ra.Root,Wn=ra.Trigger,qn=ra.Portal,Vn=(ra.Close,Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ra.Overlay,{ref:s,className:ns("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a})})));Vn.displayName=ra.Overlay.displayName;const Yn=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsxs)(qn,{children:[(0,te.jsx)(Vn,{}),(0,te.jsxs)(ra.Content,{ref:s,className:ns("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[a,(0,te.jsxs)(ra.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,te.jsx)(Ds.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}));Yn.displayName=ra.Content.displayName;const Hn=e=>{let{className:s,...t}=e;return(0,te.jsx)("div",{className:ns("flex flex-col space-y-1.5 text-center sm:text-left",s),...t})};Hn.displayName="DialogHeader";const Gn=e=>{let{className:s,...t}=e;return(0,te.jsx)("div",{className:ns("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};Gn.displayName="DialogFooter";const Jn=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ra.Title,{ref:s,className:ns("text-lg font-semibold leading-none tracking-tight",t),...a})}));Jn.displayName=ra.Title.displayName;const Zn=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ra.Description,{ref:s,className:ns("text-sm text-muted-foreground",t),...a})}));Zn.displayName=ra.Description.displayName;const Kn=e=>{let{question:s,answer:t}=e;const[a,r]=(0,Y.useState)(!1);return(0,te.jsxs)("div",{className:"border-b border-gray-200 py-4",children:[(0,te.jsxs)("button",{className:"flex justify-between items-center w-full text-left",onClick:()=>r(!a),children:[(0,te.jsx)("h3",{className:"text-lg font-medium text-gray-800",children:s}),(0,te.jsx)("span",{className:"text-gray-600 transition-transform duration-300 "+(a?"rotate-180":""),children:(0,te.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,te.jsx)("polyline",{points:"6 9 12 15 18 9"})})})]}),(0,te.jsx)(xn.N,{children:a&&(0,te.jsx)(hn.P.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},transition:{duration:.3},className:"overflow-hidden",children:(0,te.jsx)("div",{className:"pt-4 pb-2 text-gray-600",children:t})})})]})};function Xn(){const e=[{question:"What is Base44?",answer:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{children:"Base44 is an AI-powered platform that allows you to build custom software applications without coding. It uses natural language processing to understand your requirements and generate functional software based on your descriptions."}),(0,te.jsx)("p",{children:"Our platform is designed to be user-friendly and accessible to non-technical users, enabling you to create powerful applications through simple conversations with our AI."})]})},{question:"What's included in the free plan?",answer:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{children:"The free plan gives you a daily allowance of 5 messages and a monthly cap of 25 messages total. You also get 500 integration credits to experiment with various integrations like authentication, database, and analytics."}),(0,te.jsx)("p",{children:"With the free plan, you have access to all core integration types, allowing you to build fully functional applications with user authentication, data storage, and more - all at no cost."})]})},{question:"What are integration credits?",answer:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{children:"Integration credits are used to access Base44's various integrations within your application. Each integration request costs 1 credit, regardless of which integration you're using."}),(0,te.jsx)("p",{children:"These integrations enhance your app's functionality, including LLMs, file uploading, image understanding, image generation, email sending, SMS sending, database querying, and many more. The number of integration credits in your plan determines how many of these requests you can make per month."})]})},{question:"What types of applications can I build with Base44?",answer:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{children:"Base44 is versatile and can be used to build a wide range of applications, including but not limited to: fully functional SaaS products, backoffice tools, personal productivity apps, customer portals, and business process automation tools."}),(0,te.jsx)("p",{children:"You can also use it for rapid prototyping and creating MVPs, allowing you to validate your ideas quickly without investing in expensive development resources."})]})},{question:"Who owns the applications created with Base44?",answer:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{children:"Between you and Base44, all applications and content generated through our platform shall be considered your property. We make no ownership claims over anything you create using Base44.          "}),(0,te.jsx)("p",{children:"Your intellectual property remains yours, and you're free to use, modify, distribute, or sell the generated applications as permitted by law.          "})]})},{question:"How are Base44 applications deployed?",answer:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{children:"With Base44, deployment is incredibly simple. Your applications are instantly usable and shareable as soon as you create them. Simply use and share the URL of your app with others."}),(0,te.jsx)("p",{children:"There's no need for separate hosting or deployment steps, making it incredibly easy to get your application up and running quickly."})]})},{question:"What happens if I reach my plan limits?",answer:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{children:"When you reach your daily message limit, you'll need to wait until the next day to send more messages. If you hit your monthly limit, you won't be able to send additional messages or make integration requests until the beginning of your next billing cycle."}),(0,te.jsx)("p",{children:"To avoid interruptions in your app development and usage, you can upgrade to a higher tier plan with increased limits at any time from your billing dashboard."})]})}];return(0,te.jsxs)("div",{className:" rounded-xl p-8 mt-12",children:[(0,te.jsx)("h2",{className:"text-2xl font-semibold mb-6 text-gray-800",children:"Frequently Asked Questions"}),(0,te.jsx)("div",{className:"divide-y divide-gray-200",children:e.map(((e,s)=>(0,te.jsx)(Kn,{question:e.question,answer:e.answer},s)))})]})}const Qn=Y.forwardRef(((e,s)=>{let{className:t,type:a,...r}=e;return(0,te.jsx)("input",{type:a,className:ns("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:s,...r})}));Qn.displayName="Input";const el=(0,ts.cva)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),sl=Y.forwardRef(((e,s)=>{let{className:t,variant:a,size:r,asChild:n=!1,...l}=e;const i=n?Ms.DX:"button";return(0,te.jsx)(i,{className:ns(el({variant:a,size:r,className:t})),ref:s,...l})}));sl.displayName="Button";class tl extends K.H{getBaseURL(){return"/credits"}addBonusCredits(e,s,t){return this.axios.post("/add-bonus-credits",{user_id:e,num_messages:s,reason:t})}createCouponCode(e,s,t,a){return this.axios.post("/create-coupon-code",{code:e,num_messages:s,max_number_of_people:t,domain:a})}getCouponCodes(){return this.axios.get("/coupon-codes")}getBonusCredits(e){return this.axios.get(`/${e}/bonus-credits`)}addCouponCode(e){return this.axios.post(`/add-coupon-code/${e}`)}deleteBonusCredits(e,s){return this.axios.delete(`/${e}/bonus-credits/${s}`)}}const al=new tl;var rl=t(16859),nl=t(34799);function ll(){const{toast:e}=Un(),{user:s}=ne(),{activeWorkspace:t}=xe(),[a,r]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(null);if((0,Y.useEffect)((()=>{(async()=>{if(null!=t&&t.id)try{l(!0),o(null);const e=await de.getMySeatInfo(t.id);r(e)}catch(s){o(s),e({variant:"destructive",title:"Error",description:"Failed to load workspace billing information"})}finally{l(!1)}})()}),[null==t?void 0:t.id,e]),n)return(0,te.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-slate-700"})});if(i||!a)return(0,te.jsx)(is,{className:"border-red-200 bg-red-50",children:(0,te.jsx)(cs,{className:"text-red-800",children:"Unable to load workspace billing information. Please try again later."})});const c=null==a?void 0:a.user_seat,d=null==a?void 0:a.workspace,m=null==a?void 0:a.is_admin,u=(null==a?void 0:a.workspace_admins)||[];return(0,te.jsxs)("div",{className:"space-y-6",children:["assigned"===(null==c?void 0:c.status)?(0,te.jsx)(Vs,{className:"border-slate-200",children:(0,te.jsx)(Js,{className:"pt-6 space-y-4",children:(0,te.jsxs)("div",{children:[(0,te.jsxs)("h2",{className:"text-2xl font-semibold text-slate-900 mb-3",children:[c.seat_type," Plan",(0,te.jsx)(ws,{children:(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)(rl.A,{className:"h-4 w-4 text-slate-400 hover:text-slate-600 ml-2 inline"})}),(0,te.jsx)(Ss,{children:(0,te.jsxs)("p",{children:["Seat #",c.seat_id]})})]})})]}),(0,te.jsxs)("p",{className:"text-slate-700 mb-4",children:["You're currently on the ",c.seat_type," plan. To make changes, please contact your workspace ",u.some((e=>"owner"===e.role))?"owner":"administrator","."]}),(0,te.jsxs)("div",{className:"space-y-2",children:[u.filter((e=>"owner"===e.role)).map(((e,s)=>(0,te.jsxs)("p",{className:"text-sm text-slate-600",children:[(0,te.jsx)("span",{className:"font-medium",children:"Workspace owner:"})," ",e.email]},s))),u.filter((e=>"admin"===e.role)).map(((e,s)=>(0,te.jsxs)("p",{className:"text-sm text-slate-600",children:[(0,te.jsx)("span",{className:"font-medium",children:"Workspace admin:"})," ",e.email]},s)))]})]})})}):(0,te.jsx)(Vs,{className:"border-slate-200",children:(0,te.jsx)(Js,{className:"pt-6 space-y-4",children:(0,te.jsxs)("div",{children:[(0,te.jsx)("h2",{className:"text-2xl font-semibold text-slate-900 mb-3",children:"No Seat Assigned"}),(0,te.jsxs)("p",{className:"text-slate-700 mb-4",children:["You don't currently have a seat plan assigned in this workspace. To get access, please contact your workspace ",u.some((e=>"owner"===e.role))?"owner":"administrator","."]}),(0,te.jsxs)("div",{className:"space-y-2",children:[u.filter((e=>"owner"===e.role)).map(((e,s)=>(0,te.jsxs)("p",{className:"text-sm text-slate-600",children:[(0,te.jsx)("span",{className:"font-medium",children:"Workspace owner:"})," ",e.email]},s))),u.filter((e=>"admin"===e.role)).map(((e,s)=>(0,te.jsxs)("p",{className:"text-sm text-slate-600",children:[(0,te.jsx)("span",{className:"font-medium",children:"Workspace admin:"})," ",e.email]},s)))]})]})})}),m&&(0,te.jsxs)(is,{className:"bg-teal-50 border-teal-200",children:[(0,te.jsx)(nl.A,{className:"h-4 w-4"}),(0,te.jsxs)(cs,{className:"text-teal-800",children:[(0,te.jsx)("strong",{children:"Administrator Access:"})," Visit the"," ",(0,te.jsx)("a",{href:`/workspace/${d.id}`,className:"underline font-medium hover:text-teal-900",children:"workspace dashboard"})," ","to manage seats, billing, and team members."]})]})]})}var il=t(15255);const ol="GTM-5WLCSX6J",cl=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};window.dataLayer=window.dataLayer||[],window.dataLayer.push({event:e,event_id:(0,il.A)().toString(),...s})};function dl(){const e=(0,Z.zy)();return(0,Y.useEffect)((()=>{!function(){if(document.getElementById("gtm-script"))return;const e=document.createElement("script");e.id="gtm-script",e.innerHTML=`\n    (function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':\n    new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],\n    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=\n    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);\n    })(window,document,'script','dataLayer','${ol}');\n  `,document.head.prepend(e)}(),function(){if(document.getElementById("gtm-noscript"))return;const e=document.createElement("noscript");e.id="gtm-noscript",e.innerHTML=`\n    <iframe src="https://www.googletagmanager.com/ns.html?id=${ol}"\n    height="0" width="0" style="display:none;visibility:hidden"></iframe>\n  `,document.body.prepend(e)}()}),[]),(0,Y.useEffect)((()=>{cl("pageview",{page_path:e.pathname})}),[e]),null}var ml=t(90386),ul=t.n(ml);function xl(){return(0,te.jsxs)("div",{className:"bg-white rounded-[20px] p-6 flex flex-col h-[480px] border-2 border-[#E9E9E9] animate-pulse",children:[(0,te.jsxs)("div",{className:"mb-5",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,te.jsx)("div",{className:"h-5 bg-gray-200 rounded w-16"}),(0,te.jsx)("div",{className:"h-6 bg-gray-200 rounded w-20"})]}),(0,te.jsxs)("div",{className:"flex items-end mb-2",children:[(0,te.jsx)("div",{className:"h-8 bg-gray-200 rounded w-12"}),(0,te.jsx)("div",{className:"h-6 bg-gray-200 rounded w-16 ml-2"})]})]}),(0,te.jsx)("div",{className:"mb-4",children:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("div",{className:"h-4 bg-gray-200 rounded w-32"}),(0,te.jsx)("div",{className:"h-4 bg-gray-200 rounded w-28"})]})}),(0,te.jsx)("div",{className:"mb-4",children:(0,te.jsx)("div",{className:"h-10 bg-gray-200 rounded-[8px] w-full"})}),(0,te.jsxs)("div",{className:"space-y-2 flex-grow",children:[(0,te.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full"}),(0,te.jsx)("div",{className:"h-3 bg-gray-200 rounded w-4/5"}),(0,te.jsx)("div",{className:"h-3 bg-gray-200 rounded w-3/4"}),(0,te.jsx)("div",{className:"h-3 bg-gray-200 rounded w-full"}),(0,te.jsx)("div",{className:"h-3 bg-gray-200 rounded w-2/3"}),(0,te.jsx)("div",{className:"h-3 bg-gray-200 rounded w-4/5"}),(0,te.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2"})]})]})}const hl=e=>{let{text:s,variant:t="default",disabled:a=!1,showX:r=!1,showGift:n=!1}=e;return(0,te.jsxs)("div",{className:"flex items-center text-sm "+(a?"text-gray-400":"text-gray-600"),children:[r?(0,te.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 mr-3 flex-shrink-0 text-gray-500",width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,te.jsx)("path",{d:"M18 6 6 18"}),(0,te.jsx)("path",{d:"m6 6 12 12"})]}):n?(0,te.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-7 h-7 mr-3 flex-shrink-0 rounded-full p-1.5 "+(a?"text-gray-400":"text-teal-600"),style:{backgroundColor:"#F0FFE1"},width:"28",height:"28",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,te.jsx)("rect",{x:"3",y:"8",width:"18",height:"4",rx:"1"}),(0,te.jsx)("path",{d:"M12 8v13"}),(0,te.jsx)("path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7"}),(0,te.jsx)("path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5"})]}):(0,te.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"w-4 h-4 mr-3 flex-shrink-0 "+(a?"text-gray-400":"text-teal-600"),width:"24",height:"24",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:(0,te.jsx)("path",{d:"M20 6L9 17l-5-5"})}),(0,te.jsx)("span",{className:"text-left font-light base44-font "+(a?"text-gray-400":"text-black"),children:s})]})},pl=ot.bL,gl=(ot.YJ,ot.WT),fl=Y.forwardRef(((e,s)=>{let{className:t,children:a,advancedDropdown:r=!1,...n}=e;return(0,te.jsxs)(ot.l9,{ref:s,className:ns(`flex h-10 w-full items-center justify-between ${r?"rounded-lg":"rounded-md"} border border-input bg-background px-3 py-2 text-sm placeholder:text-muted-foreground focus:outline-none disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1`,t),...n,children:[r?(0,te.jsx)("div",{className:"flex-1 min-w-0",children:a}):a,(0,te.jsx)(ot.In,{asChild:!0,children:(0,te.jsx)(ct.A,{className:ns("h-4 w-4 opacity-50",r?"flex-shrink-0 ml-2":"")})})]})}));fl.displayName=ot.l9.displayName;const vl=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ot.PP,{ref:s,className:ns("flex cursor-default items-center justify-center py-1",t),...a,children:(0,te.jsx)(dt.A,{className:"h-4 w-4"})})}));vl.displayName=ot.PP.displayName;const jl=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ot.wn,{ref:s,className:ns("flex cursor-default items-center justify-center py-1",t),...a,children:(0,te.jsx)(ct.A,{className:"h-4 w-4"})})}));jl.displayName=ot.wn.displayName;const bl=Y.forwardRef(((e,s)=>{let{className:t,children:a,position:r="popper",...n}=e;return(0,te.jsx)(ot.ZL,{children:(0,te.jsxs)(ot.UC,{ref:s,className:ns("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...n,children:[(0,te.jsx)(vl,{}),(0,te.jsx)(ot.LM,{className:ns("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:a}),(0,te.jsx)(jl,{})]})})}));bl.displayName=ot.UC.displayName;Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ot.JU,{ref:s,className:ns("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...a})})).displayName=ot.JU.displayName;const yl=Y.forwardRef(((e,s)=>{let{className:t,children:a,hideCheckIcon:r=!1,...n}=e;return(0,te.jsxs)(ot.q7,{ref:s,className:ns("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 text-sm outline-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50",r?"pl-2 pr-2":"pl-8 pr-2",t),...n,children:[!r&&(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)(ot.VF,{children:(0,te.jsx)(mt.A,{className:"h-4 w-4"})})}),(0,te.jsx)(ot.p4,{children:a})]})}));yl.displayName=ot.q7.displayName;Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ot.wv,{ref:s,className:ns("-mx-1 my-1 h-px bg-muted",t),...a})})).displayName=ot.wv.displayName;const Nl=e=>{var s,t,a,r,n;let{planType:l,plan:i,allPlans:o,currentTier:c,stats:d,usage:m,onSubscribe:u,onUpgrade:x,onManageSubscription:h,upgrading:p,disabled:g=!1,billingPeriod:f="yearly"}=e;const[v,j]=(0,Y.useState)(!1),[b,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)("elite"),[k,_]=(0,Y.useState)(!1),[S,C]=(0,Y.useState)(!1),A="elite"===l,E=(()=>{if(!A)return i;const e=`${N}_${f}`,s=o.find((s=>{let[t]=s;return t===e}));return s?s[1]:i})(),I=(null==E||null===(s=E.metadata)||void 0===s?void 0:s.monthly_message_limit)||0,L=(null==E||null===(t=E.metadata)||void 0===t?void 0:t.monthly_integration_credits)||0,T=Nn((null==E?void 0:E.nickname)||""),$=A?N:l,D=("active"===(null==d?void 0:d.subscription_status)||"past_due"===(null==d?void 0:d.subscription_status))&&(null==d||null===(a=d.stripe_subscription)||void 0===a||null===(r=a.plan)||void 0===r?void 0:r.id)===E.id,P=function(e,s){const t=["free","starter","starter_yearly","builder","builder_yearly","pro","pro_yearly","elite","elite_yearly","elite_2","elite_2_yearly","elite_3","elite_3_yearly"],a=t.indexOf((null==e?void 0:e.toLowerCase())||""),r=t.indexOf((null==s?void 0:s.toLowerCase())||"");return r>a&&-1!==a&&-1!==r}(c,$),M=function(e,s){const t=["free","starter","starter_yearly","builder","builder_yearly","pro","pro_yearly","elite","elite_yearly","elite_2","elite_2_yearly","elite_3","elite_3_yearly"],a=t.indexOf((null==e?void 0:e.toLowerCase())||""),r=t.indexOf((null==s?void 0:s.toLowerCase())||"");return r<a&&-1!==a&&-1!==r}(c,$),O="free"===(null==c?void 0:c.toLowerCase()),R=c&&!jn(c),F=(()=>{var e,s,t;if(!o)return(null==E||null===(e=E.metadata)||void 0===e?void 0:e.features)||"";const a=["starter","builder","pro"];let r=bn($);const n=r.startsWith("elite");n&&(r="pro");const l=a.indexOf(r);if(-1===l)return(null==E||null===(s=E.metadata)||void 0===s?void 0:s.features)||"";let i=[];for(let m=0;m<=l;m++){var c,d;const e=`${a[m]}_${f}`,s=o.find((s=>{let[t,a]=s;return t===e}));if(s&&null!==(c=s[1])&&void 0!==c&&null!==(d=c.metadata)&&void 0!==d&&d.features){const e=s[1].metadata.features.split(",").map((e=>e.trim())).filter((e=>e.length>0));i=[...i,...e]}}if(n&&null!=E&&null!==(t=E.metadata)&&void 0!==t&&t.features){const e=E.metadata.features.split(",").map((e=>e.trim())).filter((e=>e.length>0));i=[...i,...e]}return i.filter(((e,s,t)=>s===t.findIndex((s=>s.toLowerCase()===e.toLowerCase())))).join(",")})(),z=p?"Processing...":g?"Not Available":D?"Manage Payments":M?`Downgrade to ${T}`:P&&!O?`Upgrade to ${T}`:`Subscribe to ${T}`,U=p||g,B=()=>{const e=A?["elite","elite_2","elite_3"].map((e=>({value:e,label:"elite"===e?"Elite":"elite_2"===e?"Elite 2":"Elite 3"}))):[];if(!c||"free"===c.toLowerCase())return e;return c&&!jn(c)?e.filter((e=>function(e,s){if(!e||"free"===e.toLowerCase())return!0;if(jn(e))return!0;const t=["starter","builder","pro","elite","elite_2","elite_3"],a=bn(e),r=bn(s),n=t.indexOf(a);return t.indexOf(r)>=n}(c,yn(e.value)))):e};(0,Y.useEffect)((()=>{if(A){const e=B();e.length>0&&!e.find((e=>e.value===N))&&w(e[0].value)}}),[c,A]);const W=E.unit_amount?"month"===(null===(n=E.recurring)||void 0===n?void 0:n.interval)?(E.unit_amount/100).toFixed(0):(E.unit_amount/100/12).toFixed(0):"0",q=(()=>{if(!R||!o)return null;const e=yn(bn(c)),s=o.find((s=>{let[t]=s;return t===e}));return s?s[1]:null})(),V=null!=q&&q.unit_amount?(q.unit_amount/100/12).toFixed(0):"0";return(0,te.jsx)(te.Fragment,{children:(0,te.jsxs)("div",{className:"relative",children:[D&&(0,te.jsx)("div",{className:"absolute z-10 -top-[26px] left-1/4 -translate-x-1/2 px-3 py-1 bg-slate-700 text-white text-sm rounded-t-[12px]",children:"Current Plan"}),(0,te.jsxs)("div",{className:"bg-white rounded-[20px] p-6 flex flex-col transition-all duration-300 hover:shadow-xl h-[480px] "+(D?"border-2 border-slate-700":"pro"!==l||g?"border-2 border-[#E9E9E9]":"border-2 border-orange-300 mb-2"),children:[(0,te.jsxs)("div",{className:""+(A?"mb-2":"mb-5"),children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,te.jsx)("div",{className:"flex items-center gap-2",children:(0,te.jsx)("span",{className:"text-[18px] font-[400] "+(g?"text-gray-400":"text-gray-900"),children:T})}),"pro"===l&&!g&&(0,te.jsx)("span",{className:"px-2 py-1 text-sm font-medium bg-[#FFE5DA] text-[#F16727] rounded-[6px]",children:"Recommended"})]}),(0,te.jsxs)("div",{className:"flex items-end mb-2",children:[(0,te.jsx)("span",{className:"text-3xl font-medium "+(g?"text-gray-400":"text-gray-900"),children:"$"}),(0,te.jsx)("span",{className:"text-3xl font-medium "+(g?"text-gray-400":"text-gray-900"),children:W}),(0,te.jsx)("span",{className:"font-thin ml-1 mb-1 text-[#C1C1C1] text-2xl",children:"/"}),(0,te.jsx)("span",{className:"font-normal mb-1 text-[#C1C1C1] text-[14px]",children:"mo"})]})]}),(0,te.jsx)("div",{className:"-mt-1 mb-2",children:A&&!g?(0,te.jsxs)(pl,{value:N,onValueChange:w,children:[(0,te.jsx)(fl,{advancedDropdown:!0,className:"w-full h-auto p-2 bg-white border border-gray-200",children:(0,te.jsx)("div",{className:"w-full text-left",children:(0,te.jsxs)("div",{className:"w-full flex flex-col gap-1",children:[(0,te.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,te.jsx)("span",{className:"font-[500] inline-block min-w-[30px]",children:vn(I)}),(0,te.jsx)("span",{className:"font-[400] text-[#5F5F5F]",children:"Monthly credits"})]}),(0,te.jsxs)("div",{className:"text-sm text-gray-900",children:[(0,te.jsx)("span",{className:"font-[500] inline-block min-w-[30px]",children:vn(L)}),(0,te.jsx)("span",{className:"font-[400] text-[#5F5F5F]",children:"Integration credits"})]})]})})}),(0,te.jsx)(bl,{className:"w-[calc(100%-1rem)] max-w-[320px] z-50 p-1.5",sideOffset:4,children:B().map((e=>{var s,t;const a=`${e.value}_${f}`,r=o.find((e=>{let[s]=e;return s===a})),n=r?r[1]:null,l=(null==n||null===(s=n.metadata)||void 0===s?void 0:s.monthly_message_limit)||0,i=(null==n||null===(t=n.metadata)||void 0===t?void 0:t.monthly_integration_credits)||0;return(0,te.jsx)(yl,{value:e.value,className:"px-4 py-2 border-b border-gray-100 last:border-b-0",hideCheckIcon:!0,children:(0,te.jsxs)("div",{className:"w-full flex flex-col gap-1",children:[(0,te.jsxs)("div",{className:"text-sm leading-[17px] flex items-center gap-1.5 text-gray-900",children:[(0,te.jsx)("span",{className:"font-bold",children:vn(l)}),(0,te.jsx)("span",{className:"text-gray-500",children:"monthly credits"})]}),(0,te.jsxs)("div",{className:"text-sm leading-[17px] flex items-center gap-1.5 text-gray-900",children:[(0,te.jsx)("span",{className:"font-bold",children:vn(i)}),(0,te.jsx)("span",{className:"text-gray-500",children:"integration credits"})]})]})},e.value)}))})]}):(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)("div",{className:"text-sm "+(g?"text-gray-400":"text-gray-900"),children:[(0,te.jsx)("span",{className:"font-[500] inline-block min-w-[30px]",children:vn(I)}),(0,te.jsx)("span",{className:"font-[400] text-[#5F5F5F]",children:"Monthly credits"})]}),(0,te.jsxs)("div",{className:"text-sm "+(g?"text-gray-400":"text-gray-900"),children:[(0,te.jsx)("span",{className:"font-[500] inline-block min-w-[30px]",children:vn(L)}),(0,te.jsx)("span",{className:"font-[400] text-[#5F5F5F]",children:"Integration credits"})]})]})}),(0,te.jsx)("div",{className:"mb-4",children:(0,te.jsx)(sl,{className:"w-full py-2 text-[16px] font-medium transition-colors cursor-pointer rounded-[8px] "+(D?"bg-[#F4F4F5] py-2 text-[16px] font-medium shadow-sm hover:bg-gray-50 text-gray-700":g?"bg-gray-100 border border-gray-200 text-gray-400 cursor-not-allowed":"pro"===l?"bg-[#F97316] hover:bg-[#000000] text-white":"bg-white border border-gray-300 hover:bg-[#F97316] text-black hover:text-white hover:border-white"),onClick:()=>{if(!g&&!U)if(D)R?_(!0):h();else if(M)y(!0);else if(P&&!O)if(R){x(A?N:l)}else j(!0);else{u(A?N:l)}},disabled:U,children:z})}),(0,te.jsx)("div",{className:"space-y-1 flex-grow",children:null==F?void 0:F.split(",").map(((e,s)=>(0,te.jsx)(hl,{text:e.trim(),disabled:g,showGift:!1},s)))})]}),(0,te.jsx)(Bn,{open:v,onOpenChange:j,children:(0,te.jsxs)(Yn,{className:"sm:max-w-md",children:[(0,te.jsxs)(Hn,{children:[(0,te.jsx)(Jn,{children:"Confirm Subscription Upgrade"}),(0,te.jsxs)(Zn,{children:["You are about to upgrade to the ",T," plan for $",W,"/mo. Your subscription will be updated immediately and you'll be charged a prorated amount for the remainder of your billing cycle."]})]}),(0,te.jsxs)(Gn,{className:"sm:justify-between",children:[(0,te.jsx)(sl,{variant:"outline",onClick:()=>j(!1),className:"text-sm",children:"Cancel"}),(0,te.jsx)(sl,{onClick:()=>{if(j(!1),R&&P&&!O){x(A?N:l)}else x(E.id)},disabled:p,className:"text-sm bg-teal-600 hover:bg-teal-700",children:p?"Processing...":"Confirm Upgrade"})]})]})}),(0,te.jsx)(Bn,{open:b,onOpenChange:y,children:(0,te.jsxs)(Yn,{className:"sm:max-w-md",children:[(0,te.jsxs)(Hn,{children:[(0,te.jsx)(Jn,{children:"Confirm Subscription Downgrade"}),(0,te.jsxs)(Zn,{children:["You are about to downgrade to the ",T," plan for $",W,"/mo. This change will take effect at the end of your current billing cycle."]})]}),(0,te.jsxs)(Gn,{className:"sm:justify-between",children:[(0,te.jsx)(sl,{variant:"outline",onClick:()=>y(!1),className:"text-sm",children:"Cancel"}),(0,te.jsx)(sl,{onClick:()=>{y(!1),x(E.id)},disabled:p,className:"text-sm bg-gray-500 hover:bg-gray-600",children:p?"Processing...":"Confirm Downgrade"})]})]})}),(0,te.jsx)(Bn,{open:k,onOpenChange:_,children:(0,te.jsxs)(Yn,{className:"sm:max-w-md",children:[(0,te.jsxs)(Hn,{children:[(0,te.jsx)(Jn,{children:"Manage Your Subscription"}),(0,te.jsxs)(Zn,{children:["Choose how you'd like to manage your ",T," subscription."]})]}),(0,te.jsxs)("div",{className:"py-4 space-y-3",children:[(0,te.jsx)(sl,{onClick:()=>{_(!1),C(!0)},className:"w-full bg-teal-600 hover:bg-teal-700 text-white p-4 h-auto",disabled:!q,children:(0,te.jsxs)("div",{className:"text-left w-full",children:[(0,te.jsx)("div",{className:"font-medium",children:"Upgrade to Yearly"}),(0,te.jsx)("div",{className:"text-sm opacity-90 mt-1",children:"Save money and get a free domain + 25 credits to share!"})]})}),(0,te.jsx)(sl,{onClick:()=>{_(!1),h()},variant:"outline",className:"w-full p-4 h-auto",children:(0,te.jsxs)("div",{className:"text-left w-full",children:[(0,te.jsx)("div",{className:"font-medium",children:"Manage Payments"}),(0,te.jsx)("div",{className:"text-sm text-gray-600 mt-1",children:"Update payment method, view invoices, and more"})]})})]})]})}),(0,te.jsx)(Bn,{open:S,onOpenChange:C,children:(0,te.jsxs)(Yn,{className:"sm:max-w-md",children:[(0,te.jsxs)(Hn,{children:[(0,te.jsx)(Jn,{children:"Confirm Subscription Upgrade"}),(0,te.jsxs)(Zn,{children:["You are about to upgrade to the ",Nn((null==q?void 0:q.nickname)||"")," yearly plan for $",V,"/mo. Your subscription will be updated immediately and you'll be charged a prorated amount for the remainder of your billing cycle."]})]}),(0,te.jsx)("div",{className:"py-4",children:(0,te.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,te.jsx)("div",{className:"text-green-800 font-medium mb-2",children:"\u{1f381} Yearly Benefits"}),(0,te.jsxs)("ul",{className:"text-sm text-green-700 space-y-1",children:[(0,te.jsx)("li",{children:"\u2022 Get a free domain for a year"}),(0,te.jsx)("li",{children:"\u2022 25 credits to share with friends"}),(0,te.jsx)("li",{children:"\u2022 Better value with yearly pricing"})]})]})}),(0,te.jsxs)(Gn,{className:"sm:justify-between",children:[(0,te.jsx)(sl,{variant:"outline",onClick:()=>C(!1),className:"text-sm",children:"Cancel"}),(0,te.jsx)(sl,{onClick:()=>{C(!1),q&&x(q.id)},disabled:p,className:"text-sm bg-teal-600 hover:bg-teal-700",children:p?"Processing...":"Confirm Upgrade"})]})]})})]})})},wl=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(rt.bL,{className:ns("grid gap-2",t),...a,ref:s})}));wl.displayName=rt.bL.displayName;const kl=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(rt.q7,{ref:s,className:ns("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...a,children:(0,te.jsx)(rt.C1,{className:"flex items-center justify-center",children:(0,te.jsx)(nt.A,{className:"h-2.5 w-2.5 fill-current text-current"})})})}));kl.displayName=rt.q7.displayName;var _l=t(12188);const Sl=_l.bL,Cl=Y.forwardRef(((e,s)=>{let{...t}=e;return(0,te.jsx)(_l.R6,{ref:s,...t})}));Cl.displayName=_l.R6.displayName;const Al=Y.forwardRef(((e,s)=>{let{...t}=e;return(0,te.jsx)(_l.Ke,{ref:s,...t})}));Al.displayName=_l.Ke.displayName;const El=e=>{var s,t;let{period:a,plan:r,monthlyPlan:n,features:l,isSelected:i,isExpanded:o,onSelect:c,onExpansionToggle:d,onYearlySelect:m,disabled:u=!1}=e;const x=(null==r||null===(s=r.metadata)||void 0===s?void 0:s.monthly_message_limit)||0,h=(null==r||null===(t=r.metadata)||void 0===t?void 0:t.monthly_integration_credits)||0,p=(null==r?void 0:r.nickname)||"",g=(Nn(p),p.toLowerCase().includes("starter"));let f,v;"yearly"===a?(f=(r.unit_amount/100/12).toFixed(0),v=" x 12 months"):(f=r.unit_amount?(r.unit_amount/100).toFixed(0):"0",v=" / every month");const j="yearly"===a?"Yearly":"Monthly",b=(()=>{if("yearly"!==a||null==n||!n.unit_amount||null==r||!r.unit_amount)return 0;const e=12*n.unit_amount-r.unit_amount;return Math.round(e/100)})();return(0,te.jsx)(Sl,{open:o,onOpenChange:d,onClick:c,children:(0,te.jsxs)("div",{className:`font-base44 bg-white cursor-pointer rounded-[12px] ${i?"border border-black":"border border-transparent"} ${i?"":"hover:bg-gray-50"} ${u?"text-gray-200":""} ${"yearly"===a?"mb-4":""} transition-all duration-200`,children:[(0,te.jsxs)("div",{className:"flex items-center justify-between p-4 sm:p-6",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-3 sm:space-x-4 flex-1 cursor-pointer",children:[(0,te.jsx)(kl,{value:a,id:a,className:i?"border-black text-black":""}),(0,te.jsx)("div",{className:"text-left flex-1 min-w-0",children:(0,te.jsxs)("label",{htmlFor:a,className:"text-base sm:text-lg flex flex-col sm:flex-row sm:items-center gap-1 sm:gap-3 "+(u?"text-gray-400":"text-gray-900"),children:[(0,te.jsx)("span",{className:"font-bold",children:j}),(0,te.jsx)("span",{className:"hidden sm:block h-px w-4 bg-gray-300"}),(0,te.jsxs)("span",{className:"font-normal text-sm sm:text-base",children:["$",f,v]})]})})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-3 flex-shrink-0",children:["yearly"===a&&b>0&&(0,te.jsxs)("span",{className:`px-2 sm:px-4 py-1 text-xs sm:text-sm font-bold ${i?"bg-[#F0FFE1]":""} text-[#00A184] rounded-lg border border-[#00A184]`,children:["SAVE $",b]}),(0,te.jsx)(Cl,{asChild:!0,children:(0,te.jsx)("button",{className:"p-1 hover:bg-gray-100 rounded",children:o?(0,te.jsx)(dt.A,{className:"h-5 w-5 text-gray-400"}):(0,te.jsx)(ct.A,{className:"h-5 w-5 text-gray-400"})})})]})]}),(0,te.jsx)(Al,{children:(0,te.jsxs)("div",{className:"px-4 sm:px-6 pb-4 sm:pb-6",children:[(0,te.jsx)("div",{className:"border-t border-gray-200"}),(0,te.jsx)("div",{className:"mt-4 mb-6",children:(0,te.jsxs)("div",{className:"flex gap-3",children:[(0,te.jsxs)("div",{className:"text-sm flex items-center gap-2 "+(u?"text-gray-400":"text-gray-900 bg-slate-100 px-4 py-2 rounded-lg w-fit"),children:[(0,te.jsx)("span",{className:"font-bold",children:vn(x)}),(0,te.jsx)("span",{className:"text-black",children:"Monthly credits"})]}),(0,te.jsxs)("div",{className:"text-sm flex items-center gap-2 "+(u?"text-gray-400":"text-gray-900 bg-slate-100 px-4 py-2 rounded-lg w-fit"),children:[(0,te.jsx)("span",{className:"font-semibold",children:vn(h)}),(0,te.jsx)("span",{className:"text-black",children:"Integration credits"})]})]})}),!g&&(0,te.jsxs)("div",{className:"mb-4 "+("monthly"===a?"bg-slate-50 p-3 sm:p-4 rounded-lg border border-gray-200":""),children:[(0,te.jsx)("h4",{className:"text-sm font-bold mb-3",children:"monthly"===a?"NOTE: Monthly subscription doesn't include:":`What's included with the ${a} plan`}),(0,te.jsx)("div",{className:"space-y-2",children:!g&&("yearly"===a||"monthly"===a)&&{yearly:["Enjoy a special discount and save money","Get a free domain for 1 year","Receive 25 credits to share with a friend"],monthly:["Special discount and savings","Free domain for 1 year","25 credits to share with a friend"]}[a].map(((e,s)=>(0,te.jsx)(hl,{text:e,disabled:u,showX:"monthly"===a,showGift:"yearly"===a},`additional-${s}`)))}),"monthly"===a&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"border-t border-gray-200 mt-4"}),(0,te.jsxs)("p",{className:"mt-4 text-sm",children:["Choose a ",(0,te.jsx)("span",{className:"text-blue-500 cursor-pointer hover:underline",onClick:m,children:"yearly"})," subscription to get the most from your premium plan"]})]})]})]})})]})})},Il=e=>{var s;let{selectedPlanType:t,stats:a,onSubscribe:r,onBack:n,selectedEliteTier:l,isUpgradeFlow:i=!1,onUpgrade:o}=e;const[c,d]=(0,Y.useState)("yearly"),[m,u]=(0,Y.useState)("yearly"),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),f=l||t,v=a.pricing.monthly[f],j=a.pricing.yearly[f];if(!v||!j)return(0,te.jsxs)("div",{className:"text-center py-8 px-4",children:[(0,te.jsx)("p",{className:"text-gray-500",children:"Plan not found. Please try again."}),(0,te.jsx)(sl,{onClick:n,variant:"outline",className:"mt-4",children:"Go Back"})]});Nn(v.nickname);const b=e=>{var s;return(null==e||null===(s=e.metadata)||void 0===s?void 0:s.features)||""},y=e=>{d(e),u(e)},N=e=>{u(m===e?null:e)};return(0,te.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,te.jsx)("div",{className:"rounded-lg",children:(0,te.jsxs)(wl,{value:c,onValueChange:y,className:"gap-0",children:[(0,te.jsx)(El,{period:"yearly",plan:j,monthlyPlan:v,features:b(j),isSelected:"yearly"===c,isExpanded:"yearly"===m,onSelect:()=>y("yearly"),onExpansionToggle:()=>N("yearly")}),(0,te.jsx)(El,{period:"monthly",plan:v,monthlyPlan:v,features:b(v),isSelected:"monthly"===c,isExpanded:"monthly"===m,onSelect:()=>y("monthly"),onExpansionToggle:()=>N("monthly"),onYearlySelect:()=>y("yearly")})]})}),(0,te.jsx)("div",{className:"mt-6 flex justify-center sm:justify-end px-4 sm:px-0",children:(0,te.jsx)(sl,{onClick:()=>{if(i)h(!0);else{r(("yearly"===c?j:v).id)}},className:"w-full sm:w-auto px-6 py-4 text-md font-normal bg-black hover:bg-orange-600 text-white rounded-lg",disabled:p,children:i?"Confirm Subscription Upgrade":"Continue to Checkout"})}),i&&(0,te.jsx)(Bn,{open:x,onOpenChange:h,children:(0,te.jsxs)(Yn,{className:"sm:max-w-md",children:[(0,te.jsxs)(Hn,{children:[(0,te.jsx)(Jn,{children:"Confirm Subscription Upgrade"}),(0,te.jsxs)(Zn,{children:["You are about to upgrade to the ",Nn((null===(s="yearly"===c?j:v)||void 0===s?void 0:s.nickname)||"")," plan for $",(w="yearly"===c?j:v,null!=w&&w.unit_amount?"month"===(null===(k=w.recurring)||void 0===k?void 0:k.interval)?(w.unit_amount/100).toFixed(0):(w.unit_amount/100/12).toFixed(0):"0"),"/mo. Your subscription will be updated immediately and you'll be charged a prorated amount for the remainder of your billing cycle."]})]}),(0,te.jsxs)(Gn,{className:"sm:justify-between",children:[(0,te.jsx)(sl,{variant:"outline",onClick:()=>h(!1),disabled:p,className:"text-sm",children:"Cancel"}),(0,te.jsx)(sl,{onClick:async()=>{if(o){g(!0);try{const e="yearly"===c?j:v;await o(e.id),h(!1)}catch(e){}finally{g(!1)}}},disabled:p,className:"text-sm bg-teal-600 hover:bg-teal-700",children:p?"Processing...":"Confirm Upgrade"})]})]})})]});var w,k},Ll=e=>{let{isOpen:s,onClose:t}=e;const a=(0,Y.useRef)(null),r=(0,Y.useRef)(null);(0,Y.useEffect)((()=>{if(s){if(window.hbspt)n();else{const e=document.createElement("script");e.src="//js-eu1.hsforms.net/forms/embed/v2.js",e.charset="utf-8",e.type="text/javascript",document.head.appendChild(e),e.onload=()=>{n()}}const e=document.createElement("style");return e.textContent='\n        .hs-form-field {\n          margin-bottom: 1rem;\n        }\n        .hs-form-field label {\n          font-size: 0.875rem;\n          font-weight: 500;\n          color: #374151;\n          margin-bottom: 0.5rem;\n          display: block;\n        }\n        .hs-form-field input,\n        .hs-form-field textarea {\n          width: 100%;\n          padding: 0.75rem;\n          border: 1px solid #d1d5db;\n          border-radius: 0.5rem;\n          font-size: 0.875rem;\n          transition: border-color 0.2s;\n        }\n        .hs-form-field input:focus,\n        .hs-form-field textarea:focus {\n          outline: none;\n          border-color: #3b82f6;\n          box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1);\n        }\n        .hs-form-field textarea {\n          min-height: 100px;\n          resize: vertical;\n        }\n        .hs-error-msgs {\n          color: #dc2626;\n          font-size: 0.75rem;\n          margin-top: 0.25rem;\n        }\n        .hs-button {\n          background-color: #1f2937;\n          color: white;\n          padding: 0.75rem 1.5rem;\n          border: none;\n          border-radius: 0.5rem;\n          font-weight: 500;\n          cursor: pointer;\n          transition: background-color 0.2s;\n          width: 100%;\n          margin-top: 1rem;\n        }\n        .hs-button:hover {\n          background-color: #111827;\n        }\n        .hs-form {\n          margin-top: 1rem;\n        }\n        .hs-form .hs-form-field {\n          display: inline-block;\n          width: calc(50% - 0.5rem);\n          margin-right: 1rem;\n        }\n        .hs-form .hs-form-field:nth-child(even) {\n          margin-right: 0;\n        }\n        .hs-form .hs-form-field:last-child,\n        .hs-form .hs-form-field:nth-last-child(2) {\n          width: 100%;\n          margin-right: 0;\n        }\n        @media (max-width: 640px) {\n          .hs-form .hs-form-field {\n            width: 100%;\n            margin-right: 0;\n          }\n        }\n        \n        /* Success message styling with Base44 colors */\n        .hs-form .hs-error-msgs,\n        .hs-form .hs-error-msgs label {\n          display: none !important;\n        }\n        \n        .success-message {\n          text-align: center;\n          padding: 3rem 2rem;\n          background: linear-gradient(135deg, #fef7ed 0%, #fef3e2 100%);\n          border-radius: 1rem;\n          margin: 1rem 0;\n          border: 1px solid #fed7aa;\n          position: relative;\n          overflow: hidden;\n        }\n        \n        .success-message::before {\n          content: "";\n          position: absolute;\n          top: 0;\n          left: 0;\n          right: 0;\n          height: 4px;\n          background: linear-gradient(90deg, #f97316, #ea580c);\n        }\n        \n        .success-icon {\n          display: flex;\n          align-items: center;\n          justify-content: center;\n          width: 4rem;\n          height: 4rem;\n          background: #f97316;\n          color: white;\n          border-radius: 50%;\n          margin: 0 auto 1.5rem;\n          box-shadow: 0 4px 12px rgba(249, 115, 22, 0.3);\n        }\n        \n        .success-title {\n          color: #9a3412;\n          font-size: 1.5rem;\n          font-weight: 700;\n          margin: 0 0 0.75rem 0;\n          line-height: 1.2;\n        }\n        \n        .success-description {\n          color: #c2410c;\n          font-size: 1rem;\n          margin: 0;\n          line-height: 1.6;\n          max-width: 400px;\n          margin: 0 auto;\n        }\n        \n        .success-decoration {\n          position: absolute;\n          top: -10px;\n          right: -10px;\n          width: 60px;\n          height: 60px;\n          background: rgba(249, 115, 22, 0.1);\n          border-radius: 50%;\n        }\n        \n        .success-decoration:nth-child(2) {\n          bottom: -10px;\n          left: -10px;\n          width: 40px;\n          height: 40px;\n          background: rgba(249, 115, 22, 0.05);\n        }\n        \n        .base44-logo {\n          width: 2rem;\n          height: 2rem;\n          margin: 0 auto 1rem;\n        }\n      ',document.head.appendChild(e),()=>{const e=document.querySelector("style[data-hubspot-modal]");e&&e.remove()}}}),[s]);const n=()=>{window.hbspt&&r.current&&window.hbspt.forms.create({portalId:"146561033",formId:"6c32b630-0d03-43da-948e-3808a34bbeff",region:"eu1",target:"#hubspot-form-container",onFormSubmitted:function(e){const s=document.getElementById("hubspot-form-container");s&&(s.innerHTML='\n              <div class="success-message">\n                <div class="success-decoration"></div>\n                <div class="success-decoration"></div>\n                <div class="success-icon">\n                  <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                    <path d="M22 11.08V12a10 10 0 1 1-5.93-9.14"></path>\n                    <polyline points="22,4 12,14.01 9,11.01"></polyline>\n                  </svg>\n                </div>\n                <h3 class="success-title">Thank you for reaching out!</h3>\n                <p class="success-description">We\'ve received your message and our team will get back to you within 24 hours. We\'re excited to help you with your Base44 journey!</p>\n              </div>\n            ')}})};return s?(0,te.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:(0,te.jsxs)("div",{ref:a,className:"bg-white rounded-xl shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between p-6 border-b border-slate-100",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h2",{className:"text-2xl font-bold text-slate-900",children:"Let's talk"}),(0,te.jsx)("p",{className:"text-slate-600 mt-1",children:"Connect with our team to see how Base44 can help your organization."})]}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:t,className:"h-8 w-8 p-0 hover:bg-slate-100 rounded-full",children:(0,te.jsx)(Ds.A,{className:"h-4 w-4"})})]}),(0,te.jsx)("div",{className:"p-6",children:(0,te.jsx)("div",{id:"hubspot-form-container",ref:r})})]})}):null};var Tl=t(55510),$l=t(63997),Dl=t(16243);const Pl=e=>{let{icon:s,title:t,description:a}=e;return(0,te.jsxs)("div",{className:"flex flex-col items-start gap-2",children:[(0,te.jsx)("div",{className:"w-5 h-5 flex items-center justify-center flex-shrink-0",children:s}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"text-white font-bold mb-1 text-sm",children:t}),(0,te.jsx)("p",{className:"text-white font-normal text-sm",children:a})]})]})},Ml=()=>{const[e,s]=(0,Y.useState)(!1);return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"mt-8 max-w-full mx-auto px-4",children:(0,te.jsx)("div",{className:"bg-gradient-to-tl from-[#FE7F48] via-slate-800 to-slate-800 rounded-[20px] px-12 py-8 text-white",children:(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row items-center gap-14",children:[(0,te.jsxs)("div",{className:"flex-[2] flex flex-col justify-center items-start",children:[(0,te.jsx)("h3",{className:"text-[24px] font-bold mb-2",children:"Base44 Enterprise Capabilities"}),(0,te.jsx)("p",{className:"text-white mb-6 font-light",children:"Empower large organizations to build solutions that fit their teams perfectly, safely and at scale"}),(0,te.jsx)(sl,{className:"bg-transparent text-white hover:bg-white hover:text-slate-800 font-medium px-8 py-3 border border-white hover:border-white rounded-lg transition-colors text-base",onClick:()=>s(!0),children:"Contact Us"})]}),(0,te.jsx)("div",{className:"flex-[3]",children:(0,te.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-14 w-full",children:[(0,te.jsx)(Pl,{icon:(0,te.jsx)(qa.A,{className:"w-5 h-5 text-orange-400"}),title:"Tailored onboarding at scale",description:"Custom training designed for your team's skills, roles, and goals so everyone is ready from day one."}),(0,te.jsx)(Pl,{icon:(0,te.jsx)(Tl.A,{className:"w-5 h-5 text-orange-400"}),title:"Dedicated account manager",description:"A single point of contact offering guidance and support to help you achieve your objectives faster."}),(0,te.jsx)(Pl,{icon:(0,te.jsx)($l.A,{className:"w-5 h-5 text-orange-400"}),title:"Priority support, guaranteed",description:"Direct access to a support channel and guaranteed response times for every issue that arises."}),(0,te.jsx)(Pl,{icon:(0,te.jsx)(Dl.A,{className:"w-5 h-5 text-orange-400"}),title:"Enterprise security and compliance",description:"Easily manage access, connect with your systems, and meet all necessary regulatory requirements."})]})})]})})}),(0,te.jsx)(Ll,{isOpen:e,onClose:()=>s(!1)})]})};var Ol=t(37358),Rl=t(53270);const Fl=()=>(0,te.jsx)("div",{className:"mt-6 mb-2 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"flex items-center justify-center gap-6 flex-wrap",children:[(0,te.jsx)("span",{style:{color:"#000624"},className:"text-sm font-normal leading-normal",children:"Base44 benefits:"}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Ol.A,{size:16,style:{color:"#000624"}}),(0,te.jsx)("span",{style:{color:"#000624"},className:"text-sm font-medium leading-normal",children:"Responsive visual editor"})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Rl.A,{size:16,style:{color:"#000624"}}),(0,te.jsx)("span",{style:{color:"#000624"},className:"text-sm font-medium leading-normal",children:"Built-in backend"})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Wa.A,{size:16,style:{color:"#000624"}}),(0,te.jsx)("span",{style:{color:"#000624"},className:"text-sm font-medium leading-normal",children:"User management"})]})]})});var zl=t(1323);const Ul=e=>{let{type:s,title:t,message:a,subMessage:r,buttonText:n,loadingText:l,onButtonClick:i,handleManageSubscription:o,isLoading:c}=e;const d="cancellation"===s?{container:"bg-gradient-to-r from-orange-50 to-orange-50/80 border-orange-200/60 shadow-sm",icon:"text-orange-500",title:"text-orange-900 font-semibold",description:"text-orange-800",subText:"text-orange-600",button:"bg-orange-100 border-orange-200 text-orange-800 hover:bg-orange-200 hover:border-orange-300 transition-all duration-200 font-medium shadow-sm"}:{container:"bg-gradient-to-r from-slate-50 to-slate-50/80 border-slate-200/60 shadow-sm",icon:"text-slate-500",title:"text-slate-900 font-semibold",description:"text-slate-700",subText:"text-slate-600",button:"bg-slate-100 border-slate-200 text-slate-800 hover:bg-slate-200 hover:border-slate-300 transition-all duration-200 font-medium shadow-sm"};return(0,te.jsx)(is,{className:`mb-3 ${d.container} rounded-xl border p-4`,children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)(zl._TA,{className:`h-4 w-4 ${d.icon} mt-0.5 flex-shrink-0`}),(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsx)(os,{className:`${d.title} text-sm mb-1 leading-tight`,children:t}),(0,te.jsxs)(cs,{className:`${d.description} text-sm leading-relaxed`,children:[(0,te.jsx)("div",{className:"mb-1",children:a}),r&&(0,te.jsx)("div",{className:`text-xs ${d.subText} leading-relaxed`,children:r})]})]}),n&&(0,te.jsx)("div",{className:"flex-shrink-0",children:(0,te.jsx)(sl,{variant:"outline",size:"sm",className:`text-xs px-3 py-1.5 h-auto rounded-lg ${d.button}`,onClick:"cancellation"===s?o:i,disabled:c,children:c?l:n})})]})})};var Bl=t(97202);const Wl=()=>(0,te.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 lg:gap-4 max-w-full mx-auto px-4",children:[(0,te.jsx)(xl,{}),(0,te.jsx)(xl,{}),(0,te.jsx)(xl,{}),(0,te.jsx)(xl,{})]}),ql=()=>{var e;const{toast:s}=Un(),{user:t}=ne(),{activeWorkspace:a}=xe(),r=(0,Y.useRef)(null),[n,l]=(0,Y.useState)("billing"),[i,o]=(0,Y.useState)("yearly"),[c,d]=(0,Y.useState)(""),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)(null),[f,v]=(0,Y.useState)(!0),[j,b]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(""),[w,k]=(0,Y.useState)(""),[_,S]=(0,Y.useState)(!1),[C,A]=(0,Y.useState)(""),[E,I]=(0,Y.useState)(!1),[L,T]=(0,Y.useState)(!1),$=a&&!a.is_personal;(0,Y.useEffect)((()=>{const e=(null==a?void 0:a.id)||null;null!==r.current&&r.current!==e&&(h(null),g(null),v(!0),l("billing"),o("monthly"),d(""),u(!1),b(!1),N(""),k(""),S(!1),A("")),r.current=e}),[null==a?void 0:a.id]),(0,Y.useEffect)((()=>{if($)return;(async()=>{try{v(!0);const[e,s]=await Promise.all([Qe.default.getCurrentUsage(),Qe.default.getStats()]);h(e),g(s);const t=e;if(null!=t&&t.tier)if("free"===t.tier.toLowerCase())o("yearly");else{const e=t.tier.toLowerCase().includes("_yearly");o(e?"yearly":"monthly")}}catch(e){}finally{v(!1)}})()}),[$]),(0,Y.useEffect)((()=>{if(t){"true"===new URLSearchParams(window.location.search).get("success")&&t.email&&(window.rewardful&&window.rewardful("convert",{email:t.email}),Se("Billing - Purchase",{}),cl("Purchase",{email:(0,ml.sha256)(t.email),price:20,user_id:t.id}))}}),[t]),(0,Y.useEffect)((()=>{t&&!$&&(Se("Package Picker",{}),cl("package_picker",{user_id:t.id,email:(0,ml.sha256)(t.email)}))}),[t,$]);const D=async e=>{const a=["starter","builder","pro","elite"].includes(e),r=["elite","elite_2","elite_3"].includes(e);if(a||r)return N(a?e:"elite"),k(r?e:""),void b(!0);try{Se("Hit Subscribe",{}),cl("checkout_initiated",{email:(0,ml.sha256)(t.email),price:20,user_id:t.id});const s=await Tn.createCheckoutSession(e),{sessionId:a}=s,r=await(0,Bl.loadStripe)("pk_live_51QK05lD5KgnLQ3Da11GxDxTfiDHUUr9QGgmU8BY0JIRuCUkU01wxJoKJ8wP72hPAS30JxEsTdEJ4puysUKwQn2te00tAMQjxt9");await r.redirectToCheckout({sessionId:a})}catch(n){s({variant:"destructive",title:"Error",description:"Failed to create checkout session. Please try again later."})}},P=()=>{b(!1),N(""),k(""),S(!1),A("")},M=async e=>{try{var t;const a=null===(t=(await Tn.updateSubscription(e)).subscription)||void 0===t?void 0:t.is_downgrade;s({title:"Subscription Updated",description:a?"Your subscription has been scheduled to downgrade at the end of your billing cycle.":"Your subscription has been upgraded successfully. Changes will be reflected shortly."}),setTimeout((()=>{window.location.reload()}),2e3)}catch(r){var a;s({variant:"destructive",title:"Error",description:(null===(a=r.response)||void 0===a?void 0:a.detail)||"Failed to update subscription. Please try again later."})}},O=async e=>{const s=["elite","elite_2","elite_3"];if((["starter","builder","pro","elite"].includes(e)||s.includes(e))&&"monthly"===i)return N(s.includes(e)?"elite":e),s.includes(e)?k(e):k(""),A(e),S(!0),void b(!0);await M(e)},R=async()=>{try{const e=await Tn.createPortalSession();window.open(e.url,"_blank")}catch(e){s({variant:"destructive",title:"Error",description:"Failed to open subscription management. Please try again later."})}},F=null==t?void 0:t.subscription_schedule_id,z=!0===(null==p||null===(e=p.stripe_subscription)||void 0===e?void 0:e.cancel_at_period_end),U=()=>{if(null==p||!p.pricing)return[];const e=[];return Object.entries(p.pricing.monthly).forEach((s=>{let[t,a]=s;e.push([`${t}_monthly`,a])})),Object.entries(p.pricing.yearly).forEach((s=>{let[t,a]=s;e.push([`${t}_yearly`,a])})),e};return(0,te.jsxs)("div",{className:"container mx-auto px-2 sm:px-6 lg:px-6 py-6 sm:py-8 min-h-screen flex flex-col font-base44",children:[!$&&!f&&(null==x?void 0:x.past_due)&&(0,te.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-md text-red-800",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Ze.A,{className:"h-5 w-5 mr-2 flex-shrink-0"}),(0,te.jsx)("span",{className:"font-medium",children:"Subscription payment overdue"})]}),(0,te.jsx)(sl,{onClick:async()=>{try{const e="payment_method_update",s=await Tn.createPortalSession(e);window.location.href=s.url}catch(e){s({variant:"destructive",title:"Error",description:"Failed to open payment management. Please try again."})}},variant:"outline",size:"sm",className:"border-red-300 text-red-700 hover:bg-red-100 hover:border-red-400",children:"Update Payment Method"})]}),(0,te.jsx)("p",{className:"text-sm mt-2",children:"Your subscription payment is overdue. Access to some features is currently limited. Please update your payment method to regain full access."})]}),j&&(0,te.jsx)("div",{className:"block lg:hidden mb-2",children:(0,te.jsxs)(sl,{onClick:P,variant:"ghost",className:"px-2 text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[(0,te.jsx)($t.A,{className:"h-5 w-5"}),(0,te.jsx)("span",{className:"font-base44",children:"Back"})]})}),(0,te.jsx)("div",{className:"flex flex-col items-center text-center mb-6",children:j?(0,te.jsx)(te.Fragment,{children:(0,te.jsxs)("div",{className:"w-full relative",children:[(0,te.jsxs)(sl,{onClick:P,variant:"ghost",className:"hidden lg:flex absolute left-0 px-2 text-gray-600 hover:text-gray-900 items-center gap-1",children:[(0,te.jsx)($t.A,{className:"h-5 w-5"}),(0,te.jsx)("span",{className:"font-base44",children:"Back"})]}),(0,te.jsxs)("div",{className:"max-w-3xl mx-auto text-center mb-2",children:[(0,te.jsx)("h2",{className:"text-3xl md:text-4xl font-normal text-slate-900 mb-2 font-base44",children:_?`Choose your billing cycle for upgrading to ${y}`:`Select a billing cycle for your ${y} plan`}),(0,te.jsx)(Fl,{})]})]})}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("h1",{className:"text-3xl md:text-4xl font-normal text-slate-900 base44-font",children:"billing"===n?"Choose the plan that's right for you":"Usage"}),(0,te.jsx)(Fl,{}),"billing"!==n&&(0,te.jsx)("div",{className:"flex justify-center mt-4",children:(0,te.jsxs)("button",{onClick:()=>l("billing"),className:"text-sm text-orange-600 hover:text-orange-700 font-medium flex items-center",children:[(0,te.jsx)(Ze.A,{size:16,className:"mr-1"}),$?"View Billing":"See Pricing"]})})]})}),$?"billing"===n?(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsx)(ll,{}),(0,te.jsx)(Xn,{})]}):(0,te.jsx)("div",{className:"space-y-8"}):"billing"===n?(0,te.jsxs)("div",{className:"space-y-8",children:[F&&(0,te.jsx)(Ul,{type:"schedule-change",title:"Pending Subscription Change",message:`You have a subscription change to the ${B=null==t?void 0:t.subscription_schedule_tier,B?B.split("_").map((e=>e.charAt(0).toUpperCase()+e.slice(1))).join(" "):""} plan scheduled to take effect at the end of your current billing cycle.`,subMessage:'Note: To cancel your subscription, first cancel this change, then use "manage payments" to cancel.',buttonText:"Cancel Change",loadingText:"Cancelling...",onButtonClick:async()=>{try{I(!0),await Tn.cancelSchedule(),s({title:"Success",description:"Subscription schedule cancelled successfully"}),I(!1),setTimeout((()=>{window.location.reload()}),2e3)}catch(e){s({variant:"destructive",title:"Error",description:"Failed to cancel subscription schedule. Please try again later."}),I(!1)}},handleManageSubscription:R,isLoading:E}),!F&&z&&(0,te.jsx)(Ul,{type:"cancellation",title:"Subscription Cancellation Scheduled",message:`Your subscription will end on ${(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"})})(null==t?void 0:t.subscription_period_end)}. Until then, you have full access to all features.`,subMessage:"Want to keep your subscription? You can reactivate it with one click.",buttonText:"Manage Payments",loadingText:"Processing...",handleManageSubscription:R,isLoading:L}),f?(0,te.jsx)(Wl,{}):j?(0,te.jsx)(te.Fragment,{children:(0,te.jsx)(Il,{selectedPlanType:y,stats:p,onSubscribe:D,onBack:P,selectedEliteTier:w,isUpgradeFlow:_,onUpgrade:M})}):(0,te.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-3 lg:gap-4 max-w-full mx-auto px-4",children:["starter","builder","pro","elite"].map((e=>{const s=(e=>{if(null==p||!p.pricing)return null;const s=("yearly"===i?p.pricing.yearly:p.pricing.monthly)[e];return s?[e,s]:null})(e);return s?(0,te.jsx)("div",{className:"w-full "+("pro"===e?"lg:order-2 xl:order-2":"builder"===e?"lg:order-3 xl:order-3":"starter"===e?"lg:order-4 xl:order-4":"elite"===e?"lg:order-1 xl:order-1":""),children:(0,te.jsx)(Nl,{planType:e,plan:s[1],allPlans:U(),currentTier:(null==x?void 0:x.tier)||"",stats:p,usage:x,onSubscribe:D,onUpgrade:O,onManageSubscription:R,upgrading:!1,billingPeriod:i})},e):null}))}),!j&&(0,te.jsx)(Ml,{}),!f&&!j&&(0,te.jsx)("div",{className:"flex justify-end mt-2",children:(0,te.jsxs)("div",{className:"relative group",children:[(0,te.jsx)("button",{type:"button",className:"text-xs text-gray-400 hover:text-gray-600 underline-offset-4 hover:underline",onClick:()=>{var e;return null===(e=document.getElementById("coupon-form"))||void 0===e?void 0:e.classList.toggle("hidden")},children:"Have a coupon code?"}),(0,te.jsx)("div",{id:"coupon-form",className:"hidden absolute right-0 mt-2 bg-white shadow-lg rounded-md p-3 border border-gray-100 z-10 w-64",children:(0,te.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),c.trim()){u(!0);try{const e=await al.addCouponCode(c.trim());s({title:"Success",description:`${e.num_messages} credits added to your account!`}),d("")}catch(a){var t;s({variant:"destructive",title:"Error",description:(null===(t=a.response)||void 0===t?void 0:t.detail)||"Failed to apply coupon code. Please try again."})}finally{u(!1)}}},className:"flex gap-2 items-center",children:[(0,te.jsx)(Qn,{type:"text",placeholder:"Enter code",value:c,onChange:e=>d(e.target.value),className:"flex-1 text-xs h-7"}),(0,te.jsx)(sl,{type:"submit",disabled:m||!c.trim(),variant:"ghost",size:"sm",className:"text-xs h-7 px-2",children:m?"...":"Apply"})]})})]})}),(0,te.jsx)(Xn,{})]}):(0,te.jsx)("div",{className:"space-y-8"})]});var B},Vl=e=>{let{className:s,children:t,...a}=e;return(0,te.jsxs)(ra.Portal,{children:[(0,te.jsx)(ra.Overlay,{className:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),(0,te.jsx)(ra.Content,{className:ns("fixed left-[50%] top-[50%] z-50 w-full translate-x-[-50%] translate-y-[-50%] bg-background shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-[16px]","max-w-[90vw] h-[90vh] overflow-hidden",s),...a,children:t})]})},Yl=e=>{let{isOpen:s,onClose:t,onSubscriptionSuccess:a}=e;return(0,te.jsx)(Bn,{open:s,onOpenChange:t,children:(0,te.jsx)(Vl,{className:"bg-white",children:(0,te.jsxs)("div",{className:"h-full flex flex-col",children:[(0,te.jsx)("div",{className:"flex-shrink-0 flex items-center justify-end px-6 pt-4",children:(0,te.jsxs)("button",{onClick:t,className:"h-8 w-8 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 flex items-center justify-center",children:[(0,te.jsx)(Ds.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{className:"sr-only",children:"Close"})]})}),(0,te.jsx)("div",{className:"flex-1 overflow-auto",children:(0,te.jsx)(ql,{})})]})})})};function Hl(e){let{currentUsage:s,stats:t,className:a=""}=e;const{toast:r}=Un(),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),{app:x}=vs(),{user:h}=ne(),{nextPlan:p,billingPeriod:g,isLoading:f,error:v}=In(s,t),j=(null==s?void 0:s.tier)||null,b=!j||"free"===j.toLowerCase(),y=kn(j),N=_n(j),w=b&&(null==s?void 0:s.daily_usage)>=(null==s?void 0:s.daily_limit),k=(()=>{if(!N||null==t||!t.pricing)return null;return("yearly"===y?t.pricing.yearly:t.pricing.monthly)[N]||null})(),_=(e,t)=>{try{var a;const r={user_id:(null==h?void 0:h.id)||null,app_id:(null==x?void 0:x.id)||null,conversation_id:(null==x||null===(a=x.conversation)||void 0===a?void 0:a.id)||null},n={cta:e,origin:"chat out of credits message",target_route:b||!N?"/billing":"direct_upgrade",current_tier:j,next_tier:N,billing_period:y,upgrade_type:t,daily_usage:(null==s?void 0:s.daily_usage)||null,daily_limit:(null==s?void 0:s.daily_limit)||null,monthly_usage:(null==s?void 0:s.monthly_usage)||null,monthly_limit:(null==s?void 0:s.monthly_limit)||null,is_daily_limit_hit:w};Se("User clicked upgrade",{...r,...n}),Fe(r,n)}catch(v){}},S=()=>{u(!0);const e=b?"billing_dialog":"direct_upgrade",s=C();_(s,e),b?(d(!0),o(!0)):(async()=>{if(null!=k&&k.id){l(!0);try{var e;const s=null===(e=(await Tn.updateSubscription(k.id)).subscription)||void 0===e?void 0:e.is_downgrade;r({title:"Subscription Updated",description:s?"Your subscription has been scheduled to downgrade at the end of your billing cycle.":"Your subscription has been upgraded successfully. Changes will be reflected shortly."}),setTimeout((()=>{window.location.reload()}),2e3)}catch(v){var s;r({variant:"destructive",title:"Error",description:(null===(s=v.response)||void 0===s?void 0:s.detail)||"Failed to update subscription. Please try again later."})}finally{l(!1),u(!1)}}})()},C=()=>{if(b)return c?"Opening...":"View All Plans";if(!N)return"View All Plans";return`Upgrade to ${An(N)} ${y.charAt(0).toUpperCase()+y.slice(1)}`},A=()=>Sn(p),E=()=>{if(null==p||!p.unit_amount)return{price:"0",billingText:"billed monthly"};const e="yearly"===g;return{price:e?(p.unit_amount/100/12).toFixed(0):(p.unit_amount/100).toFixed(0),billingText:e?"billed yearly":"billed monthly"}};return f?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:`py-2 px-2 ${a} align-center w-full`,children:(0,te.jsx)("div",{className:"min-h-[100px] font-base44 rounded-[16px]",children:(0,te.jsxs)("div",{className:"p-2 text-center",children:[(0,te.jsx)("div",{className:"mb-2",children:(0,te.jsx)("div",{className:"font-light text-gray-700 mb-4 leading-relaxed",children:(0,te.jsxs)("div",{className:"animate-pulse",children:[(0,te.jsx)("div",{className:"h-4 bg-gray-200 rounded mb-2 w-3/4 mx-auto"}),(0,te.jsx)("div",{className:"h-3 bg-gray-200 rounded w-1/2 mx-auto"})]})})}),(0,te.jsx)("div",{className:"",children:(0,te.jsx)("div",{className:"animate-pulse",children:(0,te.jsx)("div",{className:"w-full h-[32px] bg-gray-200 rounded-[10px]"})})})]})})}),(0,te.jsx)(Yl,{isOpen:i,onClose:()=>{o(!1),d(!1),u(!1)},onSubscriptionSuccess:()=>{o(!1),d(!1),u(!1),setTimeout((()=>{window.location.reload()}),1e3)}})]}):v?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:`py-6 px-6 ${a} font-base44`,children:(0,te.jsxs)("div",{className:"max-w-lg",children:[(0,te.jsx)("div",{className:"mb-2",children:(0,te.jsx)("p",{className:"text-md font-light text-gray-700 mb-6 leading-relaxed",children:w?(0,te.jsxs)(te.Fragment,{children:["Looks like you've reached your daily credit limit. Your credits will reset tomorrow, or"," ",(0,te.jsx)("button",{onClick:()=>{_("upgrade now","billing_dialog"),o(!0)},className:"text-orange-600 underline hover:text-orange-700 bg-transparent border-none cursor-pointer",children:"upgrade now"})," ","for more credits immediately."]}):(0,te.jsxs)(te.Fragment,{children:["Looks like you've used all your credits for this month."," ",(0,te.jsx)("button",{onClick:()=>{_("See all plans","billing_dialog"),o(!0)},className:"text-orange-600 underline hover:text-orange-700 bg-transparent border-none cursor-pointer",children:"See all plans"}),"."]})})}),b?(0,te.jsx)("button",{onClick:S,disabled:c||m,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 bg-orange-500 text-white text-md font-medium rounded-lg hover:bg-orange-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:C()}):(0,te.jsx)("button",{onClick:S,disabled:n||m,className:"w-full inline-flex items-center justify-center gap-2 px-4 py-3 bg-orange-500 text-white text-md font-medium rounded-lg hover:bg-orange-400 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Upgrading...":C()})]})}),(0,te.jsx)(Yl,{isOpen:i,onClose:()=>{o(!1),d(!1),u(!1)},onSubscriptionSuccess:()=>{o(!1),d(!1),u(!1),setTimeout((()=>{window.location.reload()}),1e3)}})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:`py-2 px-2 ${a} align-center w-full`,children:(0,te.jsx)("div",{className:" min-h-[100px] font-base44  rounded-[16px]",children:(0,te.jsxs)("div",{className:"p-2 text-center",children:[(0,te.jsx)("div",{className:"mb-2",children:b?(0,te.jsx)("div",{className:"font-light text-gray-700 mb-4 leading-relaxed",children:w?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"text-black text-[16px]",children:"You're out of daily credits on your Free plan"}),(0,te.jsx)("div",{className:"text-[14px]",children:"Upgrade to a Premium plan and unlock instant credits and more power for your app"})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"text-black text-[16px]",children:"You're out of monthly credits on your Free plan"}),(0,te.jsx)("div",{className:"text-[14px]",children:"Upgrade to a Premium plan and unlock instant credits and more power for your app"})]})}):N?(0,te.jsxs)("p",{className:"text-md font-light text-gray-700 mb-4 leading-relaxed",children:[(0,te.jsx)("span",{className:"font-bold text-md text-black",children:"You've hit this month's limit"}),(0,te.jsx)("br",{}),(0,te.jsxs)("span",{children:["Out of credits but still full of ideas? Upgrade to unlock more power for your app ",(0,te.jsx)("button",{onClick:()=>{_("Compare all plans","billing_dialog"),o(!0)},className:"text-indigo-500 hover:text-indigo-600 bg-transparent border-none cursor-pointer",children:"Compare all plans"})]})]}):(0,te.jsxs)("div",{className:"font-light text-gray-700 mb-4 leading-relaxed",children:[(0,te.jsx)("div",{className:"text-black text-[16px]",children:"You've hit the limit on our highest plan"}),(0,te.jsx)("div",{className:"text-[14px]",children:"Let's take it further - contact our sales team to create a custom plan for you"})]})}),b&&(0,te.jsx)("div",{className:"",children:(0,te.jsx)("button",{onClick:S,disabled:c||m,className:"font-base44 w-full inline-flex items-center justify-center px-6 h-[32px] bg-orange-500 text-white text-[16px] font-medium rounded-[10px] hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:C()})}),!b&&!N&&(0,te.jsx)("div",{className:"",children:(0,te.jsx)("a",{href:"https://base44.com/enterprise",target:"_blank",rel:"noopener noreferrer",onClick:()=>_("Contact Support","contact_support"),className:"font-base44 w-full inline-flex items-center justify-center px-6 h-[32px] bg-orange-500 text-white text-[16px] font-medium rounded-[10px] hover:bg-orange-600",children:"Contact Support"})}),!b&&N&&(0,te.jsxs)("div",{className:"bg-white/50 rounded-[12px] p-4 font-base44",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,te.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 font-base44",children:[An(N)," Plan"]}),(0,te.jsxs)("div",{className:"flex items-center gap-2 bg-white p-0.5 px-4 rounded-full",children:[(0,te.jsxs)("div",{className:"text-lg font-semibold text-slate-900",children:["$",E().price]}),(0,te.jsx)("div",{className:"text-xs text-slate-500 font-base44",children:E().billingText})]})]}),(0,te.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,te.jsxs)("div",{className:"text-sm text-slate-600 flex",children:[(0,te.jsx)("span",{className:"text-orange-500 font-semibold min-w-[40px]",children:Cn(A().messageCredits)})," Monthly credits"]}),(0,te.jsxs)("div",{className:"text-sm text-slate-600 flex",children:[(0,te.jsx)("span",{className:"text-orange-500 font-semibold min-w-[40px]",children:Cn(A().integrationCredits)})," Integration credits"]})]}),(0,te.jsx)("div",{className:"mb-2 cursor-pointer",children:b?(0,te.jsx)("button",{onClick:S,disabled:c||m,className:"font-base44 w-full inline-flex items-center justify-center px-6 h-[32px] bg-orange-500 text-white text-[16px] font-medium rounded-[10px] hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:C()}):(0,te.jsx)("button",{onClick:S,disabled:n||m,className:"font-base44 cursor-pointer w-full inline-flex items-center justify-center px-6 h-[32px] bg-orange-500 text-white text-[16px] font-medium rounded-[10px] hover:bg-orange-600 disabled:opacity-50 disabled:cursor-not-allowed",children:n?"Upgrading...":C()})}),(0,te.jsx)("p",{className:"text-center text-sm font-thin text-slate-500",children:b?"View all available plans and pricing":"Clicking Upgrade will confirm your payment"})]})]})})}),(0,te.jsx)(Yl,{isOpen:i,onClose:()=>{o(!1),d(!1),u(!1)},onSubscriptionSuccess:()=>{o(!1),d(!1),u(!1),setTimeout((()=>{window.location.reload()}),1e3)}})]})}function Gl(e){let{endDate:s,isDaily:t=!1}=e;const[a,r]=(0,Y.useState)("");return(0,Y.useEffect)((()=>{if(!s)return;const e=()=>{const e=new Date,t=new Date(s+"T00:00:00").getTime()-e.getTime();if(t>0){const e=Math.floor(t/864e5),s=Math.floor(t%864e5/36e5),a=Math.floor(t%36e5/6e4);r(e>0?`${e}d : ${s}h`:s>0?`${s}h : ${a}m`:`${a}m`)}else r("Expired")};e();const t=setInterval(e,6e4);return()=>clearInterval(t)}),[s]),(0,te.jsx)("span",{className:"flex text-md text-white justify-center",children:t?" ":`${a} until credits renew`})}const Jl=function(e){var s;let{chat:t,addMessage:a,undoMessage:r,status:n,onStop:l,suggestions:i=null,isDisabled:o=!1,isOutOfCredits:c=!1,currentUsage:d=null,billingStats:m=null,customButtomRight:u=null,customButtomLeft:x=null,customMiddleComponent:h=null,placeholder:p="What would you like to change?",isDiscussionMode:g=!1,isVisualEditMode:f=!1}=e;const{user:v}=ne(),[j,b]=(0,Y.useState)(""),[y,N]=(0,Y.useState)([]),w=(0,Y.useRef)(null),[k,_]=(0,Y.useState)(!1),[S,C]=(0,Y.useState)(!0),[A,E]=(0,Y.useState)(!1),I=null===(s=v.platform_role)||void 0===s?void 0:s.includes("admin"),L=(!(null!=d&&d.tier)||"free"===(null==d?void 0:d.tier.toLowerCase()))&&(null==d?void 0:d.daily_usage)>=(null==d?void 0:d.daily_limit),T=()=>{w.current&&S&&(w.current.scrollTop=w.current.scrollHeight)},$=()=>{const e=(()=>{if(!w.current)return!0;const e=w.current;return e.scrollHeight-e.scrollTop-e.clientHeight<=100})();_(!e),C(e),E(!0),clearTimeout($.timeout),$.timeout=setTimeout((()=>{E(!1)}),1500)};(0,Y.useEffect)((()=>{new URLSearchParams(window.location.search).get("msgId")||k||T()}),[null==t?void 0:t.messages,k]),(0,Y.useEffect)((()=>{k||T()}),[n,k]),(0,Y.useEffect)((()=>{if(!w.current)return;const e=new MutationObserver((()=>{k||T()}));e.observe(w.current,{childList:!0,subtree:!0,characterData:!0});const s=w.current;return s.addEventListener("scroll",$),()=>{e.disconnect(),s.removeEventListener("scroll",$)}}),[k]);const D=(0,Y.useMemo)((()=>(null==t?void 0:t.messages.filter((e=>!0!==e.hidden)))||[]),[(null==t?void 0:t.messages)||[]]);return t?(0,te.jsxs)("div",{className:"flex flex-col h-full w-full bg-[#F8FAFC] relative p-2",children:[(0,te.jsx)("div",{className:""}),(0,te.jsx)("div",{ref:w,className:"flex-grow overflow-y-auto py-2 space-y-2 pb-4 scrollbar-auto-hide relative z-10 "+(A?"scrollbar-visible":""),onMouseEnter:()=>{E(!0)},onMouseLeave:()=>{clearTimeout($.timeout),setTimeout((()=>{E(!1)}),300)},children:(0,te.jsx)(un,{messages:D,undoMessage:r?e=>{const s=t.messages.find((s=>s.id===e));"user"===s.role&&(r(e),b(s.content))}:null})}),(0,te.jsxs)("div",{className:"relative z-10",children:[(0,te.jsx)(fn,{status:n,messages:D}),h||("ready"===n.state&&i?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"text-[10px] text-gray-400 text-center mb-1",children:"Suggestions"}),(0,te.jsx)("div",{className:"flex justify-center gap-3 px-4 py-2 border-t border-gray-100",children:[i.suggestion_1,i.suggestion_2,i.suggestion_3].map(((e,s)=>(0,te.jsx)("span",{className:"text-xs text-gray-400 hover:text-gray-600 cursor-pointer transition-colors duration-200 hover:underline px-2 py-1 rounded-full hover:bg-gray-50",onClick:()=>(e=>{b(e.prompt)})(e),children:e.title},s)))})]}):null)]}),(0,te.jsxs)("div",{className:"rounded-[12px] relative z-10 "+(c?"bg-[linear-gradient(0deg,rgba(238,86,225,0.1)_0%,rgba(238,86,225,0.1)_52%,rgba(249,115,22,0.1)_79%,rgba(239,198,168,0.1)_100%)]":""),children:[c&&(0,te.jsx)("div",{className:"flex justify-center",children:(0,te.jsx)(Hl,{currentUsage:d,stats:m})}),(0,te.jsxs)("div",{className:"relative flex-shrink-0",children:[c&&(null==d?void 0:d.current_credit_period_end_date)&&(0,te.jsx)("div",{className:"flex justify-center -mb-1",children:(0,te.jsx)("div",{className:"bg-[#C7BECF] rounded-t-[16px] p-2 px-4 w-full text-center",children:(0,te.jsx)(Gl,{endDate:d.next_period_start_date,isDaily:L})})}),(0,te.jsx)("div",{className:"w-full "+(c?"bg-[#C7BECF] border border-[#C7BECF] rounded-b-[16px]":""),children:(0,te.jsx)("div",{className:"join w-full",children:(0,te.jsx)(Ps,{value:j,onValueChange:b,files:y,onFilesChange:N,onSend:async()=>{if(j.trim()&&"processing"!==n.state)try{const e={content:j,file_urls:y};b(""),N([]),C(!0),_(!1),await a(e)}catch(e){Ga.toast.error("Failed to send message")}},onStop:l,placeholder:p,disabled:"processing"===n.state||o,customButtomRight:u,customButtomLeft:x,isProcessing:"processing"===n.state,isDiscussionMode:g,isVisualEditMode:f,isOutOfCredits:c})})})]}),I&&(0,te.jsx)("div",{className:"text-xs text-gray-400 text-center opacity-0 hover:opacity-100 transition-opacity duration-200 absolute bottom-0 right-0",children:(0,te.jsxs)("a",{onClick:()=>{const e=t.messages.slice(-8).map((e=>`${e.role}:\n${e.content}`)).join("\n\n");navigator.clipboard.writeText(e)},className:"hover:underline inline-flex items-center gap-1",children:[(0,te.jsx)(Ha.A,{className:"w-3 h-3"}),"Copy"]})})]})]}):(0,te.jsx)("div",{className:"alert alert-warning m-4 text-sm",children:"No chat found"})};var Zl=t(50253);function Kl(e){let{isVisualEditMode:s,toggleVisualEditMode:t,isSaving:a}=e;return(0,te.jsxs)("button",{onClick:t,className:"flex items-center gap-1 px-2 py-1 rounded-md text-xs "+(s?"bg-blue-50 text-blue-600 hover:bg-blue-100":"text-gray-600 bg-gray-100 hover:bg-gray-200"),disabled:a,children:[(0,te.jsx)(Zl.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Visual Edit"})]})}var Xl=t(17119),Ql=t.t(Xl,2);const ei="palette",si="custom",ti="bg",ai="text",ri="#000000",ni=[{name:"Slate",prefix:"slate"},{name:"Gray",prefix:"gray"},{name:"Zinc",prefix:"zinc"},{name:"Neutral",prefix:"neutral"},{name:"Stone",prefix:"stone"},{name:"Red",prefix:"red"},{name:"Orange",prefix:"orange"},{name:"Amber",prefix:"amber"},{name:"Yellow",prefix:"yellow"},{name:"Lime",prefix:"lime"},{name:"Green",prefix:"green"},{name:"Emerald",prefix:"emerald"},{name:"Teal",prefix:"teal"},{name:"Cyan",prefix:"cyan"},{name:"Sky",prefix:"sky"},{name:"Blue",prefix:"blue"},{name:"Indigo",prefix:"indigo"},{name:"Violet",prefix:"violet"},{name:"Purple",prefix:"purple"},{name:"Fuchsia",prefix:"fuchsia"},{name:"Pink",prefix:"pink"},{name:"Rose",prefix:"rose"}],li=[50,100,200,300,400,500,600,700,800,900,950],ii=e=>e<500?"text-gray-900":"text-white",oi=e=>{let{color:s}=e;if(!s)return(0,te.jsx)("span",{className:"text-sm text-gray-500",children:"None"});const t=s.type===si?{backgroundColor:s.value,border:"1px solid rgba(0,0,0,0.1)"}:null,a=s.type===ei?`bg-${s.name}-${s.shade} border border-black/10`:"";return(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("div",{className:`h-6 w-6 rounded-sm mr-2 ${a}`,style:t}),(0,te.jsx)("span",{className:"text-sm text-gray-700",children:s.type===ei?`${s.name.charAt(0).toUpperCase()+s.name.slice(1)} ${s.shade}`:s.value})]})},ci=e=>{let{mode:s,onModeChange:t}=e;return(0,te.jsx)("div",{className:"w-full",children:(0,te.jsxs)("div",{className:"flex h-8 items-center rounded-md bg-gray-100 p-0.5",children:[(0,te.jsx)("button",{type:"button",className:"flex-1 inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 "+(s===ei?"bg-white text-slate-950 shadow-sm":"text-slate-500 hover:text-slate-900"),onClick:()=>t(ei),children:"Palettes"}),(0,te.jsx)("button",{type:"button",className:"flex-1  inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1 text-sm font-medium ring-offset-white transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-slate-950 focus-visible:ring-offset-2 "+(s===si?"bg-white text-slate-950 shadow-sm":"text-slate-500 hover:text-slate-900"),onClick:()=>t(si),children:"Custom"})]})})},di=e=>{let{color:s,onChange:t}=e;const[a,r]=(0,Y.useState)(100),[n,l]=(0,Y.useState)(50),[i,o]=(0,Y.useState)(0),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),x=(0,Y.useRef)(null),h=(0,Y.useRef)(null);(0,Y.useEffect)((()=>{if(s&&s.startsWith("#")&&7===s.length){const[e,t,a]=(e=>{if(!e||!e.startsWith("#")||7!==e.length)return[0,100,50];const s=parseInt(e.slice(1,3),16)/255,t=parseInt(e.slice(3,5),16)/255,a=parseInt(e.slice(5,7),16)/255,r=Math.max(s,t,a),n=Math.min(s,t,a);let l,i,o=(r+n)/2;if(r===n)l=i=0;else{const e=r-n;switch(i=o>.5?e/(2-r-n):e/(r+n),r){case s:l=(t-a)/e+(t<a?6:0);break;case t:l=(a-s)/e+2;break;case a:l=(s-t)/e+4;break;default:l=0}l/=6}return l=Math.max(0,Math.min(360,Math.round(360*l))),i=Math.max(0,Math.min(100,Math.round(100*i))),o=Math.max(0,Math.min(100,Math.round(100*o))),[l,i,o]})(s);o(e),r(t),l(a)}else o(0),r(100),l(50)}),[s]);const p=(e,s,t)=>{e=Math.max(0,Math.min(360,e))/360,s=Math.max(0,Math.min(100,s))/100;const a=(e,s,t)=>(t<0&&(t+=1),t>1&&(t-=1),t<1/6?e+6*(s-e)*t:t<.5?s:t<2/3?e+(s-e)*(2/3-t)*6:e),r=(t=Math.max(0,Math.min(100,t))/100)<.5?t*(1+s):t+s-t*s,n=2*t-r,l=a(n,r,e+1/3),i=a(n,r,e),o=a(n,r,e-1/3),c=e=>{const s=Math.max(0,Math.min(255,Math.round(255*e))).toString(16);return 1===s.length?"0"+s:s};return`#${c(l)}${c(i)}${c(o)}`},g=(e,s)=>{if(!x.current)return;const o=x.current.getBoundingClientRect(),c=Math.max(0,Math.min(e-o.left,o.width)),d=Math.max(0,Math.min(s-o.top,o.height)),m=Math.round(c/o.width*100),u=Math.round(100-d/o.height*100),[h,g,f]=((e,s,t)=>{const a=(t/=100)*(2-(s/=100))/2,r=0!==a&&1!==a?(t-a)/Math.min(a,1-a):0;return[e,Math.round(100*r),Math.round(100*a)]})(i,m,u);if(Math.abs(g-a)>.5||Math.abs(f-n)>.5){r(g),l(f);const e=p(h,g,f);t(e)}},f=e=>{if(!h.current)return;const s=h.current.getBoundingClientRect(),r=Math.max(0,Math.min(e-s.left,s.width-1)),l=Math.max(0,Math.min(360,r/(s.width-1)*360));if(Math.abs(l-i)>1){o(l);const e=p(l,a,n);t(e)}};(0,Y.useEffect)((()=>{const e=e=>{e.preventDefault(),c?g(e.clientX,e.clientY):m&&f(e.clientX)},s=e=>{e.preventDefault(),d(!1),u(!1)};return(c||m)&&(document.addEventListener("mousemove",e,{passive:!1}),document.addEventListener("mouseup",s,{passive:!1}),document.body.style.userSelect="none",document.body.style.cursor=c?"crosshair":"pointer"),()=>{document.removeEventListener("mousemove",e),document.removeEventListener("mouseup",s),document.body.style.userSelect="",document.body.style.cursor=""}}),[c,m,i,a,n]);const[v,j,b]=((e,s,t)=>{const a=(t/=100)+(s/=100)*Math.min(t,1-t),r=0===a?0:2*(1-t/a);return[e,Math.round(100*r),Math.round(100*a)]})(i,a,n);return(0,te.jsxs)("div",{className:"p-4 space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)("div",{className:"w-12 h-12 rounded-lg border border-gray-200 shadow-sm",style:{backgroundColor:s||"#000000"}}),(0,te.jsx)("div",{className:"flex-1",children:(0,te.jsx)("input",{type:"text",value:s||"",onChange:e=>t(e.target.value),className:"w-full px-3 py-2 text-sm border border-gray-200 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"#000000"})})]}),(0,te.jsx)("div",{className:"relative",children:(0,te.jsx)("div",{ref:x,className:"w-full h-32 rounded-md border border-gray-200 relative overflow-hidden select-none "+(c?"cursor-grabbing":"cursor-crosshair"),style:{background:`linear-gradient(to top, #000000, transparent), linear-gradient(to right, #ffffff, hsl(${i}, 100%, 50%))`},onMouseDown:e=>{e.preventDefault(),"mousedown"===e.type&&d(!0),g(e.clientX,e.clientY)},children:(0,te.jsx)("div",{className:"absolute w-3 h-3 border-2 border-white rounded-full shadow-md transform -translate-x-1/2 -translate-y-1/2 pointer-events-none transition-transform "+(c?"scale-110":"scale-100"),style:{left:`${Math.max(0,Math.min(100,j))}%`,top:`${Math.max(0,Math.min(100,100-b))}%`,boxShadow:"0 0 0 1px rgba(0,0,0,0.3), 0 2px 4px rgba(0,0,0,0.2)"}})})}),(0,te.jsx)("div",{className:"relative",children:(0,te.jsx)("div",{ref:h,className:"w-full h-4 rounded-md border border-gray-200 relative overflow-hidden select-none "+(m?"cursor-grabbing":"cursor-pointer"),style:{background:"linear-gradient(to right, #ff0000 0%, #ffff00 17%, #00ff00 33%, #00ffff 50%, #0000ff 67%, #ff00ff 83%, #ff0000 100%)"},onMouseDown:e=>{e.preventDefault(),"mousedown"===e.type&&u(!0),f(e.clientX)},children:(0,te.jsx)("div",{className:"absolute w-4 h-6 border-2 border-white rounded-sm shadow-md transform -translate-x-1/2 -translate-y-1/2 pointer-events-none top-1/2 transition-transform "+(m?"scale-110":"scale-100"),style:{left:`${Math.max(0,Math.min(100,i/360*100))}%`,boxShadow:"0 0 0 1px rgba(0,0,0,0.3), 0 2px 4px rgba(0,0,0,0.2)"}})})})]})},mi=e=>{let{selectedColorInfo:s,onColorSelect:t}=e;return(0,te.jsx)("div",{className:"overflow-y-auto max-h-64 p-2",children:ni.map((e=>(0,te.jsxs)("div",{className:"mb-3",children:[(0,te.jsx)("div",{className:"text-xs font-medium text-gray-900 mb-1",children:e.name}),(0,te.jsx)("div",{className:"flex flex-wrap gap-2",children:li.map((a=>{const r=(null==s?void 0:s.name)===e.prefix&&(null==s?void 0:s.shade)===a;return(0,te.jsx)("button",{type:"button",className:`\n                  aspect-square border border-black/10 rounded-sm flex items-center hover:ring-2 hover:ring-offset-1 hover:ring-blue-500 justify-center w-6 h-6 bg-${e.prefix}-${a} \n                  ${ii(a)} ${r?"ring-2 ring-offset-1 ring-blue-500":""}\n                `,onClick:()=>t(e.prefix,a),children:r&&(0,te.jsx)(mt.A,{className:"h-3 w-3"})},a)}))})]},e.prefix)))})};const ui=function(e){let{label:s,selectedColor:t,onChange:a}=e;const[r,n]=(0,Y.useState)(!1),[l,i]=(0,Y.useState)(ei),[o,c]=(0,Y.useState)(ri),[d,m]=(0,Y.useState)(null),u=(0,Y.useRef)(null),x=(0,Y.useRef)(null),[h,p]=(0,Y.useState)({top:0,left:0,width:0}),g=s.toLowerCase().includes("background")?ti:ai;(0,Y.useEffect)((()=>{const e=(e=>{if(!e)return null;const s=e.match(/^(bg|text)-([a-z]+)-(\d+)$/);if(s)return{type:ei,name:s[2],shade:parseInt(s[3])};const t=e.match(/^(bg|text)-\[(.+)\]$/);return t?{type:si,value:t[2]}:null})(t);if(!e)return m(null),void c(ri);e.type===si?(i(si),c(e.value),m(null)):(i(ei),m({name:e.name,shade:e.shade}),c(ri))}),[t]),(0,Y.useEffect)((()=>{if(r&&x.current){const e=x.current.getBoundingClientRect();p({top:e.bottom+window.scrollY+4,left:e.left+window.scrollX,width:e.width})}}),[r]),(0,Y.useEffect)((()=>{const e=e=>{const s=document.getElementById("color-dropdown");!u.current||u.current.contains(e.target)||s&&s.contains(e.target)||n(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[]);const f=()=>{m(null),c(ri),a(null),n(!1)};return(0,te.jsxs)("div",{ref:u,className:"relative",children:[(0,te.jsx)("div",{className:"flex items-start justify-between gap-4",children:(0,te.jsx)("div",{className:"flex-1",children:(0,te.jsxs)("div",{className:"flex gap-4",children:[(0,te.jsx)("label",{className:"text-sm font-light text-gray-700 min-w-[100px] pt-2",children:s}),(0,te.jsxs)("button",{ref:x,type:"button",onClick:()=>n(!r),className:"flex-1 flex items-center bg-gray-100 justify-between px-2 py-2 rounded-md  hover:bg-gray-200 focus:outline-none focus:ring-1 focus:ring-gray-300",children:[oi({color:d?{type:ei,name:d.name,shade:d.shade}:o!==ri?{type:si,value:o}:null}),r?(0,te.jsx)(dt.A,{className:"h-4 w-4 text-gray-500"}):(0,te.jsx)(ct.A,{className:"h-4 w-4 text-gray-500"})]})]})})}),r&&(0,Xl.createPortal)((0,te.jsx)("div",{id:"color-dropdown",className:"fixed z-50 bg-white shadow-lg rounded-[8px] border border-gray-200 max-w-[250px]",style:{top:`${h.top}px`,left:`${h.left}px`,width:`${h.width}px`,maxHeight:"400px"},children:(0,te.jsxs)("div",{className:"flex flex-col h-full",children:[(0,te.jsx)("div",{className:"p-2",children:(0,te.jsx)(ci,{mode:l,onModeChange:i})}),(0,te.jsx)("div",{className:"flex-1 overflow-auto",children:l===ei?(0,te.jsx)(mi,{selectedColorInfo:d,onColorSelect:(e,s)=>{m({name:e,shade:s}),a(`${g}-${e}-${s}`),n(!1)}}):(0,te.jsx)(di,{color:o,onChange:e=>{c(e),a(`${g}-[${e}]`)}})}),(0,te.jsx)("div",{className:"border-t border-gray-200",children:(0,te.jsxs)("div",{className:"flex items-center justify-between p-2 hover:bg-gray-50 cursor-pointer",onClick:f,children:[(0,te.jsx)("span",{className:"text-sm font-light text-gray-700",children:"Clear Color"}),(0,te.jsx)("button",{className:"w-6 h-6 rounded-sm border border-gray-300 relative hover:bg-gray-50",onClick:f,children:(0,te.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,te.jsx)("div",{className:"w-[2px] h-[120%] bg-red-500 rotate-45 transform origin-center"})})})]})})]})}),document.body)]})};var xi=t(72995),hi=t(14703),pi=t(45462),gi=t(56404),fi=t(25146),vi=t(80369);const ji=[0,1,2,3,4,5,6,8,10,12,16,20,24,32,40,48,64];const bi=function(e){let{label:s,spacing:t,onChange:a}=e;const r=s.toLowerCase().startsWith("m")?"m":"p",[n,l]=(0,Y.useState)({all:0,t:0,r:0,b:0,l:0,x:0,y:0}),[i,o]=(0,Y.useState)("axes"),[c,d]=(0,Y.useState)(!1),m=(0,Y.useRef)(null);(0,Y.useEffect)((()=>{const e={all:0,t:0,r:0,b:0,l:0,x:0,y:0};let s=!1,a=!1,n=!1,i=!1;const c=t||{},u=e=>{if(!e)return 0;if("mx-auto"===e)return s=!0,0;const t=e.match(new RegExp(`^${r}[ytrlbx]?-(\\d+)$`));if(!t)return 0;const a=parseInt(t[1]),n=ji.indexOf(a);return-1!==n?n:0};c.all&&(e.all=u(c.all),e.t=e.all,e.r=e.all,e.b=e.all,e.l=e.all,a=!0),"mx-auto"===c.x?(s=!0,n=!0):(c.x&&(e.x=u(c.x),e.l=e.x,e.r=e.x,n=!0),c.y&&(e.y=u(c.y),e.t=e.y,e.b=e.y,n=!0)),c.t&&(e.t=u(c.t),i=!0),c.r&&(e.r=u(c.r),i=!0),c.b&&(e.b=u(c.b),i=!0),c.l&&(e.l=u(c.l),i=!0),l(e),d(s);let x=m.current;x||(x=n?"axes":i?"sides":a?"all":"axes"),o(x)}),[t,r]);const u=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:c;const n={};"all"===s?n.all=`${r}-${ji[e.all]}`:"axes"===s?(t&&"m"===r?n.x="mx-auto":e.x>0&&(n.x=`${r}x-${ji[e.x]}`),e.y>0&&(n.y=`${r}y-${ji[e.y]}`)):(e.t>0&&(n.t=`${r}t-${ji[e.t]}`),e.r>0&&(n.r=`${r}r-${ji[e.r]}`),e.b>0&&(n.b=`${r}b-${ji[e.b]}`),e.l>0&&(n.l=`${r}l-${ji[e.l]}`)),a(n)},x=(e,s)=>{const t=Math.max(0,Math.min(s,ji.length-1)),a={...n};a[e]=t,"all"===i?(a.t=t,a.r=t,a.b=t,a.l=t,a.x=t,a.y=t):"axes"===i&&("x"===e?(a.l=t,a.r=t):"y"===e&&(a.t=t,a.b=t)),t>0&&"x"===e&&c&&d(!1),l(a),u(a,i,"x"!==e&&c)},h=()=>{const e=!c;if(d(e),e){const e={...n,x:0,l:0,r:0};l(e),u(e,"axes",!0)}else u(n,i,!1)},p=(e,s)=>{const t=n[e];x(e,t+(s?1:-1))},g=e=>{let{label:s,icon:t,value:a,onChange:r}=e;return(0,te.jsx)("div",{className:"flex items-center space-x-2",children:(0,te.jsx)("div",{className:"flex-1 flex items-center",children:(0,te.jsx)("div",{className:"relative flex-1 w-full min-w-[90px] max-w-[140px]",children:(0,te.jsxs)("div",{className:"relative w-full",children:[(0,te.jsx)("div",{className:"absolute left-2 top-1/2 -translate-y-1/2",children:(0,te.jsx)("div",{className:"scale-75",children:t})}),(0,te.jsx)("input",{type:"text",value:ji[a],onChange:e=>{const s=parseInt(e.target.value),t=ji.indexOf(s);-1!==t&&r(t)},className:"w-full pl-9 pr-3 py-1.5 rounded-md bg-gray-100 hover:bg-gray-200 hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-gray-500 focus:ring-1 focus:ring-gray-300 text-sm"}),(0,te.jsxs)("div",{className:"absolute inset-y-0 right-0 flex flex-col pr-1",children:[(0,te.jsx)("button",{type:"button",onClick:()=>p(s.toLowerCase(),!0),disabled:a>=ji.length-1,className:"flex-1 px-1 flex items-center justify-center hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-gray-500",children:(0,te.jsx)(dt.A,{className:"h-3 w-3"})}),(0,te.jsx)("button",{type:"button",onClick:()=>p(s.toLowerCase(),!1),disabled:a<=0,className:"flex-1 px-1 flex items-center justify-center hover:text-indigo-600 disabled:opacity-30 disabled:hover:text-gray-500",children:(0,te.jsx)(ct.A,{className:"h-3 w-3"})})]})]})})})})};return(0,te.jsx)("div",{className:"space-y-3",children:(0,te.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,te.jsx)("div",{className:"flex-1",children:(0,te.jsxs)("div",{className:"flex gap-4",children:[(0,te.jsx)("label",{className:"text-xs font-light text-gray-700 min-w-[100px] pt-2",children:s}),(0,te.jsxs)("div",{className:"flex-1 space-y-3",children:["axes"===i&&"m"===r&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"flex items-center space-x-2",children:(0,te.jsx)("div",{className:"flex items-center gap-2 w-full",children:c?(0,te.jsxs)("button",{type:"button",onClick:h,className:"flex-1 flex items-center justify-center gap-1 px-3 py-2 bg-indigo-50 rounded-md min-w-[90px] max-w-[140px] w-full",children:[(0,te.jsx)(xi.A,{className:"h-4 w-4 text-indigo-500"}),(0,te.jsx)("span",{className:"text-xs text-indigo-700",children:"mx-auto"})]}):(0,te.jsx)(g,{label:"x",icon:(0,te.jsx)(gi.A,{className:"h-4 w-4 text-gray-500"}),value:n.x,onChange:e=>x("x",e)})})}),(0,te.jsx)(g,{label:"y",icon:(0,te.jsx)(fi.A,{className:"h-4 w-4 text-gray-500"}),value:n.y,onChange:e=>x("y",e)})]}),"axes"===i&&"m"!==r&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(g,{label:"x",icon:(0,te.jsx)(Ht.A,{className:"h-4 w-4 text-gray-500"}),value:n.x,onChange:e=>x("x",e)}),(0,te.jsx)(g,{label:"y",icon:(0,te.jsx)(hi.A,{className:"h-4 w-4 text-gray-500"}),value:n.y,onChange:e=>x("y",e)})]}),"sides"===i&&(0,te.jsxs)("div",{className:"grid auto-rows-auto gap-3",style:{gridTemplateColumns:"repeat(auto-fit, minmax(90px, 140px))"},children:[(0,te.jsx)(g,{label:"t",icon:(0,te.jsx)(Ts.A,{className:"h-4 w-4 text-gray-500"}),value:n.t,onChange:e=>x("t",e)}),(0,te.jsx)(g,{label:"r",icon:(0,te.jsx)(Ht.A,{className:"h-4 w-4 text-gray-500"}),value:n.r,onChange:e=>x("r",e)}),(0,te.jsx)(g,{label:"b",icon:(0,te.jsx)(hi.A,{className:"h-4 w-4 text-gray-500"}),value:n.b,onChange:e=>x("b",e)}),(0,te.jsx)(g,{label:"l",icon:(0,te.jsx)(pi.A,{className:"h-4 w-4 text-gray-500"}),value:n.l,onChange:e=>x("l",e)})]})]})]})}),(0,te.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,te.jsx)("div",{className:"rounded-md overflow-hidden",children:(0,te.jsx)("button",{type:"button",className:"p-2 "+("axes"===i?"bg-white text-gray-700 hover:bg-gray-100":"bg-indigo-50 text-indigo-700 hover:bg-indigo-100"),onClick:()=>{return o(e="axes"===i?"sides":"axes"),m.current=e,void("axes"!==e&&c?(d(!1),u(n,e,!1)):u(n,e,c));var e},children:(0,te.jsx)(vi.A,{size:16})})}),"Margin"===s&&"axes"===i&&(0,te.jsx)("div",{children:(0,te.jsx)("button",{type:"button",onClick:h,className:"p-2 rounded "+(c?"bg-white text-gray-500 border-gray-300":"hover:bg-gray-100 text-gray-700"),children:(0,te.jsx)(xi.A,{className:"h-4 w-4"})})})]})]})})};var yi=t(14666),Ni=t(92530),wi=t(54413),ki=t(69367),_i=t(68215),Si=t(66291);const Ci=[{label:"XS",value:"text-xs",size:"xs"},{label:"S",value:"text-sm",size:"sm"},{label:"Base",value:"text-base",size:"base"},{label:"L",value:"text-lg",size:"lg"},{label:"XL",value:"text-xl",size:"xl"},{label:"2XL",value:"text-2xl",size:"2xl"},{label:"3XL",value:"text-3xl",size:"3xl"},{label:"4XL",value:"text-4xl",size:"4xl"}],Ai=[{label:"Thin",value:"font-thin",weight:100},{label:"Extra Light",value:"font-extralight",weight:200},{label:"Light",value:"font-light",weight:300},{label:"Normal",value:"font-normal",weight:400},{label:"Medium",value:"font-medium",weight:500},{label:"Semi Bold",value:"font-semibold",weight:600},{label:"Bold",value:"font-bold",weight:700},{label:"Extra Bold",value:"font-extrabold",weight:800},{label:"Black",value:"font-black",weight:900}],Ei=[{label:"Left",value:"text-left",icon:(0,te.jsx)(yi.A,{className:"h-4 w-4"})},{label:"Center",value:"text-center",icon:(0,te.jsx)(Ni.A,{className:"h-4 w-4"})},{label:"Right",value:"text-right",icon:(0,te.jsx)(wi.A,{className:"h-4 w-4"})},{label:"Justify",value:"text-justify",icon:(0,te.jsx)(ki.A,{className:"h-4 w-4"})}],Ii=[{label:"None",value:"no-underline",icon:(0,te.jsx)(_i.A,{className:"h-4 w-4"})},{label:"Underline",value:"underline",icon:(0,te.jsx)(Si.A,{className:"h-4 w-4"})},{label:"Line Through",value:"line-through",icon:(0,te.jsx)("span",{className:"text-xs line-through",children:"abc"})}],Li=[{label:"Normal",value:"normal-case",icon:(0,te.jsx)(_i.A,{className:"h-4 w-4"})},{label:"Uppercase",value:"uppercase",icon:(0,te.jsx)("span",{className:"text-xs",children:"AA"})},{label:"Lowercase",value:"lowercase",icon:(0,te.jsx)("span",{className:"text-xs",children:"aa"})},{label:"Capitalize",value:"capitalize",icon:(0,te.jsx)("span",{className:"text-xs",children:"Aa"})}];function Ti(e){let{value:s,onChange:t}=e;const a=Ci.findIndex((e=>e.value===s)),r=-1===a?2:a;return(0,te.jsxs)("div",{className:"flex items-center gap-4",children:[(0,te.jsx)("label",{className:"text-sm font-light text-gray-700 whitespace-nowrap min-w-[100px]",children:"Size"}),(0,te.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,te.jsxs)(ut,{value:s,onValueChange:t,children:[(0,te.jsx)(pt,{className:"w-[80px] h-8 text-sm font-light bg-gray-100 rounded-[6px] border-none",children:(0,te.jsx)(ht,{placeholder:"Select size"})}),(0,te.jsx)(vt,{children:Ci.map((e=>(0,te.jsx)(bt,{value:e.value,className:"text-xs",children:e.label},e.value)))})]}),(0,te.jsx)("div",{className:"flex-1",children:(0,te.jsx)("input",{type:"range",min:"0",max:Ci.length-1,value:r,onChange:e=>t(Ci[parseInt(e.target.value)].value),className:"w-full h-2 bg-gray-100 rounded-lg appearance-none cursor-pointer [&::-webkit-slider-thumb]:bg-gray-800 [&::-webkit-slider-thumb]:w-4 [&::-webkit-slider-thumb]:h-4 [&::-webkit-slider-thumb]:rounded-full [&::-webkit-slider-thumb]:appearance-none [&::-moz-range-thumb]:bg-black [&::-moz-range-thumb]:w-4 [&::-moz-range-thumb]:h-4 [&::-moz-range-thumb]:rounded-full [&::-moz-range-thumb]:border-0",style:{background:`linear-gradient(to right, rgb(75, 85, 99) 0%, rgb(75, 85, 99) ${r/(Ci.length-1)*100}%, #f3f4f6 ${r/(Ci.length-1)*100}%, #f3f4f6 100%)`}})})]})]})}function $i(e){let{value:s,onChange:t}=e;Ai.findIndex((e=>e.value===s));return(0,te.jsxs)("div",{className:"flex items-center gap-4",children:[(0,te.jsx)("label",{className:"text-sm font-light text-gray-700 whitespace-nowrap min-w-[100px] max-w-[120px]",children:"Weight"}),(0,te.jsxs)(ut,{value:s,onValueChange:t,children:[(0,te.jsx)(pt,{className:"h-8 text-sm font-light bg-gray-100 rounded-[6px] border-none",children:(0,te.jsx)(ht,{placeholder:"Select weight"})}),(0,te.jsx)(vt,{children:Ai.map((e=>(0,te.jsx)(bt,{value:e.value,className:"text-xs",children:e.label},e.value)))})]})]})}const Di=function(e){let{typography:s,onChange:t}=e;const[a,r]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null),[m,u]=(0,Y.useState)(null);return(0,Y.useEffect)((()=>{r((null==s?void 0:s.size)||Ci[2].value),l((null==s?void 0:s.weight)||Ai[3].value),o((null==s?void 0:s.align)||Ei[0].value),d((null==s?void 0:s.decoration)||Ii[0].value),u((null==s?void 0:s.transform)||Li[0].value)}),[s]),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)(Ti,{value:a,onChange:e=>{r(e),t({...s,size:e})}}),(0,te.jsx)($i,{value:n,onChange:e=>{l(e),t({...s,weight:e})}}),(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)("label",{className:"text-sm font-light text-gray-700 shrink-0 min-w-[105px]",children:"Decoration"}),(0,te.jsx)("div",{className:"flex border rounded-[6px] divide-x flex-1 overflow-hidden",children:Ii.map(((e,a)=>(0,te.jsx)("button",{type:"button",className:"flex-1 flex justify-center py-1.5 "+(c===e.value?"bg-gray-200 text-gray-700":"bg-white text-gray-700 hover:bg-gray-50"),onClick:()=>{return a=e.value,d(a),void t({...s,decoration:a});var a},title:e.label,children:e.icon},e.value)))})]}),(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)("label",{className:"text-sm font-light text-gray-700 shrink-0 min-w-[105px]",children:"Alignment"}),(0,te.jsx)("div",{className:"flex border rounded-[6px] divide-x flex-1 overflow-hidden",children:Ei.map(((e,a)=>(0,te.jsx)("button",{type:"button",className:"flex-1 flex justify-center py-1.5 "+(i===e.value?"bg-gray-200 text-gray-700":"bg-white text-gray-700 hover:bg-gray-50"),onClick:()=>{return a=e.value,o(a),void t({...s,align:a});var a},title:e.label,children:e.icon},e.value)))})]}),(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)("label",{className:"text-sm font-light text-gray-700 shrink-0 min-w-[105px]",children:"Transform"}),(0,te.jsx)("div",{className:"flex border rounded-[6px] divide-x flex-1 overflow-hidden",children:Li.map(((e,a)=>(0,te.jsx)("button",{type:"button",className:"flex-1 flex justify-center py-1.5 "+(m===e.value?"bg-gray-200 text-gray-700":"bg-white text-gray-700 hover:bg-gray-50"),onClick:()=>{return a=e.value,u(a),void t({...s,transform:a});var a},title:e.label,children:e.icon},e.value)))})]})]})};function Pi(e){const s={colors:{bg:null,text:null},spacing:{margin:{t:null,r:null,b:null,l:null,x:null,y:null,all:null},padding:{t:null,r:null,b:null,l:null,x:null,y:null,all:null}},typography:{size:null,weight:null,align:null,decoration:null,transform:null},other:[]};if(!e)return s;if("string"!=typeof e)return s;return e.trim().split(/\s+/).forEach((e=>{if(!e)return;let t=!1;e.startsWith("bg-")?(s.colors.bg=e,t=!0):!e.startsWith("text-")||e.startsWith("text-xs")||e.startsWith("text-sm")||e.startsWith("text-base")||e.startsWith("text-lg")||e.startsWith("text-xl")?e.startsWith("m-")?(s.spacing.margin.x=e,s.spacing.margin.y=e,t=!0):e.startsWith("mt-")?(s.spacing.margin.t=e,t=!0):e.startsWith("mr-")?(s.spacing.margin.r=e,t=!0):e.startsWith("mb-")?(s.spacing.margin.b=e,t=!0):e.startsWith("ml-")?(s.spacing.margin.l=e,t=!0):e.startsWith("mx-")?(s.spacing.margin.x=e,t=!0):e.startsWith("my-")?(s.spacing.margin.y=e,t=!0):e.startsWith("p-")?(s.spacing.padding.x=e,s.spacing.padding.y=e,t=!0):e.startsWith("pt-")?(s.spacing.padding.t=e,t=!0):e.startsWith("pr-")?(s.spacing.padding.r=e,t=!0):e.startsWith("pb-")?(s.spacing.padding.b=e,t=!0):e.startsWith("pl-")?(s.spacing.padding.l=e,t=!0):e.startsWith("px-")?(s.spacing.padding.x=e,t=!0):e.startsWith("py-")?(s.spacing.padding.y=e,t=!0):e.startsWith("text-xs")||e.startsWith("text-sm")||e.startsWith("text-base")||e.startsWith("text-lg")||e.startsWith("text-xl")||e.startsWith("text-2xl")||e.startsWith("text-3xl")||e.startsWith("text-4xl")?(s.typography.size=e,t=!0):e.startsWith("font-")?(s.typography.weight=e,t=!0):e.startsWith("text-left")||e.startsWith("text-center")||e.startsWith("text-right")||e.startsWith("text-justify")?(s.typography.align=e,t=!0):e.startsWith("underline")||e.startsWith("line-through")||e.startsWith("no-underline")?(s.typography.decoration=e,t=!0):(e.startsWith("uppercase")||e.startsWith("lowercase")||e.startsWith("capitalize")||e.startsWith("normal-case"))&&(s.typography.transform=e,t=!0):(s.colors.text=e,t=!0),t||s.other.push(e)})),s}function Mi(e){const s=new Set;if(e.colors&&(e.colors.bg&&s.add(e.colors.bg),e.colors.text&&s.add(e.colors.text)),e.spacing&&e.spacing.margin){const t=e.spacing.margin;t.all?s.add(t.all):(t.t&&s.add(t.t),t.r&&s.add(t.r),t.b&&s.add(t.b),t.l&&s.add(t.l),t.x&&s.add(t.x),t.y&&s.add(t.y))}if(e.spacing&&e.spacing.padding){const t=e.spacing.padding;t.all?s.add(t.all):(t.t&&s.add(t.t),t.r&&s.add(t.r),t.b&&s.add(t.b),t.l&&s.add(t.l),t.x&&s.add(t.x),t.y&&s.add(t.y))}if(e.typography){const{size:t,weight:a,align:r,decoration:n,transform:l}=e.typography;t&&s.add(t),a&&s.add(a),r&&s.add(r),n&&s.add(n),l&&s.add(l)}return e.other&&Array.isArray(e.other)&&e.other.forEach((e=>{e&&s.add(e)})),Array.from(s).join(" ")}function Oi(e){let{title:s,children:t,defaultOpen:a=!1}=e;const[r,n]=(0,Y.useState)(a);return(0,te.jsx)("div",{className:"px-2 py-1",children:(0,te.jsxs)("div",{className:"border border-gray-200 rounded-md",children:[(0,te.jsxs)("button",{onClick:()=>n(!r),type:"button",className:"w-full rounded-md flex justify-between items-center px-3 py-2 text-sm font-semibold text-gray-800 hover:bg-gray-50 cursor-pointer "+(r?"":"bg-gray-100"),children:[s,r?(0,te.jsx)(dt.A,{className:"h-4 w-4 text-gray-500"}):(0,te.jsx)(ct.A,{className:"h-4 w-4 text-gray-500"})]}),r&&(0,te.jsx)("div",{className:"p-3",children:t})]})})}function Ri(e){var s,t;let{element:a,onChange:r,onClose:n,onSave:l,onDiscard:i,isSaving:o,onContentChange:c}=e;const[d,m]=(0,Y.useState)({colors:{},spacing:{},typography:{}}),[u,x]=(0,Y.useState)(""),[h,p]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{if(null!=a&&a.classes){x(a.classes);const e=Pi(a.classes);m(e)}}),[a]);if("svg"===(null==a||null===(s=a.tagName)||void 0===s?void 0:s.toLowerCase())||(null==a||null===(t=a.tagName)||void 0===t?void 0:t.toLowerCase().startsWith("svg"))||(null==a?void 0:a.tagName)&&["path","circle","rect","line","polygon","polyline","ellipse","g","defs","use","symbol"].includes(a.tagName.toLowerCase()))return(0,te.jsx)("div",{className:"w-full h-[500px] flex flex-col items-center justify-center px-4",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)(en.A,{className:"h-12 w-12 text-slate-400 mx-auto mb-4"}),(0,te.jsx)("h3",{className:"text-lg font-medium text-slate-700 mb-2",children:"SVG Element Selected"}),(0,te.jsx)("p",{className:"text-slate-500 text-sm leading-relaxed",children:"SVG elements and their properties can only be modified through the chat interface. Use the chat to request changes to this SVG element."})]})});const g=(e,s)=>{const t={...d};t.colors[e]=s,m(t);const a=Mi(t);x(a),r(a)},f=(e,s)=>{const t={...d};t.spacing[e]=s,m(t);const a=Mi(t);x(a),r(a)};return(0,te.jsxs)("div",{className:"w-full h-[450px] flex flex-col relative",children:[(0,te.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,te.jsxs)("div",{className:"controls w-full",children:[a.isTextElement&&(0,te.jsx)(Oi,{title:"Content",defaultOpen:!0,children:a.isDynamicContent?(0,te.jsx)("p",{className:"mt-1 text-xs text-slate-500",children:"This content is dynamically generated and cannot be edited directly. You can modify the content via the chat."}):(0,te.jsx)("textarea",{className:"w-full p-2 border border-gray-200 text-sm rounded-[6px] focus:outline-none focus:ring-1 focus:ring-gray-500 overflow-y-auto min-h-[4rem]",style:{height:"auto",resize:"none"},value:a.content,onChange:e=>{var s;e.target.style.height="auto",e.target.style.height=e.target.scrollHeight+"px",s=e.target.value,c(s)}})}),(0,te.jsxs)(Oi,{title:"Colors",defaultOpen:!0,children:[(0,te.jsx)(ui,{label:"Background",selectedColor:d.colors.bg,onChange:e=>g("bg",e)}),(0,te.jsx)("div",{className:"mt-2",children:(0,te.jsx)(ui,{label:"Text Color",selectedColor:d.colors.text,onChange:e=>g("text",e)})})]}),a.isTextElement&&(0,te.jsx)(Oi,{title:"Text & Font",defaultOpen:!0,children:(0,te.jsx)(Di,{typography:d.typography,onChange:e=>{const s={...d};s.typography={...s.typography,...e},m(s);const t=Mi(s);x(t),r(t)}})}),(0,te.jsxs)(Oi,{title:"Spacing",defaultOpen:!1,children:[(0,te.jsx)(bi,{label:"Margin",spacing:d.spacing.margin||{},onChange:e=>f("margin",e)}),(0,te.jsx)("div",{className:"mt-3",children:(0,te.jsx)(bi,{label:"Padding",spacing:d.spacing.padding||{},onChange:e=>f("padding",e)})})]}),(0,te.jsx)(Oi,{title:"Advanced - Tailwind Classes",defaultOpen:!1,children:(0,te.jsx)("textarea",{className:"w-full p-2 border border-gray-200 text-sm font-mono rounded-[6px] focus:outline-none focus:ring-1 focus:ring-gray-500",rows:"5",value:u,onChange:e=>{const s=e.target.value;x(s);const t=Pi(s);m(t),r(s)},placeholder:"Enter Tailwind classes..."})})]})}),(0,te.jsxs)("div",{className:"sticky bottom-0 left-0 right-0  p-3 flex justify-between",children:[(0,te.jsxs)("button",{onClick:()=>{i&&i()},disabled:o,className:"flex items-center gap-1 px-3 py-1 hover:bg-gray-200 text-gray-700 rounded-[6px]  text-sm",children:[(0,te.jsx)(nn.A,{className:"h-3 w-3"}),"Discard"]}),(0,te.jsx)("button",{onClick:()=>{l&&l(a,u)},disabled:o,className:"flex items-center gap-1 px-3 py-1 bg-blue-600 hover:bg-blue-700 text-white rounded-[6px] text-sm",children:o?"Saving...":"Save"})]})]})}var Fi=t(76322);const zi=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Fi.bL,{ref:s,className:ns("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,te.jsx)(Fi.C1,{className:ns("flex items-center justify-center text-current"),children:(0,te.jsx)(mt.A,{className:"h-4 w-4"})})})}));zi.displayName=Fi.bL.displayName;const Ui=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("textarea",{className:ns("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...a})}));Ui.displayName="Textarea";var Bi=t(87466);const Wi=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsxs)(Bi.bL,{ref:s,className:ns("relative overflow-hidden",t),...r,children:[(0,te.jsx)(Bi.LM,{className:"h-full w-full rounded-[inherit]",children:a}),(0,te.jsx)(qi,{}),(0,te.jsx)(Bi.OK,{})]})}));Wi.displayName=Bi.bL.displayName;const qi=Y.forwardRef(((e,s)=>{let{className:t,orientation:a="vertical",...r}=e;return(0,te.jsx)(Bi.VM,{ref:s,orientation:a,className:ns("flex touch-none select-none transition-colors","vertical"===a&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===a&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",t),...r,children:(0,te.jsx)(Bi.lr,{className:"relative flex-1 rounded-full bg-border"})})}));qi.displayName=Bi.VM.displayName;var Vi=t(89318),Yi=t(81745);function Hi(e){let{isOpen:s,onClose:t}=e;const{app:a,updateApp:r}=vs(),[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)([]),[m,u]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{if(a){l(a.custom_instructions||""),o(a.frozen_files||[]);const e=[["pages",a.pages],["functions",a.functions],["components",a.components]].flatMap((e=>{let[s,t]=e;return Object.keys(t||{}).map((e=>`${s}/${e}`))}));d(e)}}),[a,s]);const x=e=>{o(e?[...c]:[])};return(0,te.jsx)(na,{open:s,onOpenChange:t,children:(0,te.jsxs)(da,{className:"max-w-[90vw] sm:max-w-[500px] p-0 overflow-hidden rounded-lg shadow-lg border-0",children:[(0,te.jsx)(ma,{className:"px-6 pt-5 pb-3 bg-gradient-to-r from-slate-50 to-gray-50",children:(0,te.jsxs)(xa,{className:"flex items-center gap-2 text-lg font-medium",children:[(0,te.jsx)(Vi.A,{className:"h-5 w-5 text-gray-700"}),"AI Controls"]})}),(0,te.jsxs)("div",{className:"p-6 space-y-5 overflow-y-auto max-h-[70vh]",children:[(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)(at,{htmlFor:"custom-instructions",className:"text-sm font-medium flex items-center",children:"Custom Instructions"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Provide additional instructions that will be included in every interaction with the AI. These can help guide the AI's behavior and responses."}),(0,te.jsx)(Ui,{id:"custom-instructions",value:n,onChange:e=>l(e.target.value),placeholder:"e.g., Keep dark themes, always break down to small files, RTL...",className:"min-h-[100px] resize-none border-gray-200 focus:border-gray-300 transition-colors"})]}),(0,te.jsx)(Xs,{className:"my-5"}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsxs)(at,{className:"text-sm font-medium flex items-center gap-2",children:[(0,te.jsx)(Ls.A,{className:"h-4 w-4 text-gray-700"}),"Freeze Files",i.length>0&&(0,te.jsxs)(qs,{variant:"secondary",className:"ml-1 bg-blue-50 text-blue-700 hover:bg-blue-100",children:[i.length," frozen"]})]}),(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsx)(Rs,{variant:"outline",size:"sm",className:"h-8 text-xs border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-colors",onClick:()=>x(!0),children:"Freeze All"}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",className:"h-8 text-xs border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-colors",onClick:()=>x(!1),children:"Unfreeze All"})]})]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select files that should be protected from AI edits. The AI will not modify frozen files."}),(0,te.jsx)(Wi,{className:"h-[200px] border border-gray-200 rounded-lg overflow-hidden",children:(0,te.jsx)("div",{className:"p-1",children:c.map((e=>{const s=i.includes(e);return(0,te.jsxs)("div",{className:"flex items-center p-2 rounded-md transition-colors "+(s?"bg-blue-50 text-blue-800":"hover:bg-gray-50"),children:[(0,te.jsx)(zi,{id:`freeze-${e}`,checked:s,onCheckedChange:()=>(e=>{o((s=>s.includes(e)?s.filter((s=>s!==e)):[...s,e]))})(e),className:s?"border-blue-500 text-blue-600":""}),(0,te.jsxs)("div",{className:"flex-1 flex items-center ml-3",children:[(0,te.jsx)(at,{htmlFor:`freeze-${e}`,className:"cursor-pointer text-sm font-normal flex-1",children:e}),s?(0,te.jsx)(Ls.A,{className:"h-3.5 w-3.5 text-blue-500 ml-2"}):(0,te.jsx)(Yi.A,{className:"h-3.5 w-3.5 text-gray-300 ml-2"})]})]},e)}))})})]})]}),(0,te.jsx)(ua,{className:"px-6 py-4 bg-gray-50 border-t border-gray-100",children:(0,te.jsxs)("div",{className:"flex w-full gap-3 sm:justify-end",children:[(0,te.jsx)(Rs,{type:"button",variant:"outline",onClick:t,disabled:m,className:"flex-1 sm:flex-initial border-gray-200",children:"Cancel"}),(0,te.jsx)(Rs,{type:"button",onClick:async()=>{try{u(!0),await r({custom_instructions:n,frozen_files:i}),t()}catch(e){}finally{u(!1)}},disabled:m,className:"flex-1 sm:flex-initial bg-[#2b3440] hover:bg-[#3a4555] text-white",children:m?(0,te.jsxs)("span",{className:"flex items-center gap-2",children:[(0,te.jsx)("span",{className:"h-4 w-4 animate-spin rounded-full border-2 border-current border-t-transparent"}),"Saving..."]}):(0,te.jsxs)("span",{className:"flex items-center gap-1",children:[(0,te.jsx)(mt.A,{className:"h-4 w-4"}),"Save Changes"]})})]})})]})})}var Gi=t(94119),Ji=t(52536),Zi=t(83817),Ki=t(4940),Xi=t(36876);function Qi(e){let{app:s,writeCodeToFile:t,setContextSelectedElement:a}=e;const[r,n]=(0,Y.useState)(!1),[l,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)({left:0,top:0}),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),g=(0,Y.useRef)(null),f=(0,Y.useRef)(!1),v=(0,Y.useRef)(null),j=()=>!Object.keys(s.pages).length||!window.location.pathname.includes("preview")||window.innerWidth<768;(0,Y.useEffect)((()=>{if(j())return;const e=document.getElementById("preview-iframe");if(e){g.current=e;const s=()=>{e.getBoundingClientRect();m({left:0,top:-300})};return s(),window.addEventListener("resize",s),()=>window.removeEventListener("resize",s)}}),[window.location.pathname]),(0,Y.useEffect)((()=>{j()&&(n(!1),c(!1),i(null),a(null))}),[window.location.pathname]),(0,Y.useEffect)((()=>{if(j())return;const e=e=>{var s;const t=e.data;switch(t.type){case"visual-edit-agent-ready":f.current=!0;break;case"element-selected":const e={tagName:t.tagName,classes:t.classes,linenumber:t.linenumber,dataSourceLocation:t.dataSourceLocation,filename:t.filename,visualSelectorId:t.visualSelectorId,content:t.content,isDynamicContent:t.isDynamicContent,isTextElement:["p","h1","h2","h3","h4","h5","h6","span","a","label"].includes(null===(s=t.tagName)||void 0===s?void 0:s.toLowerCase())};i(e),v.current=t.visualSelectorId,c(!0),a({tagName:t.tagName,dataset:{filename:t.filename,linenumber:t.linenumber}})}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[a,window.location.pathname]),(0,Y.useEffect)((()=>{}),[o,l]);const b=e=>{v.current&&(i((s=>({...s,classes:e}))),g.current&&g.current.contentWindow.postMessage({type:"update-classes",data:{classes:e,visualSelectorId:v.current}},"*"))},y=e=>{i((s=>({...s,content:e}))),p(!0),g.current&&g.current.contentWindow.postMessage({type:"update-content",data:{content:e,visualSelectorId:v.current}},"*")},N=()=>{c(!1),g.current&&g.current.contentWindow.postMessage({type:"unselect-element"},"*"),i(null),v.current=null,a(null)},w=async(e,a)=>{if(e&&e.dataSourceLocation)try{x(!0);const r=e.dataSourceLocation,[i,o,c]=r.split(":");let d=i;d.endsWith(".js")&&(d=d.replace(".js",""));const m=parseInt(o,10),u=parseInt(c,10);if(isNaN(m)||isNaN(u))return;const h=(e=>{if(!e)return null;try{if("layout"===e)return s.layout;if(e.startsWith("pages/")){const t=e.split("pages/")[1];return s.pages[t]}if(e.startsWith("components/")){const t=e.split("components/")[1];return s.components[t]}}catch(t){}return null})(d);if(!h)return;const p={className:a};l.isTextElement&&!l.isDynamicContent&&(p.content=l.content);const f=function(e,s,t,a){try{const r=(0,Ji.parse)(e,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","objectRestSpread","functionBind","exportDefaultFrom","exportNamespaceFrom","dynamicImport","nullishCoalescingOperator","optionalChaining","asyncGenerators","bigInt","optionalCatchBinding","throwExpressions"]});let n=!1;return(0,Zi.default)(r,{JSXElement(e){const r=e.node.openingElement,{start:l}=r.loc||{};if(l&&l.line===s&&l.column===t){if(void 0!==a.className){const e=r.attributes.findIndex((e=>Xi.isJSXAttribute(e)&&Xi.isJSXIdentifier(e.name)&&"className"===e.name.name)),s=Xi.jsxAttribute(Xi.jsxIdentifier("className"),Xi.stringLiteral(a.className));e>=0?r.attributes[e]=s:r.attributes.push(s)}if(void 0!==a.content&&!r.selfClosing){const s=Xi.jsxText(a.content);e.node.children=[s]}n=!0,e.stop()}}}),n?{code:(0,Ki.default)(r,{retainLines:!0,compact:!1,concise:!1}).code,success:!0,found:!0}:{code:e,success:!0,found:!1,error:`Element not found at line ${s}, column ${t}`}}catch(r){return{code:e,success:!1,found:!1,error:r instanceof Error?r.message:"Unknown error"}}}(h,m,u,p);if(!f.success)return;if(!f.found)return;await t(d,f.code),g.current&&g.current.contentWindow.postMessage({type:"refresh-page"},"*"),N(),n(!1)}catch(r){}finally{x(!1)}},k=()=>{g.current&&(g.current.contentWindow.postMessage({type:"refresh-page"},"*"),N(),n(!1))};return{isVisualEditMode:r,selectedElement:l,isFormVisible:o,formPosition:d,isSaving:u,shouldHideSelectElement:j(),toggleVisualEditMode:()=>{const e=!r;n(e),g.current&&f.current&&g.current.contentWindow.postMessage({type:"toggle-visual-edit-mode",data:{enabled:e}},"*"),e||(i(null),v.current=null,c(!1),a(null),g.current&&g.current.contentWindow.postMessage({type:"unselect-element"},"*"))},handleClassesChange:b,handleCloseForm:N,handleSave:w,handleDiscard:k,renderVisualEditsMiddleComponent:e=>o&&l&&!j()?(0,te.jsx)("div",{className:"w-full p-2",children:(0,te.jsxs)("div",{className:"w-full border border-gray-300 bg-white mb-2 flex flex-col rounded-[12px] overflow-hidden",children:[(0,te.jsxs)("div",{className:"p-2 bg-white text-xs text-gray-500 flex justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 px-2 py-1",children:[(0,te.jsx)("div",{className:"flex items-center gap-2",children:(0,te.jsx)(Zl.A,{className:"text-black",size:20})}),(0,te.jsx)("div",{className:"text-black text-sm",children:"Visual Edit"}),(0,te.jsx)("div",{className:"bg-blue-100 text-blue-600 text-sm  rounded-md p-0.5 px-1.5 flex items-center gap-0.5",children:l.isTextElement?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Gi.A,{className:"w-4 h-4"}),l.tagName.toLowerCase()]}):l.tagName.toLowerCase()})]}),(0,te.jsx)("div",{className:"flex items-center gap-2 py-1 px-2",children:(0,te.jsx)("button",{onClick:N,className:"text-gray-500 hover:text-gray-700",children:(0,te.jsx)(Ds.A,{className:"text-black hover:text-gray-700",size:20})})})]}),(0,te.jsx)("div",{className:"w-full flex-1 overflow-y-auto",style:{minHeight:"250px"},children:(0,te.jsx)(e,{element:l,onChange:b,onContentChange:y,onClose:()=>{N(),k()},onSave:w,onDiscard:k,isSaving:u})})]})}):null}}var eo=t(69830),so=t(51981);function to(e){let{appId:s,onOpenChatSettings:t,frozenFiles:a}=e;const{app:r,updateApp:n}=vs(),{toast:l}=Un(),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),p=(0,Y.useRef)(null);(0,Y.useEffect)((()=>{const e=e=>{p.current&&!p.current.contains(e.target)&&(o(!1),d(!1),u(!1))};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[]);const g=async e=>{h(!0);try{await n({model:e}),u(!1),o(!1),l({title:"AI model updated",description:"Your app is now using a different AI model"})}catch(s){l({title:"Error",description:"Failed to update AI model",variant:"destructive"})}finally{h(!1)}},f=(null==a?void 0:a.length)||0,v=(e=>{switch(e){case"claude_3_7":return"Claude 3.7";case"claude_sonnet_4":return"Claude Sonnet 4";case"gemini_2_5_pro":return"Gemini 2.5 Pro";case"gpt_5":return"GPT-5";default:return"Default"}})(r.model);return(0,te.jsxs)("div",{className:"relative",ref:p,children:[(0,te.jsx)("div",{className:"flex items-center",children:(0,te.jsx)("button",{onClick:()=>o(!i),className:"flex items-center justify-center px-1 py-1 rounded-md rounded-md hover:bg-gray-100 transition-colors","aria-label":"App Settings",children:(0,te.jsx)(Vi.A,{className:"h-4 w-4 transition-transform duration-300 ease-in-out "+(i?"rotate-90":"")})})}),i&&(0,te.jsxs)("div",{className:"absolute bottom-full left-0 mb-2 w-52 bg-white rounded-md shadow-lg z-10 border border-gray-200 py-0.5",children:[(0,te.jsxs)("div",{className:"relative border-t border-gray-100",children:[(0,te.jsx)("div",{className:"px-3 py-1.5 text-sm hover:bg-gray-50 cursor-pointer transition-colors "+(m?"bg-gray-50":""),onClick:()=>{u(!m),d(!1)},children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(eo.A,{className:"w-3.5 h-3.5 text-gray-600"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("span",{className:"font-medium",children:"AI Model"}),(0,te.jsx)("div",{className:"text-xs text-gray-500",children:v})]})]}),(0,te.jsx)(pr.A,{className:"w-3 h-3 text-gray-400 transition-transform duration-200 "+(m?"rotate-90":"")})]})}),m&&(0,te.jsxs)("div",{className:"absolute left-full bottom-0 ml-0.5 w-56 bg-white rounded-md shadow-lg border border-gray-200 py-0.5 z-20",children:[(0,te.jsxs)("button",{onClick:()=>g("default"),disabled:x,className:"w-full px-3 py-1.5 text-sm text-left hover:bg-gray-50 flex items-center justify-between transition-colors "+("default"!==r.model&&r.model?"":"bg-blue-50/70"),children:[(0,te.jsxs)("div",{className:"flex flex-col items-start",children:[(0,te.jsx)("span",{children:"Default"}),(0,te.jsx)("span",{className:"text-[10px] text-gray-500 mt-0.5",children:"Automatically selects the best model for your app"})]}),("default"===r.model||!r.model)&&(0,te.jsx)(mt.A,{className:"w-3.5 h-3.5 text-blue-600 ml-2 flex-shrink-0"})]}),(0,te.jsxs)("button",{onClick:()=>g("claude_sonnet_4"),disabled:x,className:"w-full px-3 py-1.5 text-sm text-left hover:bg-gray-50 flex items-center justify-between transition-colors "+("claude_sonnet_4"===r.model?"bg-blue-50/70":""),children:[(0,te.jsx)("span",{children:"Claude Sonnet 4"}),"claude_sonnet_4"===r.model&&(0,te.jsx)(mt.A,{className:"w-3.5 h-3.5 text-blue-600"})]}),(0,te.jsxs)("button",{onClick:()=>g("gemini_2_5_pro"),disabled:x,className:"w-full px-3 py-1.5 text-sm text-left hover:bg-gray-50 flex items-center justify-between transition-colors "+("gemini_2_5_pro"===r.model?"bg-blue-50/70":""),children:[(0,te.jsx)("span",{children:"Gemini 2.5 Pro"}),"gemini_2_5_pro"===r.model&&(0,te.jsx)(mt.A,{className:"w-3.5 h-3.5 text-blue-600"})]}),(0,te.jsxs)("button",{onClick:()=>g("gpt_5"),disabled:x,className:"w-full px-3 py-1.5 text-sm text-left hover:bg-gray-50 flex items-center justify-between transition-colors "+("gpt_5"===r.model?"bg-blue-50/70":""),children:[(0,te.jsx)("span",{children:"GPT-5"}),"gpt_5"===r.model&&(0,te.jsx)(mt.A,{className:"w-3.5 h-3.5 text-blue-600"})]}),x&&(0,te.jsxs)("div",{className:"flex justify-center items-center py-1.5 text-xs text-gray-500 bg-gray-50 border-t border-gray-100",children:[(0,te.jsx)("div",{className:"animate-spin h-3 w-3 border-2 border-blue-500 border-t-transparent rounded-full mr-2"}),"Updating..."]})]})]}),(0,te.jsxs)("button",{onClick:()=>{o(!1),t()},className:"w-full px-3 py-1.5 text-sm text-left text-gray-700 hover:bg-gray-50 flex items-center justify-between border-t border-gray-100 transition-colors",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(so.A,{size:13,className:"mr-2 text-gray-600"}),(0,te.jsx)("span",{className:"font-medium",children:"AI Controls"})]}),f>0&&(0,te.jsxs)("span",{className:"text-xs text-blue-600 font-medium bg-blue-50 px-1.5 py-0.5 rounded",children:[f," frozen"]})]})]})]})}var ao=t(33252);const ro=e=>{let{isDiscussionMode:s,setIsDiscussionMode:t}=e;return(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsxs)("button",{onClick:()=>t(!s),className:"flex items-center gap-1 px-2 py-1 rounded-md text-xs transition-all duration-200 "+(s?"bg-violet-50 text-violet-600 hover:bg-violet-100":"text-gray-600 bg-gray-100 hover:bg-gray-200"),children:[(0,te.jsx)(ao.A,{className:"h-3 w-3"}),(0,te.jsx)("span",{children:"Discuss"})]})}),(0,te.jsx)(Ss,{side:"top",align:"end",className:"max-w-[280px]",children:(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("p",{className:"font-medium",children:"Discuss Mode"}),(0,te.jsx)("p",{className:"text-xs text-muted-foreground",children:"Chat with the AI about anything without making code changes. Uses 0.3 credits per request."})]})})]})};function no(){const[e,s]=(0,Y.useState)(!1),[t,a]=(0,Y.useState)(null),{app:r,addChatMessage:n,undoMessage:l,stopChat:i,suggestions:o,currentUsage:c,writeCodeToFile:d,setSelectedElement:m}=vs(),[u,x]=(0,Y.useState)(!1),{isVisualEditMode:h,isSaving:p,shouldHideSelectElement:g,toggleVisualEditMode:f,handleDiscard:v,renderVisualEditsMiddleComponent:j}=Qi({app:r,writeCodeToFile:d,setContextSelectedElement:m});(0,Y.useEffect)((()=>{c&&(async()=>{try{const e=await Qe.default.getStats();a(e)}catch(e){}})()}),[c]);const b=!!c&&(c.daily_usage>=(c.daily_limit||1e6)||null!==c.monthly_limit&&void 0!==c.monthly_limit&&c.monthly_usage>=c.monthly_limit),y=b?"0 credits remaining":e?"What would you like to discuss?":"What would you like to change?";return(0,te.jsxs)("div",{className:"h-full flex flex-col",children:[(0,te.jsx)(Jl,{chat:r.conversation,addMessage:s=>(h&&v(),e&&(s.additional_message_params=s.additional_message_params||{},s.additional_message_params.discussion_mode=!0),n(s)),status:r.status,undoMessage:l,onStop:i,suggestions:o,isDisabled:b,isOutOfCredits:b,currentUsage:c,billingStats:t,placeholder:y,isDiscussionMode:e,isVisualEditMode:h,customButtomRight:null,customButtomLeft:t=>(0,te.jsxs)("div",{className:"flex items-center gap-1",children:[(0,te.jsx)(to,{appId:r.id,onOpenChatSettings:()=>x(!0),frozenFiles:r.frozen_files}),(0,te.jsx)("div",{className:"h-6 w-px bg-gray-200 mx-2"}),t,!g&&(0,te.jsx)(Kl,{isVisualEditMode:h,toggleVisualEditMode:f,isSaving:p}),!b&&(0,te.jsx)(ro,{isDiscussionMode:e,setIsDiscussionMode:s})]}),customMiddleComponent:(0,te.jsx)("div",{children:j(Ri)})}),(0,te.jsx)(Hi,{isOpen:u,onClose:()=>x(!1)})]})}var lo=t(24276),io=t(18134);const oo=_l.bL,co=_l.R6,mo=_l.Ke,uo={overview:lo.A,data:It.A,users:Wa.A,analytics:io.A,domains:Tt.A,security:Dl.A,code:_t.A,logs:It.A,settings:Vi.A,payments:Ze.A,secrets:It.A,api:_t.A,agents:eo.A},xo=e=>{if(e.id&&e.id.startsWith("entity-"))return null;const s=uo[e.id];return!s&&e.icon?(0,te.jsx)("div",{className:"min-w-[20px]",children:e.icon}):s?(0,te.jsx)(s,{className:"w-5 h-5"}):null},ho=(e,s)=>e.id===s||!!e.subitems&&e.subitems.some((e=>ho(e,s))),po=e=>{let{item:s,selected:t,onSelect:a,searchTerm:r,level:n=0}=e;const l=t===s.id,i=s.subitems&&s.subitems.some((e=>t===e.id||!!e.subitems&&ho(e,t)));return!r||s.label.toLowerCase().includes(r.toLowerCase())||s.subitems&&s.subitems.some((e=>e.label.toLowerCase().includes(r.toLowerCase())||e.subitems&&e.subitems.some((e=>e.label.toLowerCase().includes(r.toLowerCase())))))?s.subitems?(0,te.jsxs)(oo,{defaultOpen:l||i,className:ns("group",n>0?"ml-3":""),children:[(0,te.jsx)(co,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"ghost",className:ns("w-full justify-start px-3 py-2.5 text-sm rounded-lg transition-colors",l||i?"bg-primary/10 text-primary":"text-foreground hover:bg-gray-100"),children:[(0,te.jsx)("div",{className:ns("w-6 h-6 flex items-center justify-center",l?"text-primary":"text-muted-foreground"),children:xo(s)}),(0,te.jsx)("span",{className:"ml-3 truncate",children:s.label}),(0,te.jsx)("div",{className:"ml-auto",children:(0,te.jsx)(ct.A,{className:"h-4 w-4 transition-transform group-data-[state=open]:rotate-180 text-muted-foreground"})})]})}),(0,te.jsxs)(mo,{className:"mt-1 relative",children:[(0,te.jsx)("div",{className:"absolute left-6 top-0 bottom-0 w-px bg-gray-200"}),s.subitems.map(((e,s)=>(0,te.jsx)(po,{item:e,selected:t,onSelect:a,searchTerm:r,level:n+1},s)))]})]}):(0,te.jsxs)(Rs,{variant:"ghost",className:ns("w-full justify-start px-3 py-2.5 text-sm rounded-lg transition-colors",l?"bg-primary/10 text-primary":"text-foreground hover:bg-gray-100"),onClick:()=>a(s.id),children:[(0,te.jsx)("div",{className:ns("w-6 h-6 flex items-center justify-center",l?"text-primary":"text-muted-foreground"),children:xo(s)}),(0,te.jsx)("span",{className:"ml-3 truncate",children:s.label})]}):null},go=e=>{let{items:s,selected:t,onSelect:a,isOpen:r,onClose:n,title:l,showBackButton:i,onBack:o,showSearch:c=!1,style:d}=e;const[m,u]=(0,Y.useState)(""),[x,h]=(0,Y.useState)(!1);return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm transition-opacity lg:hidden "+(r?"opacity-100 z-40":"opacity-0 pointer-events-none"),onClick:n}),(0,te.jsxs)("div",{className:`fixed lg:static inset-y-0 left-0 transform ${r?"translate-x-0":"-translate-x-full"} lg:translate-x-0 transition duration-200 ease-in-out bg-white border-r z-50 lg:z-0 w-full h-full flex flex-col`,style:d,children:[(0,te.jsx)("div",{className:"p-2 flex justify-end lg:hidden",children:(0,te.jsx)(Rs,{variant:"ghost",size:"icon",onClick:n,children:(0,te.jsx)(Ds.A,{className:"h-4 w-4"})})}),i&&(0,te.jsxs)(Rs,{variant:"ghost",className:"justify-start mx-3 mb-2 px-4 text-sm",onClick:o,children:[(0,te.jsx)(pr.A,{className:"h-4 w-4 mr-2 rotate-180"}),"Back to Editor"]}),c&&(0,te.jsx)("div",{className:"px-3 pt-2 pb-4",children:(0,te.jsxs)("div",{className:ns("relative flex items-center",x?"ring-2 ring-ring":""),children:[(0,te.jsx)(Na.A,{className:"absolute left-3 h-4 w-4 text-muted-foreground"}),(0,te.jsx)("input",{type:"text",placeholder:"Search...",value:m,onChange:e=>u(e.target.value),className:ns("w-full py-2 pl-9 pr-3 bg-gray-100 rounded-lg text-sm","focus:outline-none transition-all","placeholder:text-muted-foreground","text-foreground"),onFocus:()=>h(!0),onBlur:()=>h(!1)})]})}),(0,te.jsx)("nav",{className:"flex-1 overflow-y-auto py-1 px-3 space-y-1 scrollbar-thin scrollbar-thumb-muted",children:s.map(((e,s)=>(0,te.jsx)(po,{item:e,selected:t,onSelect:a,searchTerm:m},s)))})]})]})};var fo=t(58907),vo=t(27255),jo=t(98989);var bo=t(23740);const yo=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(bo.uB,{ref:s,className:ns("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",t),...a})}));yo.displayName=bo.uB.displayName;const No=e=>{let{children:s,...t}=e;return(0,te.jsx)(na,{...t,children:(0,te.jsx)(da,{className:"overflow-hidden p-0 shadow-lg",children:(0,te.jsx)(yo,{className:"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5",children:s})})})},wo=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,te.jsx)(Na.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,te.jsx)(bo.uB.Input,{ref:s,className:ns("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",t),...a})]})}));wo.displayName=bo.uB.Input.displayName;const ko=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(bo.uB.List,{ref:s,className:ns("max-h-[300px] overflow-y-auto overflow-x-hidden",t),...a})}));ko.displayName=bo.uB.List.displayName;const _o=Y.forwardRef(((e,s)=>(0,te.jsx)(bo.uB.Empty,{ref:s,className:"py-6 text-center text-sm",...e})));_o.displayName=bo.uB.Empty.displayName;const So=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(bo.uB.Group,{ref:s,className:ns("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",t),...a})}));So.displayName=bo.uB.Group.displayName;const Co=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(bo.uB.Separator,{ref:s,className:ns("-mx-1 h-px bg-border",t),...a})}));Co.displayName=bo.uB.Separator.displayName;const Ao=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(bo.uB.Item,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50",t),...a})}));Ao.displayName=bo.uB.Item.displayName;const Eo=e=>{let{className:s,...t}=e;return(0,te.jsx)("span",{className:ns("ml-auto text-xs tracking-widest text-muted-foreground",s),...t})};Eo.displayName="CommandShortcut";const Io=e=>{let{value:s,onChange:t,options:a,isMulti:r,placeholder:n,optionsNames:l=null}=e;const i=a.map(((e,s)=>null==e?{label:(null==l?void 0:l[s])||"null",value:null}:"object"==typeof e?{label:e.label||l[s],value:e.value}:{label:l?l[s]:e,value:e}));let o=[];if(s)if(r)o=s.map((e=>i.find((s=>s.value===e)))).filter(Boolean);else{const e=i.find((e=>e.value===s));e&&(o=[e])}const c=e=>{const s=o.filter((s=>s.value!==e.value));t(s.map((e=>e.value)))};var d;return r?(0,te.jsxs)(yo,{className:"border rounded-md",children:[(0,te.jsx)("div",{className:"flex gap-1 flex-wrap p-2",children:null===(d=o)||void 0===d?void 0:d.map((e=>(0,te.jsxs)(qs,{variant:"secondary",className:"max-w-[200px]",children:[(0,te.jsx)("span",{className:"truncate",children:e.label}),(0,te.jsx)("button",{className:"ml-1 ring-offset-background rounded-full outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",onKeyDown:s=>{"Enter"===s.key&&c(e)},onMouseDown:e=>{e.preventDefault(),e.stopPropagation()},onClick:()=>c(e),children:(0,te.jsx)(Ds.A,{className:"h-3 w-3 text-muted-foreground hover:text-foreground"})})]},e.value)))}),(0,te.jsx)(wo,{placeholder:n||"Search...",className:"border-none focus:ring-0"}),(0,te.jsx)(So,{className:"max-h-[200px] overflow-auto",children:0===(null==i?void 0:i.length)?(0,te.jsx)("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"No options available"}):null==i?void 0:i.map((e=>{var s;return(0,te.jsx)("div",{className:"cursor-pointer px-2 py-1.5 "+(null!==(s=o)&&void 0!==s&&s.some((s=>s.value===e.value))?"bg-muted":""),onClick:()=>(e=>{if(r){const s=o.some((s=>s.value===e.value))?o.filter((s=>s.value!==e.value)):[...o,e];t(s.map((e=>e.value)))}else t(e.value)})(e),children:e.label},e.value)}))})]}):(0,te.jsxs)(ut,{value:null==s?void 0:s.toString(),onValueChange:e=>t(e),children:[(0,te.jsx)(pt,{children:(0,te.jsx)(ht,{placeholder:n})}),(0,te.jsx)(vt,{children:(0,te.jsx)(xt,{children:0===i.length?(0,te.jsx)("div",{className:"py-6 text-center text-sm text-muted-foreground",children:"No options available"}):i.map((e=>{var s;return(0,te.jsx)(bt,{value:(null===(s=e.value)||void 0===s?void 0:s.toString())||null,children:e.label},e.value||"null")}))})})]})};function Lo(e){let{value:s,onChange:t,name:a,itemSchema:r,isMulti:n=!1}=e;const{getEntitiesSDK:l}=vs(),[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)(!1),m=l();return(0,Y.useEffect)((()=>{d(!0);const e=r.$ref.split("/");if(4!==e.length||""!==e[0]||"entities"!==e[1]||"id"!==e[3])throw new Error(`Error in ${a} field. Invalid $ref format: ${r.$ref}. should be like /entities/EntityName/id`);const s=e[2];m[s].list().then((e=>{o(e.map((e=>{const t=m[s].schema();let a="id";for(const s in t.properties)if(s.toLowerCase().includes("name")||s.toLowerCase().includes("title")){a=s;break}return{label:e[a],value:e.id}}))),d(!1)}))}),[r.$ref]),c?(0,te.jsx)("div",{children:"Loading..."}):(0,te.jsx)(Io,{options:i,onChange:t,isMulti:n,value:s})}var To=t(53938);function $o(e){let{className:s,classNames:t,showOutsideDays:a=!0,...r}=e;return(0,te.jsx)(To.hv,{showOutsideDays:a,className:ns("p-3",s),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",nav:"space-x-1 flex items-center",nav_button:ns(Os({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:ns(Os({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"bg-accent text-accent-foreground",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{...s}=e;return(0,te.jsx)($t.A,{className:"h-4 w-4"})},IconRight:e=>{let{...s}=e;return(0,te.jsx)(pr.A,{className:"h-4 w-4"})}},...r})}$o.displayName="Calendar";var Do=t(32264),Po=t(33822);const Mo=Po.bL,Oo=Po.l9,Ro=Y.forwardRef(((e,s)=>{let{className:t,align:a="center",sideOffset:r=4,...n}=e;return(0,te.jsx)(Po.ZL,{children:(0,te.jsx)(Po.UC,{ref:s,align:a,sideOffset:r,className:ns("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})})}));function Fo(e){let{value:s,onChange:t,format:a="date",className:r}=e;const n=(e,s)=>{if(s){const[t,a]=s.split(":");e.setHours(parseInt(t)),e.setMinutes(parseInt(a))}t(e)};let l=s;return l=null==s||""===s?null:new Date(s),(0,te.jsxs)(Mo,{children:[(0,te.jsx)(Oo,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"outline",className:ns("w-full justify-start text-left font-normal",!l&&"text-muted-foreground",r),children:[(0,te.jsx)(At.A,{className:"mr-2 h-4 w-4"}),l?"date"===a?(0,Do.GP)(l,"PPP"):"date-time"===a?(0,Do.GP)(l,"PPP HH:mm:ss"):(0,Do.GP)(l,"HH:mm:ss"):(0,te.jsx)("span",{children:"Pick a date"})]})}),(0,te.jsx)(Ro,{className:"w-auto p-0",style:{zIndex:9999,position:"relative",isolation:"isolate",pointerEvents:"auto"},onInteractOutside:e=>{e.target.closest('[role="dialog"]')&&e.preventDefault()},forceMount:!0,children:(0,te.jsxs)("div",{className:"p-3 bg-popover shadow-lg rounded-md border",style:{pointerEvents:"auto"},children:[(0,te.jsx)($o,{mode:"single",selected:l,onSelect:e=>n(e),initialFocus:!0,className:"pointer-events-auto"}),("date-time"===a||"time"===a)&&(0,te.jsx)("input",{type:"time",className:"mt-3 w-full px-3 py-2 border rounded pointer-events-auto",value:l?(0,Do.GP)(l,"HH:mm"):"",onChange:e=>n(l||new Date,e.target.value)})]})})]})}Ro.displayName=Po.UC.displayName;var zo=t(77834);function Uo(e){let{value:s,onChange:t,isMulti:a}=e;const r=vs(),[n,l]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{if(s){l((a?s:[s]).map((e=>({name:e.split("/").pop(),url:e}))))}}),[s,a]);const c=(0,Y.useCallback)((async e=>{o(!0);try{const s=await Promise.all(e.map((async e=>{const s=null!=r&&r.app?await bs.uploadAppFile(e,r.app.id):await bs.uploadFile(e);return{name:e.name,url:s.url}})));l((e=>{const t=a?[...e,...s]:s;return d(t),t}))}catch(s){}finally{o(!1)}}),[a,t]),d=e=>{t(a?e.map((e=>e.url)):e.length>0?e[0].url:null)};return(0,te.jsxs)("div",{className:"w-full",children:[(0,te.jsxs)("div",{className:ns("flex items-center justify-center w-full rounded-lg border border-dashed","border-muted-foreground/25 hover:border-primary transition-colors","p-4 cursor-pointer"),onClick:()=>{var e;return null===(e=document.getElementById("fileInput"))||void 0===e?void 0:e.click()},children:[i?(0,te.jsx)("div",{className:"loading loading-spinner"}):(0,te.jsx)(zo.A,{className:"h-5 w-5 text-muted-foreground"}),(0,te.jsx)("input",{id:"fileInput",type:"file",multiple:a,className:"hidden",onChange:e=>c(Array.from(e.target.files||[])),disabled:i})]}),n.length>0&&(0,te.jsx)("div",{className:"mt-2 space-y-1",children:n.map(((e,s)=>(0,te.jsxs)("div",{className:"flex items-center justify-between bg-muted/50 p-1 rounded",children:[(0,te.jsx)("a",{href:e.url,target:"_blank",rel:"noopener noreferrer",className:"text-xs hover:underline truncate",children:e.name}),(0,te.jsx)(Rs,{variant:"ghost",size:"icon",onClick:()=>{return s=e,void l((e=>{const t=e.filter((e=>e!==s));return d(t),t}));var s},className:"h-4 w-4 p-0",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]},s)))})]})}const Bo=e=>{let{value:s,onChange:t}=e;return(0,te.jsx)(zi,{checked:s,onCheckedChange:t})},Wo=e=>{let{value:s,onChange:t}=e;const[a,r]=(0,Y.useState)("");return(0,te.jsxs)("div",{className:"flex flex-wrap items-center border rounded-md p-1",children:[s&&s.map(((e,a)=>(0,te.jsxs)("span",{className:"bg-gray-200 rounded-md px-2 py-1 m-1 flex items-center",children:[e,(0,te.jsx)("button",{type:"button",onClick:()=>(e=>{const a=s.filter(((s,t)=>t!==e));t(a)})(a),className:"ml-1 text-gray-500 hover:text-gray-700 focus:outline-none",children:"\xd7"})]},a))),(0,te.jsx)("input",{type:"text",value:a,onChange:e=>{r(e.target.value)},onKeyDown:e=>{if("Enter"===e.key&&a.trim()){e.preventDefault();const n=[...s||[],a.trim()];t(n),r("")}else if("Backspace"===e.key&&!a&&s&&s.length>0){const e=s.slice(0,-1);t(e)}},className:"flex-grow outline-none px-2 py-1",placeholder:"enter values..."})]})};function qo(e){if(void 0!==e.default)return e.default;switch(e.type){case"string":return"";case"number":return 0;case"boolean":return!1;default:return null}}function Vo(e){let{path:s,schema:t,value:a,setValueAt:r,getValueAt:n,uiSchema:l,validationErrors:i}=e;const o=a||[];if("string"===t.items.type&&!t.items.$ref&&!t.items.enum&&!t.items.format)return(0,te.jsx)(Wo,{value:o,onChange:e=>r(s,e)});if("string"===t.items.type&&t.items.enum)return(0,te.jsx)(Io,{options:t.items.enum,isMulti:!0,value:o,onChange:e=>r(s,e),optionsNames:t.items.enumNames});if("string"===t.items.type&&"file"===t.items.format)return(0,te.jsx)(Uo,{value:o,onChange:e=>r(s,e),isMulti:!0});if(t.items.$ref)return(0,te.jsx)(Lo,{value:o,onChange:e=>r(s,e),name:s[s.length-1],itemSchema:t.items,isMulti:!0});const c=t.items.default||"object"===t.items.type?{}:null;if(!t.hasOwnProperty("items"))throw new Error(`Error in json schema for array: items is required. path: ${s.join(".")}`);return(0,te.jsxs)("div",{className:"space-y-4 ps-4 border-s-2 border-gray-200",children:[o.map(((e,a)=>(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)("button",{className:"absolute top-0 right-0 p-1 text-gray-500 hover:text-gray-700",onClick:()=>(e=>{const t=[...o];t.splice(e,1),r(s,t)})(a),children:(0,te.jsx)(Ds.A,{size:16})}),(0,te.jsx)(Ho,{path:[...s,a],value:e,schema:t.items,setValueAt:r,getValueAt:n,uiSchema:l,validationErrors:i[a]||{}},a)]},a))),(0,te.jsx)("div",{className:"mt-2",children:(0,te.jsxs)("button",{type:"button",onClick:e=>{e.preventDefault(),r([...s,o.length],c)},className:"btn btn-outline btn-sm",children:[(0,te.jsx)(ys.A,{size:16})," Add Item"]})})]})}function Yo(e){let{path:s,schema:t,value:a,setValueAt:r,getValueAt:n,uiSchema:l,validationErrors:i,suppressLabel:o}=e;const c=a||{},[d,m]=Y.useState(""),[u,x]=Y.useState(qo(t.additionalProperties));return(0,te.jsxs)("div",{className:"space-y-2 ps-4 border-s-2 border-gray-200",children:[Object.entries(c).map((e=>{let[a,o]=e;return(0,te.jsx)("div",{children:(0,te.jsxs)("div",{className:"flex items-center gap-4 mb-1",children:[(0,te.jsx)("div",{className:"flex-1 mt-4",children:(0,te.jsx)(Qs,{type:"text",value:a,disabled:!0,className:"bg-gray-50"})}),(0,te.jsx)("div",{className:"flex-1",children:(0,te.jsx)(Ho,{path:[...s,a],value:o,schema:t.additionalProperties,setValueAt:r,getValueAt:n,uiSchema:l,validationErrors:i[a]||{},suppressLabel:!0})}),(0,te.jsx)("button",{className:"mt-4 p-1 text-gray-500 hover:text-gray-700",onClick:()=>(e=>{const t={...c};delete t[e],r(s,t)})(a),"aria-label":"Remove",children:(0,te.jsx)(Ds.A,{size:16})})]})},a)})),(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex items-center gap-4",children:[(0,te.jsx)("div",{className:"flex-1 mt-4",children:(0,te.jsx)(Qs,{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"Key",className:"flex-1"})}),(0,te.jsx)("div",{className:"flex-1",children:(0,te.jsx)(Ho,{path:[...s,"new"],value:u,schema:t.additionalProperties,setValueAt:(e,s)=>x(s),getValueAt:()=>u,uiSchema:l,validationErrors:{},suppressLabel:!0})})]}),(0,te.jsx)("div",{className:"mt-2 flex",children:(0,te.jsx)("button",{type:"button",onClick:e=>{if(e.preventDefault(),!d)return;const a={...c};a[d]=u,r(s,a),m(""),x(qo(t.additionalProperties))},className:"btn btn-outline btn-sm",children:"+ Add"})})]})]})}function Ho(e){let{path:s,getValueAt:t,setValueAt:a,schema:r,uiSchema:n,validationErrors:l,suppressLabel:i}=e;if("hidden"===n["ui:widget"])return(0,te.jsx)(te.Fragment,{});if(!r)throw new Error(`Error in json schema: schema for the property is required. property path: ${s.join(".")}`);const o=void 0===t(s)?r.default||null:t(s);let c;if(!i)if(n["ui:title"])c=n["ui:title"];else if(r.title)c=r.title;else{const e=s[s.length-1];c="number"==typeof e?void 0:e}return(0,te.jsxs)("div",{className:"mt-4",children:[c&&(0,te.jsxs)("div",{className:"mb-2",children:[(0,te.jsx)("label",{htmlFor:s.join("__"),className:"text-sm font-medium text-gray-900",children:c}),r.description&&(0,te.jsx)("p",{className:"text-sm text-gray-500",children:r.description})]}),(()=>{if(ss().isFunction(n["ui:widget"]))return n["ui:widget"]({value:o,onChange:e=>a(s,e),getValueAt:t,setValueAt:a,schema:r,uiSchema:n,path:s});if(r.enum&&"array"!==r.type&&"object"!==r.type)return(0,te.jsx)(Io,{options:r.enum,optionsNames:r.enumNames,value:o,onChange:e=>a(s,e)});if(r.$ref)return(0,te.jsx)(Lo,{value:o,onChange:e=>a(s,e),name:s[s.length-1],itemSchema:r});if("string"===r.type)return"date"===r.format||"date-time"===r.format||"time"===r.format?(0,te.jsx)(Fo,{format:r.format,value:o,onChange:e=>a(s,e)}):"file"===r.format?(0,te.jsx)(Uo,{value:o,onChange:e=>a(s,e)}):"textarea"===n["ui:widget"]?(0,te.jsx)(Ui,{value:o||"",onChange:e=>a(s,e.target.value)}):(0,te.jsx)(Qs,{type:"text",value:o||"",onChange:e=>a(s,e.target.value)});if("number"===r.type||"integer"===r.type)return(0,te.jsx)(Qs,{type:"number",value:o||"",onChange:e=>a(s,parseFloat(e.target.value)),min:r.minimum,max:r.maximum,step:"integer"===r.type?1:"any"});if("boolean"===r.type)return(0,te.jsx)(Bo,{value:o,onChange:e=>a(s,e)});if("array"===r.type)return(0,te.jsx)(Vo,{path:s,schema:r,value:o,setValueAt:a,getValueAt:t,uiSchema:n.hasOwnProperty("items")?n.items:n,validationErrors:l});if("object"===r.type){if(r.additionalProperties)return(0,te.jsx)(Yo,{path:s,schema:r,value:o,setValueAt:a,getValueAt:t,uiSchema:n,validationErrors:l,suppressLabel:i});if(!r.properties)throw new Error(`Error in json schema: properties is required for object type. property path: ${s.join(".")}. if you need the user to insert a flexible object, JsonSchemaFrom might not be the right choice`);return(0,te.jsx)("div",{className:"space-y-4 ps-4 border-s-2 border-gray-200",children:Object.entries(r.properties).map((e=>{let[r,i]=e;return(0,te.jsx)(Ho,{path:[...s,r],getValueAt:t,setValueAt:a,schema:i,uiSchema:n[r]||{},validationErrors:l[r]||{}},r)}))})}})(),l&&ss().isString(l)&&(0,te.jsx)("div",{style:{color:"red"},children:l})]})}function Go(e,s,t){if(0===s.length)return t;const[a,...r]=s,n=ss().isNumber(r[0]),l=ss().isArray(e)?[...e]:{...e};return 0===r.length?l[a]=t:l[a]=Go(n?l[a]||[]:l[a]||{},r,t),l}function Jo(e,s){if(ss().isNil(e)||0===s.length)return e;const[t,...a]=s;return 0===a.length?e[t]:Jo(e[t],a)}const Zo=e=>{let{schema:s,onChange:t,onSubmit:a,initialValues:r,uiSchema:n}=e;const[l,i]=(0,Y.useState)(r||{}),[o,c]=(0,Y.useState)({});if(!s||ss().isEmpty(s)||ss().isEmpty(s.properties))throw new Error("Error In JsonSchemaForm: valid json schema is required, but got: "+JSON.stringify(s));const d=function(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a={};if("object"===e.type&&e.properties){Object.entries(e.properties).forEach((e=>{let[r,n]=e;const l=[...t,r],i=d(n,s,l);ss().isEmpty(i)||(a[r]=i)}));const r=function(e){if(!e||(0,es.isEmpty)(e))throw new Error("JSON Schema error is required, got: "+JSON.stringify(e));if((0,es.isEmpty)(e.properties))throw new Error("JSON Schema error: properties are required in schema, got schema: "+JSON.stringify(e));return e.required||[]}(e)||[];r.forEach((r=>{const l=[...t,r],i=Jo(s,l)||e.properties[r].default,o=Jo(n,l),c="hidden"===(null==o?void 0:o["ui:widget"]);"boolean"===e.properties[r].type||null!=i&&""!==i||c||(a[r]="This field is required")}))}else if("array"===e.type&&e.items){(Jo(s,t)||[]).forEach(((r,n)=>{const l=[...t,n],i=d(e.items,s,l);ss().isEmpty(i)||(a[n]=i)}))}return a},m=(e,s)=>{const a=Go(l,e,s);i(a),t&&t(a)};if(ss().isFunction(n)&&(n=n(l)),n&&"object"==typeof n){const e={};Object.entries(n).forEach((s=>{let[t,a]=s;const r=t.split(".");let n=e;for(let e=0;e<r.length-1;e++)n[r[e]]||(n[r[e]]={}),n=n[r[e]];n[r[r.length-1]]=a})),n=e}return(0,te.jsxs)("form",{className:"pt-4",children:[Object.entries(s.properties).map((e=>{let[s,t]=e;return(0,te.jsx)(Ho,{path:[s],value:l[s],setValueAt:m,getValueAt:e=>Jo(l,e),schema:t,uiSchema:(n||{})[s]||{},validationErrors:o[s]||{}},s)})),a&&(0,te.jsx)("div",{className:"mt-4",children:(0,te.jsx)(Rs,{onClick:e=>{e.preventDefault();(()=>{const e=d(s,l);return c(e),ss().isEmpty(e)})()?a(l):(0,Ga.toast)("some fields are required: "+Object.keys(o).join(", "))},children:"Submit"})})]})},Ko=Zo,Xo=e=>{let{isOpen:s,onClose:t,title:a,children:r}=e;return s?(0,te.jsx)("div",{className:"modal modal-open",children:(0,te.jsxs)("div",{className:"modal-box",children:[(0,te.jsx)("h3",{className:"font-bold text-lg",children:a}),(0,te.jsx)("div",{className:"py-4",children:r}),(0,te.jsx)("div",{className:"modal-action",children:(0,te.jsx)("button",{className:"btn",onClick:t,children:"Close"})})]})}):null},Qo={type:"object",properties:{title:{type:"string",title:"Title",default:""},description:{type:"string",title:"Description",default:null},type:{type:"string",title:"Type",default:"string",enum:["string","number","boolean","object","array","binary"]}}};function ec(e){let s=ss().cloneDeep(Qo);return"array"===e.type&&(e.items?s.properties.items=ec(e.items):s.properties.items=ss().cloneDeep(Qo)),"string"===e.type&&(s.properties.format={type:"string",title:"Format",default:null,enum:["date","email","file","uri","date-time","ipv4","ipv6","regex"]},"file"!==e.format&&(s.properties.enum={type:"array",title:"Enum",default:null,items:{type:"string"}})),e.type,s}function sc(e){let{value:s,onSubmit:t}=e;const[a,r]=(0,Y.useState)(s),n=ec(a);return(0,te.jsx)(Ko,{schema:n,initialValues:a,onChange:e=>{r(e)},onSubmit:t})}var tc=t(388),ac=t(59807),rc=t(81807),nc=t(78541),lc=t(14754);function ic(e,s){if(s.$ref)return(0,te.jsx)(ur.A,{size:16});switch(e){case"array":return(0,te.jsx)(Sa.A,{size:16});case"date-time":case"date":return(0,te.jsx)(At.A,{size:16});case"email":return(0,te.jsx)(tc.A,{size:16});case"uri":case"url":return(0,te.jsx)(ac.A,{size:16});case"number":return(0,te.jsx)(rc.A,{size:16});case"boolean":return(0,te.jsx)(nc.A,{size:16});case"object":return(0,te.jsx)(lc.A,{size:16});default:return(0,te.jsx)(It.A,{size:16})}}function oc(e){let{name:s,prop:t,schema:a,onEdit:r}=e;const n=Object.entries(t).filter((e=>{let[s]=e;return!["type","description","default","title","format","$ref","enum","items","properties","required"].includes(s)})),l=function(e){if("array"===e.type)return"array";if("string"===e.type){if("date-time"===e.format)return"date-time";if("date"===e.format)return"date";if("email"===e.format)return"email";if("uri"===e.format)return"uri";if("url"===e.format)return"url";if(e.$ref){const s=e.$ref.split("/");return s[s.length-2]}return"text"}return e.type}(t);return(0,te.jsx)("li",{className:"py-4",children:(0,te.jsxs)("div",{className:"flex flex-col space-y-2",children:[(0,te.jsx)("div",{className:"flex items-center justify-between",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("h5",{className:"font-semibold text-gray-900 me-2",children:t.title||s}),"  ("," ",ic(l,t),(0,te.jsx)("span",{className:"ml-1",children:l}),a.required&&a.required.includes(s)&&(0,te.jsx)("span",{className:"ml-2",children:", required"}),")"]})}),t.description&&(0,te.jsx)("p",{className:"text-sm text-gray-700",children:t.description}),void 0!==t.default&&(0,te.jsxs)("div",{className:"text-sm",children:[(0,te.jsx)("span",{className:"font-medium",children:"Default:"})," ",JSON.stringify(t.default)]}),t.enum&&(0,te.jsxs)("div",{className:"text-sm",children:[(0,te.jsx)("span",{className:"font-medium",children:"Options:"})," ",t.enum.join(", ")]}),t.items&&(0,te.jsx)("div",{className:"ps-6 border-s-4 border-gray-300",children:(0,te.jsx)(cc,{schema:t.items})}),t.properties&&(0,te.jsx)("div",{className:"ps-6 border-s-4 border-gray-300",children:(0,te.jsx)(cc,{schema:t})}),n.length>0&&(0,te.jsxs)("div",{className:"mt-2",children:[(0,te.jsx)("h4",{className:"text-sm font-medium text-gray-900",children:"Additional Properties:"}),(0,te.jsx)("ul",{className:"mt-1 space-y-1",children:n.map((e=>{let[s,t]=e;return(0,te.jsxs)("li",{className:"text-sm text-gray-600",children:[(0,te.jsxs)("span",{className:"font-medium",children:[s,":"]})," ",JSON.stringify(t)]},s)}))})]})]})},s)}function cc(e){let{schema:s,onEdit:t}=e;const[a,r]=(0,Y.useState)(null),n=(e,s)=>{r({name:e,prop:s})};return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("ul",{className:"ps-4 border-s-4 border-gray-300",children:Object.entries(s.properties||{}).map((e=>{let[a,r]=e;return(0,te.jsx)(oc,{name:a,prop:r,schema:s,onEdit:t?n:null},a)}))}),a&&(0,te.jsx)(Xo,{isOpen:!!a,onClose:()=>{r(null)},title:`Edit ${a.name}`,children:(0,te.jsx)(sc,{value:a.prop,onSubmit:e=>{t&&t(a.name,e),r(null)}})})]})}const dc=ra.Root,mc=ra.Trigger,uc=ra.Close,xc=ra.Portal,hc=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ra.Overlay,{className:ns("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s})}));hc.displayName=ra.Overlay.displayName;const pc=(0,ts.cva)("fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500",{variants:{side:{top:"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top",bottom:"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom",left:"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm",right:"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm"}},defaultVariants:{side:"right"}}),gc=Y.forwardRef(((e,s)=>{let{side:t="right",className:a,children:r,...n}=e;return(0,te.jsxs)(xc,{children:[(0,te.jsx)(hc,{}),(0,te.jsxs)(ra.Content,{ref:s,className:ns(pc({side:t}),a),...n,children:[r,(0,te.jsxs)(ra.Close,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary",children:[(0,te.jsx)(Ds.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})}));gc.displayName=ra.Content.displayName;const fc=e=>{let{className:s,...t}=e;return(0,te.jsx)("div",{className:ns("flex flex-col space-y-2 text-center sm:text-left",s),...t})};fc.displayName="SheetHeader";const vc=e=>{let{className:s,...t}=e;return(0,te.jsx)("div",{className:ns("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};vc.displayName="SheetFooter";const jc=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ra.Title,{ref:s,className:ns("text-lg font-semibold text-foreground",t),...a})}));jc.displayName=ra.Title.displayName;const bc=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(ra.Description,{ref:s,className:ns("text-sm text-muted-foreground",t),...a})}));function yc(e){let{entity:s}=e;const{app:t,updateApp:a}=vs();return(0,te.jsx)(cc,{schema:s,onEdit:(e,r)=>{s.properties[e]=r,t.entities[s.name]=s,a({entities:t.entities})}})}bc.displayName=ra.Description.displayName;const Nc=function(e){let{entity:s}=e;const{app:t,getEntitiesSDK:a}=vs(),{toast:r}=Un(),[n,l]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!0),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(!1),[j,b]=(0,Y.useState)(!1),y=a(),N=async()=>{o(!0);try{const e=await y[s.name].list();l(e)}catch(e){r({title:"Error",description:"Failed to load records",variant:"destructive"})}finally{o(!1)}};return(0,Y.useEffect)((()=>{N()}),[s]),(0,te.jsxs)("div",{className:"p-4 max-w-[1200px] mx-auto",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h2",{className:"text-2xl font-bold",children:s.name}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:s.description})]}),(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsxs)(Rs,{size:"sm",onClick:()=>{h(null),d(!0)},children:[(0,te.jsx)(ys.A,{className:"h-4 w-4 mr-2"}),"Add"]}),(0,te.jsx)(Qs,{type:"file",accept:".csv",className:"hidden",id:"csv-upload",onChange:async e=>{const t=e.target.files[0];if(t){g(!0);try{const e=await y[s.name].importEntities(t);"success"===e.status&&(r({title:"Import Successful",description:`Successfully imported ${e.n_entities_created} ${s.name} records`}),N())}catch(l){var a,n;r({title:"Import Failed",description:(null===(a=l.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||l.message,variant:"destructive"})}finally{g(!1),e.target.value=""}}},disabled:p}),(0,te.jsxs)(gr,{children:[(0,te.jsx)(fr,{asChild:!0,children:(0,te.jsxs)(Rs,{size:"sm",variant:"outline",children:[(0,te.jsx)(Ea.A,{className:"h-4 w-4"}),"Actions"]})}),(0,te.jsxs)(kr,{align:"end",children:[(0,te.jsxs)(_r,{onClick:()=>document.getElementById("csv-upload").click(),disabled:p,children:[p?(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,te.jsx)(fo.A,{className:"h-4 w-4 mr-2"}),"Import"]}),(0,te.jsxs)(_r,{onClick:async()=>{v(!0);try{const e=await y[s.name].list(),t=Object.keys(e[0]||{}),a=[t.join(","),...Object.values(e).map((e=>t.map((s=>{const t=e[s];let a;a="object"==typeof t&&null!==t?JSON.stringify(t):String(t||"");return`"${a.replace(/"/g,'""')}"`})).join(",")))],n=a.join("\n"),l=new Blob([n],{type:"text/csv"}),i=window.URL.createObjectURL(l),o=document.createElement("a");o.href=i,o.download=`${s.name}_export.csv`,document.body.appendChild(o),o.click(),document.body.removeChild(o),window.URL.revokeObjectURL(i),r({title:"Export Successful",description:"Successfully exported entities to CSV"})}catch(a){var e,t;r({title:"Export Failed",description:(null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message,variant:"destructive"})}finally{v(!1)}},disabled:f,children:[f?(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,te.jsx)(vo.A,{className:"h-4 w-4 mr-2"}),"Export"]}),(0,te.jsxs)(_r,{onClick:()=>u(!0),children:[(0,te.jsx)(vi.A,{className:"h-4 w-4 mr-2"}),"Schema"]}),(0,te.jsxs)(_r,{onClick:async()=>{if(window.confirm("Are you sure you want to delete all records? This cannot be undone.")){b(!0);try{await y[s.name].deleteMany({}),l([]),r({title:"Success",description:"All records deleted successfully"})}catch(a){var e,t;r({title:"Error",description:(null===(e=a.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.message)||a.message,variant:"destructive"})}finally{b(!1)}}},disabled:j||0===n.length,className:"text-red-500 hover:text-red-600 focus:text-red-600",children:[j?(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,te.jsx)(jo.A,{className:"h-4 w-4 mr-2"}),"Delete All"]})]})]})]})]}),(0,te.jsx)("div",{className:"border rounded-md",children:(0,te.jsx)(Wi,{className:"h-[600px] w-full",children:(0,te.jsx)("div",{className:"min-w-full",children:(0,te.jsxs)(Ia,{children:[(0,te.jsx)(La,{children:(0,te.jsxs)(Da,{children:[Object.keys(s.properties).map((e=>(0,te.jsx)(Pa,{className:"text-xs whitespace-nowrap",children:s.properties[e].title||e},e))),(0,te.jsx)(Pa,{className:"text-xs",children:"Actions"})]})}),(0,te.jsx)(Ta,{children:i?(0,te.jsx)(Da,{children:(0,te.jsxs)(Ma,{colSpan:Object.keys(s.properties).length+1,className:"text-center py-4",children:[(0,te.jsx)(Je.A,{className:"h-6 w-6 animate-spin mx-auto"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Loading records..."})]})}):0===n.length?(0,te.jsx)(Da,{children:(0,te.jsxs)(Ma,{colSpan:Object.keys(s.properties).length+1,className:"text-center py-8",children:[(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"No records found"}),(0,te.jsxs)(Rs,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>{h(null),d(!0)},children:[(0,te.jsx)(ys.A,{className:"h-4 w-4 mr-2"}),"Add your first record"]})]})}):n.map((e=>(0,te.jsxs)(Da,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>{h(e),d(!0)},children:[Object.keys(s.properties).map((s=>(0,te.jsx)(Ma,{className:"text-xs whitespace-nowrap overflow-hidden text-ellipsis",style:{maxWidth:"200px"},children:"object"==typeof e[s]?JSON.stringify(e[s]):String(e[s]||"")},s))),(0,te.jsx)(Ma,{className:"whitespace-nowrap",children:(0,te.jsx)("div",{className:"flex gap-1",children:(0,te.jsx)(Rs,{size:"xs",variant:"ghost",onClick:t=>{t.stopPropagation(),(async e=>{try{await y[s.name].delete(e.id),l(n.filter((s=>s.id!==e.id))),r({title:"Success",description:"Item deleted successfully"})}catch(i){var t,a;r({title:"Error",description:(null===(t=i.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||i.message,variant:"destructive"})}})(e)},className:"text-red-500 hover:text-red-600",children:(0,te.jsx)(jo.A,{className:"h-3 w-3"})})})})]},e.id)))})]})})})}),(0,te.jsx)(dc,{open:c,onOpenChange:d,children:(0,te.jsxs)(gc,{className:"w-[400px] overflow-y-auto",children:[(0,te.jsx)(fc,{children:(0,te.jsx)(jc,{children:x?`Edit ${s.name}`:`Add New ${s.name}`})}),(0,te.jsx)("div",{className:"py-4",children:(0,te.jsx)(Ko,{schema:s,onSubmit:x?async e=>{try{const t=await y[s.name].update(x.id,e);l(n.map((e=>e.id===x.id?t:e))),d(!1),h(null),r({title:"Success",description:"Item updated successfully"})}catch(i){var t,a;r({title:"Error",description:(null===(t=i.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||i.message,variant:"destructive"})}}:async e=>{try{const t=await y[s.name].create(e);l([...n,t]),d(!1),r({title:"Success",description:"New item created successfully"})}catch(i){var t,a;r({title:"Error",description:(null===(t=i.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.message)||i.message,variant:"destructive"})}},initialValues:x})})]})}),(0,te.jsx)(dc,{open:m,onOpenChange:u,children:(0,te.jsxs)(gc,{className:"w-[600px] overflow-y-auto",children:[(0,te.jsx)(fc,{children:(0,te.jsx)(jc,{children:"Schema Editor"})}),(0,te.jsx)("div",{className:"py-4",children:(0,te.jsx)(yc,{entity:s})})]})})]})};var wc=t(2737);const kc=e=>{let{isVisible:s,onCancel:t,onInviteSuccess:a}=e;const{user:r}=ne(),{app:n}=vs(),{toast:l}=Fr(),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)("user"),[m,u]=(0,Y.useState)(""),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)([]),f="free"===(null==r?void 0:r.subscription_tier),v=p.length>0?`https://${p[0].domain}`:Zt(n);(0,Y.useEffect)((()=>{(async()=>{if(s)try{const e=await ja.filter({app_id:n.id});g(e)}catch(m){}})()}),[s,n.id]);return(0,te.jsx)(na,{open:s,onOpenChange:t,children:(0,te.jsxs)(da,{className:"sm:max-w-[520px] p-0 overflow-hidden",children:[(0,te.jsx)("div",{className:"bg-gradient-to-br from-slate-50 to-slate-100/50 px-6 py-8",children:(0,te.jsx)(ma,{className:"space-y-3",children:(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)("div",{className:"p-2 bg-orange-100 rounded-xl",children:(0,te.jsx)(pa.A,{className:"w-5 h-5 text-orange-600"})}),(0,te.jsxs)("div",{children:[(0,te.jsx)(xa,{className:"text-2xl font-semibold text-slate-900",children:"Share Your App"}),(0,te.jsxs)(ha,{className:"text-slate-600 mt-1",children:["Give others access to ",n.name]})]})]})})}),(0,te.jsxs)("div",{className:"px-6 pb-6 space-y-8",children:[(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,te.jsx)(Tt.A,{className:"w-4 h-4 text-slate-500"}),(0,te.jsx)("h3",{className:"font-medium text-slate-900",children:"Public Access"})]}),(0,te.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4 border border-slate-200",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"Share URL"}),(0,te.jsxs)(Rs,{variant:"ghost",size:"sm",onClick:()=>{navigator.clipboard.writeText(v),l({title:"URL Copied",description:"App URL has been copied to clipboard"})},className:"h-8 px-3 text-xs text-slate-600 hover:text-orange-600 hover:bg-orange-50",children:[(0,te.jsx)(Ha.A,{className:"h-3 w-3 mr-1.5"}),"Copy"]})]}),(0,te.jsx)(Qs,{readOnly:!0,value:v,className:"bg-white border-slate-200 font-mono text-sm text-slate-600 focus:ring-orange-500 focus:border-orange-500"}),(0,te.jsx)("p",{className:"text-xs text-slate-500 mt-2",children:"Anyone with this link can access your app"})]})]}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,te.jsx)(Xs,{className:"w-full"})}),(0,te.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,te.jsx)("span",{className:"bg-white px-3 text-slate-500 font-medium",children:"or"})})]}),(0,te.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),u(""),i){h(!0);try{await pe.inviteUser(n.id,i,c),l({title:"Success",description:"Invitation sent successfully"}),a(),t()}catch(m){var s,r;const t=(null===(s=m.response)||void 0===s||null===(r=s.data)||void 0===r?void 0:r.detail)||m.message||"Failed to send invitation";u(t)}finally{h(!1)}}else u("Please enter an email address")},className:"space-y-6",children:[(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-3",children:[(0,te.jsx)(tc.A,{className:"w-4 h-4 text-slate-500"}),(0,te.jsx)("h3",{className:"font-medium text-slate-900",children:"Send Invitation"})]}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"email",className:"text-sm font-medium text-slate-700",children:"Email address"}),(0,te.jsx)(Qs,{id:"email",type:"email",placeholder:"colleague@company.com",value:i,onChange:e=>o(e.target.value),className:"h-11 border-slate-200 focus:ring-orange-500 focus:border-orange-500"})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"role",className:"text-sm font-medium text-slate-700",children:"Access level"}),(0,te.jsxs)(ut,{value:c,onValueChange:d,children:[(0,te.jsx)(pt,{id:"role",className:"h-11 border-slate-200 focus:ring-orange-500 focus:border-orange-500",children:(0,te.jsx)(ht,{placeholder:"Select access level"})}),(0,te.jsxs)(vt,{children:[(0,te.jsx)(bt,{value:"user",className:"py-3",children:(0,te.jsxs)("div",{className:"flex flex-col",children:[(0,te.jsx)("span",{className:"font-medium",children:"User"}),(0,te.jsx)("span",{className:"text-xs text-slate-500",children:"Can use the app"})]})}),(0,te.jsx)(bt,{value:"admin",disabled:f,className:"py-3",children:(0,te.jsxs)("div",{className:"flex flex-col",children:[(0,te.jsx)("span",{className:"font-medium",children:"Admin"}),(0,te.jsxs)("span",{className:"text-xs text-slate-500",children:["Can manage users and settings ",f&&"\u2022 Paid plans only"]})]})})]})]}),f&&(0,te.jsxs)("div",{className:"flex items-start gap-3 mt-3 p-4 bg-gradient-to-r from-orange-50 to-orange-50/50 border border-orange-200 rounded-xl",children:[(0,te.jsx)("div",{className:"p-1 bg-orange-100 rounded-full",children:(0,te.jsx)(Ke.A,{className:"h-3 w-3 text-orange-600"})}),(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsx)("p",{className:"text-sm text-orange-800 font-medium",children:"Admin access requires a paid plan"}),(0,te.jsx)(J.Link,{to:"/billing",className:"text-sm text-orange-600 hover:text-orange-700 font-medium hover:underline inline-flex items-center gap-1 mt-1",children:"Upgrade now \u2192"})]})]})]}),m&&(0,te.jsxs)("div",{className:"flex items-start gap-3 p-4 bg-red-50 border border-red-200 rounded-xl",children:[(0,te.jsx)("div",{className:"p-1 bg-red-100 rounded-full",children:(0,te.jsx)(Ke.A,{className:"h-3 w-3 text-red-600"})}),(0,te.jsx)("p",{className:"text-sm text-red-800 font-medium",children:m})]})]})]}),(0,te.jsxs)(ua,{className:"gap-3 pt-2",children:[(0,te.jsx)(Rs,{variant:"outline",type:"button",onClick:t,className:"h-11 px-6 border-slate-200 text-slate-700 hover:bg-slate-50",children:"Cancel"}),(0,te.jsx)(Rs,{type:"submit",disabled:x,className:"h-11 px-6 bg-orange-600 hover:bg-orange-700 text-white font-medium",children:x?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Sending..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(wc.A,{className:"w-4 h-4 mr-2"}),"Send Invitation"]})})]})]})]})]})})};function _c(e){let{entity:s}=e;const{app:t,updateApp:a}=vs();return(0,te.jsx)(cc,{schema:s,onEdit:(e,r)=>{s.properties[e]=r,t.user_entity=s,a({user_entity:t.user_entity})}})}function Sc(){const{user:e}=ne(),{app:s,getEntitiesSDK:t}=vs(),{toast:a}=Un(),r=(0,Z.Zp)(),[n,l]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!0),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(null),f=t(),v=async()=>{o(!0);try{let s=await f.User.list();!(null==e||!e.email)&&(e.email.endsWith("@base44.com")||e.email.endsWith("@wix.com"))||(s=s.filter((e=>!e.email.includes("@base44.com")&&!e.email.includes("@wix.com")))),l(s)}catch(s){a({title:"Error",description:"Failed to load users",variant:"destructive"})}finally{o(!1)}};(0,Y.useEffect)((()=>{v()}),[]);return(0,te.jsxs)("div",{className:"p-4 max-w-[1200px] mx-auto",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h2",{className:"text-2xl font-bold",children:"Users"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage users and their roles"})]}),(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsxs)(Rs,{size:"sm",onClick:()=>h(!0),children:[(0,te.jsx)(ys.A,{className:"h-4 w-4"}),"Invite User"]}),(0,te.jsxs)(Rs,{size:"sm",variant:"outline",onClick:()=>u(!0),children:[(0,te.jsx)(vi.A,{className:"h-4 w-4 mr-2"}),"Schema"]})]})]}),(0,te.jsx)("div",{className:"border rounded-md",children:(0,te.jsx)(Wi,{className:"h-[600px]",children:(0,te.jsxs)(Ia,{children:[(0,te.jsx)(La,{children:(0,te.jsxs)(Da,{children:[Object.keys(s.user_entity.properties).map((e=>(0,te.jsx)(Pa,{className:"text-xs whitespace-nowrap",children:s.user_entity.properties[e].title||e},e))),(0,te.jsx)(Pa,{className:"text-xs",children:"Actions"})]})}),(0,te.jsx)(Ta,{children:i?(0,te.jsx)(Da,{children:(0,te.jsxs)(Ma,{colSpan:Object.keys(s.user_entity.properties).length+1,className:"text-center py-4",children:[(0,te.jsx)(Je.A,{className:"h-6 w-6 animate-spin mx-auto"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"Loading users..."})]})}):0===n.length?(0,te.jsx)(Da,{children:(0,te.jsxs)(Ma,{colSpan:Object.keys(s.user_entity.properties).length+1,className:"text-center py-8",children:[(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"No users found"}),(0,te.jsxs)(Rs,{variant:"outline",size:"sm",className:"mt-2",onClick:()=>h(!0),children:[(0,te.jsx)(ys.A,{className:"h-4 w-4 mr-2"}),"Invite your first user"]})]})}):n.map((e=>(0,te.jsxs)(Da,{className:"cursor-pointer hover:bg-muted/50",onClick:()=>{g(e),d(!0)},children:[Object.keys(s.user_entity.properties).map((s=>(0,te.jsx)(Ma,{className:"text-xs whitespace-nowrap overflow-hidden text-ellipsis",style:{maxWidth:"200px"},children:"object"==typeof e[s]?JSON.stringify(e[s]):String(e[s]||"")},s))),(0,te.jsx)(Ma,{className:"whitespace-nowrap",children:(0,te.jsx)("div",{className:"flex gap-1",children:(0,te.jsx)(Rs,{size:"xs",variant:"ghost",onClick:s=>{s.stopPropagation(),(async e=>{try{await f.User.delete(e.id),l(n.filter((s=>s.id!==e.id))),a({title:"Success",description:"User removed successfully"})}catch(r){var s,t;a({title:"Error",description:(null===(s=r.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.message)||r.message,variant:"destructive"})}})(e)},className:"text-red-500 hover:text-red-600",children:(0,te.jsx)(jo.A,{className:"h-3 w-3"})})})})]},e.id)))})]})})}),(0,te.jsx)(dc,{open:c,onOpenChange:d,children:(0,te.jsxs)(gc,{className:"w-[400px] overflow-y-auto",children:[(0,te.jsx)(fc,{children:(0,te.jsx)(jc,{children:"Edit User"})}),(0,te.jsx)("div",{className:"py-4",children:(0,te.jsx)(Ko,{schema:s.user_entity,onSubmit:async s=>{try{if("admin"===s.role&&"admin"!==p.role&&"free"===e.subscription_tier)return void a({title:"Subscription Required",description:(0,te.jsxs)("div",{children:["Only paying users can make other users admins.",(0,te.jsx)(Rs,{variant:"link",className:"p-0 h-auto font-semibold underline",onClick:()=>r("/billing"),children:"Upgrade your subscription"}),"to continue."]}),variant:"destructive"});const t=await f.User.update(p.id,s);l(n.map((e=>e.id===p.id?t:e))),d(!1),g(null),a({title:"Success",description:"User updated successfully"})}catch(o){var t,i;a({title:"Error",description:(null===(t=o.response)||void 0===t||null===(i=t.data)||void 0===i?void 0:i.message)||o.message,variant:"destructive"})}},initialValues:p,uiSchema:{email:{"ui:widget":"hidden"},full_name:{"ui:widget":"hidden"}}})})]})}),(0,te.jsx)(kc,{isVisible:x,onCancel:()=>h(!1),onInviteSuccess:v}),(0,te.jsx)(dc,{open:m,onOpenChange:u,children:(0,te.jsxs)(gc,{className:"w-[600px] overflow-y-auto",children:[(0,te.jsx)(fc,{children:(0,te.jsx)(jc,{children:"User Schema Editor"})}),(0,te.jsx)("div",{className:"py-4",children:(0,te.jsx)(_c,{entity:s.user_entity})})]})})]})}var Cc=t(23198);function Ac(){const{app:e}=vs(),{toast:s}=Un(),[t,a]=(0,Y.useState)(!1),[r,n]=(0,Y.useState)(!1),[l,i]=(0,Y.useState)(e.logo_prompt||"A modern, minimalist logo for a business app");return(0,te.jsxs)("div",{className:"p-8 space-y-8",children:[(0,te.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"App Logo"}),(0,te.jsxs)("div",{className:"space-y-6",children:[e.logo_url&&(0,te.jsx)("div",{className:"flex justify-center",children:(0,te.jsx)(Vs,{className:"w-32 h-32 overflow-hidden",children:(0,te.jsx)("img",{src:e.logo_url,alt:"App Logo",className:"w-full h-full object-cover"})})}),(0,te.jsxs)(lr,{defaultValue:"upload",className:"w-full",children:[(0,te.jsxs)(ir,{className:"grid w-full grid-cols-2",children:[(0,te.jsx)(or,{value:"upload",children:"Upload Logo"}),(0,te.jsx)(or,{value:"generate",children:"Generate Logo"})]}),(0,te.jsxs)(cr,{value:"upload",className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex flex-col items-center justify-center border-2 border-dashed rounded-lg p-8 hover:border-primary/50 transition-colors",children:[(0,te.jsx)("input",{type:"file",id:"logo-upload",className:"hidden",accept:"image/*",onChange:async t=>{const a=t.target.files[0];if(a)try{n(!0);const t=(await bs.uploadAppFile(a,e.id)).url;await pe.updateLogo(e.id,{logo_url:t}),s({title:"Success",description:"Logo uploaded successfully"})}catch(r){s({title:"Error",description:"Failed to upload logo",variant:"destructive"})}finally{n(!1)}}}),(0,te.jsxs)("label",{htmlFor:"logo-upload",className:"cursor-pointer text-center",children:[(0,te.jsx)(zo.A,{className:"h-8 w-8 mb-2 mx-auto text-muted-foreground"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Click to upload or drag and drop"}),(0,te.jsx)("p",{className:"text-xs text-muted-foreground",children:"PNG, JPG up to 5MB"})]})]}),(0,te.jsx)(Rs,{disabled:r,className:"w-full",onClick:()=>document.getElementById("logo-upload").click(),children:r?"Uploading...":"Select Image"})]}),(0,te.jsxs)(cr,{value:"generate",className:"space-y-4",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"logo-prompt",children:"Logo Generation Prompt"}),(0,te.jsx)(Ui,{id:"logo-prompt",value:l,onChange:e=>i(e.target.value),className:"min-h-[100px]",placeholder:"Describe how you want your logo to look"})]}),(0,te.jsxs)(Rs,{onClick:async()=>{try{a(!0),await pe.updateLogo(e.id,{prompt:l}),s({title:"Success",description:"Logo regenerated successfully"})}catch(t){s({title:"Error",description:"Failed to regenerate logo",variant:"destructive"})}finally{a(!1)}},disabled:t,className:"w-full",children:[(0,te.jsx)(Cc.A,{className:"mr-2 h-4 w-4"}),t?"Generating...":"Generate New Logo"]})]})]})]})]})}const Ec=new class extends Us{getBaseURL(){return"/app-catalog-items"}async getListingIfExists(e){const s=await this.filter({app_id:e});return s.length>0?s[0]:null}};var Ic=t(67777);const Lc=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Ic.bL,{className:ns("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:(0,te.jsx)(Ic.zi,{className:ns("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})}));Lc.displayName=Ic.bL.displayName;var Tc=t(84814),$c=t(66987),Dc=t(35254),Pc=t.n(Dc),Mc=(t(17687),t(7082));const Oc=e=>e&&"string"==typeof e?Mc.A.sanitize(e,{ALLOWED_TAGS:["p","br","strong","b","em","i","u","s","ol","ul","li","blockquote","h1","h2","h3","a","code","pre"],ALLOWED_ATTR:["href","target","rel"],ALLOWED_URI_REGEXP:/^(?:(?:https?|mailto):|[^a-z]|[a-z+.-]+(?:[^a-z+.-:]|$))/i,ALLOW_DATA_ATTR:!1,FORBID_SCRIPT:!0,FORBID_TAGS:["script","object","embed","iframe","form","input","button","svg","math","link","meta","style"],FORBID_ATTR:["onerror","onload","onclick","onmouseover","onfocus","onblur","onkeyup","onkeydown","onchange","onsubmit","onreset","onselect","onabort","style","cite"],KEEP_CONTENT:!0,RETURN_DOM:!1,RETURN_DOM_FRAGMENT:!1,RETURN_DOM_IMPORT:!1,SANITIZE_DOM:!0,HOOKS:{beforeSanitizeElements:e=>e}}):"",Rc=(0,Y.createContext)(),Fc=e=>{let{children:s}=e;const{appId:t}=(0,Z.g)(),[a,r]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(!0),[c,d]=(0,Y.useState)(null),m=async()=>{if(t){o(!0);try{const e=await pe.get(t);r(e);try{const e=await Ec.getListingIfExists(t);l(e)}catch(s){l(null)}}catch(s){var e;d(s),403===(null==s||null===(e=s.response)||void 0===e?void 0:e.status)&&d(new Error("You do not have access to this app"))}finally{o(!1)}}};(0,Y.useEffect)((()=>{m()}),[t]);const u={app:a,listing:n,isLoading:i,error:c,hasListing:!(null==n||!n.id||null!=n&&n.archived),createOrUpdateListing:async e=>{if(null!=n&&n.id){const s=await Ec.update(n.id,e);return l(s),s}{const s=await Ec.create({...e,app_id:t});return l(s),s}},refetch:()=>{m()}};return(0,te.jsx)(Rc.Provider,{value:u,children:s})},zc=()=>{const e=(0,Y.useContext)(Rc);if(!e)throw new Error("useAppListing must be used within an AppListingProvider");return e},Uc=["Marketing & Sales","Operations","Data & Analytics","Content Generation","HR & Legal","Finance","Education","Community","Lifestyle & Hobbies","Games & Entertainment"],Bc=e=>e&&Array.isArray(e)?e.filter((e=>Uc.includes(e))):[],Wc=(e,s)=>`app_listing_autosave_${e}_${s||"new"}`,qc=(e,s,t)=>{try{const a=Wc(e,s),r={...t,timestamp:Date.now()};localStorage.setItem(a,JSON.stringify(r))}catch(a){}},Vc=(e,s)=>{try{const t=Wc(e,s),a=localStorage.getItem(t);if(a){const e=JSON.parse(a);if(Date.now()-e.timestamp<6048e5){const{timestamp:s,...t}=e;return t}}return null}catch(t){return null}},Yc=(e,s)=>{try{const t=Wc(e,s);localStorage.removeItem(t)}catch(t){}},Hc="\n    .prose-editor .quill {\n        border: 1px solid hsl(var(--border));\n        border-radius: calc(var(--radius) - 2px);\n        background: hsl(var(--background));\n        width: 100%;\n        max-width: 100%;\n        overflow: hidden;\n    }\n    .prose-editor .ql-toolbar {\n        border: none;\n        border-bottom: 1px solid hsl(var(--border));\n        background: hsl(var(--muted) / 0.3);\n        border-radius: calc(var(--radius) - 2px) calc(var(--radius) - 2px) 0 0;\n        flex-wrap: wrap;\n    }\n    .prose-editor .ql-container {\n        border: none;\n        font-family: inherit;\n        width: 100%;\n        max-width: 100%;\n    }\n    .prose-editor .ql-editor {\n        min-height: 150px;\n        font-size: 0.875rem;\n        line-height: 1.5rem;\n        width: 100%;\n        max-width: 100%;\n        word-wrap: break-word;\n        overflow-wrap: break-word;\n    }\n    .prose-editor .ql-editor.ql-blank::before {\n        color: hsl(var(--muted-foreground));\n        font-style: normal;\n    }\n    .prose-editor .ql-editor p {\n        margin-bottom: 0.75rem;\n    }\n    .prose-editor .ql-editor p:last-child {\n        margin-bottom: 0;\n    }\n    .prose-editor .ql-toolbar button:hover {\n        background: hsl(var(--accent));\n    }\n    .prose-editor .ql-toolbar button.ql-active {\n        background: hsl(var(--accent));\n        color: hsl(var(--accent-foreground));\n    }\n";function Gc(e){let{listingId:s,listing:t,onSave:a,onRouteChange:r,app:n}=e;const l=(0,Y.useRef)(null),[i,o]=(0,Y.useState)(t||null),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(!1),[j,b]=(0,Y.useState)(null),[y,N]=(0,Y.useState)(null),[w,k]=(0,Y.useState)(!1),[_,S]=(0,Y.useState)(!1),[C,A]=(0,Y.useState)(null),[E,I]=(0,Y.useState)(!1),L=(0,Y.useRef)(null),T=(0,Y.useRef)(null),[$,D]=(0,Y.useState)({name:"",description:"",screenshot_urls:[],categories:[],is_private:!1}),P=(0,Y.useCallback)((e=>{null!=n&&n.id&&(S(!0),qc(n.id,s,e),A(new Date),setTimeout((()=>S(!1)),500))}),[null==n?void 0:n.id,s]),M=(0,Y.useCallback)((e=>{L.current&&clearTimeout(L.current),L.current=setTimeout((()=>{P(e)}),1e3)}),[P]);(0,Y.useEffect)((()=>{if(s&&!t)(async()=>{try{d(!0);const e=await Ec.get(s);o(e);const t=null!=n&&n.id?Vc(n.id,s):null;if(t){if(D({...t,categories:Bc(t.categories||[])}),v(!0),!E){I(!0);const e=zn({title:"Draft Restored",description:"Your unsaved changes have been restored from a previous session",variant:"default"});T.current=e}}else D({name:e.name||"",description:Oc(e.description||""),screenshot_urls:e.screenshot_urls||[],categories:Bc(e.categories||[]),is_private:e.is_private||!1})}catch(e){u(e),zn({title:"Error",description:"Failed to load listing",variant:"destructive"})}finally{d(!1)}})();else if(t){const e=null!=n&&n.id?Vc(n.id,s):null;if(e){if(D({...e,categories:Bc(e.categories||[])}),v(!0),!E){I(!0);const e=zn({title:"Draft Restored",description:"Your unsaved changes have been restored from a previous session",variant:"default"});T.current=e}}else D({name:t.name||"",description:Oc(t.description||""),screenshot_urls:t.screenshot_urls||[],categories:Bc(t.categories||[]),is_private:t.is_private||!1,archived:!1})}}),[s,t,null==n?void 0:n.id,E]),(0,Y.useEffect)((()=>{l.current&&l.current.scrollIntoView({behavior:"smooth",block:"start"})}),[]),(0,Y.useEffect)((()=>()=>{L.current&&clearTimeout(L.current),T.current&&T.current.dismiss()}),[]);const O=(e,s)=>{const t="description"===e?Oc(s):s;D((s=>{const a={...s,[e]:t};return M(a),a})),v(!0)},R=async()=>{h(!0),k(!1),T.current&&(T.current.dismiss(),T.current=null);try{let e;if(a)e=await a($);else{if(!(null!=i&&i.id||s))throw new Error("No save handler provided for new listing");e=await Ec.update((null==i?void 0:i.id)||s,$)}o(e),v(!1),null!=n&&n.id&&Yc(n.id,s),r("main"),zn({title:"Success",description:null!=i&&i.id?"Listing updated successfully":"Listing created successfully"})}catch(m){zn({title:"Error",description:m.message||"Failed to save listing",variant:"destructive"})}finally{h(!1)}},F=(0,Y.useCallback)((async e=>{if($.screenshot_urls.length>7)return void zn({title:"Error",description:"Maximum of 7 screenshots allowed",variant:"destructive"});if(["image/jpeg","image/jpg","image/png","image/webp"].includes(e.type))if(e.size>5242880)zn({title:"Error",description:"Image size must be less than 5MB",variant:"destructive"});else{g(!0);try{const s=await bs.uploadAppFile(e,n.id),t=s.url||s.file_url||s;D((e=>{const s={...e,screenshot_urls:[...e.screenshot_urls,t]};return M(s),v(!0),s})),zn({title:"Success",description:"Screenshot uploaded successfully"})}catch(m){zn({title:"Error",description:"Failed to upload screenshot",variant:"destructive"})}finally{g(!1)}}else zn({title:"Error",description:"Only JPEG, JPG, and PNG files are allowed",variant:"destructive"})}),[$.screenshot_urls.length,M]);(0,Y.useEffect)((()=>{const e=async e=>{var s;const t=null===(s=e.clipboardData)||void 0===s?void 0:s.items;if(t)for(const a of t)if(-1!==a.type.indexOf("image")){e.preventDefault();const s=a.getAsFile();s&&await F(s)}};return document.addEventListener("paste",e),()=>document.removeEventListener("paste",e)}),[F]);const z=()=>{N(null)},U=(e,s)=>{e.preventDefault(),null!==j&&j!==s&&((e,s)=>{const t=[...$.screenshot_urls],[a]=t.splice(e,1);t.splice(s,0,a),O("screenshot_urls",t)})(j,s),b(null),N(null)},B=()=>{b(null),N(null)};if(c)return(0,te.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,te.jsx)("div",{className:"text-muted-foreground",children:"Loading listing..."})});if(m)return(0,te.jsx)("div",{className:"flex items-center justify-center min-h-[400px]",children:(0,te.jsxs)("div",{className:"text-red-600",children:["Error: ",m.message]})});const W=!(null!=i&&i.id||s);return(0,te.jsxs)("div",{ref:l,className:"w-full",children:[(0,te.jsxs)("div",{className:"sticky top-0 z-10 bg-slate-50 py-4 mb-4",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mb-4",children:[(0,te.jsx)("button",{onClick:()=>r("main"),className:"hover:text-foreground hover:underline transition-colors cursor-pointer",children:"App Settings"}),(0,te.jsx)("span",{children:"/"}),(0,te.jsx)("span",{className:"transition-colors",children:"App Templates Listing"})]}),(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-start gap-4 w-full",children:[(0,te.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,te.jsx)("h2",{className:"text-xl sm:text-2xl font-semibold text-gray-800 truncate",children:W?"Create Listing":"Manage Listing"}),(0,te.jsx)("div",{className:"flex items-center gap-3 mt-1",children:(0,te.jsx)("p",{className:"text-muted-foreground text-sm sm:text-base",children:W?"Create your app's template listing":"Update your app's template listing"})})]}),(0,te.jsx)("div",{className:"flex-shrink-0",children:(0,te.jsxs)("div",{className:"flex items-center gap-2 sm:gap-3",children:[(0,te.jsx)(Rs,{onClick:()=>r("main"),variant:"outline",className:"border-gray-200 hover:bg-gray-50 hover:text-gray-700 h-8 px-2 sm:px-3 py-1 text-sm",children:"Cancel"}),(0,te.jsx)(Rs,{onClick:async()=>{W||"approved"!==(null==i?void 0:i.status)&&"rejected"!==(null==i?void 0:i.status)?await R():k(!0)},disabled:!f&&!W&&!(null!=i&&i.archived)||x||0===$.screenshot_urls.length||0===$.categories.length,className:"bg-gray-900 hover:bg-gray-500 text-white h-8 px-2 sm:px-3 py-1 text-sm whitespace-nowrap",children:x?"Saving...":W?"Create Listing":"Update Listing"})]})})]})]}),(0,te.jsx)("style",{dangerouslySetInnerHTML:{__html:Hc}}),(0,te.jsxs)("div",{className:"space-y-4 w-full max-w-full overflow-hidden",children:[(0,te.jsxs)(Vs,{className:"border-none rounded-[12px]",children:[(0,te.jsx)(Ys,{className:"py-4 px-6",children:(0,te.jsx)(Hs,{className:"text-sm font-medium",children:"App Info"})}),(0,te.jsx)(Xs,{}),(0,te.jsxs)(Js,{className:"space-y-6 pt-6",children:[(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsxs)(at,{htmlFor:"name",className:"text-sm font-medium",children:["App Name",(0,te.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,te.jsx)(Qs,{id:"name",value:$.name,onChange:e=>O("name",e.target.value),placeholder:"Enter your app name",className:"max-w-md"})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsxs)(at,{htmlFor:"description",className:"text-sm font-medium",children:["App Description",(0,te.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Tell users what makes your app worth trying."}),(0,te.jsx)("div",{className:"prose-editor w-full max-w-full pt-2",children:(0,te.jsx)(Pc(),{theme:"snow",value:$.description,onChange:e=>O("description",e),placeholder:"Describe what your app does...",modules:{toolbar:[[{header:[1,2,3,!1]}],["bold","italic","underline","strike"],[{list:"ordered"},{list:"bullet"}],["blockquote","code-block"],["link"],["clean"]]},className:"bg-white rounded-md w-full",style:{minHeight:"150px",maxWidth:"100%"}})})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsxs)(at,{children:["Categories",(0,te.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,te.jsxs)("span",{className:"text-sm text-muted-foreground",children:["(",$.categories.length," selected)"]})]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Select categories that best describe your app to help users discover it"}),(0,te.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-x-3 gap-y-2 py-3",children:Uc.map((e=>(0,te.jsxs)("div",{className:"flex items-center space-x-2 min-w-0",children:[(0,te.jsx)(zi,{id:`category-${e}`,checked:$.categories.includes(e),onCheckedChange:()=>(e=>{D((s=>{const t=s.categories.includes(e)?s.categories.filter((s=>s!==e)):[...s.categories,e],a={...s,categories:t};return M(a),v(!0),a}))})(e),className:"flex-shrink-0 shadow-sm border-slate-200"}),(0,te.jsx)(at,{htmlFor:`category-${e}`,className:"text-sm font-normal cursor-pointer truncate",children:e})]},e)))}),0===$.categories.length&&(0,te.jsx)("p",{className:"text-sm text-orange-600",children:"At least one category is required"})]}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{children:[(0,te.jsxs)(at,{children:["Screenshots",(0,te.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Add screenshots to your listing to help users understand what your app does (JPG, PNG, WEBP, 5MB max)"})]}),(null==n?void 0:n.slug)&&(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>window.open(null!=n&&n.slug?"localhost"===window.location.hostname?`http://${n.slug}.localhost:3000`:window.location.hostname.includes("base44.io")||window.location.hostname.includes("beta-base44")?`https://${n.slug}.base44.io`:window.location.hostname.includes("ba11.me")?`https://${n.slug}.ba11.me`:window.location.hostname.includes("ba22.me")?`https://${n.slug}.ba22.me`:window.location.hostname.includes("ba33.me")?`https://${n.slug}.ba33.me`:`https://${n.slug}.base44.app`:"","_blank"),className:"flex items-center gap-2 border-gray-200 hover:bg-gray-50 hover:text-gray-700 h-7",children:[(0,te.jsx)("span",{children:"Preview App"}),(0,te.jsx)(ur.A,{className:"w-3 h-3"})]})]}),(0,te.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[$.screenshot_urls.map(((e,s)=>(0,te.jsxs)("div",{className:`relative group cursor-move min-w-0 ${j===s?"opacity-50":""} ${y===s?"ring-2 ring-orange-400 ring-offset-2":""}`,draggable:!0,onDragStart:e=>((e,s)=>{b(s),e.dataTransfer.effectAllowed="move",e.dataTransfer.setData("text/html",e.target.outerHTML),e.dataTransfer.setDragImage(e.target,e.target.offsetWidth/2,e.target.offsetHeight/2)})(e,s),onDragOver:e=>((e,s)=>{e.preventDefault(),e.dataTransfer.dropEffect="move",N(s)})(e,s),onDragLeave:z,onDrop:e=>U(e,s),onDragEnd:B,children:[0===s&&(0,te.jsx)("div",{className:"absolute top-2 left-2 z-10 bg-orange-500 text-white text-xs px-2 py-1 rounded font-medium shadow-sm",children:"Primary"}),(0,te.jsx)("img",{src:e,alt:`Screenshot ${s+1}`,className:"w-full h-32 object-cover rounded-lg border shadow-sm",onError:e=>{e.target.src="/placeholder.png",e.target.onerror=null}}),(0,te.jsx)("div",{className:"absolute inset-0 opacity-0 group-hover:opacity-100 transition-opacity rounded-lg",children:(0,te.jsx)(Rs,{size:"sm",variant:"destructive",onClick:()=>(e=>{const s=$.screenshot_urls.filter(((s,t)=>t!==e));O("screenshot_urls",s)})(s),className:"absolute bottom-2 right-2 h-8 w-8 p-0 bg-red-500 hover:bg-red-600 text-white shadow-lg",children:(0,te.jsx)(Tc.A,{className:"h-4 w-4"})})}),(0,te.jsx)("div",{className:"absolute top-2 right-2 opacity-0 group-hover:opacity-90 transition-opacity",children:(0,te.jsx)("div",{className:"text-white text-xs bg-black/70 px-2 py-1 rounded",children:"Drag to reorder"})})]},s))),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Qs,{type:"file",accept:".jpg,.jpeg,.png,image/jpeg,image/png",multiple:!0,onChange:async e=>{const s=e.target.files;if(s&&0!==s.length)for(const t of s)await F(t)},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",disabled:p||$.screenshot_urls.length>=7}),(0,te.jsx)("div",{className:"w-full h-32 rounded-lg border-2 border-dashed border-gray-300 flex flex-col items-center justify-center transition-colors "+($.screenshot_urls.length>=7?"bg-gray-100 cursor-not-allowed":"bg-gray-50 hover:bg-gray-100 cursor-pointer"),children:p?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($c.A,{className:"w-6 h-6 text-gray-400 animate-spin mb-2"}),(0,te.jsx)("span",{className:"text-sm text-gray-500",children:"Uploading..."})]}):$.screenshot_urls.length>=7?(0,te.jsx)(te.Fragment,{children:(0,te.jsx)("span",{className:"text-sm text-gray-500",children:"Maximum screenshots reached (7)"})}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(ys.A,{className:"w-6 h-6 text-gray-400 mb-2"}),(0,te.jsx)("span",{className:"text-sm text-gray-500",children:"Add Screenshot"})]})})]})]}),(0,te.jsx)("div",{className:"rounded-lg bg-slate-50 p-3 flex items-center gap-2",children:(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"Tip: You can paste screenshots directly from your clipboard (Ctrl/Cmd + V) or drag and drop images to reorder them"})}),0===$.screenshot_urls.length&&(0,te.jsx)("p",{className:"text-sm text-orange-600",children:"At least one screenshot is required for your listing"})]})]})]}),(0,te.jsxs)(Vs,{className:"border-none rounded-[12px]",children:[(0,te.jsx)(Ys,{className:"py-4 px-6",children:(0,te.jsx)(Hs,{className:"text-sm font-medium",children:"Settings"})}),(0,te.jsx)(Xs,{className:"mb-4"}),(0,te.jsx)(Js,{className:"space-y-6",children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)(at,{htmlFor:"is_private",className:"text-sm font-medium",children:"Visible to Everyone"}),(0,te.jsx)("p",{className:"text-sm text-regular text-muted-foreground",children:"Make your listing public and discoverable by others"})]}),(0,te.jsx)(Lc,{id:"is_private",checked:!$.is_private,onCheckedChange:e=>O("is_private",!e)})]})})]})]}),(0,te.jsx)(na,{open:w,onOpenChange:k,children:(0,te.jsxs)(da,{className:"sm:max-w-md",children:[(0,te.jsxs)(ma,{children:[(0,te.jsx)(xa,{children:"Attention"}),(0,te.jsx)(ha,{children:"approved"===(null==i?void 0:i.status)?"Making changes to your app will require re-approval before it appears in the catalog again":"rejected"===(null==i?void 0:i.status)?"Your app will be reviewed again for approval":""})]}),(0,te.jsxs)(ua,{className:"flex gap-2",children:[(0,te.jsx)(Rs,{variant:"outline",onClick:()=>k(!1),disabled:x,children:"Cancel"}),(0,te.jsx)(Rs,{onClick:R,disabled:x,className:"bg-gray-900 hover:bg-gray-500 text-white",children:x?"Saving...":"Continue"})]})]})})]})}function Jc(e){let{onRouteChange:s}=e;const{app:t,listing:a,isLoading:r,error:n,createOrUpdateListing:l}=zc();return r?(0,te.jsx)("div",{className:"p-6",children:"Loading..."}):n?(0,te.jsxs)("div",{className:"p-6 text-red-600",children:["Error: ",n.message]}):(0,te.jsx)(Gc,{listingId:null==a?void 0:a.id,onRouteChange:s,onSave:l,app:t,listing:a||{name:(null==t?void 0:t.name)||"",description:Oc((null==t?void 0:t.user_description)||"<p></p>"),screenshot_urls:[],categories:Bc((null==t?void 0:t.categories)||[]),is_private:!1}})}var Zc=t(15924),Kc=t(85354);function Xc(){const{app:e}=vs(),{user:s}=ne(),{workspaces:t}=xe(),[a,r]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(!0);return(0,Y.useEffect)((()=>{(()=>{if(!e.organization_id||!t||!s)return r(!1),void l(!1);const a=t.find((s=>s.id===e.organization_id));if(!a)return r(!1),void l(!1);const n=!a.is_personal&&a.id!==s.personal_organization_id;r(n),l(!1)})()}),[e.organization_id,t,s]),{isInSharedWorkspace:a,isLoading:n}}const Qc=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsx)(ot.q7,{ref:s,className:ns("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-3 pr-2 text-sm outline-none focus:bg-slate-100 focus:text-slate-900 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:(0,te.jsx)(ot.p4,{children:a})})}));Qc.displayName="SelectItemNoCheck";const ed=e=>{let{options:s=[],value:t,onValueChange:a,placeholder:r="Select option",disabled:n=!1,className:l}=e;const i=s.find((e=>e.value===t));return(0,te.jsxs)(pl,{value:t,onValueChange:a,disabled:n,children:[(0,te.jsx)(fl,{className:ns("w-full h-10 px-3 py-2 text-sm","border border-slate-200 rounded-md","bg-white","hover:border-slate-300","focus:border-slate-400 focus:ring-1 focus:ring-slate-400","disabled:bg-slate-50 disabled:text-slate-400 disabled:cursor-not-allowed","transition-colors duration-200",l),children:(0,te.jsx)(gl,{children:i?(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[i.icon&&(0,te.jsx)(i.icon,{className:"w-4 h-4 flex-shrink-0 text-slate-500"}),(0,te.jsx)("span",{className:"truncate text-sm font-medium text-slate-900",children:i.label})]}):(0,te.jsx)("span",{className:"text-slate-400 text-sm",children:r})})}),(0,te.jsx)(bl,{className:"bg-white border border-slate-200 rounded-md shadow-lg",children:s.map((e=>(0,te.jsx)(Qc,{value:e.value,className:ns("py-2 cursor-pointer","hover:bg-slate-50 focus:bg-slate-50","data-[state=checked]:bg-slate-100"),children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[e.icon&&(0,te.jsx)(e.icon,{className:"w-4 h-4 flex-shrink-0 text-slate-500"}),(0,te.jsx)("span",{className:"text-sm font-medium text-slate-900",children:e.label})]})},e.value)))})]})},sd=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Fi.bL,{ref:s,className:ns("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...a,children:(0,te.jsx)(Fi.C1,{className:ns("flex items-center justify-center text-current"),children:(0,te.jsx)(mt.A,{className:"h-4 w-4"})})})}));sd.displayName=Fi.bL.displayName;const td=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(st.b,{ref:s,className:ns("text-regular text-sm leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",t),...a})}));td.displayName=st.b.displayName;const ad=e=>{let{checked:s,onCheckedChange:t,label:a,disabled:r=!1,className:n,checkboxClassName:l,labelClassName:i}=e;return(0,te.jsxs)("div",{className:ns("flex items-center space-x-2",!r&&"hover:opacity-70 cursor-pointer",r&&"cursor-not-allowed","transition-opacity duration-200",n),onClick:()=>{!r&&t&&t(!s)},children:[(0,te.jsx)(sd,{checked:s,onCheckedChange:()=>{},disabled:r,className:ns("h-4 w-4","border-slate-300 rounded-sm","data-[state=checked]:bg-slate-900 data-[state=checked]:border-slate-900","data-[state=checked]:text-white","focus-visible:ring-2 focus-visible:ring-slate-400 focus-visible:ring-offset-2","disabled:opacity-50","transition-colors duration-200","pointer-events-none",l)}),(0,te.jsx)(td,{className:ns("text-sm text-slate-700","font-normal","select-none","peer-disabled:opacity-50","pointer-events-none",i),children:a})]})},rd=e=>[{value:"private",label:"Private",icon:Ls.A},...e?[{value:"workspace",label:"Workspace",icon:Wa.A}]:[],{value:"public",label:"Public",icon:Tt.A}];function nd(e,s){return"private"===e?"private_with_login":"workspace"===e?"workspace_with_login":"public"===e?s?"public_with_login":"public_without_login":"private_with_login"}function ld(e){let{value:s,onValueChange:t,disabled:a=!1,showWorkspace:r=!0,className:n}=e;const l=function(e){switch(e){case"private_with_login":default:return"private";case"workspace_with_login":return"workspace";case"public_with_login":case"public_without_login":return"public"}}(s),i="public_without_login"!==s;const o=rd(r),c=a||"public"!==l;return(0,te.jsxs)("div",{className:ns("space-y-2",n),children:[(0,te.jsx)(ed,{options:o,value:l,onValueChange:e=>{const s=nd(e,"public"!==e||i);t(s)},disabled:a,placeholder:"Select visibility"}),(0,te.jsx)(ad,{checked:i,onCheckedChange:e=>{if("public"===l){const s=nd(l,e);t(s)}},disabled:c,label:"Require login to access"})]})}class id extends K.H{getBaseURL(){return"/apps"}activateBackendFunctions(e){return this.axios.post(`/${e}/activate-backend-functions`)}getBackendFunctionsLogs(e,s,t){return this.axios.get(`/${e}/functions/${s}/logs`,{params:t})}}const od=new id,cd=e=>(e=>e&&e.subscription_tier&&!["free","starter"].includes(e.subscription_tier))(e),dd=()=>(0,te.jsxs)(is,{variant:"warning",className:"bg-gray-50 border-gray-200",children:[(0,te.jsx)(Zc.A,{className:"h-4 w-4 text-gray-500"}),(0,te.jsx)(os,{className:"text-gray-800",children:"Premium Feature"}),(0,te.jsxs)(cs,{className:"text-gray-600",children:["Backend functions are available only for Builder tier and above.",(0,te.jsx)("a",{href:"/billing",className:"ml-1 underline font-medium text-gray-700 hover:text-gray-900",children:"Upgrade your plan"})," to unlock this feature."]})]});function md(e){let{className:s,...t}=e;return(0,te.jsx)("div",{className:ns("animate-pulse rounded-md bg-muted",s),...t})}function ud(e){let{onRouteChange:s}=e;const{hasListing:t,listing:a,isLoading:r,refetch:n}=zc(),[l,i]=(0,Y.useState)(!1);return r?(0,te.jsx)("div",{className:"space-y-4",children:(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[(0,te.jsxs)("div",{className:"flex-grow space-y-2",children:[(0,te.jsx)(md,{className:"h-4 w-20"}),(0,te.jsx)(md,{className:"h-3 w-full max-w-md"})]}),(0,te.jsx)(md,{className:"h-9 w-36"})]})}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row justify-between items-start gap-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"App Templates"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:t?"Manage your template listing":"Share your template with the community so others can discover and use it."})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsxs)(Rs,{onClick:()=>s("appListing"),variant:"outline",className:"flex items-center border-gray-200 hover:bg-gray-50 hover:text-gray-700 cursor-pointer",children:[(0,te.jsx)(Sa.A,{className:"mr-2 h-4 w-4"}),t?"Manage Listing":"Publish to App Templates"]}),t&&(0,te.jsxs)(gr,{children:[(0,te.jsx)(fr,{asChild:!0,children:(0,te.jsx)(Rs,{variant:"outline",className:"flex items-center border-gray-200 hover:bg-gray-50 hover:text-gray-700 cursor-pointer p-2",children:(0,te.jsx)(Ea.A,{})})}),(0,te.jsxs)(kr,{align:"end",children:[(0,te.jsx)(_r,{onClick:()=>window.open("/app-templates?category=my-apps","_blank"),children:"See on App Templates"}),(0,te.jsx)(_r,{onClick:async()=>{if(window.confirm("Are you sure you want to remove this listing? This action will remove it from the App templates.")){i(!0);try{await Ec.archiveItem(null==a?void 0:a.id,!(null!=a&&a.archived)),zn({title:"Success",description:"Listing removed from catalog successfully"}),await n()}catch(e){zn({title:"Error",description:e.message||"Failed to remove listing from catalog",variant:"destructive"})}finally{i(!1)}}},disabled:!t||l,className:"text-red-600 focus:text-red-600",children:l?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Removing..."]}):"Remove from App Templates"})]})]})]})]}),t&&a&&(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,te.jsx)("div",{className:"flex-shrink-0",children:(0,te.jsx)("div",{className:"w-20 h-20 sm:w-20 sm:h-20 rounded-lg overflow-hidden bg-white border border-slate-200 shadow-sm",children:a.screenshot_urls&&a.screenshot_urls[0]?(0,te.jsx)("img",{src:a.screenshot_urls[0],alt:`${a.name} screenshot`,className:"w-full h-full object-cover"}):(0,te.jsx)("div",{className:"w-full h-full flex items-center justify-center text-slate-400",children:(0,te.jsx)(Vi.A,{className:"w-6 h-6"})})})}),(0,te.jsx)("div",{className:"flex-grow min-w-0",children:(0,te.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-2",children:(0,te.jsxs)("div",{className:"min-w-0",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("h4",{className:"font-medium text-slate-900 truncate",children:a.name}),(0,te.jsx)("span",{className:"inline-flex items-center px-2.5 py-1 rounded-lg text-xs font-medium "+("approved"===a.status?"bg-teal-100 text-teal-800":"pending"===a.status?"bg-yellow-50 text-yellow-600 border border-yellow-200 rounded-[20px]":"bg-red-100 text-red-800"),children:a.status.charAt(0).toUpperCase()+a.status.slice(1)})]}),(0,te.jsx)("p",{className:"text-sm text-gray-500 mt-0.5",children:a.updated_date?new Date(a.updated_date).toLocaleString("en-US",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric"}):"Published to App Templates"}),"rejected"===a.status&&a.rejected_reason&&(0,te.jsxs)("p",{className:"text-xs bg-red-100 text-red-800 mt-1 rounded-lg p-2 font-medium",children:["Rejected Reason: ",a.rejected_reason]})]})})})]})]})}const xd=function(e){var s;let{onRouteChange:t}=e;const{user:a}=ne(),{app:r,updateApp:n}=vs(),{isInSharedWorkspace:l}=Xc(),i=(0,Z.Zp)(),o=(0,Z.zy)(),{toast:c}=Un(),[d,m]=(0,Y.useState)(!1),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,j]=(0,Y.useState)(!1),[b,y]=(0,Y.useState)(null),N=(0,Y.useRef)(null),w=(0,Y.useRef)(null),k=(0,Y.useRef)(null),_=(0,Y.useRef)(null),S=(0,Y.useRef)(null),C=(0,Y.useRef)(null),A=(0,Y.useRef)(null),E=(0,Y.useRef)(null),I=(0,Y.useRef)(null),L=cd(a);(0,Y.useEffect)((()=>{const e=new URLSearchParams(o.search).get("selectedParam");if(e){y(e);let s=null;switch(e){case"main-page":s=N;break;case"visibility":s=w;break;case"branding-badge":s=k;break;case"hide-created-by":s=_;break;case"enable-agents":s=S;break;case"clone-app":s=C;break;case"backend-functions":s=A;break;case"delete-app":s=E;break;case"admin-controls":s=I}s&&s.current&&setTimeout((()=>{s.current.scrollIntoView({behavior:"smooth",block:"center"})}),300)}}),[o.search]);const T=async()=>{try{await pe.delete(r.id),c({title:"Success",description:"App deleted successfully"}),i("/")}catch(e){c({title:"Error",description:"Failed to delete app",variant:"destructive"})}},$=e=>b===e?"selected-section p-4 rounded-md":"";return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("h2",{className:"text-2xl font-semibold text-gray-800 mb-6",children:"App Settings"}),(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsx)("style",{jsx:!0,global:!0,children:"\n                .selected-section {\n                    position: relative;\n                    border-left: 4px solid #334155;\n                    background-color: rgba(241, 245, 249, 0.7);\n                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);\n                    transition: all 0.4s ease;\n                    padding-left: 16px !important;\n                    padding-top: 14px !important;\n                    padding-bottom: 14px !important;\n                    margin: 4px 0 !important;\n                    border-radius: 4px;\n                }\n\n                /* Left border with animated glow */\n                .selected-section::before {\n                    content: '';\n                    position: absolute;\n                    left: -4px;\n                    top: 0;\n                    width: 4px;\n                    height: 100%;\n                    background: linear-gradient(to bottom, #0f766e, #334155);\n                    box-shadow: 0 0 12px rgba(15, 118, 110, 0.5);\n                    animation: border-pulse 2.5s infinite ease-in-out;\n                    z-index: 1;\n                }\n                \n                /* Light effect */\n                .selected-section::after {\n                    content: '';\n                    position: absolute;\n                    left: 0;\n                    top: 0;\n                    height: 100%;\n                    width: 100%;\n                    background: linear-gradient(to right, rgba(15, 118, 110, 0.08), transparent 50%);\n                    animation: light-pulse 2.5s infinite ease-in-out;\n                    pointer-events: none;\n                    border-radius: 4px;\n                }\n                \n                @keyframes border-pulse {\n                    0%, 100% {\n                        box-shadow: 0 0 8px rgba(15, 118, 110, 0.4);\n                    }\n                    50% {\n                        box-shadow: 0 0 20px rgba(15, 118, 110, 0.7);\n                    }\n                }\n                \n                @keyframes light-pulse {\n                    0%, 100% {\n                        opacity: 0.3;\n                        background: linear-gradient(to right, rgba(15, 118, 110, 0.05), transparent 50%);\n                    }\n                    50% {\n                        opacity: 0.7;\n                        background: linear-gradient(to right, rgba(15, 118, 110, 0.12), transparent 60%);\n                    }\n                }\n            "}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{className:"border-b border-gray-100",children:(0,te.jsx)(Hs,{className:"text-gray-800",children:"General Settings"})}),(0,te.jsxs)(Js,{className:"space-y-6 pt-6",children:[(0,te.jsxs)("div",{ref:N,className:`flex flex-col sm:flex-row justify-between sm:items-center gap-2 ${$("main-page")}`,children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"Main Page"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Set the default landing page for your app"})]}),(0,te.jsx)("div",{className:"w-full sm:w-64",children:(0,te.jsxs)(ut,{value:r.main_page||"",onValueChange:async e=>{try{n({main_page:e}),c({title:"Success",description:"Main page updated successfully"})}catch(s){c({title:"Error",description:"Failed to update main page",variant:"destructive"})}},children:[(0,te.jsx)(pt,{children:(0,te.jsx)(ht,{placeholder:"Select main page"})}),(0,te.jsx)(vt,{children:Object.keys(r.pages||{}).map((e=>(0,te.jsx)(bt,{value:e,children:e},e)))})]})})]}),(0,te.jsx)(Xs,{}),(0,te.jsxs)("div",{ref:w,className:`flex flex-col sm:flex-row justify-between sm:items-center gap-2 ${$("visibility")}`,children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"App Visibility"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Control who can access your application"})]}),(0,te.jsx)("div",{className:"w-full sm:w-64",children:(0,te.jsx)(ld,{value:r.public_settings||"private_with_login",onValueChange:async e=>{x(!0);try{await n({public_settings:e}),c({title:"Success",description:"App visibility updated successfully"})}catch(s){c({title:"Error",description:"Failed to update app visibility",variant:"destructive"})}finally{x(!1)}},disabled:u,showWorkspace:l})})]}),(0,te.jsx)(Xs,{}),(0,te.jsxs)("div",{ref:k,className:`flex flex-col sm:flex-row justify-between sm:items-center gap-2 ${$("platform-badge")}`,children:[(0,te.jsxs)("div",{className:"flex-grow space-y-1",children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"Platform Badge"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:'Show or hide the "Edit with Base44" badge on your app.'}),"free"===a.subscription_tier&&(0,te.jsxs)("p",{className:"text-xs text-orange-500 pt-1",children:[(0,te.jsx)(Ls.A,{className:"h-3 w-3 inline-block mr-1 relative -top-px"}),"Available only for paying users.",(0,te.jsx)("a",{href:"/billing",className:"ml-1 underline font-medium hover:text-orange-700",children:"Upgrade now"})]})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 mt-2 sm:mt-0",children:[(0,te.jsx)(Lc,{id:"platform-badge-switch",checked:!0===r.is_remixable,onCheckedChange:async e=>{p(!0);try{n({is_remixable:e}),c({title:"Success",description:`Platform badge will be ${e?"visible":"hidden"}.`})}catch(s){c({title:"Error",description:"Failed to update platform badge visibility.",variant:"destructive"})}finally{p(!1)}},disabled:"free"===a.subscription_tier||h,"aria-label":"Toggle platform badge visibility"}),(0,te.jsx)(at,{htmlFor:"platform-badge-switch",className:"text-sm text-muted-foreground",children:!0===r.is_remixable?"Visible":"Hidden"})]})]}),(0,te.jsx)(Xs,{}),(0,te.jsxs)("div",{ref:_,className:`flex flex-col sm:flex-row justify-between sm:items-center gap-2 ${$("hide-created-by")}`,children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"Hide Entity Creator"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:'Hide who created each record in your app\'s data tables. When enabled, the "created by" field will not be shown to users.'})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 mt-2 sm:mt-0",children:[(0,te.jsx)(Lc,{id:"hide-created-by-switch",checked:!0===r.hide_entity_created_by,onCheckedChange:async e=>{f(!0);try{n({hide_entity_created_by:e}),c({title:"Success",description:`Entity creator information will be ${e?"hidden":"visible"} in your app.`})}catch(s){c({title:"Error",description:"Failed to update entity creator visibility.",variant:"destructive"})}finally{f(!1)}},disabled:g,"aria-label":"Toggle hide entity creator"}),(0,te.jsx)(at,{htmlFor:"hide-created-by-switch",className:"text-sm text-muted-foreground",children:!0===r.hide_entity_created_by?"Hidden":"Visible"})]})]}),(0,te.jsx)(Xs,{}),(0,te.jsxs)("div",{ref:S,className:`flex flex-col sm:flex-row justify-between sm:items-center gap-2 ${$("enable-agents")}`,children:[(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"AI Agents"}),(0,te.jsx)("span",{className:"px-2 py-0.5 text-xs font-medium bg-teal-100 text-teal-700 rounded-full",children:"Alpha"})]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Build AI agents into your app using Base44's AI agents infrastructure"})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 mt-2 sm:mt-0",children:[(0,te.jsx)(Lc,{id:"enable-agents-switch",checked:!0===r.agents_enabled,onCheckedChange:async e=>{j(!0);try{await n({agents_enabled:e}),c({title:"Success",description:`AI agents ${e?"enabled":"disabled"} successfully.`})}catch(s){c({title:"Error",description:"Failed to update AI agents setting.",variant:"destructive"})}finally{j(!1)}},disabled:v,"aria-label":"Toggle AI agents"}),(0,te.jsx)(at,{htmlFor:"enable-agents-switch",className:"text-sm text-muted-foreground",children:!0===r.agents_enabled?"Enabled":"Disabled"})]})]}),r.agents_enabled&&(0,te.jsxs)(is,{className:"bg-teal-50 border-teal-200",children:[(0,te.jsx)(eo.A,{className:"h-4 w-4 text-teal-600"}),(0,te.jsx)(os,{className:"text-teal-800",children:"AI Agents Enabled"}),(0,te.jsx)(cs,{className:"text-teal-700",children:"Your app now has access to Base44's AI agents infrastructure. You can create intelligent agents that can help users with various tasks, answer questions, and interact with your app's data. Use the chat to build and configure your agents."})]}),(0,te.jsx)(Xs,{}),(0,te.jsxs)("div",{ref:C,className:`flex flex-col sm:flex-row justify-between sm:items-center gap-2 ${$("clone-app")}`,children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"Clone App"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Create a duplicate of this app"})]}),(0,te.jsxs)(Rs,{onClick:async()=>{window.open(`/remix-app/${r.id}?clone_history=true`,"_blank")},variant:"outline",className:"flex items-center border-gray-200 hover:bg-gray-50 hover:text-gray-700",children:[(0,te.jsx)(Ha.A,{className:"mr-2 h-4 w-4"}),"Create Copy"]})]}),(0,te.jsx)(Xs,{}),(0,te.jsx)(ud,{onRouteChange:t}),(0,te.jsx)(Xs,{}),(0,te.jsxs)("div",{ref:A,className:`flex flex-col sm:flex-row justify-between sm:items-center gap-2 ${$("backend-functions")}`,children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"Backend Functions"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Enable server-side functionality (Alpha)"})]}),L?(0,te.jsxs)(Rs,{onClick:async()=>{try{m(!0),await od.activateBackendFunctions(r.id),c({title:"Success",description:"Backend functions activated successfully. Prompt the chat to build your backend functions."})}catch(e){c({title:"Error",description:"Failed to activate backend functions",variant:"destructive"})}finally{m(!1)}},disabled:d||!!r.has_backend_functions_enabled,variant:"outline",className:"flex items-center border-gray-200 hover:bg-gray-50 hover:text-gray-700",children:[(0,te.jsx)(Ua.A,{className:"mr-2 h-4 w-4"}),d?"Activating...":r.has_backend_functions_enabled?"Activated":"Activate"]}):(0,te.jsxs)(Rs,{variant:"outline",className:"flex items-center text-gray-500 border-gray-200 hover:bg-gray-50",onClick:()=>i("/billing"),children:[(0,te.jsx)(ur.A,{className:"mr-2 h-4 w-4"}),"Upgrade Plan"]})]}),L?!r.has_backend_functions_enabled&&(0,te.jsxs)(is,{variant:"warning",className:"bg-gray-50 border-gray-200",children:[(0,te.jsx)(Zc.A,{className:"h-4 w-4 text-gray-500"}),(0,te.jsx)(os,{className:"text-gray-800",children:"Backend Functions - Alpha Feature"}),(0,te.jsx)(cs,{className:"text-gray-600",children:"This feature is currently in alpha and may be unstable. It is recommended only for developers at this time. Use with caution."})]}):(0,te.jsx)(dd,{})]})]}),(0,te.jsxs)(Vs,{className:"border-gray-200",children:[(0,te.jsxs)(Ys,{className:"border-b border-gray-100",children:[(0,te.jsx)(Hs,{className:"text-gray-800",children:"Danger Zone"}),(0,te.jsx)(Gs,{className:"text-gray-600",children:"Irreversible actions that affect your app"})]}),(0,te.jsxs)(Js,{className:"space-y-6",children:[(0,te.jsxs)("div",{ref:E,className:`flex flex-col sm:flex-row justify-between sm:items-center gap-2 ${$("delete-app")}`,children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"Delete App"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Permanently remove this app and all its data"})]}),(0,te.jsxs)(Rs,{onClick:()=>{window.confirm("Are you sure you want to delete this app? This action cannot be undone.")&&T()},variant:"destructive",className:"flex items-center bg-red-500/90 hover:bg-red-600 text-white",children:[(0,te.jsx)(Tc.A,{className:"mr-2 h-4 w-4"}),"Delete App"]})]}),(null===(s=a.platform_role)||void 0===s?void 0:s.includes("admin"))&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Xs,{}),(0,te.jsxs)("div",{ref:I,className:`flex flex-col sm:flex-row justify-between sm:items-center gap-2 ${$("admin-controls")}`,children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"Admin Controls"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Manage app availability"})]}),(0,te.jsxs)(Rs,{onClick:async()=>{try{n({is_blocked:!r.is_blocked}),c({title:"Success",description:`App ${r.is_blocked?"unblocked":"blocked"} successfully`})}catch(e){c({title:"Error",description:`Failed to ${r.is_blocked?"unblock":"block"} app`,variant:"destructive"})}},variant:"outline",className:"flex items-center border-gray-200 hover:bg-gray-50 hover:text-gray-700",children:[(0,te.jsx)(Kc.A,{className:"mr-2 h-4 w-4"}),r.is_blocked?"Unblock App":"Block App"]})]})]})]})]})]})]})};function hd(){const[e,s]=(0,Y.useState)((()=>"appListing"===new URLSearchParams(window.location.search).get("tab")?"appListing":"main")),t=e=>{s(e)},a={main:(0,te.jsx)(xd,{onRouteChange:t}),appListing:(0,te.jsx)(Jc,{onRouteChange:t})};return(0,te.jsx)(Fc,{children:(0,te.jsx)("div",{className:"max-w-8xl mx-auto p-4",children:a[e]||a.main})})}function pd(e){return(null==e?void 0:e.auth_config)||{enable_username_password:!1,enable_google_login:!0,enable_microsoft_login:!1,enable_facebook_login:!1,enable_sso_login:!1,sso_provider_name:null}}const gd=e=>{let{children:s,content:t,side:a="left"}=e;const r="right"===a,n="top"===a,l="bottom"===a,i="left"===a;return(0,te.jsxs)("div",{className:"relative group",children:[s,(0,te.jsxs)("div",{className:`\n                absolute px-3 py-2 bg-gray-900 text-white text-xs rounded-md \n                opacity-0 group-hover:opacity-100 transition-opacity duration-200 \n                pointer-events-none whitespace-nowrap z-50 min-w-max\n                ${l?"top-full mt-2 left-1/2 transform -translate-x-1/2":n?"bottom-full mb-2 left-1/2 transform -translate-x-1/2":r?"bottom-full mb-2 right-0":i?"right-full mr-2 top-1/2 transform -translate-y-1/2":"bottom-full mb-2 left-0"}\n            `,children:[t,(0,te.jsx)("div",{className:`\n                    absolute border-4 border-transparent\n                    ${l?"bottom-full -mb-1 left-1/2 transform -translate-x-1/2 border-b-gray-900":n?"top-full -mt-1 left-1/2 transform -translate-x-1/2 border-t-gray-900":r?"top-full -mt-1 right-4 border-t-gray-900":i?"left-full -ml-1 top-1/2 transform -translate-y-1/2 border-l-gray-900":"top-full -mt-1 left-4 border-t-gray-900"}\n                `})]})]})},fd=e=>{let{provider:s,icon:t,iconBg:a,title:r,description:n,checked:l,onToggle:i,disabled:o}=e;const c=a||"bg-white border-gray-200",d=o&&!l;return(0,te.jsx)("div",{className:"bg-white rounded-lg outline outline-1 outline-offset-[-1px] outline-gray-200 overflow-hidden "+(d?"opacity-60":""),children:(0,te.jsxs)("div",{className:"p-4 flex justify-start items-center gap-4",children:[(0,te.jsx)("div",{className:`w-10 h-10 rounded-lg border flex items-center justify-center ${c} ${d?"opacity-60":""}`,children:t}),(0,te.jsxs)("div",{className:"flex-1 flex flex-col justify-start items-start gap-0.5",children:[(0,te.jsx)("div",{className:"flex justify-center items-center gap-2",children:(0,te.jsx)("div",{className:"text-gray-900 text-sm font-medium leading-tight "+(d?"text-gray-400":""),children:r})}),(0,te.jsx)("div",{className:"self-stretch flex justify-center items-center gap-2.5",children:(0,te.jsx)("div",{className:"flex-1 text-gray-500 text-sm font-normal leading-tight "+(d?"text-gray-400":""),children:n})})]}),(0,te.jsx)(Lc,{id:`${s}-auth-switch`,checked:l,onCheckedChange:e=>i(s,e),disabled:o})]})})};function vd(){const{user:e}=ne(),{app:s,updateApp:t,updateSecrets:a}=vs(),r=e.subscription_tier&&!["free","starter","pro"].includes(e.subscription_tier),n=(0,Z.zy)(),{toast:l}=Un(),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(new Set),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)({name:"",client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""}),[f,v]=(0,Y.useState)(""),[j,b]=(0,Y.useState)(null),[y,N]=(0,Y.useState)({email_password:!1,google:!1,microsoft:!1,facebook:!1}),[w,k]=(0,Y.useState)({email_password:!1,google:!1,microsoft:!1,facebook:!1}),_=[{id:"email_password",title:"Email and password authentication",description:"Members can log in with email and password",iconBg:"bg-slate-900 border-slate-900",icon:(0,te.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,te.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"})})},{id:"google",title:"Google authentication",description:"Members can log in with a Google account",iconBg:"bg-white border-gray-200",icon:(0,te.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,te.jsx)("path",{fill:"#4285F4",d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z"}),(0,te.jsx)("path",{fill:"#34A853",d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z"}),(0,te.jsx)("path",{fill:"#FBBC05",d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z"}),(0,te.jsx)("path",{fill:"#EA4335",d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z"})]})},{id:"microsoft",title:"Microsoft authentication",description:"Members can log in with a Microsoft account",iconBg:"bg-white border-gray-200",icon:(0,te.jsxs)("svg",{className:"w-5 h-5",viewBox:"0 0 24 24",children:[(0,te.jsx)("path",{fill:"#F25022",d:"M0 0h11.5v11.5H0z"}),(0,te.jsx)("path",{fill:"#00A4EF",d:"M12.5 0H24v11.5H12.5z"}),(0,te.jsx)("path",{fill:"#7FBA00",d:"M0 12.5h11.5V24H0z"}),(0,te.jsx)("path",{fill:"#FFB900",d:"M12.5 12.5H24V24H12.5z"})]})},{id:"facebook",title:"Facebook authentication",description:"Members can log in with a Facebook account",iconBg:"bg-[#1877F2] border-[#1877F2]",icon:(0,te.jsx)("svg",{className:"w-5 h-5 text-white",fill:"currentColor",viewBox:"0 0 24 24",children:(0,te.jsx)("path",{d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})})}],S={google:{name:"google",displayName:"Google Workspace",description:"Google Workspace (formerly G Suite) SSO",defaults:{discovery_url:"https://accounts.google.com/.well-known/openid-configuration",scope:"openid email profile"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"discovery_url",required:!1,row:2,tooltip:"OIDC discovery endpoint (pre-configured for Google)"}]},microsoft:{name:"microsoft",displayName:"Microsoft Azure AD",description:"Microsoft Azure Active Directory (requires tenant ID)",defaults:{scope:"openid email profile"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"tenant_id",required:!0,row:2,tooltip:"Azure AD Directory (tenant) ID - found in Azure Portal \u2192 Azure Active Directory \u2192 Overview",placeholder:"Your Azure AD tenant ID"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"discovery_url",required:!1,row:3,tooltip:"OIDC discovery endpoint automatically generated from your tenant ID"}],autoGenerate:{field:"tenant_id",template:e=>`https://login.microsoftonline.com/${e}/v2.0/.well-known/openid-configuration`,target:"discovery_url"}},github:{name:"github",displayName:"GitHub",description:"GitHub OAuth (not OIDC compatible)",defaults:{scope:"user:email",auth_endpoint:"https://github.com/login/oauth/authorize",token_endpoint:"https://github.com/login/oauth/access_token",userinfo_endpoint:"https://api.github.com/user"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (user:email for GitHub)"},{name:"auth_endpoint",required:!1,row:2,tooltip:"GitHub OAuth authorization endpoint (pre-configured)"},{name:"token_endpoint",required:!1,row:3,tooltip:"GitHub OAuth token endpoint (pre-configured)"},{name:"userinfo_endpoint",required:!1,row:3,tooltip:"GitHub API user endpoint (pre-configured)"}]},okta:{name:"okta",displayName:"Okta",description:"Okta (requires your tenant domain)",defaults:{scope:"openid email profile"},fields:[{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:1,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"okta_domain",required:!0,row:2,tooltip:"Your Okta domain name (e.g., 'your-company' from your-company.okta.com)",placeholder:"your-company"},{name:"scope",required:!1,row:2,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"discovery_url",required:!1,row:3,tooltip:"OIDC discovery endpoint automatically generated from your Okta domain"}],autoGenerate:{field:"okta_domain",template:e=>`https://${e}.okta.com/.well-known/openid-configuration`,target:"discovery_url"}},advanced:{name:"advanced",displayName:"Advanced / Manual Configuration",description:"Configure all fields manually for any OAuth/OIDC provider",defaults:{scope:"email profile"},fields:[{name:"name",required:!0,row:1,tooltip:"Custom name for your SSO provider"},{name:"client_id",required:!0,row:1,tooltip:"The OAuth client ID provided by your identity provider"},{name:"client_secret",required:!0,row:2,tooltip:"The OAuth client secret provided by your identity provider (keep this confidential)"},{name:"discovery_url",required:!1,row:2,tooltip:"OIDC discovery endpoint URL (if supported by your provider)"},{name:"scope",required:!1,row:3,tooltip:"OAuth scopes to request (openid, email, profile are commonly used)"},{name:"auth_endpoint",required:!1,row:3,tooltip:"OAuth authorization endpoint URL"},{name:"token_endpoint",required:!1,row:4,tooltip:"OAuth token endpoint URL"},{name:"userinfo_endpoint",required:!1,row:4,tooltip:"OAuth userinfo endpoint URL"},{name:"jwks_uri",required:!1,row:5,tooltip:"JSON Web Key Set URI for token verification"}]}},C=(0,Y.useRef)(null);(0,Y.useEffect)((()=>{const e=new URLSearchParams(n.search).get("selectedParam");if(e){b(e);let s=null;if("sso-settings"===e)s=C,d(!0);s&&s.current&&setTimeout((()=>{s.current.scrollIntoView({behavior:"smooth",block:"center"})}),300)}}),[n.search]),(0,Y.useEffect)((()=>{if(s){const e=pd(s),t=e.enable_sso_login;Object.values(w).some((e=>e))||N({email_password:e.enable_username_password||!1,google:!t&&(e.enable_google_login||!1),microsoft:!t&&(e.enable_microsoft_login||!1),facebook:!t&&(e.enable_facebook_login||!1)})}}),[null==s?void 0:s.auth_config,w]),(0,Y.useEffect)((()=>{(async()=>{if(null!=s&&s.id)try{const e=pd(s),t=await xs.getSecrets(s.id),a=Object.keys(t).filter((e=>e.startsWith("sso_"))).reduce(((e,s)=>(e[s.replace("sso_","")]=t[s],e)),{}),r={name:e.sso_provider_name||"",client_id:a.client_id?a.client_id.match(/^x+$/i)?"\u2022".repeat(20):a.client_id:"",client_secret:a.client_secret?a.client_secret.match(/^x+$/i)?"\u2022".repeat(20):a.client_secret:"",discovery_url:a.discovery_url?a.discovery_url.match(/^x+$/i)?"\u2022".repeat(20):a.discovery_url:"",scope:a.scope?a.scope.match(/^x+$/i)?"\u2022".repeat(20):a.scope:"openid email profile",auth_endpoint:a.auth_endpoint?a.auth_endpoint.match(/^x+$/i)?"\u2022".repeat(20):a.auth_endpoint:"",token_endpoint:a.token_endpoint?a.token_endpoint.match(/^x+$/i)?"\u2022".repeat(20):a.token_endpoint:"",userinfo_endpoint:a.userinfo_endpoint?a.userinfo_endpoint.match(/^x+$/i)?"\u2022".repeat(20):a.userinfo_endpoint:"",jwks_uri:a.jwks_uri?a.jwks_uri.match(/^x+$/i)?"\u2022".repeat(20):a.jwks_uri:"",tenant_id:a.tenant_id?a.tenant_id.match(/^x+$/i)?"\u2022".repeat(20):a.tenant_id:"",okta_domain:a.okta_domain?a.okta_domain.match(/^x+$/i)?"\u2022".repeat(20):a.okta_domain:""};let n="";if(e.sso_provider_name)n=S[e.sso_provider_name]?e.sso_provider_name:"advanced";else if(r.name){const e=Object.entries(S).find((e=>{let[s,t]=e;return t.name===r.name}));n=e?e[0]:"advanced"}else x&&!e.sso_provider_name&&(n="google");let l=r;const i=new Set;if(n&&"advanced"===n)l={...r,name:e.sso_provider_name||r.name||""},e.sso_provider_name&&e.sso_provider_name!==r.name&&i.add("name");else if(n&&S[n]){const e=S[n],s={};if(Object.entries(e.defaults||{}).forEach((e=>{let[t,a]=e;r[t]||(s[t]=a,i.add(t))})),l={...r,...s,name:e.name},e.name!==r.name&&i.add("name"),e.autoGenerate){const s=l[e.autoGenerate.field];s&&!l[e.autoGenerate.target]&&(l[e.autoGenerate.target]=e.autoGenerate.template(s),i.add(e.autoGenerate.target))}}g(l),v(n),u(i)}catch(e){const t=pd(s);g({name:t.sso_provider_name||"",client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""}),v(""),u(new Set)}})()}),[null==s?void 0:s.id,null==s?void 0:s.auth_config,x]);const A=(e,s)=>{g((t=>{const a={...t,[e]:s},r=S[f];if(null!=r&&r.autoGenerate&&e===r.autoGenerate.field&&s){const e=r.autoGenerate.template(s);a[r.autoGenerate.target]=e,u((e=>new Set(e).add(r.autoGenerate.target)))}return a})),u((s=>new Set(s).add(e)))},E=e=>e&&S[e]&&S[e].fields||[],I=e=>e&&"string"==typeof e&&(e.match(/^x+$/)||e.match(/^\u2022+$/)),L=(e,s)=>I(s)?"\u2022".repeat(20):s,T=async(e,a)=>{if(w[e])return;const r=pd(s);if(a&&r.enable_sso_login&&"email_password"!==e)return void l({title:"Cannot Enable Social Provider",description:"Please disable SSO first before enabling social providers",variant:"destructive"});const n={email_password:{field:"enable_username_password",name:"Email and Password"},google:{field:"enable_google_login",name:"Google"},microsoft:{field:"enable_microsoft_login",name:"Microsoft"},facebook:{field:"enable_facebook_login",name:"Facebook"}}[e];if(n){N((s=>({...s,[e]:a}))),k((s=>({...s,[e]:!0})));try{s.auth_config[n.field]=a,await t({auth_config:{...s.auth_config,[n.field]:a}}),l({title:a?`${n.name} Authentication Enabled`:`${n.name} Authentication Disabled`,description:a?`${n.name} authentication is now enabled for your app`:`${n.name} authentication has been disabled`})}catch(i){N((s=>({...s,[e]:!a}))),l({title:"Error",description:`Failed to update ${n.name} authentication`,variant:"destructive"})}finally{k((s=>({...s,[e]:!1})))}}};return(0,te.jsxs)("div",{className:"max-w-4xl mx-auto p-4 space-y-6",children:[(0,te.jsx)("style",{jsx:!0,global:!0,children:"\n                .selected-section {\n                    position: relative;\n                    border-left: 4px solid #334155;\n                    background-color: rgba(241, 245, 249, 0.7);\n                    box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);\n                    transition: all 0.4s ease;\n                    padding-left: 16px !important;\n                    padding-top: 14px !important;\n                    padding-bottom: 14px !important;\n                    margin: 4px 0 !important;\n                    border-radius: 4px;\n                }\n\n                /* Left border with animated glow */\n                .selected-section::before {\n                    content: '';\n                    position: absolute;\n                    left: -4px;\n                    top: 0;\n                    width: 4px;\n                    height: 100%;\n                    background: linear-gradient(to bottom, #0f766e, #334155);\n                    box-shadow: 0 0 12px rgba(15, 118, 110, 0.5);\n                    animation: border-pulse 2.5s infinite ease-in-out;\n                    z-index: 1;\n                }\n                \n                /* Light effect */\n                .selected-section::after {\n                    content: '';\n                    position: absolute;\n                    left: 0;\n                    top: 0;\n                    height: 100%;\n                    width: 100%;\n                    background: linear-gradient(to right, rgba(15, 118, 110, 0.08), transparent 50%);\n                    animation: light-pulse 2.5s infinite ease-in-out;\n                    pointer-events: none;\n                    border-radius: 4px;\n                }\n                \n                @keyframes border-pulse {\n                    0%, 100% {\n                        box-shadow: 0 0 8px rgba(15, 118, 110, 0.4);\n                    }\n                    50% {\n                        box-shadow: 0 0 20px rgba(15, 118, 110, 0.7);\n                    }\n                }\n                \n                @keyframes light-pulse {\n                    0%, 100% {\n                        opacity: 0.3;\n                        background: linear-gradient(to right, rgba(15, 118, 110, 0.05), transparent 50%);\n                    }\n                    50% {\n                        opacity: 0.7;\n                        background: linear-gradient(to right, rgba(15, 118, 110, 0.12), transparent 60%);\n                    }\n                }\n            "}),(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h2",{className:"text-2xl font-semibold text-gray-800",children:"Authentication"}),(0,te.jsxs)("p",{className:"text-gray-600 mt-1",children:["Configure the authentication methods that members of your app can use to log in to ",(null==s?void 0:s.name)||"(AppName)","."]})]}),(0,te.jsx)("div",{className:"space-y-3",children:_.map((e=>(0,te.jsx)(fd,{provider:e.id,icon:e.icon,iconBg:e.iconBg,title:e.title,description:e.description,checked:y[e.id],onToggle:T,disabled:!!pd(s).enable_sso_login&&"email_password"!==e.id},e.id)))}),(0,te.jsxs)("div",{className:"flex items-center py-2",children:[(0,te.jsx)("div",{className:"flex-1 border-t border-gray-200"}),(0,te.jsx)("div",{className:"px-3 text-gray-500 text-sm font-medium",children:"or"}),(0,te.jsx)("div",{className:"flex-1 border-t border-gray-200"})]})]}),(0,te.jsxs)("div",{ref:C,className:`bg-white rounded-lg outline outline-1 outline-offset-[-1px] outline-gray-200 ${$="sso-settings",j===$?"selected-section p-4 rounded-md":""} ${r?"":"opacity-75"}`,children:[(0,te.jsxs)("div",{className:"p-4 flex justify-start items-center gap-4",children:[(0,te.jsx)("div",{className:"w-10 h-10 bg-slate-900 rounded-lg border border-slate-900 flex items-center justify-center",children:(0,te.jsx)("svg",{className:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,te.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),(0,te.jsxs)("div",{className:"flex-1 flex flex-col justify-start items-start gap-0.5",children:[(0,te.jsxs)("div",{className:"flex justify-center items-center gap-2",children:[(0,te.jsx)("div",{className:"text-gray-900 text-sm font-medium leading-tight",children:"Single Sign-on (SSO)"}),(0,te.jsx)(gd,{content:"Early-stage feature for feedback. Subject to change or removal.",side:"top",children:(0,te.jsxs)("div",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-orange-50 border border-orange-200 rounded-full",children:[(0,te.jsx)("div",{className:"w-1.5 h-1.5 bg-orange-400 rounded-full animate-pulse"}),(0,te.jsx)("span",{className:"text-xs font-medium text-orange-800",children:"Elite Early Preview"})]})})]}),(0,te.jsx)("div",{className:"self-stretch text-gray-500 text-sm font-normal leading-tight",children:"Allow members to log in using a custom SSO that fits your organization's needs."}),(0,te.jsx)("button",{onClick:()=>window.open("https://docs.base44.com/Guides/Setting-up-SSO","_blank","noopener,noreferrer"),className:"text-blue-600 text-sm font-medium hover:text-blue-700 underline",children:"Learn more about SSO"})]}),(0,te.jsx)("div",{className:"flex items-center gap-3",children:pd(s).sso_provider_name&&!x?(0,te.jsx)(Lc,{id:"sso-toggle",checked:!0===pd(s).enable_sso_login,onCheckedChange:async e=>{if(i)return;pd(s).sso_provider_name;const a={...y},r=c;e?(N((e=>({...e,google:!1,microsoft:!1,facebook:!1}))),d(!0)):d(!1),o(!0);try{e?(await t({auth_config:{...s.auth_config,sso_provider_name:"google",enable_sso_login:!0,enable_google_login:!1,enable_microsoft_login:!1,enable_facebook_login:!1}}),l({title:"SSO Enabled",description:"Single Sign-On has been enabled and social login providers have been disabled. Please configure your SSO settings."})):(await t({auth_config:{...s.auth_config,enable_sso_login:!1}}),h(!1),l({title:"SSO Disabled",description:"Single Sign-On has been disabled"}))}catch(n){N(a),d(r),l({title:"Error",description:"Failed to update SSO settings",variant:"destructive"})}finally{o(!1)}},disabled:!1}):x?(0,te.jsx)(Lc,{id:"sso-toggle",checked:!1,onCheckedChange:()=>{},disabled:!0}):(0,te.jsx)(gd,{content:r?"Configure Single Sign-On for your app":"SSO is available for Elite tier and above",side:"left",children:(0,te.jsx)("button",{onClick:()=>{r&&(h(!0),d(!0),v("google"))},className:"px-4 py-2 border rounded-md text-xs font-medium leading-4 tracking-normal transition-colors "+(r?"bg-white border-gray-300 text-gray-700 hover:bg-gray-50":"bg-gray-100 border-gray-200 text-gray-400 cursor-not-allowed"),disabled:i||!r,children:i?"Setting up...":"Set Up"})})})]}),(pd(s).sso_provider_name||x)&&!c&&(0,te.jsx)("div",{className:"px-4 pb-4",children:(0,te.jsxs)("button",{onClick:()=>{const e=c;if(d(!c),e)v(""),u(new Set);else{const e=pd(s);e.sso_provider_name?S[e.sso_provider_name]?v(e.sso_provider_name):v("advanced"):v("google")}},className:"w-full h-10 flex items-center justify-between hover:bg-gray-50 transition-colors group bg-white rounded-md border border-gray-200",style:{paddingTop:"4px",paddingRight:"4px",paddingBottom:"4px",paddingLeft:"12px"},children:[(0,te.jsx)("div",{className:"text-gray-900 text-sm font-medium",children:x?"Set up SSO Configuration":((e,t,a)=>{const r=pd(s);return(null===(e=S[r.sso_provider_name])||void 0===e?void 0:e.displayName)||(null===(t=r.sso_provider_name)||void 0===t?void 0:t.charAt(0).toUpperCase())+(null===(a=r.sso_provider_name)||void 0===a?void 0:a.slice(1))+" SSO"})()}),(0,te.jsxs)("div",{className:"flex items-center gap-2 text-gray-500",children:[(0,te.jsx)("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,te.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15.232 5.232l3.536 3.536m-2.036-5.036a2.5 2.5 0 113.536 3.536L6.5 21.036H3v-3.572L16.732 3.732z"})}),(0,te.jsx)("span",{className:"text-sm",children:x?"Set up":"Configure"}),(0,te.jsx)(ct.A,{className:"w-4 h-4 transition-transform "+(c?"rotate-180":"")})]})]})}),c&&(pd(s).sso_provider_name||x)&&(0,te.jsx)("div",{className:"border-t border-gray-100 p-4 bg-white",children:(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("div",{className:"text-gray-500 text-sm font-normal leading-tight mb-2",children:"Select SSO Provider"}),(0,te.jsxs)(ut,{value:f,onValueChange:e=>{v(e);const t=pd(s);if("advanced"===e){const e=t.sso_provider_name&&!S[t.sso_provider_name];g(e?e=>({...e,name:t.sso_provider_name||e.name||"advanced"}):{name:"",client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""})}else if(e&&S[e]){const s=S[e];if(t.sso_provider_name===e)g((e=>({...e,name:s.name})));else{const e={...{name:s.name,client_id:"",client_secret:"",discovery_url:"",scope:"openid email profile",auth_endpoint:"",token_endpoint:"",userinfo_endpoint:"",jwks_uri:"",tenant_id:"",okta_domain:""},...s.defaults};if(s.autoGenerate){const t=e[s.autoGenerate.field];if(t){const a=s.autoGenerate.template(t);e[s.autoGenerate.target]=a}}g(e)}}},children:[(0,te.jsx)(pt,{className:"w-full px-4 py-3 bg-white rounded-md shadow-sm outline outline-1 outline-offset-[-1px] outline-gray-200",children:(0,te.jsx)(ht,{placeholder:"Select SSO Provider"})}),(0,te.jsx)(vt,{children:Object.entries(S).map((e=>{let[s,t]=e;return(0,te.jsx)(bt,{value:s,children:t.displayName},s)}))})]})]}),(e=>{const s=E(e);if(!s.length)return null;const t=s.reduce(((e,s)=>{const t=s.row||1;return e[t]||(e[t]=[]),e[t].push(s),e}),{});return(0,te.jsx)("div",{className:"space-y-4",children:Object.entries(t).sort(((e,s)=>{let[t]=e,[a]=s;return parseInt(t)-parseInt(a)})).map((s=>{let[t,a]=s;return(0,te.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map(((s,t)=>{var r,n,l,i;const o=a.length>1&&1===t,c=p[s.name]||"",d=s.placeholder||`Enter ${s.name.replace("_"," ")}`,m=L(s.name,c),u="discovery_url"===s.name&&"discovery_url"===(null===(r=S[e])||void 0===r||null===(n=r.autoGenerate)||void 0===n?void 0:n.target)&&c;return(0,te.jsxs)("div",{children:[(0,te.jsxs)(at,{className:"text-gray-500 text-sm flex items-center gap-1",children:[s.name.replace("_"," ").replace(/\b\w/g,(e=>e.toUpperCase())),s.required&&" *",s.name===(null===(l=S[e])||void 0===l||null===(i=l.autoGenerate)||void 0===i?void 0:i.target)&&c&&" (Auto-generated)",(0,te.jsx)(gd,{content:s.tooltip,side:o?"right":"left",children:(0,te.jsx)(rl.A,{className:"w-3.5 h-3.5 text-gray-400 hover:text-gray-600 cursor-help"})})]}),(0,te.jsx)(Qs,{className:"mt-1 w-full h-8 "+(u?"bg-gray-50":""),type:"text",placeholder:d,value:m,onChange:e=>{I(e.target.value)||A(s.name,e.target.value)},onFocus:e=>{I(m)&&(e.target.value="",A(s.name,""))},readOnly:u})]},s.name)}))},t)}))})})(f),(0,te.jsxs)("div",{className:"flex justify-between pt-4",children:[(0,te.jsx)(Rs,{onClick:()=>{d(!1),x&&h(!1),v(""),u(new Set)},variant:"outline",className:"border-gray-300 text-gray-700 hover:bg-gray-50",children:x?"Cancel Setup":"Dismiss"}),(0,te.jsx)(Rs,{onClick:async()=>{o(!0);try{const e={};Object.keys(p).forEach((s=>{const t=p[s];!t||I(t)||!m.has(s)&&""===t||(e[`sso_${s}`]=t)})),Object.keys(e).length>0&&await a(e);let r=null;f&&"advanced"!==f?r=f:"advanced"===f&&(r=p.name||"advanced");const n={sso_provider_name:r,enable_sso_login:!0};x&&(n.enable_google_login=!1,n.enable_microsoft_login=!1,n.enable_facebook_login=!1),await t({auth_config:{...s.auth_config,...n}}),u(new Set),x&&(h(!1),N((e=>({...e,google:!1,microsoft:!1,facebook:!1})))),d(!1);const i=Object.keys(e).length;l({title:"Success",description:x?"SSO has been enabled and configured successfully":i>0?`SSO settings updated successfully (${i} configuration${1===i?"":"s"} saved)`:"SSO provider updated successfully"})}catch(e){l({title:"Error",description:"Failed to update SSO settings",variant:"destructive"})}finally{o(!1)}},disabled:i||!f||E(f).some((e=>e.required&&!p[e.name])),className:"bg-gray-900 text-white",children:i?"Saving...":x?"Enable SSO":"Save SSO Settings"})]})]})})]})]});var $}const jd=e=>{let{value:s,onChange:t,language:a="javascript",readOnly:r=!1,height:n,className:l,style:i,isSaving:o,...c}=e;const d={};return n&&(d.height=n),(0,te.jsxs)("div",{className:"relative h-full",children:[(0,te.jsx)(rr.KE,{defaultLanguage:a,value:s,onChange:e=>{t&&!r&&t(e)},options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,readOnly:r},...d,...c}),o&&(0,te.jsx)("div",{className:"absolute top-2 right-2 bg-gray-700 text-white text-xs px-2 py-1 rounded opacity-70",children:"Saving..."})]})};var bd=t(23046);const yd=function(){var e;const{user:s}=ne(),{app:t}=vs(),[a,r]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(Object.keys(t.entities)[0]||"EntityName"),[i,o]=(0,Y.useState)("javascript"),c=(null===(e=t.entities[n])||void 0===e?void 0:e.properties)||{},d=Object.keys(c).join(", "),m=`// JavaScript Example: Reading Entities\n// Filterable fields: ${d}\nasync function fetch${n}Entities() {\n    const response = await fetch(\`${(0,bd.Gt)()}/apps/${t.id}/entities/${n}\`, {\n        headers: {\n            'api_key': '${s.api_key}', // or use await User.me() to get the API key\n            'Content-Type': 'application/json'\n        }\n    });\n    const data = await response.json();\n    console.log(data);\n}\n\n// JavaScript Example: Updating an Entity\n// Filterable fields: ${d}\nasync function update${n}Entity(entityId, updateData) {\n    const response = await fetch(\`${(0,bd.Gt)()}/apps/${t.id}/entities/${n}/\${entityId}\`, {\n        method: 'PUT',\n        headers: {\n            'api_key': '${s.api_key}', // or use await User.me() to get the API key\n            'Content-Type': 'application/json'\n        },\n        body: JSON.stringify(updateData)\n    });\n    const data = await response.json();\n    console.log(data);\n}`,u=`# Python Example: Reading Entities\n# Filterable fields: ${d}\nimport requests\n\ndef make_api_request(api_path, method='GET', data=None):\n    url = f'${(0,bd.Gt)()}/{api_path}'\n    headers = {\n        'api_key': '${s.api_key}',\n        'Content-Type': 'application/json'\n    }\n    if method.upper() == 'GET':\n        response = requests.request(method, url, headers=headers, params=data)\n    else:\n        response = requests.request(method, url, headers=headers, json=data)\n    response.raise_for_status()\n    return response.json()\n\nentities = make_api_request(f'apps/${t.id}/entities/${n}')\nprint(entities)\n\n# Python Example: Updating an Entity\n# Filterable fields: ${d}\ndef update_entity(entity_id, update_data):\n    response = requests.put(\n        f'${(0,bd.Gt)()}/apps/${t.id}/entities/${n}/{entity_id}',\n        headers={\n            'api_key': '${s.api_key}',\n            'Content-Type': 'application/json'\n        },\n        json=update_data\n    )\n    response.raise_for_status()\n    return response.json()`;return(0,te.jsxs)("div",{className:"p-8",children:[(0,te.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"\u{1f680} API Integration Made Easy"}),(0,te.jsx)("h3",{className:"text-xl mb-2",children:"Example: API Operations"}),(0,te.jsx)("p",{className:"mb-4",children:"Select an entity to generate code examples for reading and updating:"}),(0,te.jsx)("select",{value:n,onChange:e=>l(e.target.value),className:"mb-4 p-2 border rounded",children:Object.keys(t.entities).map((e=>(0,te.jsx)("option",{value:e,children:e},e)))}),(0,te.jsxs)("div",{className:"mb-4",children:[(0,te.jsx)("button",{onClick:()=>o("javascript"),className:"mr-2 "+("javascript"===i?"font-bold":""),children:"JavaScript"}),(0,te.jsx)("button",{onClick:()=>o("python"),className:""+("python"===i?"font-bold":""),children:"Python"})]}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(jd,{value:"javascript"===i?m:u,language:i,readOnly:!0,height:"600px"}),(0,te.jsxs)("button",{onClick:()=>(e=>{navigator.clipboard.writeText(e),r(!0),setTimeout((()=>r(!1)),2e3)})("javascript"===i?m:u),className:"btn btn-sm btn-outline absolute top-2 right-2",children:[(0,te.jsx)(Ha.A,{className:"w-4 h-4 mr-2"}),a?"Copied!":"Copy"]})]})]})};var Nd=t(51654);const wd=(0,ts.cva)("rounded-full relative z-10",{variants:{saveSize:{sm:"h-5 w-5",default:"h-6 w-6",lg:"h-8 w-8",xl:"h-10 w-10"}},defaultVariants:{saveSize:"default"}});function kd(e){let{onClick:s,saveSize:t="default",className:a,...r}=e;const n="sm"===t?"h-3 w-3":"lg"===t?"h-5 w-5":"xl"===t?"h-6 w-6":"h-4 w-4";return(0,te.jsx)(sl,{...r,onMouseDown:e=>{e.preventDefault(),e.stopPropagation(),r.disabled||s()},className:ns(wd({saveSize:t}),a),children:(0,te.jsx)(mt.A,{className:n})})}function _d(e){let{initialText:s,onChange:t,className:a="",minWidth:r=60,maxWidth:n=280,validate:l}=e;const[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(s),[m,u]=(0,Y.useState)(s),[x,h]=(0,Y.useState)(r),[p,g]=(0,Y.useState)(!1),f=(0,Y.useRef)(null),v=(0,Y.useRef)(null),j=(0,Y.useRef)(null),b=()=>{if(j.current){const e=j.current.scrollWidth||j.current.offsetWidth,s=Math.min(Math.max(e,r),n),t=n;h(i?t:s),f.current&&(f.current.style.width=`${t}px`)}};(0,Y.useEffect)((()=>{i&&f.current&&(f.current.focus(),b())}),[i]),(0,Y.useEffect)((()=>{b()}),[c,i,r,n]),(0,Y.useEffect)((()=>{d(s)}),[s]);const y=()=>{u(c),o(!0)},N=()=>{g(!0),t(c),o(!1),g(!1)},w=()=>{d(m),o(!1)},k=()=>!l||l(c);return(0,te.jsxs)("div",{className:"inline-flex items-center group relative",children:[(0,te.jsxs)("div",{className:"relative",style:{minWidth:`${r}px`,maxWidth:`${n}px`},children:[i?(0,te.jsx)("input",{ref:f,type:"text",value:c,onChange:e=>{d(e.target.value)},onKeyDown:e=>{"Enter"===e.key?(e.preventDefault(),k()&&N()):"Escape"===e.key&&w()},onBlur:()=>{p||w()},className:`bg-transparent border-none outline-none p-0 m-0 ${a}`,style:{font:"inherit",fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit",letterSpacing:"inherit",color:"inherit"}}):(0,te.jsx)("span",{ref:v,onClick:y,className:`cursor-pointer whitespace-nowrap overflow-hidden text-ellipsis block ${a}`,children:c}),(0,te.jsx)("span",{ref:j,className:`absolute opacity-0 pointer-events-none whitespace-nowrap ${a}`,style:{font:"inherit",fontSize:"inherit",fontWeight:"inherit",lineHeight:"inherit",letterSpacing:"inherit",top:0,left:0,zIndex:-1},children:c}),(0,te.jsx)("div",{className:"absolute bottom-0 left-0 h-0.5 transition-all duration-200 pointer-events-none "+(i?"bg-slate-400":"border-b-2 border-dashed border-slate-400 opacity-0 group-hover:opacity-100"),style:{width:`${x}px`,zIndex:1}})]}),(0,te.jsx)("div",{className:"ml-2 w-7 h-7 flex items-center justify-center relative",children:i?(0,te.jsx)(kd,{onClick:N,disabled:!k(),saveSize:"lg",variant:"outline"}):(0,te.jsx)(Ba.A,{className:"h-5 w-5 text-slate-400 cursor-pointer",onClick:y})})]})}const Sd=e=>{if(!e||!e.entities)return!1;const s=Object.values(e.entities),t=s.length>0&&s.some((e=>!e.rls)),a="public_without_login"===e.public_settings||"public_with_login"===e.public_settings;return t&&a};function Cd(e){let{onClosePublish:s}=e;const{app:t}=vs(),a=(0,Z.Zp)(),[r,n]=(0,Y.useState)(!1),[l,i]=(0,Y.useState)(!1),o=Sd(t),c=`security-warning-dismissed-${t.id}`;(0,Y.useEffect)((()=>{"true"===localStorage.getItem(c)&&n(!0)}),[c]);const d=()=>{l||(i(!0),s&&s(),a(`/apps/${t.id}/editor/workspace/security?autoStartScan=1`),i(!1))};return o&&!r?(0,te.jsx)("div",{className:"pt-2",children:(0,te.jsx)(is,{variant:"destructive",className:"border-amber-300 bg-amber-100 text-gray-800 p-3",children:(0,te.jsx)("div",{className:"flex items-start justify-between w-full",children:(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsx)("div",{className:"font-semibold text-gray-800 text-sm mb-1",children:(0,te.jsx)("span",{children:"Your app data is publicly accessible"})}),(0,te.jsxs)(cs,{className:"text-gray-800 text-sm ",children:["Run a security scan and follow the recommendations to protect it.",(0,te.jsx)("div",{className:"mt-3",children:(0,te.jsx)(Rs,{size:"sm",onClick:d,disabled:l,className:"bg-amber-300 hover:bg-amber-400 text-gray-800 font-medium h-6 px-4 py-4 rounded-md",children:l?"Starting scan\u2026":"Run Security Scan"})})]})]})})})}):null}function Ad(){var e,s;const{app:t,updateApp:a}=vs(),{isInSharedWorkspace:r}=Xc(),n=(0,Z.Zp)(),{toast:l}=Un(),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(""),[j,b]=(0,Y.useState)([]);(0,Y.useEffect)((()=>{(async()=>{if(null!=t&&t.id)try{const e=await ja.filter({app_id:t.id});b(e)}catch(e){}})()}),[null==t?void 0:t.id]);const y=j.length>0?`https://${j[0].domain}`:Zt(t);(0,Y.useEffect)((()=>{t.user_description&&v(t.user_description)}),[t.user_description]);return(0,te.jsxs)("div",{className:"h-full bg-gray-50 p-4 sm:p-6",children:[(0,te.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,te.jsxs)("div",{className:"space-y-6 mb-8",children:[(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 sm:gap-6 items-start sm:items-center",children:[(0,te.jsx)("div",{className:"shrink-0 w-16 sm:w-20 h-16 sm:h-20 rounded-xl bg-white shadow p-3 flex items-center justify-center",children:t.logo_url?(0,te.jsx)("img",{src:t.logo_url,alt:`${t.name} logo`,className:"w-12 h-12 object-contain"}):(0,te.jsx)("div",{className:"w-12 h-12 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,te.jsx)("span",{className:"text-xl font-bold text-gray-400",children:(null===(e=t.name)||void 0===e||null===(s=e[0])||void 0===s?void 0:s.toUpperCase())||"A"})})}),(0,te.jsxs)("div",{className:"flex-grow min-w-0",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between flex-wrap",children:[(0,te.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:(0,te.jsx)(_d,{initialText:t.name||"untitled",onChange:async e=>{var s;"ready"===(null===(s=t.status)||void 0===s?void 0:s.state)?0!==e.length?a({name:e}):l({title:"Error",description:"App name cannot be empty",variant:"destructive"}):l({title:"Error",description:"App is still loading... name not updated",variant:"destructive"})},validate:e=>e.trim().length>0})}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>{a({is_starred:!t.is_starred}),l({title:t.is_starred?"Removed from favorites":"Added to favorites",description:t.is_starred?"App removed from your starred list":"App added to your starred list"})},className:"hover:bg-yellow-100 transition-colors "+(t.is_starred?"text-yellow-500":"text-gray-400"),children:(0,te.jsx)(wa.A,{className:"h-4 w-4 "+(t.is_starred?"fill-current":"")})})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("p",{className:"text-gray-600 text-sm mt-1",children:t.user_description}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>{v(t.user_description||""),g(!0)},className:"mt-1 p-1 pr-3 h-auto",children:(0,te.jsx)(Ba.A,{className:"h-3 w-3 text-gray-400"})})]}),(0,te.jsxs)("p",{className:"text-xs text-muted-foreground mt-1",children:["Created ",Bt().utc(t.created_date).fromNow()]})]})]}),(0,te.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,te.jsxs)(Rs,{variant:"outline",onClick:()=>{n(`/apps/${t.id}/editor/preview/${Object.keys(t.pages)[0]}`)},className:"gap-1.5 w-36 h-10",children:[(0,te.jsx)(ur.A,{className:"w-4 h-4"}),"Open App"]}),(0,te.jsxs)(Rs,{variant:"outline",onClick:()=>u(!0),className:"gap-1.5 w-36 h-10",children:[(0,te.jsx)(pa.A,{className:"w-4 h-4 ml-[-8px]"}),(0,te.jsxs)("div",{className:"flex flex-col items-start",children:[(0,te.jsx)("span",{className:"mb-[-6px]",children:"Share App"}),(0,te.jsx)("span",{className:"text-[9px] mb-[-3px] text-gray-500",children:"win free credits!"})]})]})]})]}),(0,te.jsxs)("div",{className:"grid sm:grid-cols-2 gap-4",children:[(0,te.jsx)(Vs,{children:(0,te.jsxs)(Js,{className:"p-4",children:[(0,te.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-base font-semibold",children:"App Visibility"}),(0,te.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:"Control who can access your application"})]})}),(0,te.jsxs)("div",{children:[(0,te.jsx)(ld,{value:t.public_settings||"private_with_login",onValueChange:async e=>{o(!0);try{await a({public_settings:e})}finally{o(!1)}},disabled:i,showWorkspace:r}),(0,te.jsx)(Cd,{})]})]})}),(0,te.jsx)(Vs,{children:(0,te.jsxs)(Js,{className:"p-4",children:[(0,te.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-base font-semibold mb-1",children:"Invite Users"}),(0,te.jsx)("p",{className:"text-gray-600 text-xs",children:"Grow your user base by inviting others"})]}),(0,te.jsx)(Wa.A,{className:"w-4 h-4 text-gray-400"})]}),(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsxs)(Rs,{variant:"outline",className:"w-full h-10 text-sm",onClick:()=>{return e=y,navigator.clipboard.writeText(e),h(!0),void setTimeout((()=>h(!1)),2e3);var e},children:[(0,te.jsx)(Ha.A,{className:"w-3 h-3 mr-1"}),x?"Copied!":"Copy Link"]}),(0,te.jsx)(Rs,{className:"w-full h-10 text-sm bg-blue-600 hover:bg-blue-700",onClick:()=>d(!0),children:"Send Invites"})]})]})})]}),!0===t.is_remixable&&(0,te.jsx)(Vs,{className:"mt-4",children:(0,te.jsx)(Js,{className:"p-4",children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-base font-semibold",children:"Platform Badge"}),(0,te.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:'The "Edit with Base44" badge is currently visible on your app.'})]}),(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>{n(`/apps/${t.id}/editor/workspace/app-settings?selectedParam=platform-badge`)},className:"gap-1.5",children:[(0,te.jsx)(Nd.A,{className:"w-3.5 h-3.5"}),"Hide Badge"]})]})})})]}),(0,te.jsx)(kc,{isVisible:c,onCancel:()=>d(!1),onInviteSuccess:()=>d(!1)}),(0,te.jsx)(ba,{app:t,isOpen:m,onClose:()=>u(!1)}),(0,te.jsx)(na,{open:p,onOpenChange:g,children:(0,te.jsxs)(da,{className:"sm:max-w-md",children:[(0,te.jsxs)(ma,{children:[(0,te.jsx)(xa,{children:"Edit App Description"}),(0,te.jsx)(ha,{children:"Provide a brief description of your app's purpose and functionality."})]}),(0,te.jsx)("div",{className:"py-4",children:(0,te.jsx)(Ui,{value:f,onChange:e=>v(e.target.value),placeholder:"Describe your app...",className:"min-h-[100px]"})}),(0,te.jsxs)(ua,{children:[(0,te.jsx)(Rs,{variant:"outline",onClick:()=>g(!1),children:"Cancel"}),(0,te.jsx)(Rs,{onClick:async()=>{try{await a({user_description:f}),g(!1),l({title:"Description updated",description:"Your app description has been updated successfully"})}catch(e){l({title:"Error",description:"Failed to update app description",variant:"destructive"})}},children:"Save"})]})]})})]})}var Ed=t(45833);const Id=function(){const{app:e}=vs(),[s,t]=(0,Y.useState)([]),[a,r]=(0,Y.useState)(1),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)({userEmail:"",showFailuresOnly:!1,logType:"all"}),m=async()=>{l(!0);try{let s={};c.userEmail&&(s.user_email=c.userEmail),c.showFailuresOnly&&(s.status="error"),"all"!==c.logType&&(s.log_type=c.logType);const r=await ta.fetchLogs(e.id,{sort:"-created_date",q:s,skip:50*(a-1),limit:50});t(r)}catch(s){}l(!1)};(0,Y.useEffect)((()=>{null!=e&&e.id&&m()}),[null==e?void 0:e.id,a,c]);const u=e=>{switch(e){case"error":return(0,te.jsx)(ws,{children:(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)("div",{children:(0,te.jsx)(Ke.A,{className:"text-destructive",size:16})})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Error"})})]})});case"success":return(0,te.jsx)(ws,{children:(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)("div",{children:(0,te.jsx)(Ed.A,{className:"text-success",size:16})})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Success"})})]})});default:return(0,te.jsx)(ws,{children:(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)("div",{children:(0,te.jsx)(rl.A,{className:"text-primary",size:16})})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Info"})})]})})}},x=[...new Set(s.map((e=>e.log_type)))];return(0,te.jsxs)("div",{className:"space-y-4 p-4",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("h2",{className:"text-xl font-semibold",children:"Logs Explorer"}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>{m()},children:[(0,te.jsx)($c.A,{className:"h-4 w-4 mr-1"}),"Refresh"]}),(0,te.jsx)(ws,{children:(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)(Rs,{variant:"outline",size:"sm",children:(0,te.jsx)(vo.A,{className:"h-4 w-4"})})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Export logs"})})]})})]})]}),(0,te.jsxs)("div",{className:"flex flex-wrap items-center gap-2 rounded-md border bg-card p-2",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Na.A,{className:"h-4 w-4 text-muted-foreground"}),(0,te.jsx)(Qs,{placeholder:"Filter by email...",className:"h-8 w-44 bg-transparent",value:c.userEmail,onChange:e=>d((s=>({...s,userEmail:e.target.value})))})]}),(0,te.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,te.jsx)(zi,{id:"showFailures",checked:c.showFailuresOnly,onCheckedChange:e=>d((s=>({...s,showFailuresOnly:!!e})))}),(0,te.jsx)("label",{htmlFor:"showFailures",className:"text-sm cursor-pointer",children:"Errors only"})]}),(0,te.jsxs)(ut,{value:c.logType,onValueChange:e=>d((s=>({...s,logType:e}))),children:[(0,te.jsx)(pt,{className:"h-8 w-36",children:(0,te.jsx)(ht,{placeholder:"Log type"})}),(0,te.jsxs)(vt,{children:[(0,te.jsx)(bt,{value:"all",children:"All types"}),x.map((e=>(0,te.jsx)(bt,{value:e,children:e},e)))]})]}),(0,te.jsxs)(Rs,{variant:"ghost",size:"sm",onClick:()=>d({userEmail:"",showFailuresOnly:!1,logType:"all"}),children:[(0,te.jsx)(Ds.A,{className:"h-3.5 w-3.5 mr-1"}),"Clear"]})]}),n?(0,te.jsx)("div",{className:"flex h-40 items-center justify-center",children:(0,te.jsx)("div",{className:"h-8 w-8 animate-spin rounded-full border-4 border-primary border-t-transparent"})}):(0,te.jsx)("div",{className:"rounded-md border bg-card",children:(0,te.jsxs)(Ia,{children:[(0,te.jsx)(La,{children:(0,te.jsxs)(Da,{children:[(0,te.jsx)(Pa,{className:"w-12"}),(0,te.jsx)(Pa,{children:"Type"}),(0,te.jsx)(Pa,{children:"User"}),(0,te.jsx)(Pa,{children:"Timestamp"}),(0,te.jsx)(Pa,{className:"w-10"})]})}),(0,te.jsx)(Ta,{children:0===s.length?(0,te.jsx)(Da,{children:(0,te.jsx)(Ma,{colSpan:5,className:"h-32 text-center text-muted-foreground",children:"No logs found"})}):s.map(((e,s)=>{return(0,te.jsxs)(Y.Fragment,{children:[(0,te.jsxs)(Da,{className:(null==i?void 0:i.created_date)===e.created_date?"bg-muted/50":"",children:[(0,te.jsx)(Ma,{className:"pr-0",children:u(e.status)}),(0,te.jsx)(Ma,{className:"font-medium",children:e.object_name||e.log_type}),(0,te.jsx)(Ma,{className:"text-sm text-muted-foreground",children:e.user_email}),(0,te.jsx)(Ma,{className:"text-sm text-muted-foreground",children:(t=e.created_date,new Date(t).toLocaleString())}),(0,te.jsx)(Ma,{className:"text-right",children:(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>o((null==i?void 0:i.created_date)===e.created_date?null:e),children:(null==i?void 0:i.created_date)===e.created_date?(0,te.jsx)(dt.A,{size:16}):(0,te.jsx)(ct.A,{size:16})})})]}),(null==i?void 0:i.created_date)===e.created_date&&(0,te.jsx)(Da,{children:(0,te.jsx)(Ma,{colSpan:5,className:"p-0",children:(0,te.jsx)("div",{className:"bg-muted/30 px-6 py-3",children:(0,te.jsxs)("div",{className:"grid grid-cols-1 gap-4 md:grid-cols-2",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"mb-2 text-sm font-semibold",children:"Inputs"}),(0,te.jsx)("pre",{className:"max-h-60 overflow-auto rounded bg-card p-2 text-xs",children:JSON.stringify(e.inputs,null,2)})]}),e.outputs&&(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"mb-2 text-sm font-semibold",children:"Outputs"}),(0,te.jsx)("pre",{className:"max-h-60 overflow-auto rounded bg-card p-2 text-xs",children:JSON.stringify(e.outputs,null,2)})]}),e.error&&(0,te.jsxs)("div",{className:e.outputs?"col-span-2":"",children:[(0,te.jsx)("h4",{className:"mb-2 text-sm font-semibold text-destructive",children:"Error"}),(0,te.jsx)("pre",{className:"max-h-60 overflow-auto rounded bg-destructive/10 p-2 text-xs text-destructive-foreground",children:e.error})]})]})})})})]},s);var t}))})]})}),(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)(Rs,{variant:"outline",size:"sm",disabled:1===a,onClick:()=>r((e=>Math.max(1,e-1))),children:"Previous"}),(0,te.jsxs)("span",{className:"text-sm text-muted-foreground",children:["Page ",a]}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",disabled:s.length<50,onClick:()=>r((e=>e+1)),children:"Next"})]})]})};var Ld=t(45403),Td=t(81095),$d=t(68354),Dd=t(93245),Pd=t(60158),Md=t(44813),Od=t(40992),Rd=t(10734),Fd=t(81850);const zd=e=>{let{data:s,title:t="Bar Chart",barColor:a="#14b8a6",maxWidth:r="800px",maxLabelWidth:n="40%",backgroundColor:l="white",textColor:i="#1f2937",renderLabel:o=e=>e.name,renderValue:c=e=>e.value}=e;const d=Math.max(...s.map((e=>e.value))),m=s.length,u=m<=5?"40px":m<=10?"32px":m<=20?"24px":"16px",x=m<=5?"14px":m<=10?"12px":m<=20?"10px":"8px";return(0,te.jsxs)("div",{style:{width:"100%",maxWidth:r,margin:"0 auto",padding:"24px",backgroundColor:l,borderRadius:"8px",overflow:"hidden"},children:[t&&(0,te.jsx)("h2",{style:{fontSize:"24px",fontWeight:"bold",marginBottom:"24px",color:i,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t}),(0,te.jsx)("div",{style:{display:"flex",flexDirection:"column",gap:"8px"},children:s.map(((e,s)=>{const t=e.value/d*100;return(0,te.jsxs)("div",{style:{position:"relative",height:u,marginBottom:"8px",overflow:"hidden"},children:[(0,te.jsx)("div",{style:{position:"absolute",top:0,left:0,height:"100%",width:`${t}%`,backgroundColor:a,borderRadius:"4px",transition:"width 0.5s ease-in-out"}}),(0,te.jsx)("div",{style:{position:"absolute",left:"8px",top:"50%",transform:"translateY(-50%)",fontSize:x,fontWeight:"500",color:i,zIndex:1,whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",maxWidth:n},children:o(e)}),(0,te.jsx)("div",{style:{position:"absolute",right:"8px",top:"50%",transform:"translateY(-50%)",fontSize:x,fontWeight:"500",color:i,overflow:"hidden",textOverflow:"ellipsis"},children:c(e)})]},s)}))})]})};function Ud(e){var s;let{appId:t,pageNames:a}=e;const[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)({from:void 0,to:void 0}),[o,c]=(0,Y.useState)("all"),[d,m]=(0,Y.useState)(null),[u,x]=(0,Y.useState)(!0),[h,p]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{(async()=>{x(!0);try{const e={};null!=l&&l.from&&(e.date_from=(0,Do.GP)(l.from,"yyyy-MM-dd")),null!=l&&l.to&&(e.date_to=(0,Do.GP)(l.to,"yyyy-MM-dd")),"all"!==o&&(e.page_name=o),d&&(e.user_email=d);const s=await ta.getStats(t,e);n(s)}catch(e){}finally{x(!1)}})()}),[t,l,o,d]);const g=(r?"all"===o?r.top_pages:r.top_pages.filter((e=>e.url===o)):[]).map((e=>({name:e.page_name,value:e.visits}))),f=null!=r&&r.top_users?h?r.top_users:r.top_users.slice(0,5):[],v=(null==r||null===(s=r.top_users)||void 0===s?void 0:s.length)>5;return u&&!r?(0,te.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):(0,te.jsxs)("div",{className:"space-y-4 p-4",children:[(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,te.jsxs)(Mo,{children:[(0,te.jsx)(Oo,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"outline",className:ns("w-full sm:w-[240px] justify-start text-left font-normal",!l&&"text-muted-foreground"),children:[(0,te.jsx)(At.A,{className:"mr-2 h-4 w-4"}),null!=l&&l.from?l.to?(0,te.jsxs)(te.Fragment,{children:[(0,Do.GP)(l.from,"LLL dd, y")," - ",(0,Do.GP)(l.to,"LLL dd, y")]}):(0,Do.GP)(l.from,"LLL dd, y"):(0,te.jsx)("span",{children:"Pick a date range"})]})}),(0,te.jsx)(Ro,{className:"w-auto p-0",align:"start",children:(0,te.jsx)($o,{initialFocus:!0,mode:"range",defaultMonth:null==l?void 0:l.from,selected:l,onSelect:i,numberOfMonths:1})})]}),(0,te.jsxs)(ut,{value:o,onValueChange:c,children:[(0,te.jsx)(pt,{className:"w-full sm:w-[240px]",children:(0,te.jsx)(ht,{placeholder:"Filter by page"})}),(0,te.jsxs)(vt,{children:[(0,te.jsx)(bt,{value:"all",children:"All Pages"}),null==a?void 0:a.map((e=>(0,te.jsx)(bt,{value:e,children:e},e)))]})]}),d&&(0,te.jsxs)("div",{className:"flex items-center gap-2 bg-muted px-3 py-2 rounded-md",children:[(0,te.jsxs)("span",{className:"text-sm",children:["Filtered by user: ",d]}),(0,te.jsx)("button",{onClick:()=>m(null),className:"text-muted-foreground hover:text-foreground",children:(0,te.jsx)(Fd.A,{className:"h-4 w-4"})})]}),u&&(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin text-muted-foreground"}),(0,te.jsx)("span",{className:"text-sm text-muted-foreground",children:"Updating..."})]})]}),(0,te.jsxs)("div",{className:"grid gap-4 grid-cols-1 md:grid-cols-2",children:[(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{className:"pb-2",children:(0,te.jsx)(Hs,{className:"text-lg",children:"Total Unique Users"})}),(0,te.jsx)(Js,{children:(0,te.jsx)("div",{className:"text-3xl font-bold",children:(null==r?void 0:r.unique_users_count)||0})})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{className:"pb-2",children:(0,te.jsx)(Hs,{className:"text-lg",children:"Top Users"})}),(0,te.jsx)(Js,{children:(0,te.jsxs)("div",{className:"space-y-2",children:[f.map(((e,s)=>(0,te.jsxs)("div",{className:"flex justify-between items-center text-sm cursor-pointer hover:bg-muted p-2 rounded-md",onClick:()=>m(e.email),children:[(0,te.jsx)("span",{className:"truncate max-w-[180px]",children:e.email}),(0,te.jsxs)("span",{className:"font-semibold",children:[e.visits," visits"]})]},s))),v&&(0,te.jsx)(Rs,{variant:"ghost",className:"w-full mt-2 text-sm text-muted-foreground hover:text-foreground",onClick:()=>p(!h),children:h?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(dt.A,{className:"h-4 w-4 mr-2"})," Show Less"]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(ct.A,{className:"h-4 w-4 mr-2"})," Show More Users"]})})]})})]})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsx)(Hs,{className:"text-lg",children:"Top Pages"})}),(0,te.jsxs)(Js,{children:[(0,te.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Shows the most visited pages in your app and their total visit count"}),(0,te.jsx)(zd,{data:g,title:"",maxWidth:"100%",maxLabelWidth:"60%",backgroundColor:"transparent",renderLabel:e=>"all"===t?(0,te.jsx)(J.Link,{to:`/apps/${e.name}`,target:"_blank",className:"hover:underline",children:e.name}):e.name})]})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsx)(Hs,{className:"text-lg",children:"Unique Users Over Time"})}),(0,te.jsxs)(Js,{children:[(0,te.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Tracks the number of distinct users accessing your app each day"}),(null==r?void 0:r.users_per_date.length)<=1?(0,te.jsx)("div",{className:"h-[200px] flex items-center justify-center text-muted-foreground",children:"Not enough data to show trends"}):(0,te.jsx)("div",{className:"h-[300px]",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)($d.Q,{data:r.users_per_date,margin:{top:10,right:10,left:0,bottom:0},children:[(0,te.jsx)(Dd.d,{strokeDasharray:"3 3"}),(0,te.jsx)(Pd.W,{dataKey:"date"}),(0,te.jsx)(Md.h,{}),(0,te.jsx)(Od.m,{}),(0,te.jsx)(Rd.G,{type:"monotone",dataKey:"unique_users",stroke:"#8884d8",fill:"#8884d8",name:"Unique Users"})]})})})]})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsx)(Hs,{className:"text-lg",children:"Total Usage Over Time"})}),(0,te.jsxs)(Js,{children:[(0,te.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Shows the total number of visits to your app, including repeat visits from the same users"}),(null==r?void 0:r.users_per_date.length)<=1?(0,te.jsx)("div",{className:"h-[200px] flex items-center justify-center text-muted-foreground",children:"Not enough data to show trends"}):(0,te.jsx)("div",{className:"h-[300px]",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)($d.Q,{data:r.users_per_date,margin:{top:10,right:10,left:0,bottom:0},children:[(0,te.jsx)(Dd.d,{strokeDasharray:"3 3"}),(0,te.jsx)(Pd.W,{dataKey:"date"}),(0,te.jsx)(Md.h,{}),(0,te.jsx)(Od.m,{}),(0,te.jsx)(Rd.G,{type:"monotone",dataKey:"total_visits",stroke:"#82ca9d",fill:"#82ca9d",name:"Total Visits"})]})})})]})]})]})}const Bd=function(){const{app:e}=vs();return(0,te.jsx)(Ud,{appId:e.id,pageNames:Object.keys(e.pages)})};var Wd=t(71742);const qd=e=>{if(!e)return null;const s=e.match(/Deployment (.*?) failed with error (.*)/);return s?{deployment:`${s[1]} failed`,error:s[2].replace(/\\n\\n+/g,": ").replace(/\\n+/g," ").trim()}:void 0};function Vd(e){let{isSaving:s,hasEditorErrors:t,onDiscard:a,onSave:r,onSaveAndRedeploy:n,hasUnsavedChanges:l,isFunction:i,deploymentError:o,onClearError:c}=e;if(!l&&!o)return null;const d=qd(o);return d?(0,te.jsx)("div",{className:"fixed bottom-2 right-6 w-full max-w-2xl z-[100]",children:(0,te.jsxs)("div",{className:"flex flex-col bg-white/95 backdrop-blur border border-red-200 text-red-700 rounded-lg shadow-lg overflow-hidden",children:[(0,te.jsxs)("div",{className:"flex items-start p-3 gap-3 bg-red-50/80",children:[(0,te.jsx)("div",{className:"flex-1 min-w-0",children:(0,te.jsx)("div",{className:"font-medium text-base text-red-800",children:d.deployment})}),(0,te.jsx)("button",{onClick:c,className:"text-red-600 hover:text-red-700 hover:bg-red-100 p-1.5 rounded-md transition-colors","aria-label":"Close",children:(0,te.jsx)(Ds.A,{className:"w-4 h-4"})})]}),d.error&&(0,te.jsx)("div",{className:"p-3 bg-white/50 border-t border-red-100",children:(0,te.jsx)("div",{className:"font-mono text-xs text-red-600 whitespace-pre-wrap break-words bg-red-50/50 rounded-md p-3",children:d.error})})]})}):(0,te.jsxs)("div",{className:"fixed bottom-6 right-6 flex flex-col gap-2 w-56 z-[200]",children:[t&&(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-1 px-2 py-1 bg-red-50 border border-red-200 text-red-700 text-xs rounded shadow",children:[(0,te.jsx)(Ke.A,{className:"w-4 h-4 text-red-500"}),(0,te.jsx)("span",{children:"Editor has errors"})]}),(0,te.jsxs)(Rs,{variant:"outline",size:"lg",className:"rounded-full shadow-lg w-full",onClick:a,disabled:s,children:[(0,te.jsx)(nn.A,{className:"w-4 h-4 mr-2"}),"Discard"]}),i?(0,te.jsxs)(Rs,{size:"lg",className:"relative rounded-full shadow-lg bg-gray-900 text-white hover:bg-gray-800 w-full justify-center",onClick:n,disabled:s,children:[s?(0,te.jsx)($c.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,te.jsx)($c.A,{className:"w-4 h-4 mr-2"}),"Save & Redeploy"]}):(0,te.jsxs)(Rs,{size:"lg",className:"rounded-full shadow-lg bg-gray-900 text-white hover:bg-gray-800 w-full",onClick:r,disabled:s,children:[s?(0,te.jsx)(Wd.A,{className:"w-4 h-4 mr-2 animate-spin"}):(0,te.jsx)(Wd.A,{className:"w-4 h-4 mr-2"}),"Save"]})]})}function Yd(e){let{filepath:s,selectedLine:t,onEdit:a,onSaveOrDiscard:r,isFunction:n,onRedeployFunction:l}=e;const{user:i}=ne(),{app:o,writeCodeToFile:c}=vs(),[d,m]=(0,Y.useState)(!1),[u,x]=(0,Y.useState)(""),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,j]=(0,Y.useState)(null),b=(0,Y.useRef)(null),y=(0,Y.useRef)(null),N="free"===(null==i?void 0:i.subscription_tier),w=(0,Y.useRef)(null),k=(0,Y.useRef)(""),_=(0,Y.useRef)(s),[S,C]=(0,Y.useState)(!0),A=()=>{if(b.current&&y.current){const e=b.current.getModel(),s=y.current;if(e&&s){const t=s.editor.getModelMarkers({resource:e.uri}).some((e=>e.severity===s.MarkerSeverity.Error));C(t)}}};(0,Y.useEffect)((()=>{if(!s||!o)return;f(!1);let e="";if("layout"===s)e=o.layout;else if(s.startsWith("pages/")){const t=s.split("pages/")[1];e=o.pages[t]}else if(s.startsWith("components/")){const t=s.split("components/")[1];e=o.components[t]}else if(s.startsWith("functions/")){const t=s.split("functions/")[1];e=o.functions[t]}else if(s.startsWith("entities/")){const t=s.split("entities/")[1];e=JSON.stringify(o.entities[t],null,2)}if(x(e),k.current=e,_.current=s,f(!0),b.current&&(w.current=b.current.saveViewState()),b.current){const e=b.current.getModel();if(e){const s=e.onDidChangeDecorations((()=>{A(),s&&s.dispose&&s.dispose()}))}}}),[s,o]),(0,Y.useEffect)((()=>{b.current&&w.current&&(b.current.restoreViewState(w.current),b.current.focus(),w.current=null)}),[u,h]),(0,Y.useEffect)((()=>{t&&h&&g&&u&&(()=>{if(!(b.current&&t&&h&&g))return;const e=b.current,s=e.getModel();if(!s)return;const a=parseInt(t,10);if(isNaN(a)||a<=0)return;const r=s.getLineCount(),n=Math.min(a,r);requestAnimationFrame((()=>{try{e.revealLineInCenter(n),e.setPosition({lineNumber:n,column:1}),e.setSelection({startLineNumber:n,startColumn:1,endLineNumber:n,endColumn:s.getLineMaxColumn(n)}),e.focus()}catch(t){}}))})()}),[t,h,g,u]),(0,Y.useEffect)((()=>{if(!b.current||!y.current)return;const e=b.current.getModel(),s=y.current;if(!e||!s)return;const t=s.editor.onDidChangeMarkers((s=>{s.some((s=>s.toString()===e.uri.toString()))&&A()}));return A(),()=>{t&&t.dispose&&t.dispose()}}),[h,u]),(0,Y.useEffect)((()=>{j(null)}),[s]);const E=u!==k.current;return(0,te.jsxs)("div",{className:"h-full relative",children:[(0,te.jsx)(Vd,{isSaving:d,hasEditorErrors:S,onDiscard:()=>{x(k.current),b.current&&w.current&&(b.current.restoreViewState(w.current),b.current.focus()),r&&r()},onSave:async()=>{m(!0),await(async e=>{N||(m(!0),await c(s,e),m(!1))})(u),m(!1),r&&r()},onSaveAndRedeploy:async()=>{if(m(!0),j(null),r&&r(),l)try{await l(u)}catch(e){j(e.message||"Failed to redeploy function")}m(!1)},hasUnsavedChanges:E,isFunction:n,deploymentError:v,onClearError:()=>{j(null)}}),(0,te.jsx)(rr.KE,{defaultLanguage:"javascript",value:u,onChange:e=>{N||(x(e),b.current&&(w.current=b.current.saveViewState()),a&&a())},onMount:(e,s)=>{b.current=e,y.current=s,p(!0);const t=e.getModel();t&&t.onDidChangeContent((()=>{f(!0)}))},options:{minimap:{enabled:!1},scrollBeyondLastLine:!1,fontSize:14,readOnly:N||d,padding:{top:N?40:0}},height:"100%"}),N&&(0,te.jsxs)("div",{className:"absolute top-0 left-0 right-0 bg-amber-50 border-b border-amber-200 p-3 z-10 text-sm text-amber-800",children:["Code editing is only available on paid plans.",(0,te.jsx)(J.Link,{to:"/billing",className:"ml-2 text-blue-600 hover:underline",children:"Upgrade your plan"})]}),d&&(0,te.jsx)("div",{className:"absolute top-10 right-2 bg-gray-700 text-white text-xs px-2 py-1 rounded opacity-70"})]})}function Hd(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};const a=(0,ee.Ay)(`https://base44.app/api/apps/${e.id}/functions`,t,!0,!1,!1);s=s||(e=>{}),a.interceptors.response.use((e=>e),(e=>{const t=`error trying to call function: ${e.config.url}`;let a=e.config.data;try{"string"!=typeof a&&(a=JSON.stringify(a)),a&&a.length>1e3&&(a=a.substring(0,997)+"...")}catch(i){a=String(a)}let r="";try{var n;null!==(n=e.response)&&void 0!==n&&n.data?(r="object"==typeof e.response.data?JSON.stringify(e.response.data):String(e.response.data),r.length>1e3&&(r=r.substring(0,997)+"...")):r=e.message||"Unknown error"}catch(i){r=String(e)||"Unknown error"}const l=`When using the app, on url ${window.location.href} the following function call failed: \nurl: ${e.config.baseURL}${e.config.url}\nmethod: ${e.config.method}\ndata: ${a}\nerror: ${r}`;return s(t,l),Promise.reject(e)}));let r={};return(e.function_names||Object.keys(e.functions||{})).forEach((e=>{r[e]=async s=>await a.post(`/${e}`,s||{})})),r}var Gd=t(25692),Jd=t(7838),Zd=t(30621),Kd=t(5487);const Xd=(0,Y.forwardRef)(((e,s)=>{let{functionName:t,hasUnsavedChanges:a}=e;const{user:r}=ne(),{app:n,runtimeAuthToken:l}=vs(),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)("{\n  \n}"),[f,v]=(0,Y.useState)(null),[j,b]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(null),[w,k]=(0,Y.useState)(null),[_,S]=(0,Y.useState)(!1),[C,A]=(0,Y.useState)(!1),[E,I]=(0,Y.useState)(!1),[L,T]=(0,Y.useState)([]),[$,D]=(0,Y.useState)(!1),[P,M]=(0,Y.useState)(null),[O,R]=(0,Y.useState)(0),[F]=(0,Y.useState)(50),[z,U]=(0,Y.useState)(!0);(0,Y.useEffect)((()=>{o(Hd(n,(()=>{}),{Authorization:`Bearer ${l}`}))}),[null==n?void 0:n.id,null==n?void 0:n.functions]);const B=async e=>{if(null!=n&&n.id&&t)try{await pe.redeployFunction(n.id,t,e)}catch(r){var s,a;const e=(null===(s=r.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||r.message||"An error occurred while redeploying the function";throw new Error(e)}};(0,Y.useImperativeHandle)(s,(()=>({handleRedeployFunction:B})));const W=async(e,s)=>{try{await navigator.clipboard.writeText(e),"url"===s?(S(!0),setTimeout((()=>S(!1)),2e3)):"headers"===s?(A(!0),setTimeout((()=>A(!1)),2e3)):"curl"===s&&(I(!0),setTimeout((()=>I(!1)),2e3))}catch(t){}},q=()=>null!=n&&n.slug&&null!=n&&n.id&&t?`${Zt(n)}/api/apps/${n.id}/functions/${t}`:"",V=()=>{const e={"Content-Type":"application/json"};return null!=r&&r.api_key&&(e.api_key=r.api_key),e},H=async function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(null!=n&&n.id&&t){D(!0),M(null);try{const a=await od.getBackendFunctionsLogs(n.id,t,{limit:F,offset:e});T(s||0===e?a:e=>[...e,...a]),U(a.length===F),R(e)}catch(l){var a,r;M((null===(a=l.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||l.message||"Failed to fetch logs")}finally{D(!1)}}},G=e=>{try{return new Date(e).toLocaleString()}catch(s){return e}},J=e=>{switch(null==e?void 0:e.toLowerCase()){case"error":return"text-red-600 bg-red-50 border-red-200";case"warn":case"warning":return"text-amber-600 bg-amber-50 border-amber-200";case"info":return"text-blue-600 bg-blue-50 border-blue-200";case"debug":return"text-purple-600 bg-purple-50 border-purple-200";default:return"text-slate-600 bg-slate-50 border-slate-200"}};return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"fixed bottom-6 right-6",children:!a&&(0,te.jsxs)("div",{className:"bg-white/95 backdrop-blur-sm border border-slate-200 rounded-2xl shadow-2xl p-2 flex items-center gap-1",children:[(0,te.jsxs)(Rs,{variant:"ghost",size:"sm",className:"rounded-xl text-slate-600 hover:text-slate-800 hover:bg-slate-100 transition-all duration-200",onClick:()=>d(!0),children:[(0,te.jsx)(Gd.A,{className:"h-4 w-4 mr-2"}),"Test Function"]}),(0,te.jsx)("div",{className:"w-px h-6 bg-slate-300 mx-1"}),(0,te.jsxs)(Rs,{variant:"ghost",size:"sm",className:"rounded-xl text-slate-600 hover:text-slate-800 hover:bg-slate-100 transition-all duration-200",onClick:()=>{h(!0),0===L.length&&H(0,!0)},children:[(0,te.jsx)(Jd.A,{className:"h-4 w-4 mr-2"}),"Logs"]}),(0,te.jsx)("div",{className:"w-px h-6 bg-slate-300 mx-1"}),(0,te.jsxs)(Rs,{variant:"ghost",size:"sm",className:"rounded-xl text-slate-600 hover:text-slate-800 hover:bg-slate-100 transition-all duration-200",onClick:()=>u(!0),children:[(0,te.jsx)(Ua.A,{className:"h-4 w-4 mr-2"}),"API"]})]})}),y&&(0,te.jsx)("div",{className:"fixed bottom-24 right-6 max-w-md",children:(0,te.jsxs)(is,{variant:"destructive",className:"bg-white/95 backdrop-blur-sm border-red-200",children:[(0,te.jsx)(Kd.A,{className:"h-4 w-4"}),(0,te.jsx)(os,{children:"Deployment Error"}),(0,te.jsx)(cs,{className:"font-mono text-sm whitespace-pre-wrap break-all",children:y})]})}),(0,te.jsx)(dc,{open:x&&!a,onOpenChange:h,children:(0,te.jsxs)(gc,{className:"sm:max-w-3xl md:max-w-5xl w-[96vw]",children:[(0,te.jsx)(fc,{className:"pb-3",children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Jd.A,{className:"h-5 w-5 text-teal-600"}),(0,te.jsx)(jc,{className:"text-slate-800 text-lg",children:"Logs"})]}),(0,te.jsx)("div",{className:"text-sm text-slate-500 font-mono bg-slate-100 px-2 py-1 rounded",children:t})]}),(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>{H(0,!0)},disabled:$,className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50 border-teal-200",children:[(0,te.jsx)($c.A,{className:"h-4 w-4 mr-1 "+($?"animate-spin":"")}),"Refresh"]})]})}),(0,te.jsxs)("div",{className:"space-y-3",children:[P&&(0,te.jsxs)(is,{variant:"destructive",className:"mb-4",children:[(0,te.jsx)(Kd.A,{className:"h-4 w-4"}),(0,te.jsx)(os,{children:"Error"}),(0,te.jsx)(cs,{children:P})]}),0===L.length&&!$&&!P&&(0,te.jsxs)("div",{className:"text-center py-8 text-slate-500",children:[(0,te.jsx)(It.A,{className:"h-8 w-8 mx-auto mb-3 text-slate-400"}),(0,te.jsx)("p",{className:"font-medium mb-1",children:"No logs found"}),(0,te.jsx)("p",{className:"text-xs text-slate-400",children:"This function hasn't generated any logs yet."})]}),L.length>0&&(0,te.jsx)("div",{className:"max-h-[70vh] overflow-y-auto border border-slate-200 rounded-lg",children:(0,te.jsx)("div",{className:"divide-y divide-slate-100",children:L.map(((e,s)=>{return(0,te.jsxs)("div",{className:"px-3 py-2 hover:bg-slate-50/50 transition-colors "+(J(e.level).includes("red")?"bg-red-50/30":J(e.level).includes("amber")?"bg-amber-50/30":J(e.level).includes("blue")?"bg-blue-50/30":J(e.level).includes("purple")?"bg-purple-50/30":""),children:[(0,te.jsx)("div",{className:"flex items-start gap-3 mb-1",children:(0,te.jsxs)("div",{className:"flex items-center gap-2 flex-shrink-0",children:[e.level&&(0,te.jsx)("span",{className:"text-xs font-medium uppercase px-1.5 py-0.5 rounded-sm "+("error"===e.level.toLowerCase()?"bg-red-100 text-red-700 border border-red-200":"warn"===e.level.toLowerCase()||"warning"===e.level.toLowerCase()?"bg-amber-100 text-amber-700 border border-amber-200":"info"===e.level.toLowerCase()?"bg-blue-100 text-blue-700 border border-blue-200":"debug"===e.level.toLowerCase()?"bg-purple-100 text-purple-700 border border-purple-200":"bg-slate-100 text-slate-700 border border-slate-200"),children:e.level}),(0,te.jsx)("span",{className:"text-xs text-slate-400 font-mono min-w-0",children:G(e.time).split(", ")[1]}),e.region&&(0,te.jsx)("span",{className:"text-xs text-slate-400 bg-slate-100 px-1.5 py-0.5 rounded-sm font-mono",children:e.region.replace("gcp-","")})]})}),(0,te.jsx)("div",{className:"font-mono text-xs leading-relaxed text-slate-700 whitespace-pre-wrap break-words pl-1",children:"string"==typeof e.message?(t=e.message.trim(),"string"!=typeof t?t:t.replace(/\u001b\[[0-9;]*m/g,"")):JSON.stringify(e.message,null,2)})]},`${e.time}-${s}`);var t}))})}),z&&L.length>0&&(0,te.jsx)("div",{className:"flex justify-center pt-2",children:(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>{!$&&z&&H(O+F)},disabled:$,className:"text-slate-600 hover:text-slate-800 text-xs",children:$?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-1 h-3 w-3 animate-spin"}),"Loading..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(pr.A,{className:"mr-1 h-3 w-3"}),"Load More"]})})}),$&&0===L.length&&(0,te.jsx)("div",{className:"flex justify-center py-8",children:(0,te.jsxs)("div",{className:"flex items-center text-slate-500 text-sm",children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Loading logs..."]})})]})]})}),(0,te.jsx)(dc,{open:m&&!a,onOpenChange:u,children:(0,te.jsxs)(gc,{className:"sm:max-w-md md:max-w-lg w-[90vw] flex flex-col",children:[(0,te.jsxs)(fc,{className:"pb-4 flex-shrink-0",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Ua.A,{className:"h-5 w-5 text-teal-600"}),(0,te.jsx)(jc,{className:"text-slate-800 text-lg",children:"API Information"})]}),(0,te.jsx)("div",{className:"text-sm text-slate-500 font-mono bg-slate-100 px-2 py-1 rounded w-fit",children:t})]}),(0,te.jsxs)("div",{className:"flex-1 overflow-y-auto mt-6 space-y-6 pr-2",children:[(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Function URL"}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>W(q(),"url"),className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50",children:_?(0,te.jsx)(mt.A,{className:"h-4 w-4"}):(0,te.jsx)(Ha.A,{className:"h-4 w-4"})})]}),(0,te.jsx)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:(0,te.jsx)("code",{className:"text-sm font-mono text-slate-800 break-all",children:q()})}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"Make POST requests to this endpoint with your function payload."})]}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Headers"}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>W(JSON.stringify(V(),null,2),"headers"),className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50",children:C?(0,te.jsx)(mt.A,{className:"h-4 w-4"}):(0,te.jsx)(Ha.A,{className:"h-4 w-4"})})]}),(0,te.jsx)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:(0,te.jsx)("pre",{className:"text-sm font-mono text-slate-800 whitespace-pre-wrap",children:JSON.stringify(V(),null,2)})}),(0,te.jsxs)("div",{className:"text-xs text-slate-500 space-y-1",children:[(0,te.jsxs)("p",{children:[(0,te.jsx)("strong",{children:"Content-Type:"})," Always required for JSON payloads."]}),null!=r&&r.api_key?(0,te.jsxs)("p",{children:[(0,te.jsx)("strong",{children:"api_key:"})," Your personal API key - only include this if your function requires authentication. Keep it secure and don't expose it publicly."]}):(0,te.jsxs)("p",{className:"text-amber-600",children:[(0,te.jsx)("strong",{children:"api_key:"})," Not found. Include your personal API key here only if your function requires authentication."]})]})]}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Request Body"}),(0,te.jsx)("div",{className:"bg-slate-50 border border-slate-200 rounded-lg p-4",children:(0,te.jsx)("pre",{className:"text-sm font-mono text-slate-800 whitespace-pre-wrap",children:'{\n  "param1": "value1",\n  "param2": "value2"\n}'})}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"Send a JSON object in the request body with any parameters your function requires. The structure depends on what your function expects to receive."})]}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("h3",{className:"text-sm font-semibold text-slate-700 uppercase tracking-wider",children:"Usage Example (cURL)"}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>W(`curl -X POST "${q()}" \\\n  -H "Content-Type: application/json" ${null!=r&&r.api_key?`\\\n  -H "api_key: ${r.api_key}" `:""}\\\n  -d '{"param1": "value1", "param2": "value2"}'`,"curl"),className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50",children:E?(0,te.jsx)(mt.A,{className:"h-4 w-4"}):(0,te.jsx)(Ha.A,{className:"h-4 w-4"})})]}),(0,te.jsx)("div",{className:"bg-slate-900 rounded-lg p-4",children:(0,te.jsx)("pre",{className:"text-sm font-mono text-green-400 whitespace-pre-wrap break-all",children:`curl -X POST "${q()}" \\\n  -H "Content-Type: application/json" ${null!=r&&r.api_key?`\\\n  -H "api_key: ${r.api_key}" `:""}\\\n  -d '{"param1": "value1", "param2": "value2"}'`})})]})]})]})}),(0,te.jsx)(dc,{open:c&&!a,onOpenChange:d,children:(0,te.jsxs)(gc,{className:"sm:max-w-md md:max-w-lg w-[90vw]",children:[(0,te.jsxs)(fc,{className:"pb-4",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Gd.A,{className:"h-5 w-5 text-orange-600"}),(0,te.jsx)(jc,{className:"text-slate-800 text-lg",children:"Test Function"})]}),(0,te.jsx)("div",{className:"text-sm text-slate-500 font-mono bg-slate-100 px-2 py-1 rounded w-fit",children:t})]}),(0,te.jsxs)("div",{className:"mt-6 space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Payload"}),(0,te.jsx)(Ui,{value:p,onChange:e=>g(e.target.value),className:"font-mono h-40",placeholder:"Enter JSON payload"})]}),(0,te.jsx)(Rs,{onClick:async()=>{if(i&&t){b(!0),N(null),v(null);try{const e=JSON.parse(p),s=await i[t](e);v(s)}catch(l){var e,s,a,r,n;N((null===(e=l.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.error)||(null===(a=l.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.message)||l.message||"An error occurred while executing the function"),k((null===(n=l.response)||void 0===n?void 0:n.data)||"")}finally{b(!1)}}},disabled:j,className:"w-full",children:j?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Running..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Zd.A,{className:"mr-2 h-4 w-4"}),"Run Function"]})}),y&&(0,te.jsxs)(is,{variant:"destructive",children:[(0,te.jsx)(Kd.A,{className:"h-4 w-4"}),(0,te.jsx)(os,{children:"Error"}),(0,te.jsxs)(cs,{className:"font-mono text-sm whitespace-pre-wrap break-all",children:[y,w&&(0,te.jsxs)("div",{className:"mt-2 pt-2 border-t border-red-300 dark:border-red-700",children:[(0,te.jsx)("h4",{className:"text-xs font-semibold mb-1 uppercase tracking-wider text-red-700 dark:text-red-300",children:"Technical Details (JSON RESPONSE):"}),(0,te.jsx)("div",{className:"bg-red-50 dark:bg-red-900/30 p-2 rounded-md overflow-auto max-h-40",children:(0,te.jsx)("pre",{className:"text-xs font-mono whitespace-pre-wrap break-all",children:"string"==typeof w?w:JSON.stringify(w,null,2)})})]})]})]}),f&&(0,te.jsxs)("div",{className:"mt-4",children:[(0,te.jsx)("h3",{className:"text-sm font-medium mb-2",children:"Result"}),(0,te.jsxs)(lr,{defaultValue:"formatted",children:[(0,te.jsxs)(ir,{className:"mb-2",children:[(0,te.jsx)(or,{value:"formatted",children:"Formatted"}),(0,te.jsx)(or,{value:"raw",children:"Raw"})]}),(0,te.jsx)(cr,{value:"formatted",children:(0,te.jsx)("div",{className:"bg-gray-50 p-4 rounded-md overflow-auto max-h-60",children:(0,te.jsx)("pre",{className:"text-sm font-mono whitespace-pre-wrap",children:(e=>{try{return JSON.stringify(e,null,2)}catch(s){return String(e)}})(f)})})}),(0,te.jsx)(cr,{value:"raw",children:(0,te.jsx)("div",{className:"bg-gray-50 p-4 rounded-md overflow-auto max-h-60",children:(0,te.jsx)("pre",{className:"text-sm font-mono whitespace-pre-wrap",children:JSON.stringify(f)})})})]})]})]})]})})]})})),Qd=Xd;var em=t(57543),sm=t(15939);const tm=e=>{let{selectedFile:s,onFileSelect:t,onBack:a,app:r,width:n,hasUnsavedChanges:l=!1}=e;const[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)([]),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)({}),p=e=>{const s={};return Object.keys(e||{}).forEach((e=>{const t=e.split("/");let a=s;for(let s=0;s<t.length;s++){const e=t[s],r=s===t.length-1,n=t.slice(0,s+1).join("/");a[e]||(a[e]=r?{isFile:!0,path:n}:{isFile:!1,children:{},path:n}),r||(a=a[e].children||{})}})),s},g=(e,s,t)=>Object.entries(e).map((e=>{let[a,r]=e;const n=s?`${s}/${a}`:`${t}:${a}`;if(r.isFile){return{id:n,label:a,icon:"entities"===t?(0,te.jsx)(Rl.A,{className:"w-4 h-4"}):(0,te.jsx)(em.A,{className:"w-4 h-4"})}}{const e=g(r.children,n,t);return{id:n,label:a,icon:(0,te.jsx)(sm.A,{className:"w-4 h-4"}),subitems:e}}}));(0,Y.useEffect)((()=>{if(i.length<2||!m)return void d([]);const e=[],s=(s,t)=>{t&&Object.entries(t).forEach((t=>{let[a,r]=t;const n=r.toString().split("\n").map(((e,s)=>({line:e,idx:s+1}))).filter((e=>{let{line:s}=e;return s.toLowerCase().includes(i.toLowerCase())}));n.length>0&&e.push({type:s,key:a,matches:n.map((e=>{let{line:s,idx:t}=e;return{lineNumber:t,content:s,preview:s.trim()}}))})}))};if(s("pages",r.pages),s("components",r.components),s("entities",r.entities),s("functions",r.functions),r.layout){const s=r.layout.toString().split("\n").map(((e,s)=>({line:e,idx:s+1}))).filter((e=>{let{line:s}=e;return s.toLowerCase().includes(i.toLowerCase())}));s.length>0&&e.push({type:"layout",key:"main",matches:s.map((e=>{let{line:s,idx:t}=e;return{lineNumber:t,content:s,preview:s.trim()}}))})}d(e)}),[i,r,m]);const f=e=>{let{item:s,selected:t,onSelect:a}=e;const r=x[s.id]||!1,n=r?s.matches:s.matches.slice(0,3),i=s.matches.length>3;return(0,te.jsxs)("div",{className:"pl-2 mb-2",children:[(0,te.jsxs)(Rs,{variant:t===s.id?"secondary":"ghost",className:`w-full justify-start text-left ${t===s.id?"bg-primary/10 text-primary hover:bg-primary/20":"hover:bg-gray-100"} ${l?"pointer-events-none opacity-60 cursor-not-allowed":""}`,onClick:()=>{l||a(s.id)},title:l?"You have unsaved changes. Save or discard to jump to a line.":"",children:[s.icon,(0,te.jsx)("span",{className:"ml-2 truncate max-w-[250px] inline-block",children:s.label})]}),(0,te.jsxs)("div",{className:"pl-4 mt-1 text-xs",children:[n.map(((e,t)=>(0,te.jsxs)("div",{className:"text-gray-600 bg-gray-100 rounded p-1 mb-1 overflow-hidden cursor-pointer hover:bg-gray-200 "+(l?"pointer-events-none opacity-60 cursor-not-allowed":""),onClick:()=>{return t=e.lineNumber,void(l||a(s.id,t));var t},title:l?"You have unsaved changes. Save or discard to jump to a line.":"",children:[(0,te.jsxs)("span",{className:"text-gray-500",children:[e.lineNumber,": "]}),(0,te.jsx)("span",{className:"whitespace-nowrap overflow-hidden text-ellipsis inline-block max-w-[180px]",children:e.preview})]},t))),i&&(0,te.jsxs)("div",{className:"text-gray-500 italic pl-1 flex items-center cursor-pointer hover:text-gray-700",onClick:e=>{e.stopPropagation(),h((e=>({...e,[s.id]:!r})))},children:[(0,te.jsx)("span",{className:"mr-1 inline-block w-4 h-4 text-center leading-4 bg-gray-200 rounded-full",children:r?"\u2212":"+"}),r?"Collapse matches":s.matches.length-3+" more matches"]})]})]})};return(0,te.jsxs)("div",{className:"flex flex-col h-full bg-gray-100 border-r",style:{width:"100%"},children:[(0,te.jsx)("div",{className:"border-b p-2 bg-gray-50",children:(0,te.jsxs)(Rs,{variant:"ghost",className:"w-full justify-start text-sm",onClick:a,children:[(0,te.jsx)($t.A,{className:"h-4 w-4 mr-2"}),"Back to Editor"]})}),(0,te.jsx)("div",{className:"p-3 border-b",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Qs,{type:"text",placeholder:"Search files...",value:i,onChange:e=>{o(e.target.value),u(e.target.value.length>=2)},className:"text-sm w-full"}),i&&(0,te.jsx)(Rs,{variant:"ghost",size:"icon",onClick:()=>{o(""),u(!1)},children:(0,te.jsx)(zl.MKb,{className:"h-4 w-4"})})]})}),m&&c.length>0?(0,te.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[(0,te.jsxs)("div",{className:"p-2 text-xs text-gray-500",children:[c.length," result",1!==c.length?"s":""," in ",c.length," file",1!==c.length?"s":""]}),(0,te.jsx)("div",{className:"space-y-1",children:c.map((e=>({id:`${e.type}:${e.key}`,label:e.key,icon:"entities"===e.type?(0,te.jsx)(Rl.A,{className:"w-4 h-4"}):"layout"===e.type?(0,te.jsx)(en.A,{className:"w-4 h-4"}):(0,te.jsx)(em.A,{className:"w-4 h-4"}),matches:e.matches}))).map(((e,a)=>(0,te.jsx)(f,{item:e,selected:s?`${s.type}:${s.key}`:null,onSelect:t},a)))})]}):(0,te.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,te.jsx)(go,{items:(()=>{const e=[];if(r.pages&&Object.keys(r.pages).length>0){const s=p(r.pages);e.push({id:"pages",label:"Pages",icon:(0,te.jsx)(sm.A,{className:"w-4 h-4"}),subitems:g(s,null,"pages")})}if(r.components&&Object.keys(r.components).length>0){const s=p(r.components);e.push({id:"components",label:"Components",icon:(0,te.jsx)(sm.A,{className:"w-4 h-4"}),subitems:g(s,null,"components")})}if(r.entities&&Object.keys(r.entities).length>0){const s=p(r.entities);e.push({id:"entities",label:"Entities",icon:(0,te.jsx)(sm.A,{className:"w-4 h-4"}),subitems:g(s,null,"entities")})}if(r.layout&&e.push({id:"layout:main",label:"Layout.js",icon:(0,te.jsx)(en.A,{className:"w-4 h-4"})}),r.has_backend_functions_enabled&&r.functions){const s=p(r.functions);e.push({id:"functions",label:"Functions",icon:(0,te.jsx)(sm.A,{className:"w-4 h-4"}),subitems:g(s,null,"functions")})}return e})(),selected:s?`${s.type}:${s.key}`:null,onSelect:e=>{if(e.includes("/")){const[s,a]=(e=>{if(-1!==e.indexOf(":"))return e.split(":");const s=e.split("/"),t=s[0];return 1===s.length?[t,""]:[t,s.slice(1).join("/")]})(e);let n=!1;("pages"===s&&r.pages&&r.pages[a]||"components"===s&&r.components&&r.components[a]||"functions"===s&&r.functions&&r.functions[a]||"entities"===s&&r.entities&&r.entities[a])&&(n=!0),n&&t(`${s}:${a}`)}else t(e)},title:"Files",showBackButton:!1,onBack:a,showSearch:!1,style:{width:"100%"}})})]})};var am=t(81646),rm=t(13129);const nm=e=>{let{className:s,...t}=e;return(0,te.jsx)(rm.YZ,{className:ns("flex h-full w-full data-[panel-group-direction=vertical]:flex-col",s),...t})},lm=rm.Zk,im=e=>{let{withHandle:s,className:t,...a}=e;return(0,te.jsx)(rm.TW,{className:ns("relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90",t),...a,children:s&&(0,te.jsx)("div",{className:"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border",children:(0,te.jsx)(am.A,{className:"h-2.5 w-2.5"})})})},om=()=>{const{app:e}=vs(),[s,t]=(0,Y.useState)(null),[a,r]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(!1),i=(0,Y.useRef)(null),o=(0,Z.Zp)(),c=(0,Z.zy)(),[d,m]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{const s=new URLSearchParams(c.search),a=s.get("filePath"),n=s.get("line");if(r(n?parseInt(n,10):null),a&&e){const s=a.replace(/\.\w+$/,"").split("/");if(s.length>=2){const a=s[0],r=s.slice(1).join("/");let n=!1;("pages"===a&&e.pages&&e.pages[r]||"components"===a&&e.components&&e.components[r]||"functions"===a&&e.functions&&e.functions[r]||"entities"===a&&e.entities&&e.entities[r]||"layout"===a&&e.layout)&&(n=!0),n&&t({type:a,key:r})}}}),[e,c.search]);const u=(()=>{if(!s)return null;switch(s.type){case"pages":return`pages/${s.key}`;case"components":return`components/${s.key}`;case"functions":return`functions/${s.key}`;case"entities":return`entities/${s.key}`;case"layout":return"layout";default:return null}})(),x="functions"===(null==s?void 0:s.type);return(0,te.jsx)("div",{className:"h-full w-full border rounded-lg overflow-hidden bg-white shadow-sm",children:(0,te.jsxs)(nm,{direction:"horizontal",children:[(0,te.jsx)(lm,{defaultSize:33,minSize:20,maxSize:40,className:"h-full overflow-hidden",children:(0,te.jsx)(tm,{selectedFile:s,onFileSelect:function(s){let a,n,l=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if(s.includes(":"))[a,n]=s.split(":");else{if(!s.includes("/"))return a=s,void(n="");{const t=s.split("/");a=t[0],n=t.slice(1).join("/");let r=!1;if(("pages"===a&&e.pages&&e.pages[n]||"components"===a&&e.components&&e.components[n]||"functions"===a&&e.functions&&e.functions[n]||"entities"===a&&e.entities&&e.entities[n])&&(r=!0),!r)return}}t({type:a,key:n}),r(l);const i="layout"===a?"layout/main":`${a}/${n}`,c=new URLSearchParams;c.set("filePath",i),l&&c.set("line",l),o(`?${c.toString()}`,{replace:!0})},onBack:()=>{o(`/apps/${e.id}/editor/workspace/overview`)},app:e})}),(0,te.jsx)(im,{withHandle:!0,className:"group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,te.jsx)(lm,{defaultSize:75,className:"flex-1 overflow-x-auto",children:u?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Yd,{filepath:u,selectedLine:a,onEdit:()=>{if(l(!0),null!==a){r(null);const e=new URLSearchParams(c.search);e.delete("line"),o(`?${e.toString()}`,{replace:!0})}},onSaveOrDiscard:()=>{l(!1)},isFunction:x,onRedeployFunction:async e=>{l(!0),i.current&&(await i.current.handleRedeployFunction(e),l(!1),m(!1))},isSaving:d}),x&&(0,te.jsx)(Qd,{ref:i,functionName:s.key,hasUnsavedChanges:n})]}):(0,te.jsx)("div",{className:"h-full flex items-center justify-center text-gray-500",children:"Select a file to view code"})})]})})};var cm=t(36391);function dm(e){let{appId:s,appName:t,disabled:a=!1,disabledReason:r="",onError:n=()=>{}}=e;const[l,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{(async()=>{if(!window.entri)return new Promise((e=>{const s=document.createElement("script");s.src="https://cdn.goentri.com/entri.js",s.async=!0,s.onload=()=>{c(!0),e()},document.body.appendChild(s)}));c(!0)})()}),[]);return(0,te.jsx)(Rs,{size:"sm",onClick:async()=>{if(a)n("Cannot purchase domain",r||"Domain purchase is currently disabled");else if(o){i(!0);try{const e={...(await ja.getEntriToken({appId:s,appName:t})).config};await window.entri.purchaseDomain(e),Se("Domain - Buy",{})}catch(c){var e,l;const s=(null===(e=c.response)||void 0===e||null===(l=e.data)||void 0===l?void 0:l.detail)||c.message||"Failed to get purchase config",t=s.includes("Maximum of")&&s.includes("domains allowed");n(t?"Domain limit reached":"Error purchasing domain",s)}i(!1)}else n("Error","Entri is not ready yet. Please try again in a moment.")},disabled:l||!o||a,className:"h-8 px-4 rounded-md text-sm "+(a?"bg-red-100 hover:bg-red-100 text-red-700 border border-red-200 cursor-not-allowed":"bg-black text-white hover:bg-gray-800"),children:l?"Buy Domain":o?a?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Kc.A,{className:"h-3 w-3 mr-2"}),"Domain Limit Reached"]}):"Buy Domain":(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($c.A,{className:"h-3 w-3 mr-2 animate-spin"}),"Loading Entri..."]})})}var mm=t(79348);const um=mm.Provider,xm=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(mm.Viewport,{ref:s,className:ns("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",t),...a})}));xm.displayName=mm.Viewport.displayName;const hm=(0,ts.cva)("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),pm=Y.forwardRef(((e,s)=>{let{className:t,variant:a,...r}=e;return(0,te.jsx)(mm.Root,{ref:s,className:ns(hm({variant:a}),t),...r})}));pm.displayName=mm.Root.displayName;const gm=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(mm.Action,{ref:s,className:ns("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",t),...a})}));gm.displayName=mm.Action.displayName;const fm=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(mm.Close,{ref:s,className:ns("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",t),"toast-close":"",...a,children:(0,te.jsx)(Ds.A,{className:"h-4 w-4"})})}));fm.displayName=mm.Close.displayName;const vm=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(mm.Title,{ref:s,className:ns("text-sm font-semibold",t),...a})}));vm.displayName=mm.Title.displayName;const jm=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(mm.Description,{ref:s,className:ns("text-sm opacity-90",t),...a})}));function bm(){const{toasts:e}=Un();return(0,te.jsxs)(um,{children:[e.map((function(e){let{id:s,title:t,description:a,action:r,...n}=e;return(0,te.jsxs)(pm,{...n,children:[(0,te.jsxs)("div",{className:"grid gap-1",children:[t&&(0,te.jsx)(vm,{children:t}),a&&(0,te.jsx)(jm,{children:a})]}),r,(0,te.jsx)(fm,{})]},s)})),(0,te.jsx)(xm,{})]})}jm.displayName=mm.Description.displayName;const ym=1e4,Nm=150,wm=e=>{let{isLoading:s,loadingText:t,children:a,...r}=e;return(0,te.jsx)(Rs,{...r,children:s?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($c.A,{className:"h-4 w-4 mr-2 animate-spin"}),t]}):a})},km=e=>{let{open:s,onOpenChange:t,title:a,description:r,isLoading:n,loadingText:l,confirmText:i,onConfirm:o,variant:c="destructive"}=e;return(0,te.jsx)(na,{open:s,onOpenChange:t,children:(0,te.jsxs)(da,{children:[(0,te.jsxs)(ma,{children:[(0,te.jsx)(xa,{children:a}),(0,te.jsx)(ha,{children:r})]}),(0,te.jsxs)("div",{className:"flex justify-end gap-2 pt-4",children:[(0,te.jsx)(Rs,{variant:"outline",onClick:()=>t(!1),children:"Cancel"}),(0,te.jsx)(wm,{variant:c,onClick:o,disabled:n,isLoading:n,loadingText:l,children:i})]})]})})},_m=e=>{var s,t;let{domain:a}=e;const r=void 0!==(null===(s=a.purchase_info)||void 0===s?void 0:s.purchase_time);return!0===(null===(t=a.purchase_info)||void 0===t?void 0:t.blocked)?(0,te.jsx)("span",{className:"px-2 py-0.5 text-xs bg-red-100 text-red-700 rounded-full",children:"Blocked"}):r?(0,te.jsx)("span",{className:"px-2 py-0.5 text-xs bg-blue-100 text-blue-700 rounded-full",children:"Base44 Domain"}):null},Sm=e=>{let{status:s,lastChecked:t,lastPollingTime:a,isBoughtDomain:r,isActive:n,isUnlinked:l}=e;return l?(0,te.jsx)("p",{className:"text-sm text-gray-500",children:s}):(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("p",{className:"text-sm text-gray-500",children:s}),!r&&t&&(0,te.jsx)("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:(0,te.jsxs)("span",{children:["Last checked: ",Bt().utc(t).fromNow()]})}),r&&!n&&a&&(0,te.jsx)("div",{className:"flex items-center gap-2 text-xs text-gray-400",children:(0,te.jsxs)("span",{children:["Last checked: ",Bt()(a).format("HH:mm:ss")]})})]})},Cm=e=>{var s,t,a,r;let{domain:n,isChecking:l,isVerifying:i,isUnlinking:o,onCheck:c,onVerify:d,onUnlink:m}=e;const[u,x]=(0,Y.useState)(!1),{toast:h}=Un(),p=void 0!==(null===(s=n.purchase_info)||void 0===s?void 0:s.purchase_time),g=!0===(null===(t=n.purchase_info)||void 0===t?void 0:t.unlinked),f=(null===(a=n.purchase_info)||void 0===a?void 0:a.purchase_time)&&(null===(r=n.purchase_info)||void 0===r?void 0:r.propagation_status),v=async()=>{x(!0);try{await ja.link(n.id),h({title:"Domain linked",description:"Domain has been linked to your project",duration:3e3}),c()}catch(t){var e,s;h({variant:"destructive",title:"Error linking domain",description:(null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Something went wrong",duration:3e3})}x(!1)};return g?(0,te.jsx)("div",{className:"flex items-center gap-2 justify-end",children:(0,te.jsx)(wm,{variant:"outline",size:"sm",onClick:v,disabled:u,isLoading:u,loadingText:"Linking...",children:"Link Domain"})}):(0,te.jsxs)("div",{className:"flex items-center gap-2 justify-end",children:[!f&&(0,te.jsxs)(wm,{variant:"ghost",size:"sm",onClick:c,className:"text-gray-500",disabled:l,isLoading:l,loadingText:"Checking...",children:[(0,te.jsx)($c.A,{className:"h-4 w-4 mr-2"}),"Check Status"]}),!p&&(0,te.jsx)(wm,{variant:"outline",size:"sm",onClick:d,disabled:i,isLoading:i,loadingText:"Verifying...",children:"Verify Domain"}),p&&!g&&(0,te.jsx)(wm,{variant:"outline",size:"sm",onClick:m,disabled:o,isLoading:o,loadingText:"Unlinking...",children:"Unlink Domain"})]})},Am=e=>{var s,t,a,r;let{domain:n,onUpdate:l,lastPollingTime:i}=e;const{toast:o}=Un(),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(!1),[j,b]=(0,Y.useState)(!1),y=void 0!==(null===(s=n.purchase_info)||void 0===s?void 0:s.purchase_time),N=!0===(null===(t=n.purchase_info)||void 0===t?void 0:t.unlinked),w=null!==(k=n.purchase_info)&&void 0!==k&&k.unlinked?"Unlinked":null!==(_=n.purchase_info)&&void 0!==_&&_.purchase_time&&null!==(S=n.purchase_info)&&void 0!==S&&S.propagation_status?"Domain Active":null===(C=n.purchase_info)||void 0===C||!C.purchase_time||null!==(A=n.purchase_info)&&void 0!==A&&A.blocked?"verified"===(null===(E=n.last_status_payload)||void 0===E?void 0:E.verificationStatus)?"Verified":"error"===(null===(I=n.last_status_payload)||void 0===I?void 0:I.verificationStatus)?"Error":"Pending":"Waiting for DNS Propagation";var k,_,S,C,A,E,I;return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(km,{open:f,onOpenChange:v,title:"Delete Domain",description:"Are you sure you want to delete?",isLoading:m,loadingText:"Deleting...",confirmText:"Delete Domain",onConfirm:async()=>{u(!0);try{await ja.delete(n.id),o({title:"Domain deleted",duration:3e3}),l()}catch(t){var e,s;o({variant:"destructive",title:"Error deleting domain",description:(null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Something went wrong",duration:3e3})}u(!1),v(!1)}}),(0,te.jsx)(km,{open:j,onOpenChange:b,variant:"default",title:"Unlink Domain",description:"This domain was purchased through Base44.\n\nIt will remain listed under your domains but will no longer be connected to your project.",isLoading:p,loadingText:"Unlinking...",confirmText:"Unlink Domain",onConfirm:async()=>{g(!0);try{await ja.unlink(n.id),o({title:"Domain unlinked",description:"Domain has been unlinked from your project",duration:3e3}),l()}catch(t){var e,s;o({variant:"destructive",title:"Error unlinking domain",description:(null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Something went wrong",duration:3e3})}g(!1),b(!1)}}),(0,te.jsx)(Vs,{className:"hover:bg-gray-50 transition-colors "+(N?"opacity-60":""),children:(0,te.jsx)(Js,{className:"p-4",children:(0,te.jsxs)("div",{className:"flex flex-col space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:["Domain Active"===w||"Verified"===w?(0,te.jsx)(Qa.A,{className:"h-5 w-5 text-green-500"}):(0,te.jsx)(Ke.A,{className:"h-5 w-5 text-yellow-500"}),(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("a",{href:`https://${n.domain}`,target:"_blank",children:(0,te.jsx)("p",{className:"font-medium",children:n.domain})}),(0,te.jsx)(_m,{domain:n})]}),(0,te.jsx)(Sm,{status:w,lastChecked:n.last_status_check,lastPollingTime:i,isUnlinked:N,isBoughtDomain:y,isActive:(null===(a=n.purchase_info)||void 0===a?void 0:a.purchase_time)&&(null===(r=n.purchase_info)||void 0===r?void 0:r.propagation_status)})]})]}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>v(!0),className:"text-red-500 hover:text-red-600 hover:bg-red-50",disabled:m||y&&!N,children:(0,te.jsx)(Tc.A,{className:"h-4 w-4 "+(m?"animate-spin":"")})})]}),(0,te.jsx)(Cm,{domain:n,isChecking:x,isVerifying:c,isUnlinking:p,onCheck:async()=>{h(!0);try{var e;const s=void 0!==(null===(e=n.purchase_info)||void 0===e?void 0:e.purchase_time);s||await ja.refreshStatus(n.id),l(),s&&await new Promise((e=>setTimeout(e,1e3)))}catch(a){var s,t;o({variant:"destructive",title:"Error checking status",description:(null===(s=a.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail)||"Something went wrong",duration:3e3})}h(!1)},onVerify:async()=>{d(!0);try{await ja.verify(n.id),o({title:"Verification initiated",description:"Please check back in a few minutes",duration:3e3}),l()}catch(t){var e,s;o({variant:"destructive",title:"Error verifying domain",description:(null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Something went wrong",duration:3e3})}d(!1)},onUnlink:()=>b(!0)})]})})})]})},Em=e=>{let{onAdd:s,loading:t,open:a,setOpen:r,disabled:n=!1,disabledReason:l=""}=e;const[i,o]=(0,Y.useState)("");return(0,te.jsxs)(na,{open:a,onOpenChange:r,children:[(0,te.jsx)(la,{asChild:!0,children:(0,te.jsx)(Rs,{variant:"outline",disabled:n,className:"text-gray-700 hover:text-gray-900 hover:bg-gray-100 "+(n?"bg-red-50 border-red-200 text-red-600 cursor-not-allowed hover:bg-red-50 hover:text-red-600":""),children:n?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Zc.A,{className:"h-4 w-4 mr-2"}),"Domain Limit Reached"]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(ys.A,{className:"h-4 w-4 mr-2"}),"Add Domain"]})})}),(0,te.jsxs)(da,{children:[(0,te.jsxs)(ma,{children:[(0,te.jsx)(xa,{children:"Add New Domain"}),(0,te.jsx)(ha,{children:"Enter your domain name below. Make sure it follows the format: app.example.com"})]}),(0,te.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,te.jsx)(Qs,{placeholder:"Enter domain (e.g. app.example.com)",value:i,onChange:e=>o(e.target.value)}),(0,te.jsx)("div",{className:"flex justify-end",children:(0,te.jsx)(wm,{onClick:async()=>{if(n)return;const e=i.toLowerCase().trim();await s(e),o(""),r(!1)},disabled:t||!i,isLoading:t,loadingText:"Adding...",children:"Add Domain"})})]})]})]})},Im=e=>{let{onUpgrade:s}=e;return(0,te.jsx)("div",{className:"w-full",children:(0,te.jsxs)("div",{className:"w-full rounded-lg p-12 text-center",style:{borderWidth:"2px",borderStyle:"dashed",borderColor:"#e5e7eb",borderRadius:"12px"},children:[(0,te.jsx)("h3",{className:"text-xl font-semibold mb-2",children:"Want to use your domain?"}),(0,te.jsxs)("p",{className:"text-gray-600 mb-6",children:["Custom domains are available on our Builder plan and above.",(0,te.jsx)("br",{}),"Upgrade to connect your domain to this app."]}),(0,te.jsx)(Rs,{onClick:s,className:"bg-black text-white hover:bg-gray-800",children:"View Plans"})]})})},Lm=()=>(0,te.jsx)(Vs,{children:(0,te.jsx)(Js,{className:"p-4",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)(cm.A,{className:"h-5 w-5 text-blue-500 shrink-0 mt-0.5"}),(0,te.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,te.jsxs)("p",{className:"font-medium",children:[(0,te.jsx)("b",{children:"After adding a domain"}),", connect it via your DNS provider:"]}),(0,te.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-gray-600",children:[(0,te.jsxs)("li",{children:["Add CNAME record: ",(0,te.jsx)("code",{className:"bg-gray-100 px-1.5 py-0.5 rounded",children:"www \u2192 base44.onrender.com"})]}),(0,te.jsxs)("li",{children:["Add ANAME/ALIAS record: ",(0,te.jsx)("code",{className:"bg-gray-100 px-1.5 py-0.5 rounded",children:"empty or @ \u2192 base44.onrender.com"})]}),(0,te.jsxs)("li",{children:["If your DNS provider doesn't support ANAME/ALIAS, use A record: ",(0,te.jsx)("code",{className:"bg-gray-100 px-1.5 py-0.5 rounded",children:"@ \u2192 216.24.57.1"})]}),(0,te.jsx)("li",{children:"Remove any AAAA records from your domain while configuring DNS. AAAA records map to an IPv6 address, and Base44 uses IPv4. These records can cause unexpected behavior for your custom domain."})]}),(0,te.jsx)("p",{className:"text-gray-600",children:"Note: After adding DNS records, it may take some time for changes to fully propagate across the internet. During this time, the domain may not work properly."}),(0,te.jsxs)("p",{className:"text-xs text-gray-500",children:["Need help? Create a ticket at ",(0,te.jsx)("button",{type:"button",onClick:()=>{window.open("/support","_blank")},className:"underline text-primary hover:text-orange-500 transition-colors",children:"support system"})]})]})]})})}),Tm=e=>{let{currentCount:s,maxCount:t}=e;return(0,te.jsx)(Vs,{className:"border-orange-200 bg-orange-50",children:(0,te.jsx)(Js,{className:"p-4",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)(Zc.A,{className:"h-5 w-5 text-orange-500 shrink-0 mt-0.5"}),(0,te.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,te.jsx)("p",{className:"font-medium text-orange-800",children:"Domain Limit Reached"}),(0,te.jsxs)("p",{className:"text-orange-700",children:["You have reached the maximum of ",t," domains for this app (",s,"/",t,"). Please remove some domains before adding new ones."]})]})]})})})},$m=e=>{let{app:s,onUpdate:t,isPaidTier:a=!0}=e;const[r,n]=(0,Y.useState)(!1),{toast:l}=Un(),i=Zt(s).replace(/^https?:\/\//,"");return s?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Dm,{app:s,onUpdate:t,open:r,onOpenChange:n,isPaidTier:a}),(0,te.jsx)(Vs,{className:"border rounded-lg",children:(0,te.jsx)(Js,{className:"p-4",children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("div",{className:"text-[16px] font-medium mb-1",children:i}),(0,te.jsx)("div",{className:"text-sm text-gray-500",children:"Never Expires"})]}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>n(!0),className:"ml-4",children:"Edit URL"})]})})})]}):null},Dm=e=>{let{app:s,onUpdate:t,open:a,onOpenChange:r,isPaidTier:n=!0}=e;const[l,i]=(0,Y.useState)((null==s?void 0:s.slug)||""),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)(""),{toast:u}=Un(),x=(0,Z.Zp)();(0,Y.useEffect)((()=>{i((null==s?void 0:s.slug)||""),m("")}),[null==s?void 0:s.slug]);if(!s)return null;return(0,te.jsx)(na,{open:a,onOpenChange:r,children:(0,te.jsxs)(da,{className:"w-[634px] max-w-[634px] p-6",children:[(0,te.jsx)(ma,{className:"text-left mb-3",children:(0,te.jsx)(xa,{className:"text-lg font-semibold",children:"Edit URL"})}),(0,te.jsx)("div",{className:"space-y-6",children:(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,te.jsx)("p",{className:"text-sm font-normal text-gray-500",children:"Base44 Built-in domain"}),l&&(0,te.jsx)("button",{onClick:async()=>{c(!0);try{await t({slug:null});const e=Zt(s).replace(/^https?:\/\//,"");u({title:"Slug reset to default",description:`Your app is now available at ${e}`,duration:3e3}),Se("Custom URL - Reset to Default",{}),r(!1),i("")}catch(d){var e,a;u({variant:"destructive",title:"Error resetting slug",description:(null===(e=d.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||"Failed to reset to default slug",duration:3e3})}c(!1)},disabled:o,className:"text-sm text-black hover:text-gray-600 disabled:opacity-50 disabled:cursor-not-allowed",children:"Reset to default"})]}),n?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{className:"relative flex items-center h-10 rounded-md border border-gray-300 bg-white hover:bg-gray-50 focus-within:ring-2 focus-within:ring-black focus-within:border-black",children:[(0,te.jsx)("span",{className:"text-sm text-gray-500 pl-3 select-none",children:"https://"}),(0,te.jsx)("input",{value:l,onChange:e=>{i(e.target.value.toLowerCase()),m("")},className:"flex-1 text-base bg-transparent outline-none"}),(0,te.jsxs)("span",{className:"text-sm text-gray-400 pr-3 select-none",children:[".","base44.app"]})]}),d&&(0,te.jsxs)("div",{className:"flex items-center gap-2 text-sm text-red-600 mt-2",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:d})]}),(0,te.jsx)("div",{className:"flex justify-end items-center mt-6",children:(0,te.jsx)(wm,{onClick:async()=>{c(!0);try{if(!l){await t({slug:null});const e=Zt(s).replace(/^https?:\/\//,"");return u({title:"URL updated",description:`Custom url removed. Your app is now available at ${e}`,duration:3e3}),r(!1),i(""),void c(!1)}await t({slug:l});const e=Zt({...s,slug:l}).replace(/^https?:\/\//,"");u({title:"URL updated",description:`Your app is now available at ${e}`,duration:3e3}),Se("Custom URL - Updated",{}),r(!1),i(l)}catch(d){var e,a;const t=(null===(e=d.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||d.message||"Something went wrong";t.toLowerCase().includes("is already in use")?m("URL change failed, this URL is already taken. Please try a different one."):t.toLowerCase().includes("this subdomain is reserved")?m("This URL is reserved. Please try a different one."):m("This URL is invalid. Please try a different one.")}c(!1)},disabled:o||l===(null==s?void 0:s.slug),isLoading:o,loadingText:"Changing...",className:"bg-black text-white hover:bg-gray-800 ml-auto",children:"Change"})})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{className:"relative flex items-center h-10 rounded-md border border-gray-300 bg-gray-100",children:[(0,te.jsx)("span",{className:"text-sm text-gray-500 pl-3 select-none",children:"https://"}),(0,te.jsx)("input",{value:null==s?void 0:s.slug,disabled:!0,className:"flex-1 text-base bg-transparent outline-none"}),(0,te.jsxs)("span",{className:"text-sm text-gray-400 pr-3 select-none",children:[".","base44.app"]})]}),(0,te.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mt-4",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4 text-blue-500 mt-0.5 shrink-0"}),(0,te.jsxs)("p",{className:"text-sm text-blue-800",children:["URL editing requires a starter plan."," ",(0,te.jsx)("button",{onClick:()=>{r(!1),x("/billing")},className:"underline font-medium hover:text-blue-900",children:"Upgrade to Premium"})]})]})})]})]})})]})})};function Pm(e){let{appId:s,appName:t}=e;const{user:a}=ne(),{app:r,updateApp:n}=vs(),[l,i]=(0,Y.useState)([]),[o,c]=(0,Y.useState)(!1),{toast:d}=Un(),m=(0,Z.Zp)(),u=(0,Y.useRef)(null),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(null),[f,v]=(0,Y.useState)(!1),[j,b]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(null),w=(null==a?void 0:a.subscription_tier)&&!["free","starter","starter_yearly"].includes(a.subscription_tier),k=l.length>=Nm,_=async()=>{try{const t=await ja.filter({app_id:s});if(i(t),N(Date.now()),p){const s=t.find((e=>e.domain===p));var e;if(s)g(null),null!==(e=s.purchase_info)&&void 0!==e&&e.propagation_status||x?C():S()}const a=t.some((e=>{var s,t,a;return(null===(s=e.purchase_info)||void 0===s?void 0:s.purchase_time)&&!(null!==(t=e.purchase_info)&&void 0!==t&&t.propagation_status)&&!(null!==(a=e.purchase_info)&&void 0!==a&&a.blocked)}));a&&!x?S():!a&&x&&C()}catch(r){var t,a;d({variant:"destructive",title:"Error fetching domains",description:(null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.detail)||"Something went wrong",duration:3e3})}},S=()=>{h(!0),u.current&&clearInterval(u.current),u.current=setInterval(_,ym)},C=()=>{h(!1),u.current&&(clearInterval(u.current),u.current=null)};(0,Y.useEffect)((()=>(w&&_(),()=>{C()})),[s,w]),(0,Y.useEffect)((()=>{const e=new URLSearchParams(window.location.search),s=e.get("result"),t=e.get("domain");if(s&&t){"success"===s?(d({title:"Domain Purchased!",description:`Your domain ${t} was purchased successfully. Waiting for it to appear in your domains...`}),g(t),S(),Se("Domain - Purchased Successfully",{domain:t})):d({variant:"destructive",title:"Domain Purchase Failed",description:`Purchase failed for ${t}.`});const e=new URL(window.location);e.searchParams.delete("result"),e.searchParams.delete("domain"),window.history.replaceState({},document.title,e.pathname)}}),[]);const A=async e=>{if(e)if(k)d({variant:"destructive",title:"Domain limit reached",description:`You can only have up to ${Nm} domains per app. Please remove some domains first.`,duration:5e3});else{c(!0);try{await ja.create({domain:e,app_id:s}),await _(),d({title:"Domain added successfully",description:"Please verify your domain to complete setup",duration:3e3})}catch(r){var t,a;d({variant:"destructive",title:"Error creating domain",description:(null===(t=r.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.detail)||"Something went wrong",duration:3e3})}c(!1)}};return(0,te.jsxs)("div",{className:"space-y-6 px-4 pb-4",children:[(0,te.jsx)(bm,{}),(0,te.jsxs)("div",{className:"mt-0",children:[(0,te.jsx)("h2",{className:"text-2xl font-bold mb-1.5",children:"Domains"}),(0,te.jsxs)("p",{className:"text-gray-600 text-sm mb-6",children:["Buy, connect and manage your domains. ",(0,te.jsx)("a",{href:"https://docs.base44.com/Guides/Setting-up-your-custom-domain#custom-domain-setup-and-troubleshooting-guide",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Learn more"})]}),(0,te.jsxs)("div",{className:"mb-12",children:[(0,te.jsx)("h3",{className:"text-base font-medium text-black mb-4",children:"Built-in domain"}),(0,te.jsx)($m,{app:r,onUpdate:n,isPaidTier:!0})]}),(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsx)("h3",{className:"text-base font-medium text-black mb-4",children:"Custom domains"}),w?!k&&(0,te.jsxs)("div",{className:"flex items-center gap-2.5 mb-4",children:[(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>v((e=>!e)),className:"h-8 px-4 rounded-md border text-sm bg-white",children:"Connect your Domain"}),(0,te.jsx)("div",{className:"inline-block",children:(0,te.jsx)(dm,{appId:s,appName:t,disabled:k,disabledReason:k?`Maximum of ${Nm} domains reached for this app`:"",onError:(e,s)=>{const t=e.includes("Domain limit reached")||s.includes("Maximum of");d({variant:"destructive",title:e,description:s,duration:t?5e3:3e3})}})})]}):(0,te.jsx)(Im,{onUpgrade:()=>m("/billing")})]}),w&&k&&(0,te.jsx)(Tm,{currentCount:l.length,maxCount:Nm}),w&&f&&!k&&(0,te.jsxs)("div",{className:"space-y-2 mb-4 w-full max-w-xl",children:[(0,te.jsx)(Em,{onAdd:A,loading:o,open:j,setOpen:b,disabled:k,disabledReason:k?`Maximum of ${Nm} domains reached`:""}),(0,te.jsx)(Lm,{})]}),w&&k&&f&&(0,te.jsxs)("div",{className:"space-y-2 mb-4 w-full max-w-xl",children:[(0,te.jsx)(Em,{onAdd:A,loading:o,open:j,setOpen:b,disabled:k,disabledReason:k?`Maximum of ${Nm} domains reached`:""}),(0,te.jsx)("div",{className:"text-sm text-red-600 mt-2 p-3 bg-red-50 border border-red-200 rounded-md",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Zc.A,{className:"h-4 w-4"}),(0,te.jsxs)("span",{children:["Cannot add domains: You have reached the maximum limit of ",Nm," domains per app."]})]})})]}),w&&(0,te.jsx)("div",{className:"grid gap-6",children:l.length>0&&(0,te.jsx)("div",{className:"space-y-4",children:l.map((e=>(0,te.jsx)(Am,{domain:e,onUpdate:_,lastPollingTime:y},e.id)))})})]})]})}var Mm=t(81064),Om=t(81946);function Rm(e){let{rule:s}=e;if(!s)return(0,te.jsx)("span",{className:"text-muted-foreground",children:"No restrictions"});if("{{user.email}}"===s.created_by)return(0,te.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,te.jsx)(Mm.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}})," Creator only"]});if(s.user_condition&&"admin"===s.user_condition.role)return(0,te.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,te.jsx)(Om.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}})," Admin only"]});if(s.$or)return(0,te.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,te.jsx)("span",{className:"bg-secondary text-secondary-foreground text-xs rounded-md px-1.5 py-0.5",children:"OR"}),(0,te.jsxs)("span",{children:[s.$or.length," conditions"]})]});if(s.$and)return(0,te.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,te.jsx)("span",{className:"bg-secondary text-secondary-foreground text-xs rounded-md px-1.5 py-0.5",children:"AND"}),(0,te.jsxs)("span",{children:[s.$and.length," conditions"]})]});const t=Object.keys(s).filter((e=>!e.startsWith("$")));if(t.length){const e=t[0],a=s[e];if("string"==typeof a&&a.startsWith("{{user."))return(0,te.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,te.jsx)(It.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}}),(0,te.jsxs)("span",{className:"text-xs font-medium",children:[e.replace("data.","")," = user field"]})]})}if(s.field_condition){const e=Object.entries(s.field_condition).map((e=>{let[s,t]=e;return`${s}: ${JSON.stringify(t)}`})).join(", ");return(0,te.jsxs)("span",{className:"flex items-center gap-1.5",children:[(0,te.jsx)(It.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}}),(0,te.jsxs)("span",{className:"text-xs font-medium",children:["Field(s): ",e]})]})}return(0,te.jsxs)("span",{className:"text-xs font-medium flex items-center gap-1.5",children:[(0,te.jsx)(Dl.A,{className:"h-3.5 w-3.5",style:{color:"#64748b"}}),"Custom rule"]})}function Fm(e){let{rec:s,onApply:t,onDismiss:a,forceOpen:r,onOpen:n}=e;const[l,i]=(0,Y.useState)(!!r),[o,c]=(0,Y.useState)(!1),d=(e,s,t)=>(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-1 text-black font-medium text-sm",children:[s,t]}),o?(0,te.jsx)("textarea",{className:"w-full font-mono text-xs border border-slate-200 rounded p-2 resize-none text-black",style:{background:"#F3F6F9"},rows:3,value:e,readOnly:!0}):(0,te.jsx)("div",{className:"w-full text-xs min-h-[32px] flex flex-col gap-1",children:(()=>{try{const s="string"==typeof e?JSON.parse(e):e;if(s&&(s.$or||s.$and)){return(s.$or||s.$and).map(((e,s)=>(0,te.jsx)(Rm,{rule:e},s)))}return(0,te.jsx)(Rm,{rule:s})}catch{return(0,te.jsx)("span",{children:e})}})()})]});return s?l?(0,te.jsxs)("div",{className:"mt-6 border border-slate-200 rounded-xl p-6 flex flex-col gap-4 shadow-sm animate-in fade-in relative",style:{background:"#fff"},children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,te.jsx)("button",{className:"rec-collapsible-trigger mr-2 p-0.5 flex items-center justify-center",style:{width:24,height:24,background:"none",border:"none",boxShadow:"none"},onClick:e=>{e.stopPropagation(),i(!1),a&&a()},"aria-label":"Collapse recommendations",children:(0,te.jsx)(dt.A,{className:"h-4 w-4 text-slate-500"})}),(0,te.jsx)(Zc.A,{className:"h-5 w-5 text-black",strokeWidth:2,fill:"none"}),(0,te.jsx)("span",{className:"font-semibold text-[1.08rem] text-black",children:"RLS Recommendation"})]}),(0,te.jsx)("div",{className:"text-muted-foreground text-sm mb-2",children:s.description}),(0,te.jsxs)("div",{className:"flex items-center gap-1 mb-2",children:[(0,te.jsx)("span",{className:"text-xs text-slate-700",children:"JSON"}),(0,te.jsx)(Lc,{checked:o,onCheckedChange:c,onClick:e=>e.stopPropagation(),onFocus:e=>e.stopPropagation(),className:"scale-75"})]}),(0,te.jsxs)("div",{className:o?"flex flex-col gap-3":"flex flex-row gap-3",children:[d(s.read_rule,(0,te.jsx)(Jd.A,{className:"h-4 w-4 text-slate-500 opacity-40"}),"Read"),d(s.write_rule,(0,te.jsx)(Ba.A,{className:"h-4 w-4 text-slate-500 opacity-40"}),"Write/Delete")]}),(0,te.jsxs)("div",{className:"flex justify-end gap-2 mt-6",children:[(0,te.jsx)(Rs,{variant:"ghost",className:"text-black border border-transparent hover:border-slate-300 px-4 py-2 rounded rec-save-btn",onClick:e=>{e.stopPropagation(),i(!1),a&&a()},children:"Dismiss"}),(0,te.jsx)(Rs,{className:"bg-black hover:bg-slate-800 text-white font-semibold px-4 rounded-md shadow rec-save-btn text-xs flex items-center justify-center",style:{minWidth:102,height:28},onClick:e=>{e.stopPropagation(),t&&t()},children:"Apply Fixes"})]})]}):(0,te.jsxs)("div",{className:"mt-6 w-full bg-white border border-slate-200 rounded-lg px-4 py-2 pb-3 cursor-pointer text-xs flex flex-wrap md:flex-nowrap items-center justify-between gap-2",style:{marginBottom:0,paddingBottom:0},onClick:e=>{e.stopPropagation(),r||(i(!0),n&&n())},children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 whitespace-nowrap flex-1 min-w-0",children:[(0,te.jsx)("button",{className:"rec-collapsible-trigger mr-2 p-0.5 flex items-center justify-center",style:{width:24,height:24,background:"none",border:"none",boxShadow:"none"},onClick:e=>{e.stopPropagation(),r||(i(!0),n&&n())},"aria-label":"Expand recommendations",children:(0,te.jsx)(ct.A,{className:"h-4 w-4 text-slate-500"})}),(0,te.jsx)(Zc.A,{className:"h-5 w-5 text-black",strokeWidth:2,fill:"none"}),(0,te.jsx)("span",{className:"font-semibold text-black text-xs truncate",children:"RLS Recommendation"})]}),(0,te.jsx)("div",{className:"flex-shrink-0 w-full md:w-auto flex justify-end",children:(0,te.jsx)(Rs,{className:"bg-black hover:bg-slate-800 text-white font-semibold px-4 rounded-md shadow rec-save-btn text-xs flex items-center justify-center mt-1 mb-2 md:mt-0 mr-2 md:mr-4",style:{minWidth:102,height:28},onClick:e=>{e.stopPropagation(),t&&t()},children:"Apply Fixes"})})]}):null}function zm(e){let{entity:s,scanResult:t,rlsRecs:a,onSaveRecommendation:r,onClick:n,clickable:l,forceOpenRLS:i,onRLSOpen:o}=e;const c=s.rls&&Object.keys(s.rls).length>0,d=c&&s.rls.read,m=c&&s.rls.write;let u=[];t&&a&&a.length>0&&(u=a.map(((e,s)=>({...e,_idx:s}))).filter((e=>e.entity_name===s.name)));return(0,te.jsxs)("div",{className:"w-full h-full rounded-xl border bg-white shadow-sm p-6 transition-all cursor-pointer hover:shadow-md flex flex-col "+(l?"hover:bg-muted/30":""),onClick:e=>{e.target.closest(".rec-collapsible-trigger")||e.target.closest(".rec-save-btn")||l&&n&&n()},tabIndex:l?0:void 0,role:l?"button":void 0,children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("span",{className:"text-base font-semibold",children:s.title||s.name}),(0,te.jsxs)(qs,{variant:c?"default":"outline",className:"ml-2 "+(c?"bg-blue-100 text-blue-800 hover:bg-blue-200":""),children:[c?(0,te.jsx)(Ls.A,{className:"h-3 w-3 mr-1"}):(0,te.jsx)(Jd.A,{className:"h-3 w-3 mr-1"}),c?"Restricted":"Public"]})]}),(0,te.jsx)("div",{className:"space-y-3 text-sm mt-2",children:c?(0,te.jsx)(te.Fragment,{children:(0,te.jsxs)("div",{className:"flex flex-row gap-8 w-full items-start",children:[(0,te.jsxs)("div",{className:"flex-1 min-w-[160px] flex flex-col items-start",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-1 min-h-[24px]",children:[(0,te.jsx)(Jd.A,{className:"h-4 w-4 text-slate-500 opacity-40"}),(0,te.jsx)("span",{className:"text-muted-foreground font-medium",children:"Read:"})]}),(0,te.jsx)("div",{className:"flex flex-col gap-0.5 w-full",children:d?Array.isArray(s.rls.read.$or)?s.rls.read.$or.map(((e,s)=>(0,te.jsx)("div",{className:"flex items-center py-0.5",children:(0,te.jsx)(Rm,{rule:e})},s))):(0,te.jsx)("div",{className:"flex items-center py-0.5",children:(0,te.jsx)(Rm,{rule:s.rls.read})}):(0,te.jsx)("span",{className:"text-muted-foreground",children:"No restrictions"})})]}),(0,te.jsxs)("div",{className:"flex-1 min-w-[160px] flex flex-col items-start",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-1 min-h-[24px]",children:[(0,te.jsx)(Ba.A,{className:"h-4 w-4 text-slate-500 opacity-40"}),(0,te.jsx)("span",{className:"text-muted-foreground font-medium",children:"Write/Delete:"})]}),(0,te.jsx)("div",{className:"flex flex-col gap-0.5 w-full",children:m?Array.isArray(s.rls.write.$or)?s.rls.write.$or.map(((e,s)=>(0,te.jsx)("div",{className:"flex items-center py-0.5",children:(0,te.jsx)(Rm,{rule:e})},s))):(0,te.jsx)("div",{className:"flex items-center py-0.5",children:(0,te.jsx)(Rm,{rule:s.rls.write})}):(0,te.jsx)("span",{className:"text-muted-foreground",children:"Same as read"})})]})]})}):(0,te.jsxs)("div",{className:"flex items-center text-muted-foreground",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4 mr-2 text-red-500"}),(0,te.jsx)("span",{children:"All users have full access"})]})}),u.length>0&&(0,te.jsx)(Fm,{rec:u[0],onApply:()=>r(u[0]._idx),forceOpenRLS:i,onOpen:o})]})}var Um=t(86885);const Bm=Um.bL,Wm=Um.l9,qm=Um.ZL,Vm=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Um.hJ,{className:ns("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...a,ref:s})}));Vm.displayName=Um.hJ.displayName;const Ym=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsxs)(qm,{children:[(0,te.jsx)(Vm,{}),(0,te.jsx)(Um.UC,{ref:s,className:ns("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...a})]})}));Ym.displayName=Um.UC.displayName;const Hm=e=>{let{className:s,...t}=e;return(0,te.jsx)("div",{className:ns("flex flex-col space-y-2 text-center sm:text-left",s),...t})};Hm.displayName="AlertDialogHeader";const Gm=e=>{let{className:s,...t}=e;return(0,te.jsx)("div",{className:ns("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",s),...t})};Gm.displayName="AlertDialogFooter";const Jm=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Um.hE,{ref:s,className:ns("text-lg font-semibold",t),...a})}));Jm.displayName=Um.hE.displayName;const Zm=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Um.VY,{ref:s,className:ns("text-sm text-muted-foreground",t),...a})}));Zm.displayName=Um.VY.displayName;const Km=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Um.rc,{ref:s,className:ns(Os(),t),...a})}));Km.displayName=Um.rc.displayName;const Xm=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Um.ZD,{ref:s,className:ns(Os({variant:"outline"}),"mt-2 sm:mt-0",t),...a})}));function Qm(e){var s;let{rule:t,onChange:a,onDelete:r,index:n}=e;const{app:l}=vs(),[i,o]=(0,Y.useState)((()=>t?"{{user.email}}"===t.created_by?"creatorOnly":t.user_condition?"userProperty":"fieldComparison":"none")),[c,d]=(0,Y.useState)(""),[m,u]=(0,Y.useState)(""),[x,h]=(0,Y.useState)("role"),[p,g]=(0,Y.useState)(""),f=(null==l||null===(s=l.user_entity)||void 0===s?void 0:s.properties)||{},v=Object.keys(f).filter((e=>!["role","email","full_name"].includes(e)));(0,Y.useEffect)((()=>{if(t)if(t.user_condition){const e=Object.keys(t.user_condition)[0];h(e),g(t.user_condition[e])}else{const e=Object.keys(t).filter((e=>!e.startsWith("$")));if(e.length){const s=e[0],a=t[s];"string"==typeof a&&a.startsWith("{{user.")&&(d(s.replace("data.","")),u(a.substring(7,a.length-2)))}}}),[t]);(0,Y.useEffect)((()=>{if("fieldComparison"===i&&c&&m){let e=c;["id","created_by","updated_date","created_date"].includes(c)||(e=`data.${c}`),a({[e]:`{{user.${m}}}`},n)}}),[c,m,i,n,a]),(0,Y.useEffect)((()=>{"userProperty"===i&&x&&p&&a({user_condition:{[x]:p}},n)}),[x,p,i,n,a]);return(0,te.jsxs)("div",{className:"p-5 border rounded-lg relative mb-5 bg-white shadow-sm",children:[n>0&&(0,te.jsx)(Rs,{variant:"ghost",size:"icon",className:"absolute top-3 right-3 h-7 w-7 text-destructive hover:bg-red-50",onClick:()=>r(n),title:"Remove rule",children:(0,te.jsx)(Tc.A,{className:"h-4 w-4"})}),(0,te.jsxs)(lt,{value:i,onValueChange:e=>{o(e),"none"===e?a(null,n):"creatorOnly"===e?a({created_by:"{{user.email}}"},n):"fieldComparison"===e?(d(""),u("")):"userProperty"===e&&(h("role"),g(""))},className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border hover:bg-muted/30 transition-colors",children:[(0,te.jsx)(it,{value:"none",id:`none-${n}`,className:"mt-1"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsxs)(at,{htmlFor:`none-${n}`,className:"font-medium flex items-center gap-2",children:[(0,te.jsx)(Jd.A,{className:"h-4 w-4 text-green-500"}),"No Restrictions"]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"All users can access records"})]})]}),(0,te.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border hover:bg-muted/30 transition-colors",children:[(0,te.jsx)(it,{value:"creatorOnly",id:`creatorOnly-${n}`,className:"mt-1"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsxs)(at,{htmlFor:`creatorOnly-${n}`,className:"font-medium flex items-center gap-2",children:[(0,te.jsx)(Mm.A,{className:"h-4 w-4 text-indigo-500"}),"Creator Only"]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Users can only access records they created"})]})]}),(0,te.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border hover:bg-muted/30 transition-colors",children:[(0,te.jsx)(it,{value:"fieldComparison",id:`fieldComparison-${n}`,className:"mt-1"}),(0,te.jsxs)("div",{className:"space-y-1 w-full",children:[(0,te.jsxs)(at,{htmlFor:`fieldComparison-${n}`,className:"font-medium flex items-center gap-2",children:[(0,te.jsx)(It.A,{className:"h-4 w-4 text-emerald-500"}),"Entity-User Field Comparison"]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Compare a field in this entity with a user property"}),"fieldComparison"===i&&(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 p-3 bg-muted/20 rounded-lg",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)(at,{className:"flex items-center gap-1.5",children:[(0,te.jsx)(Rl.A,{className:"h-3.5 w-3.5 text-primary/70"}),"Entity Field"]}),(0,te.jsx)(Qs,{placeholder:"e.g. department",value:c,onChange:e=>d(e.target.value),className:"border-muted-foreground/30 focus:border-primary"}),(0,te.jsx)("p",{className:"text-xs text-muted-foreground",children:"Field in the entity to compare"})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)(at,{className:"flex items-center gap-1.5",children:[(0,te.jsx)(Mm.A,{className:"h-3.5 w-3.5 text-primary/70"}),"User Field"]}),(0,te.jsxs)(ut,{value:m,onValueChange:u,children:[(0,te.jsx)(pt,{className:"border-muted-foreground/30 focus:border-primary",children:(0,te.jsx)(ht,{placeholder:"Select user field"})}),(0,te.jsx)(vt,{children:(()=>{const e=v.map((e=>({value:`data.${e}`,label:e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," ")})));return[{value:"email",label:"Email"},{value:"role",label:"Role"},{value:"id",label:"User ID"},{value:"full_name",label:"Full Name"},...e]})().map((e=>(0,te.jsx)(bt,{value:e.value,children:e.label},e.value)))})]}),(0,te.jsx)("p",{className:"text-xs text-muted-foreground",children:"Field from the user to compare"})]})]})]})]}),(0,te.jsxs)("div",{className:"flex items-start space-x-3 p-3 rounded-lg border hover:bg-muted/30 transition-colors",children:[(0,te.jsx)(it,{value:"userProperty",id:`userProperty-${n}`,className:"mt-1"}),(0,te.jsxs)("div",{className:"space-y-1 w-full",children:[(0,te.jsxs)(at,{htmlFor:`userProperty-${n}`,className:"font-medium flex items-center gap-2",children:[(0,te.jsx)(Om.A,{className:"h-4 w-4 text-amber-500"}),"User Property Check"]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground mb-2",children:"Check if a user property matches a specific value"}),"userProperty"===i&&(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 p-3 bg-muted/20 rounded-lg",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)(at,{className:"flex items-center gap-1.5",children:[(0,te.jsx)(Mm.A,{className:"h-3.5 w-3.5 text-primary/70"}),"User Property"]}),(0,te.jsxs)(ut,{value:x,onValueChange:h,children:[(0,te.jsx)(pt,{className:"border-muted-foreground/30 focus:border-primary",children:(0,te.jsx)(ht,{placeholder:"Select user property"})}),(0,te.jsxs)(vt,{children:[(0,te.jsx)(bt,{value:"role",children:"User Role"}),(0,te.jsx)(bt,{value:"email",children:"User Email"}),(0,te.jsx)(bt,{value:"full_name",children:"Full Name"}),v.map((e=>(0,te.jsx)(bt,{value:`data.${e}`,children:e.charAt(0).toUpperCase()+e.slice(1).replace(/_/g," ")},`data.${e}`)))]})]})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)(at,{className:"flex items-center gap-1.5",children:[(0,te.jsx)(Ed.A,{className:"h-3.5 w-3.5 text-primary/70"}),"Required Value"]}),"role"===x?(0,te.jsxs)(ut,{value:p,onValueChange:g,children:[(0,te.jsx)(pt,{className:"border-muted-foreground/30 focus:border-primary",children:(0,te.jsx)(ht,{placeholder:"Select role"})}),(0,te.jsxs)(vt,{children:[(0,te.jsx)(bt,{value:"admin",children:"Admin"}),(0,te.jsx)(bt,{value:"user",children:"User"})]})]}):(0,te.jsx)(Qs,{placeholder:"email"===x?"e.g. admin@example.com":"e.g. required value",value:p,onChange:e=>g(e.target.value),className:"border-muted-foreground/30 focus:border-primary"}),(0,te.jsx)("p",{className:"text-xs text-muted-foreground",children:"role"===x?"Select the required user role":"Value that the user property must match"})]})]})]})]})]})]})}function eu(e){let{entity:s,onSave:t,onBack:a}=e;const[r,n]=(0,Y.useState)(s.rls||{}),[l,i]=(0,Y.useState)("read"),[o,c]=(0,Y.useState)(s.rls&&Object.keys(s.rls).length>0?"restricted":"public"),[d,m]=(0,Y.useState)(!(!s.rls||!s.rls.write)),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)((()=>s.rls&&s.rls.read?s.rls.read.$or?s.rls.read.$or:[s.rls.read]:[null])),[g,f]=(0,Y.useState)((()=>s.rls&&s.rls.write?s.rls.write.$or?s.rls.write.$or:[s.rls.write]:[null]));(0,Y.useEffect)((()=>{const e={...r},s=h.filter((e=>null!==e)),t=g.filter((e=>null!==e));s.length>0?1===s.length?e.read=s[0]:e.read={$or:s}:delete e.read,d&&t.length>0?1===t.length?e.write=t[0]:e.write={$or:t}:d?delete e.write:e.read?e.write=e.read:delete e.write,n(e)}),[h,g,d]);const v=(e,s)=>{if("read"===l){const t=[...h];t[s]=e,p(t)}else{const t=[...g];t[s]=e,f(t)}},j=e=>{if("read"===l){const s=[...h];s.splice(e,1),p(s)}else{const s=[...g];s.splice(e,1),f(s)}};return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Bm,{open:u,onOpenChange:x,children:(0,te.jsxs)(Ym,{children:[(0,te.jsxs)(Hm,{children:[(0,te.jsxs)(Jm,{className:"flex items-center gap-2",children:[(0,te.jsx)(Zc.A,{className:"h-5 w-5 text-amber-500"}),"Remove All Security Rules"]}),(0,te.jsx)(Zm,{children:"This will remove all security rules for this entity, allowing all users to access all records. Are you sure you want to continue?"})]}),(0,te.jsxs)(Gm,{children:[(0,te.jsx)(Xm,{children:"Cancel"}),(0,te.jsx)(Km,{onClick:()=>{c("public"),p([null]),f([null]),m(!1),x(!1)},className:"bg-red-600 hover:bg-red-700 text-white",children:"Remove All Rules"})]})]})}),(0,te.jsxs)("div",{className:"flex items-center justify-between mb-6 space-x-4 border-b pb-4",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:a,className:"hover:bg-muted/50",children:[(0,te.jsx)(pi.A,{className:"h-4 w-4 mr-2"})," Back"]}),(0,te.jsxs)("div",{children:[(0,te.jsxs)("h2",{className:"text-xl font-semibold flex items-center gap-2",children:[(0,te.jsx)(Dl.A,{className:"h-5 w-5 text-primary"}),"Security Rules: ",s.title||s.name]}),"restricted"===o&&(0,te.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:"Create rules to control who can read and write records. Multiple rules are combined with OR logic."})]})]}),"restricted"===o&&(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>x(!0),className:"border-red-300 text-red-600 hover:bg-red-50 hover:text-red-700",children:"Remove All Rules"})]}),(0,te.jsxs)(Vs,{className:"w-full border-muted-foreground/20 shadow-sm",children:[(0,te.jsx)(Js,{className:"space-y-6 pt-6",children:"public"===o?(0,te.jsx)("div",{className:"p-6 border rounded-lg bg-muted/5 space-y-4",children:(0,te.jsxs)("div",{className:"flex items-start gap-4",children:[(0,te.jsx)("div",{className:"bg-green-50 p-2 rounded-full",children:(0,te.jsx)(Yi.A,{className:"h-5 w-5 text-green-600"})}),(0,te.jsxs)("div",{className:"space-y-2 flex-1",children:[(0,te.jsx)("h3",{className:"text-lg font-medium",children:"Public Access"}),(0,te.jsx)("p",{className:"text-muted-foreground",children:"Currently all users can access all records in this entity. There are no access restrictions."})]}),(0,te.jsxs)(Rs,{onClick:()=>{c("restricted"),p([null]),i("read")},className:"gap-2 whitespace-nowrap",children:[(0,te.jsx)(Ls.A,{className:"h-4 w-4"}),"Create Access Rules"]})]})}):(0,te.jsx)(te.Fragment,{children:(0,te.jsxs)(lr,{value:l,onValueChange:i,className:"w-full",children:[(0,te.jsxs)(ir,{className:"grid grid-cols-2 w-full mb-4",children:[(0,te.jsxs)(or,{value:"read",className:"flex items-center gap-2",children:[(0,te.jsx)(Jd.A,{className:"h-4 w-4"})," Read Access"]}),(0,te.jsxs)(or,{value:"write",className:"flex items-center gap-2",children:[(0,te.jsx)(Ba.A,{className:"h-4 w-4"})," Write/Delete Access"]})]}),(0,te.jsxs)(cr,{value:l,className:"space-y-6 pt-4",children:[(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,te.jsx)(at,{className:"text-base font-medium flex items-center gap-2",children:"read"===l?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Jd.A,{className:"h-4 w-4 text-blue-500"})," Read Access Rules"]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Ba.A,{className:"h-4 w-4 text-amber-500"})," Write/Delete Access Rules"]})}),(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>{"read"===l?p([...h,null]):f([...g,null])},className:"flex items-center gap-1.5 border-primary/30 hover:bg-primary/5",children:[(0,te.jsx)(ys.A,{className:"h-3.5 w-3.5"})," Add Rule"]})]}),"read"===l?h.map(((e,t)=>(0,te.jsx)(Qm,{rule:e,onChange:v,onDelete:j,index:t,entity:s},t))):d?g.map(((e,t)=>(0,te.jsx)(Qm,{rule:e,onChange:v,onDelete:j,index:t,entity:s},t))):(0,te.jsxs)("div",{className:"p-6 border rounded-lg bg-blue-50 flex flex-col items-center justify-center space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 text-blue-800",children:[(0,te.jsx)(Ht.A,{className:"h-5 w-5 text-blue-600"}),(0,te.jsx)("span",{className:"font-medium",children:"Write rules inherit from Read Access rules"})]}),(0,te.jsx)("p",{className:"text-sm text-blue-700 text-center max-w-md",children:"Users who can read records will have the same permissions for writing and deleting records"}),(0,te.jsxs)(Rs,{onClick:()=>{m(!0),h.length>0&&f([...h]),i("write")},variant:"outline",className:"border-blue-300 text-blue-700 hover:bg-blue-100",children:[(0,te.jsx)(Ba.A,{className:"h-4 w-4 mr-2"}),"Create Custom Write Rules"]})]})]}),(0,te.jsxs)("div",{className:"space-y-2 bg-muted/10 p-4 rounded-lg border",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsxs)(at,{className:"font-medium flex items-center gap-2",children:[(0,te.jsx)(It.A,{className:"h-4 w-4 text-primary/70"}),"Generated Rules (JSON)"]}),(0,te.jsx)(qs,{variant:"outline",className:"bg-primary/5 border-primary/20",children:"read"===l?h.filter((e=>null!==e)).length:d?g.filter((e=>null!==e)).length:"Same as read"})]}),(0,te.jsx)(Ui,{rows:4,value:"read"===l?r.read?JSON.stringify(r.read,null,2):"":d?r.write?JSON.stringify(r.write,null,2):"":"Using the same rules as Read Access",readOnly:!0,className:"font-mono text-sm bg-muted/30 border-muted-foreground/20"})]})]})]})})}),(0,te.jsx)(Zs,{className:"flex justify-end pt-4 border-t bg-muted/5",children:(0,te.jsxs)(Rs,{onClick:()=>{const e={...s,rls:"public"===o?void 0:r};t(e)},size:"lg",className:"gap-2",children:[(0,te.jsx)(Dl.A,{className:"h-4 w-4"}),"Save Security Rules"]})})]})]})}Xm.displayName=Um.ZD.displayName;class su extends K.H{getBaseURL(){return"/apps"}runSecurityScan(e){return this.axios.post(`/${e}/security/generate-suggestions`).then((e=>e.result||e))}}const tu=new su;function au(e){let{title:s,count:t,subtitle:a,noIssuesSubtitle:r,rightElement:n}=e;const l=t>0,i=l?(0,te.jsx)(Ke.A,{className:"h-4 w-4 mr-2 text-red-600",strokeWidth:2}):(0,te.jsx)(Ed.A,{className:"h-4 w-4 text-green-500 mr-2",strokeWidth:2});return(0,te.jsxs)("div",{className:"flex flex-col items-start w-full",children:[(0,te.jsxs)("div",{className:"flex items-center w-full",children:[(0,te.jsxs)("span",{className:"flex items-center font-semibold text-sm text-black flex-1",children:[i,s]}),n&&(0,te.jsx)("span",{children:n})]}),(0,te.jsx)("span",{className:"text-sm leading-5 font-normal mt-1 text-black ml-6",children:l?a:r})]})}function ru(e){let{title:s,issues:t=[],subtitle:a,noIssuesSubtitle:r}=e;const[n,l]=(0,Y.useState)(!1),i=t.length>0,o=i?n?(0,te.jsx)(dt.A,{className:"h-5 w-5 text-slate-500"}):(0,te.jsx)(ct.A,{className:"h-5 w-5 text-slate-500"}):null;return(0,te.jsxs)("div",{className:"w-full rounded-lg border border-[#E4E4E7] bg-white shadow-sm",children:[(0,te.jsx)("button",{className:"flex items-center justify-between w-full px-4 py-5 focus:outline-none rounded-lg",onClick:()=>i&&l((e=>!e)),"aria-expanded":n,style:{border:"none",background:"transparent",boxShadow:"none"},children:(0,te.jsx)(au,{title:s,count:t.length,subtitle:a,noIssuesSubtitle:r,rightElement:o})}),n&&i&&(0,te.jsx)("div",{className:"flex flex-col gap-4 mb-[12px] px-4 pb-4",children:t.map(((e,s)=>(0,te.jsxs)("div",{className:"flex flex-row items-start w-full rounded-lg border border-[#E4E4E7] bg-white py-3 px-4 gap-x-3 shadow-sm",children:[(0,te.jsx)("div",{className:"flex items-start",children:(0,te.jsx)(Ke.A,{className:"h-4 w-4 text-red-700 mt-0.5",strokeWidth:2})}),(0,te.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,te.jsx)("div",{className:"text-red-600 text-sm font-medium leading-5 flex items-start gap-2",children:e.description}),(0,te.jsxs)("div",{className:"text-[#71717A] text-sm font-normal leading-5",children:["File: ",e.filePath]})]})]},s)))})]})}function nu(){const{app:e}=vs(),s=(0,Z.zy)(),t=(0,Z.Zp)(),[a,r]=(0,Y.useState)(null),[n,l]=(0,Y.useState)("list"),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(!1),{toast:m}=Un(),[u,x]=(0,Y.useState)(null),h=e.entities||{},p=Object.keys(h);(0,Y.useEffect)((()=>{i&&i.rls_recommendations&&x([...i.rls_recommendations])}),[i]);const g=(0,Y.useCallback)((async()=>{Se("Security Scan Started",{app_id:e.id,app_name:e.name}),d(!0),o(null);try{const s=await tu.runSecurityScan(e.id);o(s.result||s),m({title:"Security scan complete",description:"Review the findings below."})}catch(s){m({title:"Security scan failed",description:s.message,variant:"destructive"})}finally{d(!1)}}),[e.id,e.name,m]);(0,Y.useEffect)((()=>{const e=new URLSearchParams(s.search);if("1"===e.get("autoStartScan")&&!c&&!i){g(),e.delete("autoStartScan");const a=e.toString(),r=`${s.pathname}${a?`?${a}`:""}`;t(r,{replace:!0})}}),[s.search,g,c,i,t,s.pathname]);const f=()=>{const e=document.getElementById("data-entities-section");e&&e.scrollIntoView({behavior:"smooth",block:"start"})};return"list"===n?(0,te.jsxs)("div",{className:"w-full py-8 space-y-8 p-4",children:[(0,te.jsxs)("div",{className:"mb-2",children:[(0,te.jsx)("h1",{className:"text-3xl font-bold tracking-tight",children:"App Security"}),(0,te.jsx)("p",{className:"text-muted-foreground mt-1",children:"Configure row-level security policies to control who can access your app's data"})]}),(0,te.jsxs)("div",{className:"flex items-center justify-between bg-white border border-slate-200 rounded-lg px-6 py-3 mb-6 w-full shadow-sm",children:[(0,te.jsxs)("div",{className:"flex flex-col",children:[(0,te.jsx)("span",{className:"font-semibold text-base text-black",children:"Scan issues"}),(0,te.jsx)("span",{className:"text-sm text-slate-500",children:"Scan typically takes few minutes to complete"})]}),(0,te.jsx)(Rs,{onClick:g,disabled:c,className:"bg-black hover:bg-slate-800 text-white font-semibold rounded-lg px-4 text-sm flex items-center justify-center",style:{width:175,height:34,minWidth:0},children:c?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"animate-spin h-4 w-4"}),(0,te.jsx)("span",{className:"ml-2",children:"Scanning"})]}):(0,te.jsx)("span",{children:"Start Security Check"})})]}),i?(0,te.jsxs)("div",{className:"bg-white border border-slate-200 rounded-lg p-6 mb-8 shadow-sm animate-in fade-in",children:[(0,te.jsx)("div",{className:"font-bold text-2xl text-black mb-6",children:"Scan Results"}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("div",{className:"bg-white border border-slate-200 rounded-lg p-6 shadow-sm",children:(0,te.jsx)(au,{title:"RLS Recommendations",count:(null==u?void 0:u.length)||0,subtitle:u&&u.length>0?(0,te.jsxs)(te.Fragment,{children:[`${u.length} RLS recommendation${u.length>1?"s":""} found, `,(0,te.jsx)("button",{onClick:f,className:"inline text-black font-medium underline ml-1 hover:text-slate-800 transition p-0 bg-transparent border-0 outline-none",style:{fontSize:"inherit",lineHeight:"inherit"},type:"button",children:"View recommendations"})]}):null,noIssuesSubtitle:"No RLS recommendations found",rightElement:null})}),(0,te.jsx)(ru,{title:"Secrets",subtitle:`${i.hardcoded_secrets.length} Exposed secrets found`,noIssuesSubtitle:"No exposed secrets found",issues:(i.hardcoded_secrets||[]).map((e=>({description:e.description,filePath:e.file_path})))}),(0,te.jsx)(ru,{title:"Backend Functions",subtitle:`${i.backend_functions.length} Unauthenticated backend functions found`,noIssuesSubtitle:"No unauthenticated backend functions found",issues:(i.backend_functions||[]).map((e=>({description:e.description,filePath:e.file_path})))})]})]}):null,(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("h2",{id:"data-entities-section",className:"text-xl font-medium flex items-center gap-2",children:[(0,te.jsx)(Rl.A,{className:"h-5 w-5 text-primary/70"}),"Data Entities"]}),(0,te.jsxs)(qs,{variant:"outline",className:"bg-primary/5 border-primary/20 px-3 py-1",children:[(0,te.jsx)(Wa.A,{className:"h-3.5 w-3.5 mr-1.5"}),p.length," entities"]})]}),(0,te.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6 w-full mx-auto items-stretch",children:p.map((s=>(0,te.jsx)("div",{className:"h-full flex flex-col",children:(0,te.jsx)(zm,{entity:h[s],scanResult:i,rlsRecs:u,app:e,onSaveRecommendation:t=>(async(s,t)=>{const a=u.filter(((e,a)=>e.entity_name===s&&a===t));if(0===a.length)return;const r=a[0];try{await ms.write(e.id,`entities/${r.entity_name}`,JSON.stringify({...h[r.entity_name],rls:{read:r.read_rule?JSON.parse(r.read_rule):void 0,write:r.write_rule?JSON.parse(r.write_rule):void 0}},null,2)),x((e=>e.filter(((e,s)=>s!==t)))),m({title:`Rule saved for ${r.entity_name}`,description:"The recommended rule has been saved.",variant:"success"})}catch(n){m({title:"Failed to save rule",description:n.message,variant:"destructive"})}})(s,t),onClick:()=>(e=>{r(e),l("edit")})(s),clickable:!0},s)})))})]}):(0,te.jsx)("div",{className:"max-w-full py-6 p-4",children:(0,te.jsx)(eu,{entity:h[a],onSave:s=>{ms.write(e.id,`entities/${s.name}`,JSON.stringify(s,null,2)),l("list")},onBack:()=>{l("list"),r(null)}})})}var lu=t(81872);const iu=e=>{let{secretName:s,appId:t,onUpdate:a}=e;const{toast:r}=Fr(),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(""),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),{updateSecrets:p}=vs();return(0,te.jsx)(Vs,{children:(0,te.jsx)(Js,{className:"p-4",children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(Qa.A,{className:"h-5 w-5 text-green-500"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"font-medium",children:s}),i?(0,te.jsx)("div",{className:"mt-2 space-y-2",children:(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Qs,{type:x?"text":"password",placeholder:"New secret value",value:c,onChange:e=>d(e.target.value),className:"h-8 w-48 pr-10"}),(0,te.jsx)(Rs,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-2 py-1 hover:bg-transparent",onClick:()=>{h((e=>!e))},children:x?(0,te.jsx)(Nd.A,{className:"h-3 w-3"}):(0,te.jsx)(Jd.A,{className:"h-3 w-3"})})]}),(0,te.jsx)(Rs,{size:"sm",onClick:async()=>{if(c){u(!0);try{await p({[s]:c}),r({title:"Secret updated",duration:3e3}),a(),o(!1),d(""),h(!1)}catch(n){var e,t;r({variant:"destructive",title:"Error updating secret",description:(null===(e=n.response)||void 0===e||null===(t=e.data)||void 0===t?void 0:t.detail)||"Something went wrong",duration:3e3})}u(!1)}},disabled:m||!c,className:"h-8",children:m?(0,te.jsx)($c.A,{className:"h-4 w-4 animate-spin"}):"Save"}),(0,te.jsx)(Rs,{size:"sm",variant:"outline",onClick:()=>{o(!1),d(""),h(!1)},className:"h-8",children:"Cancel"})]})}):(0,te.jsx)("p",{className:"text-sm text-gray-500",children:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022"})]})]}),(0,te.jsxs)("div",{className:"flex gap-2",children:[!i&&(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>{o(!0)},className:"text-blue-500 hover:text-blue-600 hover:bg-blue-50",children:(0,te.jsx)(lu.A,{className:"h-4 w-4"})}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:async()=>{l(!0);try{await xs.deleteSecret(t,s),r({title:"Secret deleted",duration:3e3}),a()}catch(i){var e,n;r({variant:"destructive",title:"Error deleting secret",description:(null===(e=i.response)||void 0===e||null===(n=e.data)||void 0===n?void 0:n.detail)||"Something went wrong",duration:3e3})}l(!1)},className:"text-red-500 hover:text-red-600 hover:bg-red-50",disabled:n,children:(0,te.jsx)(Tc.A,{className:"h-4 w-4 "+(n?"animate-spin":"")})})]})]})})})},ou=e=>{let{onAdd:s,loading:t}=e;const[a,r]=(0,Y.useState)(""),[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),m=a.includes(" "),u=m;return(0,te.jsxs)(na,{open:i,onOpenChange:o,children:[(0,te.jsx)(la,{asChild:!0,children:(0,te.jsxs)(Rs,{children:[(0,te.jsx)(ys.A,{className:"h-4 w-4 mr-2"}),"Add Secret"]})}),(0,te.jsxs)(da,{children:[(0,te.jsxs)(ma,{children:[(0,te.jsx)(xa,{children:"Add New Secret"}),(0,te.jsx)(ha,{children:"Enter your secret name and value below. Secrets are encrypted and securely stored."})]}),(0,te.jsxs)("div",{className:"space-y-4 pt-4",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("label",{className:"text-sm font-medium",children:"Secret Name"}),(0,te.jsx)(Qs,{placeholder:"Enter secret name (e.g. API_KEY)",value:a,onChange:e=>r(e.target.value),className:m?"border-red-500":""}),m&&(0,te.jsx)("p",{className:"text-sm text-red-500",children:"Secret name cannot contain spaces. Use underscores instead (e.g. API_KEY)."})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("label",{className:"text-sm font-medium",children:"Secret Value"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Qs,{type:c?"text":"password",placeholder:"Enter secret value",value:n,onChange:e=>l(e.target.value),className:"pr-10"}),(0,te.jsx)(Rs,{type:"button",variant:"ghost",size:"sm",className:"absolute right-0 top-0 h-full px-3 py-2 hover:bg-transparent",onClick:()=>{d((e=>!e))},children:c?(0,te.jsx)(Nd.A,{className:"h-4 w-4"}):(0,te.jsx)(Jd.A,{className:"h-4 w-4"})})]})]}),(0,te.jsx)("div",{className:"flex justify-end",children:(0,te.jsx)(Rs,{onClick:async()=>{u||(await s(a,n),r(""),l(""),d(!1),o(!1))},disabled:t||!a||!n||u,children:t?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($c.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Adding..."]}):"Add Secret"})})]})]})]})},cu=e=>{let{app:s}=e;return(0,te.jsx)(Vs,{children:(0,te.jsx)(Js,{className:"p-4",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)(Om.A,{className:"h-5 w-5 text-blue-500 shrink-0 mt-0.5"}),(0,te.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,te.jsx)("p",{className:"font-medium",children:(0,te.jsx)("b",{children:"About Secrets Management"})}),(0,te.jsx)("p",{className:"text-gray-600",children:"Secrets are environment variables that contain sensitive information like API keys, tokens, and passwords. They are encrypted at rest and securely injected into your application at runtime."}),(0,te.jsxs)("ul",{className:"list-disc list-inside space-y-1 text-gray-600",children:[(0,te.jsx)("li",{children:"Secrets are used by your backend functions to access external services"}),(0,te.jsx)("li",{children:"All secrets are encrypted and stored securely"}),(0,te.jsx)("li",{children:"You can add, update, or delete secrets as needed for your application"})]}),(0,te.jsxs)("p",{className:"text-xs text-gray-500",children:["Need help? Create a ticket at ",(0,te.jsx)("button",{type:"button",onClick:()=>{const e=null!=s&&s.id?`/support?appId=${s.id}`:"/support";window.open(e,"_blank")},className:"underline text-primary hover:text-orange-500 transition-colors",children:"support system"})]})]})]})})})};function du(){const{app:e,updateSecrets:s,existingSecretNames:t}=vs(),a=null==e?void 0:e.id,[r,n]=(0,Y.useState)({}),[l,i]=(0,Y.useState)(!1),{toast:o}=Fr(),c=((0,Z.Zp)(),async()=>{try{const e=await xs.getSecrets(a);n(e)}catch(t){var e,s;o({variant:"destructive",title:"Error fetching secrets",description:(null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Something went wrong",duration:3e3})}});(0,Y.useEffect)((()=>{c()}),[a]);return(0,te.jsx)("div",{className:"space-y-6 p-6",children:(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,te.jsx)("h2",{className:"text-2xl font-bold",children:"Application Secrets"}),(0,te.jsx)(ou,{onAdd:async(e,t)=>{if(e&&t){i(!0);try{await s({[e]:t}),await c(),o({title:"Secret added successfully",duration:3e3})}catch(n){var a,r;o({variant:"destructive",title:"Error creating secret",description:(null===(a=n.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.detail)||"Something went wrong",duration:3e3})}i(!1)}},loading:l})]}),(0,te.jsxs)("div",{className:"grid gap-6",children:[Object.keys(r).length>0?(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("h3",{className:"text-lg font-semibold text-green-600 flex items-center",children:[(0,te.jsx)(zr.A,{className:"h-5 w-5 mr-2"}),"Configured Secrets"]}),Object.keys(r).map((e=>(0,te.jsx)(iu,{secretName:e,appId:a,onUpdate:c},e)))]}):(0,te.jsx)("div",{className:"text-center py-8 text-gray-500",children:(0,te.jsx)("p",{children:"No secrets configured yet. Add your first secret to get started."})}),(0,te.jsx)(cu,{app:e})]})]})})}var mu=t(69783);let uu=null;const xu=function(e,s){class t extends mu.A{getMountPath(){return"/ws-user-apps/socket.io/"}getSocketQuery(){let t=super.getSocketQuery();return s&&(t.token=s),t.app_id=e,t}}return uu||(uu=new t),uu};let hu=null;function pu(e,s,t){class a extends K.y{constructor(){super(),this.socketManager=xu(e,s),this.axios.interceptors.response.use((e=>e),(e=>{var s,a;return t((null===(s=e.response)||void 0===s||null===(a=s.data)||void 0===a?void 0:a.message)||e.message),Promise.reject(e)}))}getClient(){return s?(0,ee.Ay)(this.getBaseURL(),{Authorization:`Bearer ${s}`}):super.getClient()}getBaseURL(){return`https://base44.app/api/apps/${e}/agents`}getConversations(){return this.axios.get("/conversations")}getConversation(e){return this.axios.get(`/conversations/${e}`)}listConversations(e){return this.axios.get("/conversations",{params:e})}createConversation(e){return this.axios.post("/conversations",e)}addMessage(e,s){let t=null;return hu&&hu.id===e.id?t=hu.messages:(hu=e,t=e.messages),e.messages=[...t,s],this.socketManager.onUpdateModel({room:`/agent-conversations/${e.id}`,data:JSON.stringify(e)}),this.axios.post(`/conversations/${e.id}/messages`,s)}subscribeToConversation(e,s){return this.socketManager.addListener(`/agent-conversations/${e}`,(e=>{hu&&hu.id===e.id&&(hu=e),s(e)}))}}return new a}var gu=t(32033),fu=t(21449);function vu(e){var s,t,a,r;let{agent:n,color:l,onEdit:i,onStartChat:o,isSelected:c=!1}=e;const d=(null===(s=n.tool_configs)||void 0===s||null===(t=s.filter((e=>e.entity_name)))||void 0===t?void 0:t.length)||0,m=(null===(a=n.tool_configs)||void 0===a||null===(r=a.filter((e=>e.function_name)))||void 0===r?void 0:r.length)||0,u=d+m;return(0,te.jsx)("div",{className:ns("group relative bg-white rounded-xl border transition-all p-4",c?"border-slate-500 shadow-md ring-2 ring-slate-200":"border-slate-200 hover:border-slate-400 hover:shadow-sm"),children:(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("div",{className:"flex items-start justify-between",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)("div",{className:ns("h-10 w-10 rounded-lg flex items-center justify-center flex-shrink-0",(null==l?void 0:l.light)||"bg-slate-100"),children:(0,te.jsx)(eo.A,{className:ns("h-5 w-5",(null==l?void 0:l.text)||"text-slate-500")})}),(0,te.jsx)("div",{className:"flex-1 min-w-0",children:(0,te.jsx)("h3",{className:"font-semibold text-slate-900 text-base",children:n.name})})]})}),(0,te.jsx)("div",{className:"pl-[52px]",children:(0,te.jsx)("p",{className:"text-sm text-slate-600 line-clamp-2",children:n.description||"No description provided"})}),u>0&&(0,te.jsxs)("div",{className:"pl-[52px] flex flex-wrap gap-2",children:[d>0&&(0,te.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-slate-600",children:[(0,te.jsx)(Rl.A,{className:"h-3 w-3"}),(0,te.jsxs)("span",{children:[d," ",1===d?"entity":"entities"]})]}),m>0&&(0,te.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-slate-600",children:[(0,te.jsx)(Ua.A,{className:"h-3 w-3"}),(0,te.jsxs)("span",{children:[m," ",1===m?"function":"functions"]})]})]}),n.tool_configs&&n.tool_configs.length>0&&(0,te.jsxs)("div",{className:"pl-[52px] flex flex-wrap gap-1",children:[n.tool_configs.slice(0,3).map(((e,s)=>(0,te.jsx)(qs,{variant:"secondary",className:"text-xs px-2 py-0 bg-slate-100 text-slate-600 border-0",children:e.entity_name||e.function_name},s))),n.tool_configs.length>3&&(0,te.jsxs)(qs,{variant:"secondary",className:"text-xs px-2 py-0 bg-slate-100 text-slate-600 border-0",children:["+",n.tool_configs.length-3," more"]})]}),(0,te.jsxs)("div",{className:"pl-[52px] flex gap-2 pt-1",children:[(0,te.jsxs)(Rs,{size:"sm",variant:"outline",onClick:e=>{e.stopPropagation(),i(n)},className:"h-8 text-xs",children:[(0,te.jsx)(lu.A,{className:"h-3.5 w-3.5 mr-1"}),"Edit Agent"]}),(0,te.jsxs)(Rs,{size:"sm",onClick:e=>{e.stopPropagation(),o(n)},className:"h-8 text-xs bg-slate-800 hover:bg-slate-900 text-white",children:[(0,te.jsx)(fu.A,{className:"h-3.5 w-3.5 mr-1"}),"Start Chat"]})]})]})})}function ju(e){try{const s=new Date(e);if(isNaN(s.getTime()))return"Recently";const t=new Date,a=Math.abs(t-s),r=Math.ceil(a/864e5);return 0===r?"Today":1===r?"Yesterday":r<7?`${r} days ago`:r<30?`${Math.floor(r/7)} weeks ago`:r<365?`${Math.floor(r/30)} months ago`:`${Math.floor(r/365)} years ago`}catch(s){return"Recently"}}function bu(e){var s,t,a;let{conversation:r,agentColor:n,onSelect:l,isSelected:i}=e;const o=null===(s=r.messages)||void 0===s?void 0:s.slice(-1)[0],c=(null===(t=r.messages)||void 0===t?void 0:t.length)||0;return(0,te.jsx)("div",{className:ns("group relative bg-white rounded-lg border transition-all cursor-pointer hover:shadow-sm p-3",i?"border-slate-400 shadow-sm":"border-slate-200 hover:border-slate-300"),onClick:()=>l(r),children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)("div",{className:ns("h-8 w-8 rounded-lg flex items-center justify-center flex-shrink-0",(null==n?void 0:n.light)||"bg-slate-100"),children:(0,te.jsx)(eo.A,{className:ns("h-4 w-4",(null==n?void 0:n.text)||"text-slate-500")})}),(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,te.jsx)("span",{className:"text-sm font-medium text-slate-800",children:r.agent_name}),(0,te.jsx)(qs,{variant:"outline",className:"text-xs px-1.5 py-0 border-slate-300",children:c})]}),o&&(0,te.jsxs)("p",{className:"text-xs text-slate-500 line-clamp-1",children:[null===(a=o.content)||void 0===a?void 0:a.substring(0,80),"..."]}),(0,te.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:ju(r.created_at)})]}),(0,te.jsx)(pr.A,{className:"h-4 w-4 text-slate-400 opacity-0 group-hover:opacity-100 transition-opacity"})]})})}const yu=e=>{let{toolCall:s}=e;const[t,a]=(0,Y.useState)(!1),r=(null==s?void 0:s.name)||"Function",n=(null==s?void 0:s.status)||"pending",l=null==s?void 0:s.results,i=(()=>{if(!l)return null;try{return"string"==typeof l?JSON.parse(l):l}catch{return l}})(),o=l&&("string"==typeof l&&/error|failed/i.test(l)||!1===(null==i?void 0:i.success)),c={pending:{icon:St.A,color:"text-slate-400",text:"Pending"},running:{icon:Je.A,color:"text-slate-500",text:"Running...",spin:!0},in_progress:{icon:Je.A,color:"text-slate-500",text:"Running...",spin:!0},completed:o?{icon:Ke.A,color:"text-red-500",text:"Failed"}:{icon:Qa.A,color:"text-green-600",text:"Success"},success:{icon:Qa.A,color:"text-green-600",text:"Success"},failed:{icon:Ke.A,color:"text-red-500",text:"Failed"},error:{icon:Ke.A,color:"text-red-500",text:"Failed"}}[n]||{icon:Gd.A,color:"text-slate-500",text:""},d=c.icon,m=r.split(".").reverse().join(" ").toLowerCase();return(0,te.jsxs)("div",{className:"mt-2 text-xs",children:[(0,te.jsxs)("button",{onClick:()=>a(!t),className:ns("flex items-center gap-2 px-3 py-1.5 rounded-lg border transition-all","hover:bg-slate-50",t?"bg-slate-50 border-slate-300":"bg-white border-slate-200"),children:[(0,te.jsx)(d,{className:ns("h-3 w-3",c.color,c.spin&&"animate-spin")}),(0,te.jsx)("span",{className:"text-slate-700",children:m}),c.text&&(0,te.jsxs)("span",{className:ns("text-slate-500",o&&"text-red-600"),children:["\u2022 ",c.text]}),!c.spin&&(s.arguments_string||l)&&(0,te.jsx)(pr.A,{className:ns("h-3 w-3 text-slate-400 transition-transform ml-auto",t&&"rotate-90")})]}),t&&!c.spin&&(0,te.jsxs)("div",{className:"mt-1.5 ml-3 pl-3 border-l-2 border-slate-200 space-y-2",children:[s.arguments_string&&(0,te.jsxs)("div",{children:[(0,te.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Parameters:"}),(0,te.jsx)("pre",{className:"bg-slate-50 rounded-md p-2 text-xs text-slate-600 whitespace-pre-wrap",children:(()=>{try{return JSON.stringify(JSON.parse(s.arguments_string),null,2)}catch{return s.arguments_string}})()})]}),i&&(0,te.jsxs)("div",{children:[(0,te.jsx)("div",{className:"text-xs text-slate-500 mb-1",children:"Result:"}),(0,te.jsx)("pre",{className:"bg-slate-50 rounded-md p-2 text-xs text-slate-600 whitespace-pre-wrap max-h-48 overflow-auto",children:"object"==typeof i?JSON.stringify(i,null,2):i})]})]})]})};function Nu(e){var s;let{message:t}=e;const a="user"===t.role;return(0,te.jsxs)("div",{className:ns("flex gap-3",a?"justify-end":"justify-start"),children:[!a&&(0,te.jsx)("div",{className:"h-7 w-7 rounded-lg bg-slate-100 flex items-center justify-center mt-0.5",children:(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"})}),(0,te.jsxs)("div",{className:ns("max-w-[85%]",a&&"flex flex-col items-end"),children:[t.content&&(0,te.jsx)("div",{className:ns("rounded-2xl px-4 py-2.5",a?"bg-slate-800 text-white":"bg-white border border-slate-200"),children:a?(0,te.jsx)("p",{className:"text-sm leading-relaxed",children:t.content}):(0,te.jsx)(Za.o,{className:"text-sm prose prose-sm prose-slate max-w-none [&>*:first-child]:mt-0 [&>*:last-child]:mb-0",components:{code:e=>{let{inline:s,className:t,children:a,...r}=e;const n=/language-(\w+)/.exec(t||"");return!s&&n?(0,te.jsxs)("div",{className:"relative group/code",children:[(0,te.jsx)("pre",{className:"bg-slate-900 text-slate-100 rounded-lg p-3 overflow-x-auto my-2",children:(0,te.jsx)("code",{className:t,...r,children:a})}),(0,te.jsx)(Rs,{size:"icon",variant:"ghost",className:"absolute top-2 right-2 h-6 w-6 opacity-0 group-hover/code:opacity-100 bg-slate-800 hover:bg-slate-700",onClick:()=>{navigator.clipboard.writeText(String(a).replace(/\n$/,"")),gu.toast.success("Code copied")},children:(0,te.jsx)(Ha.A,{className:"h-3 w-3 text-slate-400"})})]}):(0,te.jsx)("code",{className:"px-1 py-0.5 rounded bg-slate-100 text-slate-700 text-xs",children:a})},a:e=>{let{children:s,...t}=e;return(0,te.jsx)("a",{...t,target:"_blank",rel:"noopener noreferrer",children:s})},p:e=>{let{children:s}=e;return(0,te.jsx)("p",{className:"my-1 leading-relaxed",children:s})},ul:e=>{let{children:s}=e;return(0,te.jsx)("ul",{className:"my-1 ml-4 list-disc",children:s})},ol:e=>{let{children:s}=e;return(0,te.jsx)("ol",{className:"my-1 ml-4 list-decimal",children:s})},li:e=>{let{children:s}=e;return(0,te.jsx)("li",{className:"my-0.5",children:s})},h1:e=>{let{children:s}=e;return(0,te.jsx)("h1",{className:"text-lg font-semibold my-2",children:s})},h2:e=>{let{children:s}=e;return(0,te.jsx)("h2",{className:"text-base font-semibold my-2",children:s})},h3:e=>{let{children:s}=e;return(0,te.jsx)("h3",{className:"text-sm font-semibold my-2",children:s})},blockquote:e=>{let{children:s}=e;return(0,te.jsx)("blockquote",{className:"border-l-2 border-slate-300 pl-3 my-2 text-slate-600",children:s})}},children:t.content})}),(null===(s=t.tool_calls)||void 0===s?void 0:s.length)>0&&(0,te.jsx)("div",{className:"space-y-1",children:t.tool_calls.map(((e,s)=>(0,te.jsx)(yu,{toolCall:e},s)))})]})]})}function wu(e){let{conversation:s,agentColor:t,agentsSDK:a,onBack:r}=e;const[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),c=(0,Y.useRef)(null),d=(0,Y.useRef)(null),m=s.messages||[];(0,Y.useEffect)((()=>{var e;null===(e=d.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[m]);const u=async()=>{if(!n.trim()||i)return;const e={id:Date.now().toString(),role:"user",content:n.trim()};l(""),o(!0);try{await a.addMessage(s,e)}catch(t){gu.toast.error("Failed to send message")}finally{o(!1)}};return(0,te.jsxs)("div",{className:"flex flex-col h-full bg-white rounded-xl border border-slate-200",children:[(0,te.jsx)("div",{className:"border-b bg-white px-4 py-3",children:(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(Rs,{variant:"ghost",size:"icon",onClick:r,className:"h-7 w-7",children:(0,te.jsx)($t.A,{className:"h-4 w-4"})}),(0,te.jsx)("div",{className:ns("h-8 w-8 rounded-lg flex items-center justify-center",(null==t?void 0:t.light)||"bg-slate-100"),children:(0,te.jsx)(eo.A,{className:ns("h-4 w-4",(null==t?void 0:t.text)||"text-slate-500")})}),(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("h3",{className:"font-semibold text-sm text-slate-900",children:s.agent_name}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"Active conversation"})]})]})}),(0,te.jsx)(Wi,{className:"flex-1 p-4",ref:c,children:(0,te.jsxs)("div",{className:"space-y-4",children:[0===m.length?(0,te.jsxs)("div",{className:"text-center py-8",children:[(0,te.jsx)("div",{className:"h-12 w-12 rounded-xl bg-slate-100 flex items-center justify-center mx-auto mb-3",children:(0,te.jsx)(mr.A,{className:"h-6 w-6 text-slate-400"})}),(0,te.jsx)("p",{className:"text-sm text-slate-500",children:"Start your conversation"}),(0,te.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Type a message below to begin"})]}):m.map((e=>e?(0,te.jsx)(Nu,{message:e},e.id):null)),i&&(0,te.jsxs)("div",{className:"flex gap-3",children:[(0,te.jsx)("div",{className:"flex-shrink-0 mt-0.5",children:(0,te.jsx)("div",{className:ns("h-7 w-7 rounded-lg flex items-center justify-center",(null==t?void 0:t.light)||"bg-slate-100"),children:(0,te.jsx)(Je.A,{className:ns("h-3 w-3 animate-spin",(null==t?void 0:t.text)||"text-slate-500")})})}),(0,te.jsx)("div",{className:"bg-white border border-slate-200 rounded-2xl px-4 py-2.5",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400 animate-pulse"}),(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400 animate-pulse delay-75"}),(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400 animate-pulse delay-150"})]})})]}),(0,te.jsx)("div",{ref:d})]})}),(0,te.jsx)("div",{className:"border-t bg-white px-4 py-3",children:(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsx)(Qs,{value:n,onChange:e=>l(e.target.value),onKeyPress:e=>"Enter"===e.key&&!e.shiftKey&&u(),placeholder:"Type your message...",disabled:i,className:"flex-1 text-sm border-slate-200 focus:border-slate-400"}),(0,te.jsx)(Rs,{onClick:u,disabled:i||!n.trim(),size:"sm",className:"bg-slate-800 hover:bg-slate-900 text-white",children:i?(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin"}):(0,te.jsx)(wc.A,{className:"h-4 w-4"})})]})})]})}function ku(e){let{agent:s,agentColor:t,appId:a,onClose:r,onSave:n}=e;const{app:l}=vs(),[i,o]=(0,Y.useState)(s.description||""),[c,d]=(0,Y.useState)(s.instructions||""),[m,u]=(0,Y.useState)(s.tool_configs||[]),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)([]),[f,v]=(0,Y.useState)([]),[j,b]=(0,Y.useState)("guidelines");(0,Y.useEffect)((()=>{const e=Object.keys((null==l?void 0:l.entities)||{});g(e);const s=Object.keys((null==l?void 0:l.functions)||{});v(s)}),[l]);const y=e=>{u(m.filter(((s,t)=>t!==e)))},N=(e,s)=>{const t=[...m];t[e]={...t[e],...s},u(t)},w=["create","read","update","delete"],k=e=>"entity_name"in e;return(0,te.jsx)("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50 p-8",children:(0,te.jsxs)("div",{className:"w-full max-w-6xl h-[85vh] bg-white rounded-lg shadow-xl flex overflow-hidden",children:[(0,te.jsxs)("div",{className:"w-64 bg-slate-50 border-r border-slate-200 p-6",children:[(0,te.jsx)("div",{className:"mb-8",children:(0,te.jsxs)("div",{className:"flex items-center gap-3 mb-3",children:[(0,te.jsx)("div",{className:ns("h-10 w-10 rounded-lg flex items-center justify-center",(null==t?void 0:t.light)||"bg-slate-100"),children:(0,te.jsx)(eo.A,{className:ns("h-5 w-5",(null==t?void 0:t.text)||"text-slate-500")})}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:s.name}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"Agent Configuration"})]})]})}),(0,te.jsxs)("nav",{className:"space-y-1",children:[(0,te.jsxs)("button",{onClick:()=>b("guidelines"),className:ns("w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors","guidelines"===j?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-slate-100"),children:[(0,te.jsx)(It.A,{className:"inline-block w-4 h-4 mr-2"}),"Guidelines"]}),(0,te.jsxs)("button",{onClick:()=>b("tools"),className:ns("w-full text-left px-3 py-2 rounded-md text-sm font-medium transition-colors","tools"===j?"bg-white text-slate-900 shadow-sm":"text-slate-600 hover:bg-slate-100"),children:[(0,te.jsx)(vi.A,{className:"inline-block w-4 h-4 mr-2"}),"Tools and Capabilities"]})]})]}),(0,te.jsxs)("div",{className:"flex-1 flex flex-col",children:[(0,te.jsxs)("div",{className:"px-8 py-4 border-b border-slate-200 flex items-center justify-between",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"guidelines"===j?"Guidelines":"Tools and Capabilities"}),(0,te.jsx)(Rs,{variant:"ghost",size:"icon",onClick:r,className:"h-8 w-8",children:(0,te.jsx)(Ds.A,{className:"h-4 w-4"})})]}),(0,te.jsx)("div",{className:"flex-1 overflow-y-auto px-8 py-6",children:"guidelines"===j?(0,te.jsxs)("div",{className:"space-y-6 max-w-4xl",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"description",className:"text-sm font-medium text-slate-700",children:"Description"}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"This is the system prompt that defines the agent's behavior"}),(0,te.jsx)(Ui,{id:"description",value:i,onChange:e=>o(e.target.value),placeholder:"Brief description of what this agent does...",className:"min-h-[120px] resize-none font-mono text-sm"})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"instructions",className:"text-sm font-medium text-slate-700",children:"Instructions"}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"Specific guidelines and rules the agent should follow"}),(0,te.jsx)(Ui,{id:"instructions",value:c,onChange:e=>d(e.target.value),placeholder:"Detailed instructions for the agent...",className:"min-h-[200px] resize-none font-mono text-sm"})]})]}):(0,te.jsx)("div",{className:"space-y-6 max-w-4xl",children:(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"text-sm font-medium text-slate-700",children:"Available Tools"}),(0,te.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Configure what tools and data this agent can access"})]}),(0,te.jsxs)("div",{className:"flex gap-2",children:[p.length>0&&(0,te.jsxs)(Rs,{size:"sm",variant:"outline",onClick:()=>{u([...m,{entity_name:"",allowed_operations:[]}])},className:"text-xs",children:[(0,te.jsx)(Rl.A,{className:"h-3.5 w-3.5 mr-1"}),"Add Entity Tool"]}),f.length>0&&(0,te.jsxs)(Rs,{size:"sm",variant:"outline",onClick:()=>{u([...m,{function_name:"",description:""}])},className:"text-xs",children:[(0,te.jsx)(Ua.A,{className:"h-3.5 w-3.5 mr-1"}),"Add Backend Function"]})]})]}),(0,te.jsx)("div",{className:"space-y-3",children:0===m.length?(0,te.jsxs)("div",{className:"text-center py-12 bg-slate-50 rounded-lg border border-slate-200 border-dashed",children:[(0,te.jsx)(Rl.A,{className:"h-8 w-8 text-slate-400 mx-auto mb-3"}),(0,te.jsx)("p",{className:"text-sm text-slate-500",children:"No tools configured"}),(0,te.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Add entity tools or backend functions to give the agent capabilities"})]}):m.map(((e,s)=>{var t,a;return(0,te.jsx)("div",{className:"border rounded-lg p-4 bg-white border-slate-200",children:k(e)?(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"flex items-start justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Rl.A,{className:"h-4 w-4 text-teal-600"}),(0,te.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Entity Tool"})]}),(0,te.jsx)(Rs,{size:"icon",variant:"ghost",onClick:()=>y(s),className:"h-6 w-6 hover:bg-red-50",children:(0,te.jsx)(Ds.A,{className:"h-3.5 w-3.5 text-slate-400 hover:text-red-500"})})]}),(0,te.jsxs)(ut,{value:e.entity_name||"",onValueChange:e=>N(s,{entity_name:e}),children:[(0,te.jsx)(pt,{className:"w-full",children:(0,te.jsx)(ht,{placeholder:"Select entity"})}),(0,te.jsx)(vt,{children:p.map((e=>(0,te.jsx)(bt,{value:e,children:e},e)))})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{className:"text-xs font-medium text-slate-600",children:"Allowed operations:"}),(0,te.jsx)("div",{className:"flex flex-wrap gap-2",children:w.map((t=>{var a;return(0,te.jsxs)("label",{className:"flex items-center gap-1.5 cursor-pointer px-2 py-1 rounded-md hover:bg-slate-50",children:[(0,te.jsx)(zi,{checked:(null===(a=e.allowed_operations)||void 0===a?void 0:a.includes(t))||!1,onCheckedChange:()=>((e,s)=>{const t=m[e];if(!t.entity_name)return;const a=t.allowed_operations||[],r=a.includes(s)?a.filter((e=>e!==s)):[...a,s];N(e,{allowed_operations:r})})(s,t),className:"h-3.5 w-3.5"}),(0,te.jsx)("span",{className:"text-xs text-slate-600 capitalize",children:t})]},t)}))})]})]}):(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"flex items-start justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Ua.A,{className:"h-4 w-4 text-orange-600"}),(0,te.jsx)("span",{className:"text-sm font-medium text-slate-700",children:"Backend Function"})]}),(0,te.jsx)(Rs,{size:"icon",variant:"ghost",onClick:()=>y(s),className:"h-6 w-6 hover:bg-red-50",children:(0,te.jsx)(Ds.A,{className:"h-3.5 w-3.5 text-slate-400 hover:text-red-500"})})]}),(0,te.jsxs)(ut,{value:e.function_name||"",onValueChange:t=>{var a;const r=null==l||null===(a=l.functions)||void 0===a?void 0:a[t];N(s,{function_name:t,description:(null==r?void 0:r.description)||e.description||""})},children:[(0,te.jsx)(pt,{className:"w-full",children:(0,te.jsx)(ht,{placeholder:"Select backend function"})}),(0,te.jsx)(vt,{children:f.length>0?f.map((e=>(0,te.jsx)(bt,{value:e,children:e},e))):(0,te.jsx)(bt,{value:"",disabled:!0,children:"No backend functions available"})})]}),e.function_name&&(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:`func-desc-${s}`,className:"text-xs font-medium text-slate-600",children:"Function Description"}),(0,te.jsx)(Ui,{id:`func-desc-${s}`,value:e.description||"",onChange:e=>N(s,{description:e.target.value}),placeholder:"Describe when and how this function should be used...",className:"min-h-[60px] resize-none text-xs"}),(null==l||null===(t=l.functions)||void 0===t||null===(a=t[e.function_name])||void 0===a?void 0:a.description)&&(0,te.jsxs)("p",{className:"text-xs text-slate-400 italic mt-1",children:["Default: ",l.functions[e.function_name].description]})]})]})},s)}))})]})})}),(0,te.jsxs)("div",{className:"px-8 py-4 border-t border-slate-200 flex justify-end gap-3 bg-slate-50",children:[(0,te.jsx)(Rs,{variant:"outline",onClick:r,className:"px-6",children:"Cancel"}),(0,te.jsx)(Rs,{onClick:async()=>{h(!0);try{const e=m.filter((e=>e.entity_name||e.function_name)).map((e=>e.entity_name?{entity_name:e.entity_name,allowed_operations:e.allowed_operations||[]}:{function_name:e.function_name,description:e.description||""}));n&&await n({...s,description:i,instructions:c,tool_configs:e}),r()}catch(e){gu.toast.error("Failed to save agent configuration")}finally{h(!1)}},disabled:x,className:"px-6 bg-slate-900 hover:bg-slate-800 text-white",children:x?"Saving...":"Save"})]})]})]})})}const _u=[{bg:"bg-rose-500",text:"text-rose-500",light:"bg-rose-100"},{bg:"bg-blue-500",text:"text-blue-500",light:"bg-blue-100"},{bg:"bg-emerald-500",text:"text-emerald-500",light:"bg-emerald-100"},{bg:"bg-amber-500",text:"text-amber-500",light:"bg-amber-100"},{bg:"bg-purple-500",text:"text-purple-500",light:"bg-purple-100"},{bg:"bg-teal-500",text:"text-teal-500",light:"bg-teal-100"},{bg:"bg-orange-500",text:"text-orange-500",light:"bg-orange-100"},{bg:"bg-indigo-500",text:"text-indigo-500",light:"bg-indigo-100"},{bg:"bg-pink-500",text:"text-pink-500",light:"bg-pink-100"},{bg:"bg-cyan-500",text:"text-cyan-500",light:"bg-cyan-100"},{bg:"bg-lime-500",text:"text-lime-500",light:"bg-lime-100"},{bg:"bg-violet-500",text:"text-violet-500",light:"bg-violet-100"},{bg:"bg-fuchsia-500",text:"text-fuchsia-500",light:"bg-fuchsia-100"},{bg:"bg-sky-500",text:"text-sky-500",light:"bg-sky-100"},{bg:"bg-yellow-500",text:"text-yellow-500",light:"bg-yellow-100"},{bg:"bg-red-500",text:"text-red-500",light:"bg-red-100"},{bg:"bg-green-500",text:"text-green-500",light:"bg-green-100"},{bg:"bg-slate-500",text:"text-slate-500",light:"bg-slate-100"},{bg:"bg-zinc-500",text:"text-zinc-500",light:"bg-zinc-100"},{bg:"bg-stone-500",text:"text-stone-500",light:"bg-stone-100"}];function Su(e){if(!e)return _u[0];let s=0;for(let a=0;a<e.length;a++)s=(s<<5)-s+e.charCodeAt(a),s|=0;const t=Math.abs(s)%_u.length;return _u[t]}function Cu(){const{app:e,runtimeAuthToken:s,writeCodeToFile:t,updateApp:a}=vs(),r=(0,Z.Zp)(),n=(0,Z.zy)(),[l,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)([]),[d,m]=(0,Y.useState)(null),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)("agents"),[g,f]=(0,Y.useState)(!1),[v,j]=(0,Y.useState)(null),b=pu(e.id,s),y=Object.entries(e.agents||{}).map((e=>{let[s,t]=e;return{...t,key:s,name:s}}));(0,Y.useEffect)((()=>{const e=new URLSearchParams(n.search),s=e.get("agent"),t=e.get("conversation"),a=e.get("tab");t?(w(t),p("conversations")):s?(j(s),p("agents")):a&&p(a)}),[n.search]),(0,Y.useEffect)((()=>{N()}),[]);const N=async()=>{x(!0);try{const e=await b.getConversations();c(e||[])}catch(e){gu.toast.error("Failed to load conversations")}finally{x(!1)}},w=async e=>{try{const s=await b.getConversation(e);m(s),p("conversations")}catch(s){gu.toast.error("Failed to load conversation")}},k=e=>{const s=new URLSearchParams(n.search);s.delete("agent"),s.delete("conversation"),s.delete("tab"),Object.entries(e).forEach((e=>{let[t,a]=e;a&&s.set(t,a)}));const t=s.toString(),a=n.pathname+(t?`?${t}`:"");r(a,{replace:!0})},_=async e=>{f(!0);try{const s=await b.createConversation({agent_name:e.name});c((e=>[s,...e])),m(s),p("conversations"),k({conversation:s.id,tab:"conversations"}),gu.toast.success("Conversation started")}catch(s){gu.toast.error("Failed to start conversation")}finally{f(!1)}},S=async e=>{try{const s=await b.getConversation(e.id);m(s),k({conversation:e.id,tab:"conversations"})}catch(s){gu.toast.error("Failed to load conversation")}},C=e=>{i(e.name),k({agent:e.name,tab:"agents"})};(0,Y.useEffect)((()=>{let e=null;if(d)return e=b.subscribeToConversation(d.id,(e=>{m((s=>({...s,messages:e.messages})))})),()=>{e&&e()}}),[null==d?void 0:d.id]);const A=async()=>{try{await a({agents_enabled:!0}),gu.toast.success("AI agents enabled successfully")}catch(e){gu.toast.error("Failed to enable AI agents")}};return e.agents_enabled?d?(0,te.jsx)("div",{className:"h-full p-4 bg-slate-50",children:(0,te.jsx)(wu,{conversation:d,agentColor:Su(d.agent_name),agentsSDK:b,onBack:()=>{m(null),N(),k({tab:"conversations"})}})}):(0,te.jsxs)("div",{className:"h-full bg-slate-50 flex flex-col",children:[(0,te.jsx)("div",{className:"bg-white border-b px-6 py-4",children:(0,te.jsx)("div",{className:"flex items-center justify-between",children:(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)("div",{className:"h-10 w-10 rounded-xl bg-slate-100 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"flex gap-0.5",children:[(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"}),(0,te.jsx)("div",{className:"h-1.5 w-1.5 rounded-full bg-slate-400"})]})}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h1",{className:"text-xl font-semibold text-slate-900",children:"AI Agents"}),(0,te.jsx)("p",{className:"text-sm text-slate-500",children:"Manage agents and conversations"})]})]})})}),(0,te.jsx)("div",{className:"flex-1 overflow-hidden",children:0===y.length?(0,te.jsx)("div",{className:"h-full flex items-center justify-center p-6",children:(0,te.jsx)(Vs,{className:"max-w-md w-full border-dashed",children:(0,te.jsxs)(Js,{className:"flex flex-col items-center justify-center py-8",children:[(0,te.jsx)("div",{className:"h-16 w-16 rounded-2xl bg-gradient-to-br from-teal-100 to-slate-100 flex items-center justify-center mb-4",children:(0,te.jsx)(eo.A,{className:"h-8 w-8 text-teal-600"})}),(0,te.jsx)("h3",{className:"text-base font-semibold text-slate-700 mb-2",children:"No Agents Yet"}),(0,te.jsx)("p",{className:"text-sm text-slate-500 text-center",children:"Prompt the chat to create your first AI agent"})]})})}):(0,te.jsxs)(lr,{value:h,onValueChange:e=>{p(e),k({tab:e})},className:"h-full flex flex-col",children:[(0,te.jsxs)(ir,{className:"mx-6 mt-4 grid w-fit grid-cols-2 bg-slate-100",children:[(0,te.jsx)(or,{value:"agents",className:"text-sm data-[state=active]:bg-white",children:"Agents"}),(0,te.jsxs)(or,{value:"conversations",className:"text-sm data-[state=active]:bg-white",children:["Conversations",o.length>0&&(0,te.jsx)(qs,{variant:"secondary",className:"ml-1.5 px-1.5 py-0 text-xs bg-slate-200 border-0",children:o.length})]})]}),(0,te.jsxs)("div",{className:"flex-1 overflow-auto px-6 pb-6",children:[(0,te.jsx)(cr,{value:"agents",className:"mt-4 h-full",children:g?(0,te.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,te.jsx)(Je.A,{className:"h-6 w-6 animate-spin text-slate-500"})}):(0,te.jsx)("div",{className:"grid grid-cols-1 gap-3 max-w-4xl",children:y.map(((e,s)=>(0,te.jsx)("div",{onClick:()=>(e=>{j(e.name),k({agent:e.name,tab:"agents"})})(e),className:"cursor-pointer",children:(0,te.jsx)(vu,{agent:e,color:Su(e.name),onEdit:C,onStartChat:_,isSelected:v===e.name})},e.key)))})}),(0,te.jsx)(cr,{value:"conversations",className:"mt-4 h-full",children:u?(0,te.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,te.jsx)(Je.A,{className:"h-6 w-6 animate-spin text-slate-400"})}):0===o.length?(0,te.jsx)(Vs,{className:"border-dashed max-w-2xl",children:(0,te.jsxs)(Js,{className:"py-8 text-center",children:[(0,te.jsx)(fu.A,{className:"h-10 w-10 text-slate-300 mx-auto mb-3"}),(0,te.jsx)("p",{className:"text-sm text-slate-500",children:"No conversations yet"}),(0,te.jsx)("p",{className:"text-xs text-slate-400 mt-1",children:"Go to the Agents tab to start a conversation"})]})}):(0,te.jsx)("div",{className:"grid grid-cols-1 gap-2 max-w-2xl",children:o.map((e=>(0,te.jsx)(bu,{conversation:e,agentColor:Su(e.agent_name),onSelect:S,isSelected:(null==d?void 0:d.id)===e.id},e.id)))})})]})]})}),l&&(0,te.jsx)(ku,{agent:e.agents[l],agentColor:Su(l),appId:e.id,onClose:()=>{i(null),k({tab:"agents"})},onSave:async e=>{const s={description:e.description,instructions:e.instructions,tool_configs:e.tool_configs};await t("agents/"+l,JSON.stringify(s,null,2)),i(null),k({agent:l,tab:"agents"})}})]}):(0,te.jsx)("div",{className:"h-full bg-slate-50 flex items-center justify-center p-6",children:(0,te.jsx)(Vs,{className:"max-w-md w-full",children:(0,te.jsxs)(Js,{className:"flex flex-col items-center justify-center py-12",children:[(0,te.jsx)("div",{className:"h-20 w-20 rounded-2xl bg-gradient-to-br from-teal-100 to-slate-100 flex items-center justify-center mb-6",children:(0,te.jsx)(eo.A,{className:"h-10 w-10 text-teal-600"})}),(0,te.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-3",children:"AI Agents Not Enabled"}),(0,te.jsx)("p",{className:"text-sm text-slate-600 text-center mb-6 max-w-sm",children:"Enable AI agents to build intelligent assistants that can help users with various tasks and interact with your app's data."}),(0,te.jsxs)(Rs,{onClick:A,className:"bg-teal-600 hover:bg-teal-700 text-white flex items-center gap-2",children:[(0,te.jsx)(eo.A,{className:"h-4 w-4"}),"Enable AI Agents"]}),(0,te.jsx)("p",{className:"text-xs text-slate-500 mt-4",children:"This will enable AI agents infrastructure for your app"})]})})})}function Au(){const{app:e}=vs(),{workspaceView:s}=(0,Z.g)(),t=(0,Z.Zp)(),[a,r]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{e&&e.id&&l(!0)}),[e]),(0,Y.useEffect)((()=>{const e=()=>{o(window.innerWidth<1024)};return e(),window.addEventListener("resize",e),()=>{window.removeEventListener("resize",e)}}),[]);const c=s||"overview",d="code"===c,m=()=>{if(!n)return(0,te.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"animate-spin h-8 w-8 border-4 border-blue-500 rounded-full border-t-transparent mx-auto mb-4"}),(0,te.jsx)("p",{className:"text-gray-500",children:"Loading app data..."})]})});if(d)return(0,te.jsx)(om,{});let s;if("overview"===c)s=(0,te.jsx)(Ad,{appId:e.id});else if("analytics"===c)s=(0,te.jsx)(Bd,{appId:e.id});else if("domains"===c)s=(0,te.jsx)(Pm,{appId:e.id,appName:e.name});else if("secrets"===c)s=(0,te.jsx)(du,{appId:e.id});else if("security"===c)s=(0,te.jsx)(nu,{appId:e.id});else if(c.startsWith("entity-")){const t=c.split("entity-")[1],a=e.entities[t];s=a?(0,te.jsx)(Nc,{entity:a}):null}else if("users"===c)s=(0,te.jsx)(Sc,{appId:e.id});else if("logo"===c)s=(0,te.jsx)(Ac,{appId:e.id});else if("app-settings"===c)s=(0,te.jsx)(hd,{});else if("api"===c)s=(0,te.jsx)(yd,{appId:e.id});else if("logs"===c)s=(0,te.jsx)(Id,{appId:e.id});else if("authentication"===c)s=(0,te.jsx)(vd,{});else{if("agents"!==c)return(0,te.jsx)("div",{className:"p-6",children:"Unknown view"});s=(0,te.jsx)(Cu,{})}return(0,te.jsx)("div",{className:"h-full w-full overflow-auto",children:s})},u=s=>{t(`/apps/${e.id}/editor/workspace/${s}`)};let x=[{id:"overview",label:"Overview",icon:"\u{1f4cb}"},{id:"users",label:"Users",icon:"\u{1f465}"},{id:"data",label:"Data",icon:"\u{1f5c4}\ufe0f",subitems:e&&e.entities?Object.keys(e.entities).map((e=>({id:`entity-${e}`,label:e,icon:"\u{1f4c4}"}))):[]},{id:"analytics",label:"Analytics",icon:"\u{1f4c8}"},{id:"domains",label:"Domains",icon:"\u{1f310}"},{id:"security",label:"Security",icon:"\u{1f512}"},{id:"code",label:"Code",icon:"\u{1f4bb}"},{id:"agents",label:"Agents (alpha)",icon:"\u{1f916}"},{id:"logs",label:"Logs",icon:"\u{1f50d}"},{id:"api",label:"API",icon:"\u{1f511}"},{id:"settings",label:"Settings",icon:"\u2699\ufe0f",subitems:[{id:"logo",label:"Logo"},{id:"app-settings",label:"App Settings"},{id:"authentication",label:"Authentication"}]}];return e&&e.has_backend_functions_enabled&&x.push({id:"secrets",label:"Secrets",icon:"\u{1f511}"}),d?(0,te.jsx)("div",{className:"h-full w-full relative",children:m()}):i?(0,te.jsxs)("div",{className:"h-full w-full flex flex-col",children:[(0,te.jsxs)("div",{className:"w-full bg-white border-b p-2 flex items-center",children:[(0,te.jsx)("button",{className:"p-2 rounded-md hover:bg-gray-100 transition-colors",onClick:()=>r(!0),children:(0,te.jsx)(Ld.A,{size:20})}),(0,te.jsx)("div",{className:"ml-2 font-medium",children:"App Editor"})]}),(0,te.jsx)(go,{items:x,selected:c,onSelect:e=>{u(e),r(!1)},isOpen:a,onClose:()=>r(!1),title:"App Editor",showSearch:!1}),(0,te.jsx)("div",{className:"flex-1 overflow-auto",children:m()})]}):(0,te.jsx)("div",{className:"h-full w-full relative",children:(0,te.jsxs)(nm,{direction:"horizontal",children:[(0,te.jsx)(lm,{defaultSize:25,minSize:15,maxSize:30,className:"h-full overflow-hidden",children:(0,te.jsx)(go,{items:x,selected:c,onSelect:e=>{u(e),r(!1)},isOpen:a,onClose:()=>r(!1),title:"App Editor",showSearch:!1})}),(0,te.jsx)(im,{withHandle:!0,className:"group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,te.jsx)(lm,{defaultSize:75,className:"flex-1 overflow-auto",children:m()})]})})}var Eu=t(53980),Iu=t(74874),Lu=t(225),Tu=t(14664),$u=t(81103),Du=t(72420),Pu=t(4084),Mu=t(41186);function Ou(e){let{isOpen:s,onClose:t}=e;const{user:a}=ne(),{app:r}=vs(),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)("update"),[m,u]=(0,Y.useState)([]),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(!1),[f,v]=(0,Y.useState)(""),j=(0,Y.useRef)(null),b=(0,Y.useRef)(null),y=(0,Y.useRef)(null),[N,w]=(0,Y.useState)(null),[k,_]=(0,Y.useState)((null==r?void 0:r.github_repo_url)||null),[S,C]=(0,Y.useState)(""),[A,E]=(0,Y.useState)(0),[I,L]=(0,Y.useState)(!1),T=(null==a?void 0:a.subscription_tier)&&!["free","starter"].includes(a.subscription_tier);(0,Y.useEffect)((()=>{"invite"===c&&y.current&&y.current.focus()}),[c]),(0,Y.useEffect)((()=>{if(i.includes("@")||i.includes("."))return v("GitHub usernames cannot contain @ or . characters"),u([]),void g(!1);if(v(""),i.trim().length>=2){j.current&&clearTimeout(j.current);const e=Date.now()-A,s=1e3;if(i.trim()===S)return void g(m.length>0);h(!0);const t=e<s?s-e+500:500;j.current=setTimeout((()=>{$(i),C(i.trim()),E(Date.now())}),t)}else u([]),g(!1);return()=>{j.current&&clearTimeout(j.current)}}),[i,null==r?void 0:r.id,S,A,m.length]);const $=async e=>{try{h(!0);const s=await ms.searchGithubUsers(r.id,e);u(s.users||[]),g(s.users&&s.users.length>0)}catch(s){}finally{h(!1)}};return(0,te.jsx)(na,{open:s,onOpenChange:t,children:(0,te.jsxs)(da,{className:"sm:max-w-[500px]",children:[(0,te.jsxs)(ma,{children:[(0,te.jsxs)(xa,{className:"flex items-center gap-2",children:[(0,te.jsx)(Pu.A,{className:"h-5 w-5"}),"GitHub Integration"]}),(0,te.jsx)(ha,{children:null!=r&&r.github_repo_url?"Manage your GitHub repository and collaborators":"Export your app to GitHub to collaborate with others"})]}),(()=>{if(!N)return null;const e="success"===N.type?"bg-green-50 border-green-200":"error"===N.type?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200",s="success"===N.type?"text-green-700":"error"===N.type?"text-red-700":"text-blue-700",t="success"===N.type?Ed.A:"error"===N.type?Ke.A:null;return(0,te.jsxs)("div",{className:`flex items-center gap-2 p-3 my-3 rounded-md border ${e}`,children:[t&&(0,te.jsx)(t,{className:`h-5 w-5 ${s}`}),(0,te.jsx)("p",{className:`text-sm ${s}`,children:N.text})]})})(),T?k?(0,te.jsxs)("div",{className:"space-y-4 py-2",children:[(0,te.jsxs)("div",{className:"rounded-lg bg-muted p-3 mb-4",children:[(0,te.jsx)("p",{className:"text-sm font-medium mb-1",children:"Repository URL:"}),(0,te.jsx)("a",{href:k,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-blue-500 hover:underline break-all",children:k})]}),I&&(0,te.jsxs)("div",{className:"rounded-lg bg-blue-50 border border-blue-200 p-4 mb-4",children:[(0,te.jsx)("h3",{className:"text-sm font-medium text-blue-800 mb-1",children:"Important Next Step"}),(0,te.jsx)("p",{className:"text-sm text-blue-700",children:"To access this repository directly from your GitHub account, you need to invite yourself as a collaborator."}),(0,te.jsxs)(Rs,{variant:"outline",className:"mt-3 border-blue-300 hover:bg-blue-100 text-blue-800",onClick:()=>{o(a.github_username||""),d("invite")},children:[(0,te.jsx)(Mm.A,{className:"h-4 w-4 mr-2"}),"Invite Yourself as Collaborator",(0,te.jsx)(Ht.A,{className:"h-4 w-4 ml-2"})]})]}),(0,te.jsxs)(lr,{defaultValue:"update",value:c,onValueChange:d,children:[(0,te.jsxs)(ir,{className:"grid w-full grid-cols-2",children:[(0,te.jsx)(or,{value:"update",children:"Update Repository"}),(0,te.jsx)(or,{value:"invite",children:"Invite Collaborator"})]}),(0,te.jsxs)(cr,{value:"update",className:"space-y-4 pt-4",children:[(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Push the latest changes from your app to the GitHub repository."}),(0,te.jsx)(Rs,{onClick:async()=>{try{l(!0),w({type:"loading",text:"Updating GitHub repository..."});const e=await ms.updateGithubRepo(r.id);e&&e.repository_url&&_(e.repository_url),w({type:"success",text:"Successfully updated GitHub repository"})}catch(i){var e,s,t,a,n;if(null!==(e=i.response)&&void 0!==e&&null!==(s=e.data)&&void 0!==s&&null!==(t=s.message)&&void 0!==t&&t.includes("nothing to commit, working tree clean"))w({type:"success",text:"Repository is already up to date. No changes to commit."});else w({type:"error",text:"Failed to update GitHub repository: "+((null===(a=i.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.message)||i.message||"Unknown error")})}finally{l(!1)}},className:"w-full",disabled:n,children:n?"Updating...":"Update Repository"})]}),(0,te.jsxs)(cr,{value:"invite",className:"space-y-4 pt-4",children:[(0,te.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Invite a collaborator to work on your GitHub repository.",!I&&(0,te.jsx)("span",{className:"block mt-1 font-medium text-blue-600",children:"Don't forget to invite yourself to access the repository directly from your GitHub account."})]}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsxs)("div",{className:"flex space-x-2",children:[(0,te.jsxs)("div",{className:"relative flex-1",children:[(0,te.jsx)(Qs,{ref:y,placeholder:"Enter GitHub username",value:i,onChange:e=>o(e.target.value),disabled:n,onFocus:()=>i.trim().length>=2&&!f&&g(!0)}),x&&(0,te.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2",children:(0,te.jsx)(Na.A,{className:"h-4 w-4 animate-pulse text-muted-foreground"})})]}),(0,te.jsx)(Rs,{onClick:async()=>{if(i.trim())try{l(!0),w({type:"loading",text:`Inviting ${i}...`}),await ms.inviteCollaborator(r.id,i),w({type:"success",text:`Successfully invited ${i} as a collaborator`}),o(""),L(!1)}catch(t){var e,s;w({type:"error",text:"Failed to invite collaborator: "+((null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||t.message||"Unknown error")})}finally{l(!1)}else w({type:"error",text:"Please enter a GitHub username"})},disabled:n||!i.trim()||f,children:n?"Inviting...":"Invite"})]}),f&&(0,te.jsx)("div",{className:"mt-2 text-sm text-red-600 bg-red-50 p-2 rounded-md border border-red-200",children:f}),p&&!f&&(0,te.jsx)("div",{ref:b,className:"absolute z-10 mt-1 w-full max-h-48 overflow-auto bg-background border rounded-md shadow-lg",children:0===m.length?(0,te.jsx)("div",{className:"p-2 text-sm text-muted-foreground",children:"No users found"}):(0,te.jsx)("ul",{children:m.map((e=>(0,te.jsxs)("li",{className:"flex items-center gap-2 p-2 hover:bg-accent cursor-pointer",onClick:()=>{return s=e.username,o(s),void g(!1);var s},children:[(0,te.jsx)("img",{src:e.avatar_url,alt:e.username,className:"w-8 h-8 rounded-full"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("div",{className:"text-sm font-medium",children:e.username}),e.name&&(0,te.jsx)("div",{className:"text-xs text-muted-foreground",children:e.name})]})]},e.username)))})})]})]})]})]}):(0,te.jsxs)("div",{className:"space-y-4 py-4",children:[(0,te.jsxs)("div",{className:"rounded-lg bg-muted p-4",children:[(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Export your app to GitHub to enable version control, collaboration, and easier deployment."}),(0,te.jsxs)("p",{className:"text-sm text-muted-foreground mt-2",children:[(0,te.jsx)("strong",{children:"Important:"})," After exporting, you'll need to invite yourself as a collaborator to access the repository directly."]})]}),(0,te.jsx)(Rs,{onClick:async()=>{try{l(!0),w({type:"loading",text:"Exporting to GitHub..."});const e=await ms.exportToGithub(r.id);_(e.repository_url),w({type:"success",text:"Successfully exported to GitHub"}),L(!0),d("invite")}catch(t){var e,s;w({type:"error",text:"Failed to export to GitHub: "+((null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.message)||t.message||"Unknown error")})}finally{l(!1)}},className:"w-full",disabled:n,children:n?"Exporting...":"Export to GitHub"})]}):(0,te.jsx)("div",{className:"space-y-4 py-4",children:(0,te.jsxs)("div",{className:"rounded-lg bg-amber-50 border border-amber-200 p-4",children:[(0,te.jsx)("h3",{className:"text-sm font-medium text-amber-800 mb-1",children:"Upgrade Required"}),(0,te.jsx)("p",{className:"text-sm text-amber-700",children:"GitHub integration is only available on Builder, Pro, Elite and Enterprise plans."}),(0,te.jsx)(J.Link,{to:"/billing",children:(0,te.jsx)(Rs,{variant:"outline",className:"mt-3 border-amber-300 hover:bg-amber-100 text-amber-800",children:"Upgrade Your Plan"})})]})}),(0,te.jsx)(ua,{children:(0,te.jsx)(Rs,{variant:"outline",onClick:t,children:"Close"})})]})})}function Ru(e){let{isOpen:s,onClose:t}=e;const{user:a}=ne(),{app:r}=vs(),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(null),c=(null==a?void 0:a.subscription_tier)&&!["free","starter","starter_yearly"].includes(a.subscription_tier);return(0,te.jsx)(na,{open:s,onOpenChange:t,children:(0,te.jsxs)(da,{className:"sm:max-w-[500px]",children:[(0,te.jsxs)(ma,{children:[(0,te.jsxs)(xa,{className:"flex items-center gap-2",children:[(0,te.jsx)(Mu.A,{className:"h-5 w-5"}),"Export to ZIP"]}),(0,te.jsx)(ha,{children:"Download your app code as a ZIP file"})]}),(()=>{if(!i)return null;const e="success"===i.type?"bg-green-50 border-green-200":"error"===i.type?"bg-red-50 border-red-200":"bg-blue-50 border-blue-200",s="success"===i.type?"text-green-700":"error"===i.type?"text-red-700":"text-blue-700",t="success"===i.type?Ed.A:"error"===i.type?Ke.A:null;return(0,te.jsxs)("div",{className:`flex items-center gap-2 p-3 my-3 rounded-md border ${e}`,children:[t&&(0,te.jsx)(t,{className:`h-5 w-5 ${s}`}),(0,te.jsx)("p",{className:`text-sm ${s}`,children:i.text})]})})(),c?(0,te.jsxs)("div",{className:"space-y-4 py-4",children:[(0,te.jsxs)("div",{className:"rounded-lg bg-muted p-4",children:[(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Export your app to a ZIP file to download the code for local development or deployment."}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground mt-2",children:"This will include all your app's code and the necessary project structure to run it locally."})]}),null!=a&&a.api_key?(0,te.jsx)("a",{href:(()=>{if(null==r||!r.id||null==a||!a.api_key)return null;const e=`/apps/${r.id}/coding/export-to-zip?api_key=${a.api_key}`;return`${(0,bd.Gt)()}${e}`})(),download:`${(null==r?void 0:r.slug)||"app"}.zip`,className:"w-full inline-block",onClick:()=>(o({type:"success",text:"Download started. If it doesn't begin automatically, click the download button again."}),void l(!1)),children:(0,te.jsx)(Rs,{className:"w-full",disabled:n,onClick:()=>{l(!0),o({type:"loading",text:"Initiating download..."}),setTimeout((()=>{l(!1),o({type:"success",text:"Download initiated. Check your downloads folder."})}),1e3)},children:n?"Preparing Download...":"Download ZIP"})}):(0,te.jsx)(Rs,{className:"w-full",disabled:!0,children:"Unable to generate download link"})]}):(0,te.jsx)("div",{className:"space-y-4 py-4",children:(0,te.jsxs)("div",{className:"rounded-lg bg-amber-50 border border-amber-200 p-4",children:[(0,te.jsx)("h3",{className:"text-sm font-medium text-amber-800 mb-1",children:"Upgrade Required"}),(0,te.jsx)("p",{className:"text-sm text-amber-700",children:"ZIP file export is only available on Builder, Pro, Elite and Enterprise plans."}),(0,te.jsx)(J.Link,{to:"/billing",children:(0,te.jsx)(Rs,{variant:"outline",className:"mt-3 border-amber-300 hover:bg-amber-100 text-amber-800",children:"Upgrade Your Plan"})})]})}),(0,te.jsx)(ua,{children:(0,te.jsx)(Rs,{variant:"outline",onClick:t,children:"Close"})})]})})}function Fu(e){let{showFiles:s}=e;const{app:t,currentPage:a}=vs(),[r,n]=(0,Y.useState)(!1),[l,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)(!1);let u=[];if(s&&a){const{name:e,code:s}=a;if(t.layout){u.push("layout");const e=zu(t,t.layout);u=[...u,...e.map((e=>"components/"+e))]}u.push("pages/"+e);const r=zu(t,s);u=[...u,...r.map((e=>"components/"+e))],u=[...new Set(u)]}const x=e=>{n(!1),setTimeout((()=>{i(e),n(!0)}),150)};return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)(gr,{children:[(0,te.jsx)(fr,{asChild:!0,children:(0,te.jsx)("button",{className:"p-1.5 text-gray-500 hover:bg-gray-200 rounded-md transition-colors duration-200 flex items-center justify-center",title:"Github & code editing",children:(0,te.jsx)(Kd.A,{size:20,className:"text-gray-600"})})}),(0,te.jsxs)(kr,{align:"end",className:"w-64 border border-gray-200 shadow-lg rounded-lg animate-in fade-in-80",children:[s&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"px-3 py-1 text-[10px] text-gray-500 bg-gray-50 rounded mx-1",children:"FILES USED IN THIS PAGE"}),(0,te.jsx)("div",{className:"max-h-[250px] overflow-y-auto",children:u.map(((e,s)=>{const t=e.split("/"),a="layout"===e;let r=t[t.length-1],n=t.slice(0,-1).join("/");return a&&(r="layout",n="Application Layout"),(0,te.jsxs)(_r,{className:"cursor-pointer flex flex-col items-start px-3 py-1 text-xs text-gray-600 hover:bg-gray-100 rounded-md mx-1 transition-colors",onClick:()=>x(e),children:[(0,te.jsxs)("span",{className:"font-medium",children:[r,".jsx"]}),n&&(0,te.jsx)("span",{className:"text-gray-400 text-[10px] mt-0.5",children:n})]},s)}))}),(0,te.jsx)(Er,{className:"my-1 bg-gray-200"})]}),(0,te.jsx)(_r,{asChild:!0,children:(0,te.jsxs)(J.Link,{to:`/apps/${t.id}/editor/workspace/code`,className:"cursor-pointer flex items-center px-3 py-2 text-sm hover:bg-gray-100 rounded-md mx-1 my-1 transition-colors",children:[(0,te.jsx)(Du.A,{className:"mr-2 h-4 w-4 text-gray-600"}),"See all files"]})}),(0,te.jsx)(Er,{className:"my-1 bg-gray-200"}),(0,te.jsx)("div",{className:"px-3 py-1 text-[10px] text-gray-500 bg-gray-50 rounded mx-1",children:"BETA FEATURES"}),(0,te.jsxs)(_r,{className:"cursor-pointer flex items-center px-3 py-2 text-sm hover:bg-gray-100 rounded-md mx-1 my-1 transition-colors",onClick:()=>c(!0),children:[(0,te.jsx)(Pu.A,{className:"mr-2 h-4 w-4 text-gray-600"}),"Export project to GitHub"]}),(0,te.jsxs)(_r,{className:"cursor-pointer flex items-center px-3 py-2 text-sm hover:bg-gray-100 rounded-md mx-1 my-1 transition-colors",onClick:()=>m(!0),children:[(0,te.jsx)(Mu.A,{className:"mr-2 h-4 w-4 text-gray-600"}),"Export project as ZIP"]})]})]}),r&&(0,te.jsxs)("div",{className:"fixed inset-0 z-50",children:[(0,te.jsx)("div",{className:"absolute inset-0 bg-black/50",onClick:()=>n(!1)}),(0,te.jsxs)("div",{className:"absolute right-0 h-full w-3/4 bg-white dark:bg-gray-900 shadow-xl flex flex-col",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center p-4 border-b flex-shrink-0",children:[(0,te.jsxs)("h3",{className:"text-lg font-semibold",children:["Code Editor - ",l]}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>n(!1),children:"\u2715"})]}),(0,te.jsx)("div",{className:"flex-1 min-h-0",children:(0,te.jsx)(Yd,{filepath:l,onSaveOrDiscard:()=>x(l)})})]})]}),(0,te.jsx)(Ou,{isOpen:o,onClose:()=>c(!1)}),(0,te.jsx)(Ru,{isOpen:d,onClose:()=>m(!1)})]})}function zu(e,s){if(!e||!s)return[];const t=Object.keys(e.components||{});if(0===t.length)return[];const a=new Set;const r=function s(r){let n=[];const l=r.split("\n");for(const i of l)if(i.includes("/components/")){const r=i.split("/components/")[1];if(r){const l=r.match(/^([a-zA-Z0-9_/-]+)/);if(l&&l[1]){const r=l[1].trim();if(t.includes(r)&&!a.has(r)){n.push(r),a.add(r);const t=s(e.components[r]);n=[...n,...t]}else{const l=r.split("/").pop();if(t.includes(l)&&!a.has(l)){n.push(l),a.add(l);const t=s(e.components[l]);n=[...n,...t]}}}}}return n}(s);return[...new Set(r)]}var Uu=t(58406);const Bu=(0,Y.createContext)();function Wu(){const e=(0,Y.useContext)(Bu);if(void 0===e)throw new Error("useActivity must be used within an ActivityProvider");return e}const qu=function(e){let{children:s}=e;const[t,a]=(0,Y.useState)({}),[r,n]=(0,Y.useState)(0);(0,Y.useEffect)((()=>{const e=e=>{const{type:s,requestId:t,logId:r,data:l}=e.data||{};if("api-request-start"===s)a((e=>({...e,[t]:{id:t,type:"request",url:l.url,method:l.method,headers:l.headers,body:l.body,startTime:new Date,status:"pending"}}))),n((e=>e+1));else if("api-request-end"===s)a((e=>{const s=e[t];return s?{...e,[t]:{...s,status:"completed",statusCode:l.statusCode,response:l.response,endTime:new Date,duration:s.startTime?new Date-s.startTime:0}}:e})),n((e=>Math.max(0,e-1)));else if("console-log"===s){const e=new Date;a((s=>({...s,[r]:{id:r,type:"log",message:l.message,severity:l.severity,component:l.component,timestamp:e}})))}};return window.addEventListener("message",e),()=>{window.removeEventListener("message",e)}}),[]);const l=Object.values(t);return(0,te.jsx)(Bu.Provider,{value:{allActivities:l,activeRequests:r,clearActivities:()=>a({})},children:s})},Vu=Wu;var Yu=t(52245);function Hu(e){let{onClose:s}=e;const{allActivities:t,clearActivities:a}=Wu(),[r,n]=(0,Y.useState)("all"),[l,i]=(0,Y.useState)("all"),[o,c]=(0,Y.useState)(""),[d,m]=(0,Y.useState)(!1),u=(0,Y.useRef)(null),x=(0,Y.useRef)(null),h=[{value:"all",label:"All",count:t.length},{value:"requests",label:"Requests",count:t.filter((e=>"request"===e.type)).length},{value:"logs",label:"Logs",count:t.filter((e=>"log"===e.type)).length}].filter((e=>e.count>0)),p=t.filter((e=>{if(!((e,s)=>{if(!s.trim())return!0;const t=s.toLowerCase();if("log"===e.type){var a,r;const s=(null===(a=e.message)||void 0===a?void 0:a.toString().toLowerCase())||"",n=(null===(r=e.component)||void 0===r?void 0:r.toLowerCase())||"";return s.includes(t)||n.includes(t)}if("request"===e.type){var n;const s=(null===(n=e.url)||void 0===n?void 0:n.toLowerCase())||"",a="string"==typeof e.body?e.body.toLowerCase():JSON.stringify(e.body||{}).toLowerCase(),r="string"==typeof e.response?e.response.toLowerCase():JSON.stringify(e.response||{}).toLowerCase();return s.includes(t)||a.includes(t)||r.includes(t)}return!1})(e,o))return!1;if("all"===r);else if("requests"===r){if("request"!==e.type)return!1}else{if("logs"!==r)return!1;if("log"!==e.type)return!1}if("requests"===r&&"all"!==l){const s=parseInt(l);return"request"===e.type&&"completed"===e.status&&e.statusCode===s}return!0})),g=[...p].sort(((e,s)=>{const t="request"===e.type?e.startTime:e.timestamp,a="request"===s.type?s.startTime:s.timestamp;return new Date(t)-new Date(a)})),f=(()=>{if("requests"!==r)return[];const e=new Set;t.forEach((s=>{"request"===s.type&&"completed"===s.status&&s.statusCode&&e.add(s.statusCode)}));const s=[{value:"all",label:"All",count:t.filter((e=>"request"===e.type)).length}];return Array.from(e).sort(((e,s)=>e-s)).forEach((e=>{const a=t.filter((s=>"request"===s.type&&"completed"===s.status&&s.statusCode===e)).length;s.push({value:e.toString(),label:`${e}`,count:a,statusCode:e})})),s.filter((e=>e.count>0))})(),v=e=>e>=200&&e<300?"bg-emerald-50 text-emerald-700 border-emerald-200":e>=300&&e<400?"bg-blue-50 text-blue-700 border-blue-200":e>=400&&e<500?"bg-amber-50 text-amber-700 border-amber-200":e>=500?"bg-rose-50 text-rose-700 border-rose-200":"bg-slate-50 text-slate-700 border-slate-200",j=e=>e>=200&&e<300?(0,te.jsx)(Ed.A,{className:"h-3 w-3"}):e>=300&&e<400?(0,te.jsx)(rl.A,{className:"h-3 w-3"}):e>=400&&e<500?(0,te.jsx)(Zc.A,{className:"h-3 w-3"}):e>=500?(0,te.jsx)(Fd.A,{className:"h-3 w-3"}):(0,te.jsx)(rl.A,{className:"h-3 w-3"}),b=()=>{m(!0),setTimeout((()=>{u.current&&u.current.focus()}),100)};(0,Y.useEffect)((()=>{if(d&&u.current){const e=setTimeout((()=>{u.current&&document.activeElement!==u.current&&u.current.focus()}),50);return()=>clearTimeout(e)}}),[r,d]);const y=()=>{m(!1),c("")};(0,Y.useEffect)((()=>{const e=e=>{if(d&&x.current&&!x.current.contains(e.target)){const s=e.target.closest('[role="combobox"]')||e.target.closest("[data-radix-collection-item]")||e.target.closest("button");o.trim()||s||m(!1)}};return d&&document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}}),[d,o]);const N=t.filter((e=>"request"===e.type)).length,w=t.filter((e=>"log"===e.type)).length;return(0,te.jsxs)("div",{className:"flex flex-col h-full bg-white shadow-lg rounded-lg relative",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center py-3 px-4 border-b",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("h2",{className:"font-semibold",children:"Activity Monitor"}),(0,te.jsx)("div",{className:"text-xs text-muted-foreground",children:t.length>0&&(0,te.jsxs)(qs,{variant:"outline",className:"font-normal bg-slate-50",children:[t.length," entries"]})})]}),(0,te.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,te.jsxs)(ut,{value:r,onValueChange:e=>{n(e),"requests"!==e&&i("all")},children:[(0,te.jsxs)(pt,{className:"h-8 w-auto min-w-[90px] bg-white border-slate-200",children:[(0,te.jsx)(Yu.A,{className:"h-3.5 w-3.5 mr-1.5 text-slate-500"}),(0,te.jsx)(ht,{})]}),(0,te.jsx)(vt,{className:"bg-white border-slate-200",children:h.map((e=>(0,te.jsx)(bt,{value:e.value,className:"hover:bg-slate-50",children:(0,te.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,te.jsx)("span",{children:e.label}),(0,te.jsx)("span",{className:"text-xs text-slate-400 ml-2",children:e.count})]})},e.value)))})]}),"requests"===r&&f.length>1&&(0,te.jsxs)(ut,{value:l,onValueChange:i,children:[(0,te.jsx)(pt,{className:"h-8 w-auto min-w-[70px] bg-white border-slate-200",children:(0,te.jsx)(ht,{})}),(0,te.jsx)(vt,{className:"bg-white border-slate-200",children:f.map((e=>(0,te.jsx)(bt,{value:e.value,className:"hover:bg-slate-50",children:(0,te.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,te.jsx)("span",{className:"flex items-center gap-1",children:e.statusCode?(0,te.jsxs)(te.Fragment,{children:[j(e.statusCode),(0,te.jsx)(qs,{variant:"outline",className:ns("text-xs px-1 py-0.5",v(e.statusCode)),children:e.label})]}):e.label}),(0,te.jsx)("span",{className:"text-xs text-slate-400 ml-1.5",children:e.count})]})},e.value)))})]}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>{a(),c(""),n("all"),i("all"),m(!1)},className:"h-8",children:(0,te.jsx)(Tc.A,{className:"h-3.5 w-3.5"})}),s&&(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:s,className:"h-8 w-8 p-0",children:(0,te.jsx)(Ds.A,{className:"h-4 w-4"})})]})]}),(d||o.trim())&&(0,te.jsx)("div",{ref:x,className:"border-b border-slate-200 px-4 py-2",children:d?(0,te.jsxs)("div",{className:"relative animate-in slide-in-from-top-2 duration-200",children:[(0,te.jsx)(Na.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-3.5 w-3.5 text-slate-400"}),(0,te.jsx)(Qs,{ref:u,type:"text",placeholder:(()=>{switch(r){case"logs":return"Search logs...";case"requests":return"Search requests...";default:return"Search logs and requests..."}})(),value:o,onChange:e=>c(e.target.value),onKeyDown:e=>{"Escape"===e.key&&y()},className:"h-10 w-full pl-10 pr-10 text-sm bg-white border-slate-200 placeholder:text-slate-400 focus:ring-2 focus:ring-orange-100 focus:border-orange-300"},"network-search-input"),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:y,className:"absolute right-2 top-1/2 transform -translate-y-1/2 h-6 w-6 p-0 hover:bg-slate-100",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]}):(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:b,className:"h-8 w-full justify-start gap-2 bg-orange-50 border-orange-200 text-orange-700",children:[(0,te.jsx)(Na.A,{className:"h-3.5 w-3.5"}),(0,te.jsxs)("span",{className:"text-sm",children:['Search: "',o.length>30?o.substring(0,30)+"...":o,'"']})]})}),t.length>0&&(0,te.jsxs)("div",{className:"flex justify-between items-center text-xs border-b px-4 py-1 bg-slate-50",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[!d&&!o.trim()&&(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:b,className:"h-4 w-4 p-0 text-slate-400 hover:text-slate-500 hover:bg-transparent",children:(0,te.jsx)(Na.A,{className:"h-3 w-3"})}),(0,te.jsxs)("span",{children:[N," requests"]}),(0,te.jsxs)("span",{children:[w," logs"]})]}),(o.trim()||"all"!==r||"all"!==l)&&(0,te.jsxs)("div",{className:"text-slate-500",children:["Showing ",p.length," of ",t.length]})]}),0===t.length&&!d&&!o.trim()&&(0,te.jsx)("div",{className:"px-4 py-1 border-b border-slate-200",children:(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:b,className:"h-4 w-4 p-0 text-slate-400 hover:text-slate-500 hover:bg-transparent",children:(0,te.jsx)(Na.A,{className:"h-3 w-3"})})}),(0,te.jsx)(Wi,{className:"flex-grow",children:0===g.length?(0,te.jsxs)("div",{className:"flex flex-col items-center justify-center h-full text-muted-foreground p-8",children:[(0,te.jsx)("p",{className:"text-sm",children:0===t.length?"No activities logged":o.trim()?`No ${"all"===r?"activities":r} found matching "${o}"`:"No matching activities found"}),o.trim()&&(0,te.jsx)("p",{className:"text-xs mt-2 text-slate-400",children:"Try a different search term or clear filters"})]}):(0,te.jsx)("div",{className:"p-2 space-y-1",children:[...g].reverse().map((e=>"request"===e.type?(0,te.jsx)(Ju,{request:e},e.id):(0,te.jsx)(Gu,{log:e},e.id)))})})]})}function Gu(e){var s,t,a;let{log:r}=e;const{icon:n,className:l}=(e=>{switch(e){case"error":return{icon:(0,te.jsx)(Fd.A,{className:"h-3.5 w-3.5"}),className:"bg-rose-50 text-rose-700"};case"warn":return{icon:(0,te.jsx)(Zc.A,{className:"h-3.5 w-3.5"}),className:"bg-amber-50 text-amber-700"};default:return{icon:(0,te.jsx)(rl.A,{className:"h-3.5 w-3.5"}),className:"bg-slate-50 text-slate-700"}}})(r.severity),i=e=>e?Bt()(e).fromNow():"";return(0,te.jsxs)(oo,{className:"border rounded overflow-hidden hover:shadow-sm transition-all duration-200",children:[(0,te.jsxs)(co,{className:"flex w-full p-2 hover:bg-accent/5 text-left",children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-16 flex justify-center",children:(0,te.jsxs)(qs,{variant:"outline",className:"bg-purple-50 text-purple-700 font-mono text-xs uppercase",children:[(0,te.jsx)(Kd.A,{className:"h-3 w-3 mr-1"})," Log"]})}),(0,te.jsxs)("div",{className:"flex-grow mx-3",children:[r.component&&(0,te.jsx)("div",{className:"text-xs text-muted-foreground mb-0.5 font-medium",children:r.component}),(0,te.jsxs)("div",{className:"text-sm font-normal truncate",children:[null===(s=r.message)||void 0===s?void 0:s.toString().substring(0,60),(null===(t=r.message)||void 0===t?void 0:t.toString().length)>60?"...":""]})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,te.jsx)("div",{className:"text-xs text-muted-foreground text-right",children:i(r.timestamp)}),(0,te.jsx)(qs,{variant:"outline",className:ns("flex items-center",l),children:n}),(0,te.jsx)(ct.A,{className:"h-3.5 w-3.5 text-muted-foreground"})]})]}),(0,te.jsx)(mo,{children:(0,te.jsx)("div",{className:"p-4 border-t bg-slate-50/50",children:(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Message"}),(0,te.jsx)("pre",{className:"p-3 rounded bg-white text-xs overflow-auto max-h-60 border whitespace-pre-wrap",children:null===(a=r.message)||void 0===a?void 0:a.toString()})]}),(0,te.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Severity"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:r.severity})]}),r.component&&(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Component"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:r.component})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Time"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:i(r.timestamp)})]})]})]})})})]})}function Ju(e){var s;let{request:t}=e;const{app:a}=vs(),r=e=>e?Bt()(e).fromNow():"";return(0,te.jsxs)(oo,{className:"border rounded overflow-hidden hover:shadow-sm transition-all duration-200",children:[(0,te.jsxs)(co,{className:"flex w-full p-2 hover:bg-accent/5 text-left",children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-16 flex justify-center",children:(0,te.jsx)(qs,{variant:"outline",className:ns("font-mono text-xs",(e=>{switch(e){case"GET":return"bg-blue-50 text-blue-700";case"POST":return"bg-green-50 text-green-700";case"PUT":return"bg-amber-50 text-amber-700";case"DELETE":return"bg-rose-50 text-rose-700";default:return"bg-slate-100 text-slate-700"}})(t.method)),children:null===(s=t.method)||void 0===s?void 0:s.toLowerCase()})}),(0,te.jsx)("div",{className:"flex-grow mx-3",children:(0,te.jsx)("div",{className:"text-sm font-normal truncate",children:(e=>{let s=e;return e.startsWith("http")&&(s=new URL(e).pathname),s.startsWith("/api/apps/"+(null==a?void 0:a.id))&&(s=s.replace("/api/apps/"+a.id,"")),null!=a&&a.id&&s.includes(a.id)&&(s=s.replace(a.id,"{app_id}")),s})(t.url)})}),(0,te.jsxs)("div",{className:"flex items-center gap-2 shrink-0",children:[(0,te.jsx)("div",{className:"text-xs text-muted-foreground text-right",children:r(t.startTime)}),(0,te.jsxs)(qs,{variant:"outline",className:ns("flex items-center",(n=t.status,l=t.statusCode,"pending"===n?"bg-slate-100 text-slate-700":l>=200&&l<300?"bg-emerald-50 text-emerald-700":"bg-rose-50 text-rose-700")),children:[((e,s)=>"pending"===e?(0,te.jsx)(Je.A,{className:"h-3.5 w-3.5 animate-spin"}):s>=200&&s<300?(0,te.jsx)(Ed.A,{className:"h-3.5 w-3.5"}):(0,te.jsx)(Ke.A,{className:"h-3.5 w-3.5"}))(t.status,t.statusCode),"completed"===t.status&&t.statusCode]}),(0,te.jsx)(ct.A,{className:"h-3.5 w-3.5 text-muted-foreground"})]})]}),(0,te.jsx)(mo,{children:(0,te.jsx)("div",{className:"p-4 border-t bg-slate-50/50",children:(0,te.jsxs)(lr,{defaultValue:"general",children:[(0,te.jsxs)(ir,{className:"mb-3",children:[(0,te.jsx)(or,{value:"general",children:"General"}),(0,te.jsx)(or,{value:"request",children:"Request"}),"completed"===t.status&&(0,te.jsx)(or,{value:"response",children:"Response"})]}),(0,te.jsxs)(cr,{value:"general",className:"space-y-3",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"URL"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground break-all",children:t.url})]}),(0,te.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Method"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:t.method})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Status"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"completed"===t.status?`${t.statusCode} (${t.duration}ms)`:(0,te.jsxs)("span",{className:"flex items-center",children:[(0,te.jsx)(Je.A,{className:"h-3 w-3 mr-1 animate-spin"}),"Pending"]})})]})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Time"}),(0,te.jsxs)("p",{className:"text-sm text-muted-foreground",children:["Started: ",r(t.startTime),t.endTime&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("br",{}),"Completed: ",r(t.endTime)]})]})]})]}),(0,te.jsx)(cr,{value:"request",children:t.body?(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Request Data"}),(0,te.jsx)("pre",{className:"p-3 rounded bg-white text-xs overflow-auto max-h-60 border",children:"object"==typeof t.body?JSON.stringify(t.body,null,2):t.body})]}):(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"No request data"})}),"completed"===t.status&&(0,te.jsx)(cr,{value:"response",children:t.response?(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Response Data"}),(0,te.jsx)("pre",{className:"p-3 rounded bg-white text-xs overflow-auto max-h-60 border",children:"object"==typeof t.response?JSON.stringify(t.response,null,2):t.response})]}):(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"No response data"})})]})})})]});var n,l}function Zu(){const{activeRequests:e}=Vu(),[s,t]=(0,Y.useState)(!1);return(0,te.jsxs)(dc,{open:s,onOpenChange:t,children:[(0,te.jsx)(mc,{asChild:!0,children:(0,te.jsxs)("button",{className:"relative flex items-center justify-center p-1.5 text-gray-500 hover:bg-gray-200 rounded-md transition-colors","aria-label":"Network Activity",children:[(0,te.jsx)(Uu.A,{className:ns("h-5 w-5",e>0?"text-primary animate-pulse":"text-muted-foreground")}),e>0&&(0,te.jsx)("span",{className:"absolute -top-1 -right-1 flex items-center justify-center w-5 h-5 text-[10px] font-medium bg-primary/15 text-primary  rounded-full animate-[pulse_1.5s_ease-in-out_infinite]",children:e})]})}),(0,te.jsx)(gc,{side:"right",className:"min-w-[600px]",children:(0,te.jsx)(Hu,{onClose:()=>t(!1)})})]})}var Ku=t(99040);const Xu={title:"Your app data is publicly accessible",alert:{message:"This app is missing access rules.",learnMoreText:"Learn more",learnMoreUrl:"https://docs.base44.com/Guides/Using-security-check"},content:{beforePublishing:"Before publishing, keep in mind:",listItem:"Your app's data is open to everyone and not secure.",recommendation:"To keep your app data private run a security scan and apply the suggested access rules."},buttons:{publish:"Publish",runScan:"Run Security Scan"}},Qu=na,ex=da,sx=ma,tx=xa,ax=Rs;function rx(e){let{open:s,onOpenChange:t,app:a,onPublishAnyway:r,onCancel:n}=e;const l=(0,Z.Zp)();return(0,te.jsx)(Qu,{open:s,onOpenChange:t,children:(0,te.jsxs)(ex,{className:"max-w-[350px] rounded-lg sm:max-w-[634px] p-6 gap-6 [&>button]:top-[26px] [&>button]:right-6 [&>button>svg]:h-6 [&>button>svg]:w-6 text-base44",children:[(0,te.jsx)(sx,{className:"text-left",children:(0,te.jsx)(tx,{className:"text-xl font-semibold text-gray-800 tracking-normal text-base44",children:Xu.title})}),(0,te.jsxs)("div",{className:"py-0",children:[(0,te.jsx)("div",{className:"bg-amber-100 border border-amber-300 rounded-lg p-3 mb-4",children:(0,te.jsxs)("div",{className:"flex items-start",children:[(0,te.jsx)(Zc.A,{className:"h-4 w-4 text-gray-800 mr-2 my-1 flex-shrink-0 text-base44"}),(0,te.jsx)("div",{className:"text-left",children:(0,te.jsxs)("p",{className:"font-regular text-gray-800 text-base44",children:[Xu.alert.message," ",(0,te.jsx)("a",{href:Xu.alert.learnMoreUrl,target:"_blank",rel:"noopener noreferrer",className:"text-gray-800 underline hover:text-gray-600 text-base44",children:Xu.alert.learnMoreText})]})})]})}),(0,te.jsxs)("div",{className:"text-left",children:[(0,te.jsx)("p",{className:"text-regular text-gray-700 mb-1 text-base44",children:Xu.content.beforePublishing}),(0,te.jsx)("ul",{className:"list-disc list-outside text-regular text-gray-700 mb-1 ml-6 text-base44",children:(0,te.jsx)("li",{children:Xu.content.listItem})}),(0,te.jsx)("p",{className:"text-regular font-medium text-gray-800 pt-4 text-base44",children:Xu.content.recommendation})]})]}),(0,te.jsxs)("div",{className:"flex justify-end space-x-3 pt-4 text-base44",children:[(0,te.jsx)(ax,{onClick:()=>{t(!1),r&&r()},variant:"outline",className:"text-base44",children:Xu.buttons.publish}),(0,te.jsx)(ax,{onClick:()=>{t(!1),l(`/apps/${a.id}/editor/workspace/security?autoStartScan=1`)},variant:"default",className:"text-base44 text-white",children:Xu.buttons.runScan})]})]})})}const nx=Ns.Kq,lx=Ns.bL,ix=Ns.l9,ox=Y.forwardRef(((e,s)=>{let{className:t,sideOffset:a=4,...r}=e;return(0,te.jsx)(Ns.UC,{ref:s,sideOffset:a,className:ns("z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]",t),...r})}));ox.displayName=Ns.UC.displayName;const cx={COPY_LINK:"Copy link",COPIED:"Copied"},dx={TITLE:"Available Domains",MANAGE_BUTTON:"Manage"},mx={NO_CUSTOM_DOMAINS:"No custom domains configured",MORE_DOMAINS:"more domains"},ux=e=>{let{url:s,displayUrl:t,copiedUrl:a,onCopy:r}=e;const[n,l]=(0,Y.useState)(!1),i=(0,Y.useRef)(null),o=a===s;(0,Y.useEffect)((()=>()=>{i.current&&clearTimeout(i.current)}),[]),(0,Y.useEffect)((()=>{o?(l(!0),i.current&&clearTimeout(i.current),i.current=setTimeout((()=>{l(!1)}),2e3)):l(!1)}),[o]);return(0,te.jsxs)("div",{className:"group flex items-center justify-between text-sm bg-slate-100 hover:bg-transparent rounded-md",onMouseOut:()=>{l(!1)},children:[(0,te.jsxs)("div",{className:"flex items-center flex-1 overflow-hidden group-hover:bg-slate-200 group-hover:rounded-md py-2 pl-3",children:[(0,te.jsx)(Tt.A,{className:"h-4 w-4 mr-2 flex-shrink-0 text-gray-400","data-testid":"globe-icon"}),(0,te.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline truncate",children:t})]}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(nx,{delayDuration:500,children:(0,te.jsxs)(lx,{children:[(0,te.jsx)(ix,{asChild:!0,children:(0,te.jsx)("button",{onClick:e=>{r(s)},className:"ml-2 p-1 text-gray-500 hover:text-gray-700 rounded-md transition-colors opacity-0 group-hover:opacity-100",children:o?(0,te.jsx)(mt.A,{className:"h-4 w-4","data-testid":"check-icon"}):(0,te.jsx)(Ha.A,{className:"h-4 w-4","data-testid":"copy-icon"})})}),(0,te.jsx)(ox,{side:"top",sideOffset:4,children:(0,te.jsx)("p",{children:cx.COPY_LINK})})]})}),n&&(0,te.jsx)(nx,{children:(0,te.jsxs)(lx,{open:!0,children:[(0,te.jsx)(ix,{asChild:!0,children:(0,te.jsx)("div",{className:"absolute inset-0 pointer-events-none"})}),(0,te.jsx)(ox,{side:"top",sideOffset:4,children:(0,te.jsx)("p",{children:cx.COPIED})})]})})]})]})},xx=e=>{let{publishLink:s,domains:t,appId:a,onManageDomainsClick:r}=e;const n=(0,Z.Zp)(),[l,i]=(0,Y.useState)("");(0,Y.useEffect)((()=>{if(l){const e=setTimeout((()=>{i("")}),2e3);return()=>clearTimeout(e)}}),[l]);const o=e=>{navigator.clipboard.writeText(e).then((()=>{i(e)})).catch((e=>{}))},c=(0,Y.useCallback)((()=>{null==r||r(),n(`/apps/${a}/editor/workspace/domains`)}),[r,n,a]);return(0,te.jsxs)("div",{className:"py-4",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,te.jsx)("h4",{className:"font-medium text-sm leading-5 text-gray-700",children:dx.TITLE}),(0,te.jsx)(sl,{variant:"ghost",size:"sm",className:"h-5 px-0 py-0 texwt-xs text-black hover:bg-transparent hover:text-gray-600",onClick:c,children:dx.MANAGE_BUTTON})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)(ux,{url:s,displayUrl:s.replace(/(https?:\/\/)/,""),copiedUrl:l,onCopy:o},s),t&&t.length>0?t.slice(0,4).map((e=>(0,te.jsx)(ux,{url:`https://${e.domain}`,displayUrl:e.domain,copiedUrl:l,onCopy:o},e.domain))):(0,te.jsx)("p",{className:"text-sm text-gray-500",children:mx.NO_CUSTOM_DOMAINS}),t&&t.length>4&&(0,te.jsxs)("p",{className:"text-xs text-gray-500 pl-1",children:["+",t.length-4," ",mx.MORE_DOMAINS]})]})]})};const hx=e=>{let{value:s,showWorkspace:t=!0,onNavigation:a}=e;const r=(0,Z.Zp)(),{app:n}=vs(),l=function(e){switch(e){case"private_with_login":default:return"Private access (login required)";case"workspace_with_login":return"Workspace access (login required)";case"public_with_login":return"Public access (login required)";case"public_without_login":return"Public access (no login required)"}}(s),i=function(e){switch(e){case"private_with_login":default:return Ls.A;case"workspace_with_login":return Wa.A;case"public_with_login":case"public_without_login":return Tt.A}}(s);return(0,te.jsx)("div",{className:"pt-4 pb-1 border-t border-slate-200",children:(0,te.jsxs)("button",{onClick:()=>{null!=n&&n.id&&(null==a||a(),r(`/apps/${n.id}/editor/workspace/overview`))},className:"group w-full flex items-center gap-3 text-left text-sm text-slate-600 hover:text-slate-900 transition-colors",children:[(0,te.jsx)("div",{className:"flex-shrink-0 bg-gray-100 rounded-md p-[5px]",children:(0,te.jsx)(i,{size:16})}),(0,te.jsxs)("div",{className:"flex-1 flex items-center gap-1",children:[(0,te.jsx)("span",{children:l}),(0,te.jsx)(Ol.A,{size:14,className:"opacity-0 group-hover:opacity-100 transition-opacity"})]})]})})};function px(e){let{isMobile:s=!1,app:t,updateApp:a}=e;const{isInSharedWorkspace:r}=Xc(),{user:n}=ne(),[l,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)(null),[u,x]=(0,Y.useState)([]),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(""),[v,j]=(0,Y.useState)(!1),b=null!=t&&t.slug?Zt(t):"",y=Sd(t);(0,Y.useEffect)((()=>{(l||h)&&null!=t&&t.id&&(async()=>{try{const e=await ja.filter({app_id:t.id});x(e)}catch(e){}})()}),[l,h,null==t?void 0:t.id]),(0,Y.useEffect)((()=>{if(g){const e=setTimeout((()=>{f("")}),2e3);return()=>clearTimeout(e)}}),[g]);const N=e=>{let{url:s,displayUrl:t}=e;const a=g===s;return(0,te.jsxs)("div",{className:"flex items-center justify-between text-sm","data-testid":"domain-item",children:[(0,te.jsxs)("div",{className:"flex items-center flex-1 overflow-hidden",children:[(0,te.jsx)(Tt.A,{className:"h-4 w-4 mr-2 flex-shrink-0 text-gray-500"}),(0,te.jsx)("a",{href:s,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline truncate",children:t})]}),(0,te.jsx)("button",{onClick:()=>(e=>{navigator.clipboard.writeText(e).then((()=>{f(e)})).catch((e=>{}))})(s),className:"ml-2 p-1 text-gray-500 hover:bg-gray-100 rounded-md transition-colors",title:"Copy to clipboard",children:a?(0,te.jsx)(mt.A,{className:"h-4 w-4 text-green-500"}):(0,te.jsx)(Ha.A,{className:"h-4 w-4"})})]})},w=(e,s)=>{try{var a;Fe({user_id:(null==n?void 0:n.id)||null,app_id:(null==t?void 0:t.id)||null,conversation_id:(null==t||null===(a=t.conversation)||void 0===a?void 0:a.id)||null},{cta:"publish",origin:e,target_route:s}),Se("User Clicked Publish Button",{user_id:(null==n?void 0:n.id)||null,app_id:t.id,origin:e,target_route:s})}catch(r){}},k=async()=>{if(null!=t&&t.id){if(y)return w("publish_modal","security_warning"),i(!1),p(!1),void j(!0);w("publish_modal","publish"),await _()}},_=async()=>{try{c(!0),m(null),await pe.deployApp(t.id),Se("App Published",{app_id:t.id,app_name:t.name,has_custom_domains:u.length>0});const e=u.length>0?`https://${u[0].domain}`:b;window.open(e,"_blank")}catch(e){m(e.message||"Failed to deploy app")}finally{c(!1),s&&p(!1)}},S=()=>{w("security_warning","publish"),_()};return s?"icon"===s?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Rs,{variant:"ghost",size:"icon",className:"h-8 w-8",onClick:()=>p(!0),disabled:o,children:(0,te.jsx)(Ku.A,{className:"h-5 w-5"})}),(0,te.jsx)(na,{open:h,onOpenChange:p,children:(0,te.jsxs)(da,{className:"sm:max-w-md",children:[(0,te.jsx)(ma,{children:(0,te.jsx)(xa,{children:"Publish Your App"})}),null!=t&&t.last_deployed_at?(0,te.jsxs)("div",{className:"py-3 text-sm text-gray-600",children:[(0,te.jsx)("p",{className:"mb-2",children:"Publishing will make your current version available at the public link."}),(0,te.jsxs)("p",{className:"mb-2",children:["Last published: ",Bt().utc(null==t?void 0:t.last_deployed_at).fromNow()]})]}):(0,te.jsxs)("div",{className:"py-3 text-sm text-gray-600",children:[(0,te.jsx)("p",{className:"mb-2",children:"This will be the first public version of your app."}),(0,te.jsx)("p",{children:"Publishing will make your app accessible to users at the public link."})]}),d&&(0,te.jsx)("div",{className:"py-2 text-sm text-red-600 bg-red-50 border-t border-b border-red-100",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4 mr-2"}),(0,te.jsx)("p",{children:d})]})}),(0,te.jsxs)("div",{className:"py-3",children:[(0,te.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Available Domains"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(N,{url:b,displayUrl:b.replace(/(https?:\/\/)/,"")}),u.length>0?u.map(((e,s)=>(0,te.jsx)("div",{className:"px-1",children:(0,te.jsx)(N,{url:`https://${e.domain}`,displayUrl:e.domain})},s))):(0,te.jsx)("p",{className:"text-sm text-gray-500",children:"No custom domains configured"})]})]}),(0,te.jsx)(ua,{children:(0,te.jsx)(Rs,{className:"w-full bg-gray-900 text-white hover:bg-gray-800",onClick:k,disabled:o,children:o?(0,te.jsxs)("span",{className:"flex items-center justify-center",children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Publishing..."]}):"Publish App"})})]})}),(0,te.jsx)(rx,{open:v,onOpenChange:j,app:t,onPublishAnyway:S})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(_r,{asChild:!0,onClick:e=>{e.preventDefault(),p(!0)},disabled:o,children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Ku.A,{className:"mr-2 h-4 w-4"}),"Publish"]})}),(0,te.jsx)(na,{open:h,onOpenChange:p,children:(0,te.jsxs)(da,{className:"sm:max-w-md",children:[(0,te.jsx)(ma,{children:(0,te.jsx)(xa,{children:"Publish Your App"})}),t.last_deployed_at?(0,te.jsxs)("div",{className:"py-3 text-sm text-gray-600",children:[(0,te.jsx)("p",{className:"mb-2",children:"Publishing will make your current version available at the public link."}),(0,te.jsxs)("p",{className:"mb-2",children:["Last published: ",Bt().utc(null==t?void 0:t.last_deployed_at).fromNow()]})]}):(0,te.jsxs)("div",{className:"py-3 text-sm text-gray-600",children:[(0,te.jsx)("p",{className:"mb-2",children:"This will be the first public version of your app. "}),(0,te.jsx)("p",{children:"Publishing will make your app accessible to users at the public link."})]}),d&&(0,te.jsx)("div",{className:"py-2 text-sm text-red-600 bg-red-50 border-t border-b border-red-100",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4 mr-2"}),(0,te.jsx)("p",{children:d})]})}),(0,te.jsxs)("div",{className:"py-3",children:[(0,te.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Available Domains"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(N,{url:b,displayUrl:b.replace(/(https?:\/\/)/,"")}),u.length>0?u.map(((e,s)=>(0,te.jsx)("div",{className:"px-1",children:(0,te.jsx)(N,{url:`https://${e.domain}`,displayUrl:e.domain})},s))):(0,te.jsx)("p",{className:"text-sm text-gray-500",children:"No custom domains configured"})]})]}),(0,te.jsx)(ua,{children:(0,te.jsx)(Rs,{className:"w-full bg-gray-900 text-white hover:bg-gray-800",onClick:k,disabled:o,children:o?(0,te.jsxs)("span",{className:"flex items-center justify-center",children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Publishing..."]}):"Publish App"})})]})}),(0,te.jsx)(rx,{open:v,onOpenChange:j,app:t,onPublishAnyway:S})]}):(0,te.jsxs)(ws,{children:[(0,te.jsxs)(ks,{open:l,children:[(0,te.jsxs)(gr,{open:l,onOpenChange:i,children:[(0,te.jsx)(fr,{asChild:!0,children:(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)(Rs,{className:"px-3 py-1 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800 transition-colors h-8",disabled:o||!(null!=t&&t.id),children:o?(0,te.jsxs)("span",{className:"flex items-center",children:[(0,te.jsx)(Je.A,{className:"mr-2 h-3.5 w-3.5 animate-spin"}),"Publishing..."]}):(0,te.jsx)("span",{children:"Publish"})})})}),(0,te.jsxs)(kr,{align:"end",className:"w-80 p-0 rounded-xl","data-hook":"publish-dropdown-menu-content",children:[(0,te.jsxs)("div",{className:"p-4",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("h3",{className:"font-semibold text-gray-900",children:"Publish Your App"}),(null==t?void 0:t.logo_url)&&(0,te.jsx)("img",{src:t.logo_url,alt:`${(null==t?void 0:t.name)||"App"} logo`,className:"w-8 h-8 ml-3 rounded-md object-cover border border-black/10 bg-gray-300"})]}),null!=t&&t.last_deployed_at?null:(0,te.jsx)("div",{className:"py-3 text-sm text-gray-600 border-b border-slate-100",children:(0,te.jsx)("p",{children:"This will be the first public version of your app. Publishing will make your app accessible to users at the public link."})}),d&&(0,te.jsx)("div",{className:"py-2 text-sm text-red-600 bg-red-50 border-t border-b border-red-100",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4 mr-2"}),(0,te.jsx)("p",{children:d})]})}),(0,te.jsx)(xx,{publishLink:b,domains:u,appId:(null==t?void 0:t.id)||""}),(0,te.jsx)(hx,{value:(null==t?void 0:t.public_settings)||"private_with_login",showWorkspace:r,onNavigation:()=>i(!1)}),(0,te.jsx)(Cd,{onClosePublish:()=>i(!1)}),(0,te.jsx)("div",{className:"pt-3",children:(0,te.jsx)(Rs,{className:"w-full h-8 bg-gray-900 text-white text-sm rounded-md hover:bg-gray-800 transition-colors py-2",onClick:k,disabled:o,"data-testid":"publish-button",children:o?(0,te.jsxs)("span",{className:"flex items-center justify-center",children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Publishing..."]}):"Publish App"})})]}),(null==t?void 0:t.last_deployed_at)&&(0,te.jsx)("div",{className:"text-center",children:(0,te.jsxs)("p",{className:"text-xs bg-slate-100 py-[6px] font-normal leading-4 text-center text-[var(--text-muted,#71717A)]",children:["Last published ",Bt().utc(t.last_deployed_at).fromNow()]})})]})]}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Publish app and open in new tab"})})]}),(0,te.jsx)(rx,{open:v,onOpenChange:j,app:t,onPublishAnyway:S})]})}var gx=t(86009),fx=t(80903),vx=t(3255),jx=t(15332);const bx=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Wt.bL,{ref:s,className:ns("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...a})}));bx.displayName=Wt.bL.displayName;const yx=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Wt._V,{ref:s,className:ns("aspect-square h-full w-full",t),...a})}));yx.displayName=Wt._V.displayName;const Nx=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Wt.H4,{ref:s,className:ns("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...a})}));Nx.displayName=Wt.H4.displayName;const wx=hr.bL,kx=hr.l9;hr.YJ,hr.ZL,hr.Pb,hr.z6;Y.forwardRef(((e,s)=>{let{className:t,inset:a,children:r,...n}=e;return(0,te.jsxs)(hr.ZP,{ref:s,className:ns("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",a&&"pl-8",t),...n,children:[r,(0,te.jsx)(pr.A,{className:"ml-auto h-4 w-4"})]})})).displayName=hr.ZP.displayName;Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(hr.G5,{ref:s,className:ns("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})})).displayName=hr.G5.displayName;const _x=Y.forwardRef(((e,s)=>{let{className:t,sideOffset:a=4,...r}=e;return(0,te.jsx)(hr.ZL,{children:(0,te.jsx)(hr.UC,{ref:s,sideOffset:a,className:ns("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})}));_x.displayName=hr.UC.displayName;const Sx=Y.forwardRef(((e,s)=>{let{className:t,inset:a,...r}=e;return(0,te.jsx)(hr.q7,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",t),...r})}));Sx.displayName=hr.q7.displayName;Y.forwardRef(((e,s)=>{let{className:t,children:a,checked:r,...n}=e;return(0,te.jsxs)(hr.H_,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...n,children:[(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)(hr.VF,{children:(0,te.jsx)(mt.A,{className:"h-4 w-4"})})}),a]})})).displayName=hr.H_.displayName;Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsxs)(hr.hN,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)(hr.VF,{children:(0,te.jsx)(nt.A,{className:"h-2 w-2 fill-current"})})}),a]})})).displayName=hr.hN.displayName;const Cx=Y.forwardRef(((e,s)=>{let{className:t,inset:a,...r}=e;return(0,te.jsx)(hr.JU,{ref:s,className:ns("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...r})}));Cx.displayName=hr.JU.displayName;const Ax=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(hr.wv,{ref:s,className:ns("-mx-1 my-1 h-px bg-muted",t),...a})}));Ax.displayName=hr.wv.displayName;const Ex=768;function Ix(){const[e,s]=Y.useState(void 0);return Y.useEffect((()=>{const e=window.matchMedia(`(max-width: ${Ex-1}px)`),t=()=>{s(window.innerWidth<Ex)};return e.addEventListener("change",t),s(window.innerWidth<Ex),()=>e.removeEventListener("change",t)}),[]),!!e}function Lx(e){let{onDataChange:s,onReset:t}=e;const{activeWorkspace:a}=xe(),r=Ix(),[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{if(a){const e=a.is_personal||!1;if(u(e),e)l("Personal Workspace"),o(a.description||""),d(!0);else{l(a.name||""),o(a.description||"");const e=a.user_role||"member";d(["admin","owner"].includes(e))}}}),[a]),(0,Y.useEffect)((()=>{s&&a&&s({name:n,description:i,canEdit:c,isPersonalWorkspace:m,workspaceId:a.id,hasChanges:x()})}),[n,i,c,m,a,s]),(0,Y.useEffect)((()=>{if(t){const e=()=>{a&&(l(m?"Personal Workspace":a.name||""),o(a.description||""))};window.workspaceInfoReset=e}}),[a,m,t]);const x=()=>{if(!a)return!1;const e=m?"Personal Workspace":a.name||"",s=a.description||"";return n!==e||i!==s};return a?(0,te.jsxs)("div",{className:"flex flex-col gap-6",children:[!r&&(0,te.jsx)("div",{className:"flex flex-col gap-3",children:(0,te.jsx)("div",{className:"text-black text-base font-semibold",children:"Workspace info"})}),(0,te.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,te.jsx)("div",{className:"flex gap-3",children:(0,te.jsxs)("div",{className:"flex-1 flex flex-col gap-2",children:[(0,te.jsx)("label",{className:"text-gray-700 text-sm font-medium",children:"Workspace name"}),(0,te.jsx)("input",{type:"text",value:n,onChange:e=>{!m&&c&&l(e.target.value)},disabled:m||!c,className:"px-3 py-1.5 rounded-md border border-gray-300 text-sm "+(m||!c?"bg-zinc-100 text-neutral-400 cursor-not-allowed":"bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"),placeholder:"Enter workspace name"})]})}),(0,te.jsx)("div",{className:"flex gap-3",children:(0,te.jsxs)("div",{className:"flex-1 flex flex-col gap-2",children:[(0,te.jsx)("label",{className:"text-gray-700 text-sm font-medium",children:"Workspace Description"}),(0,te.jsx)("textarea",{value:i,onChange:e=>{c&&o(e.target.value)},disabled:!c,className:"h-24 px-3 py-1.5 rounded-md border border-gray-300 text-sm resize-none "+(c?"bg-white focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent":"bg-zinc-100 text-neutral-400 cursor-not-allowed"),placeholder:"Add description"})]})})]})]}):(0,te.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,te.jsx)("div",{className:"flex flex-col gap-3",children:(0,te.jsx)("div",{className:"text-black text-base font-semibold",children:"Workspace info"})}),(0,te.jsx)("div",{className:"text-gray-500 text-sm",children:"Loading workspace information..."})]})}function Tx(e){let{title:s,current:t,total:a,percentage:r,remaining:n}=e;const[l,i]=(0,Y.useState)(0);(0,Y.useEffect)((()=>{const e=setTimeout((()=>{i(r)}),100);return()=>clearTimeout(e)}),[r]);return(0,te.jsxs)("div",{className:"flex flex-col gap-2 animate-in fade-in duration-500",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium leading-tight",children:s}),(0,te.jsxs)("div",{className:"text-black text-sm font-medium leading-tight",children:[t,"/",a]})]}),(0,te.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,te.jsx)("div",{className:"flex items-center gap-3",children:(0,te.jsx)("div",{className:"flex-1 flex items-center gap-1.5",children:(0,te.jsx)("div",{className:"flex-1 h-2 bg-slate-100 rounded-full flex",children:(0,te.jsx)("div",{className:`h-full bg-gray-900 rounded-full transition-all duration-700 ease-out ${(e=>e>90?"bg-red-500":e>75?"bg-yellow-500":"bg-slate-600")(r)}`,style:{width:`${l}%`}})})})}),(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsxs)("div",{className:"text-gray-500 text-sm font-normal leading-tight",children:[r,"% used"]}),(0,te.jsxs)("div",{className:"text-gray-500 text-sm font-normal leading-tight",children:[n," ",s.toLowerCase().includes("credit")?"credits":"messages"," remaining"]})]})]})]})}var $x=t(80294),Dx=t(85706);function Px(e){let{usageByDate:s,height:t}=e;const a=e=>{try{return new Date(e).toLocaleDateString("en-US",{month:"short",day:"numeric"})}catch(s){return e}},r=(e=>{if(!e||!Array.isArray(e))return[];return[...e].sort(((e,s)=>new Date(e._id)-new Date(s._id))).slice(-10).map((e=>({...e,date:a(e._id),total_messages:e.total_messages||0})))})(s),n=e=>{let{active:s,payload:t,label:a}=e;return s&&t&&t.length?(0,te.jsxs)("div",{className:"bg-white p-3 border border-gray-200 shadow-lg rounded-md text-xs",children:[(0,te.jsx)("p",{className:"font-medium text-gray-900",children:t[0].payload.date}),(0,te.jsxs)("p",{className:"text-slate-700 mt-1",children:[(0,te.jsx)("span",{className:"font-medium",children:t[0].value})," messages"]})]}):null};return r.length?(0,te.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium leading-tight",children:"Daily Usage (Messages)"}),(0,te.jsx)("div",{className:`${t||"h-40"}`,children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)($x.E,{data:r,margin:{top:0,right:0,left:0,bottom:0},padding:{top:0,right:0,left:0,bottom:0},children:[(0,te.jsx)(Dd.d,{stroke:"#F3F4F6",vertical:!1,strokeWidth:1}),(0,te.jsx)(Pd.W,{dataKey:"date",textAnchor:"middle",height:26,fontSize:12,stroke:"#6b7280",tickMargin:10,axisLine:!1,tickLine:!1}),(0,te.jsx)(Md.h,{fontSize:12,stroke:"#6b7280",axisLine:!1,tickLine:!1,tickCount:5,tickFormatter:e=>0===e?"0":e,width:38}),(0,te.jsx)(Od.m,{content:(0,te.jsx)(n,{}),cursor:{fill:"rgba(71, 85, 105, 0.1)"}}),(0,te.jsx)(Dx.y,{dataKey:"total_messages",name:"Messages",fill:"#f1f5f9",stroke:"#d1d5db",strokeWidth:1,radius:[4,4,0,0],maxBarSize:50,animationDuration:2e3})]})})})]}):(0,te.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium leading-tight",children:"Daily Usage (Messages)"}),(0,te.jsx)("div",{className:"h-40 flex items-center justify-center",children:(0,te.jsx)("div",{className:"text-gray-500 text-sm",children:"No usage data available"})})]})}function Mx(){var e,s,t;const[a,r]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null),[m,u]=(0,Y.useState)([]),{user:x}=ne(),h=Ix(),{toast:p}=Un();(0,Y.useEffect)((()=>{g()}),[]);const g=async()=>{try{l(!0);const[e,s]=await Promise.all([Qe.default.getStats(),Qe.default.getCurrentIntegrationUsage()]),t=e,a=s,n=[{title:"Monthly Messages",current:Math.round((null==t?void 0:t.monthly_usage)||0),total:(null==t?void 0:t.monthly_limit)||0,percentage:null!=t&&t.monthly_limit?Math.round(t.monthly_usage/t.monthly_limit*100):0,remaining:Math.max(0,((null==t?void 0:t.monthly_limit)||0)-Math.round((null==t?void 0:t.monthly_usage)||0))},...null!=t&&t.daily_limit?[{title:"Daily Messages",current:Math.round((null==t?void 0:t.daily_usage)||0),total:(null==t?void 0:t.daily_limit)||0,percentage:null!=t&&t.daily_limit?Math.round(t.daily_usage/t.daily_limit*100):0,remaining:Math.max(0,((null==t?void 0:t.daily_limit)||0)-Math.round((null==t?void 0:t.daily_usage)||0))}]:[],{title:"Integration Credits",current:(null==a?void 0:a.credits_this_month)||0,total:(null==a?void 0:a.credits_limit)||0,percentage:null!=a&&a.credits_limit?Math.round(a.credits_this_month/a.credits_limit*100):0,remaining:Math.max(0,((null==a?void 0:a.credits_limit)||0)-((null==a?void 0:a.credits_this_month)||0))}];r(n),u((null==t?void 0:t.usage_by_date)||[]),d({subscription_status:null==t?void 0:t.subscription_status,is_over_limit:null==t?void 0:t.is_over_limit,past_due:null==t?void 0:t.past_due,tier:null==t?void 0:t.tier}),o(null)}catch(e){o("Failed to load usage statistics"),r([{title:"Monthly Messages",current:0,total:0,percentage:0,remaining:0},{title:"Integration Credits",current:0,total:0,percentage:0,remaining:0}]),u([])}finally{l(!1)}};return n?(0,te.jsxs)("div",{className:"flex flex-col gap-6 animate-in fade-in duration-300",children:[!h&&(0,te.jsx)("div",{className:"flex flex-col gap-3",children:(0,te.jsx)("div",{className:"text-black text-base font-semibold leading-normal",children:"Credits Usages"})}),(0,te.jsx)("div",{className:"bg-gray-100 rounded-xl border border-gray-200 flex flex-col transition-all duration-300",children:(0,te.jsx)("div",{className:"p-6 flex items-center justify-center",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-slate-700"})})})]}):i?(0,te.jsxs)("div",{className:"flex flex-col gap-6 animate-in fade-in duration-300",children:[!h&&(0,te.jsx)("div",{className:"flex flex-col gap-3",children:(0,te.jsx)("div",{className:"text-black text-base font-semibold leading-normal",children:"Credits Usages"})}),(0,te.jsx)("div",{className:"bg-gray-100 rounded-xl border border-gray-200 flex flex-col transition-all duration-300",children:(0,te.jsx)("div",{className:"p-6 flex items-center justify-center",children:(0,te.jsx)("div",{className:"text-red-500 animate-in fade-in duration-500",children:i})})})]}):(0,te.jsxs)("div",{className:"flex flex-col gap-6 animate-in fade-in duration-500",children:[!h&&(0,te.jsx)("div",{className:"flex flex-col gap-3",children:(0,te.jsx)("div",{className:"text-black text-base font-semibold leading-normal",children:"Credits Usages"})}),(0,te.jsxs)("div",{className:"bg-gray-100 rounded-xl border border-gray-200 flex flex-col transition-all duration-300",children:[(0,te.jsxs)("div",{className:"pl-6 pr-3 py-3 rounded-t-xl flex items-center gap-2.5 animate-in fade-in slide-in-from-top-2 duration-400",children:[(0,te.jsxs)("div",{className:"flex-1 flex items-center gap-2",children:[(0,te.jsxs)("div",{className:"text-black text-base font-medium leading-normal",children:["You're currently on the ",x.subscription_tier.charAt(0).toUpperCase()+x.subscription_tier.slice(1)," Plan"]}),(null==c?void 0:c.is_over_limit)&&(0,te.jsx)("div",{className:"px-2 py-1 bg-red-100 text-red-600 text-xs rounded-md animate-in fade-in duration-500",children:"Over Limit"})]}),"elite3"!==x.subscription_tier&&(0,te.jsx)("button",{onClick:async()=>{if(null!=c&&c.past_due)try{const e="payment_method_update",s=await Tn.createPortalSession(e);window.location.href=s.url}catch(i){p({variant:"destructive",title:"Error",description:"Failed to open payment management. Please try again."})}else window.open("/billing","_blank")},className:"px-4 py-1.5 bg-white rounded-md shadow-[0px_1px_2px_0px_rgba(0,0,0,0.10)] border border-orange-500 flex items-center gap-2.5 hover:bg-orange-50 transition-all duration-200 animate-in fade-in slide-in-from-right-2 duration-500",children:(0,te.jsx)("div",{className:"text-orange-500 text-sm font-medium leading-tight",children:null!=c&&c.past_due?"Update Payment":"Upgrade Plan"})})]}),(null==c?void 0:c.past_due)&&(0,te.jsx)("div",{className:"mx-6 mt-3 mb-3 p-4 bg-orange-50 border border-orange-200 rounded-lg animate-in fade-in duration-500",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-5 h-5 bg-orange-500 rounded-full flex items-center justify-center mt-0.5",children:(0,te.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,te.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("h3",{className:"text-orange-800 font-medium text-sm mb-1",children:"Payment overdue"}),(0,te.jsxs)("p",{className:"text-orange-700 text-sm",children:["Your subscription payment is past due. Credits and limits shown are based on your last paid plan (",(null==c||null===(e=c.tier)||void 0===e||null===(s=e.charAt(0))||void 0===s?void 0:s.toUpperCase())+(null==c||null===(t=c.tier)||void 0===t?void 0:t.slice(1)),")."]})]})]})}),(0,te.jsxs)("div",{className:"p-6 bg-white rounded-xl border border-gray-200 flex flex-col gap-6 animate-in fade-in slide-in-from-bottom-2 duration-600",children:[a.map(((e,s)=>(0,te.jsx)("div",{style:{animationDelay:100*s+"ms"},className:"animate-in fade-in slide-in-from-bottom-1 duration-500",children:(0,te.jsx)(Tx,{...e})},s))),(0,te.jsx)("div",{style:{animationDelay:100*a.length+"ms"},className:"animate-in fade-in slide-in-from-bottom-1 duration-500",children:(0,te.jsx)(Px,{usageByDate:m})})]})]})]})}function Ox(){const e=Ix(),[s,t]=(0,Y.useState)(!1),[a,r]=(0,Y.useState)(null),n=(0,Y.useCallback)((e=>{r(e)}),[]),l=(null==a?void 0:a.canEdit)&&(null==a?void 0:a.hasChanges);return(0,te.jsxs)("div",{className:"h-full flex flex-col",children:[(0,te.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,te.jsxs)("div",{className:(e?"px-5 pt-6":"px-6")+" pb-6 md:px-8 md:pb-8 lg:px-10 lg:pb-10 space-y-8",children:[(0,te.jsx)(Lx,{onDataChange:n,onReset:!0}),(0,te.jsx)(Mx,{})]})}),l&&(0,te.jsxs)("div",{className:"flex-shrink-0 p-4 bg-white border-t border-gray-200 flex justify-end items-center gap-3",children:[(0,te.jsx)("button",{onClick:()=>{window.workspaceInfoReset&&window.workspaceInfoReset()},disabled:s,className:"px-4 py-2 bg-white rounded-md border border-gray-300 hover:bg-gray-50 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,te.jsx)("button",{onClick:async()=>{if(a&&a.canEdit&&a.hasChanges){t(!0);try{const e={};a.isPersonalWorkspace||void 0===a.name||(e.name=a.name),void 0!==a.description&&(e.description=a.description),await de.updateWorkspace(a.workspaceId,e),Ga.default.success("Workspace settings updated successfully!")}catch(r){var e,s;Ga.default.error("Failed to update workspace settings: "+((null===(e=r.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||r.message||"Unknown error"))}finally{t(!1)}}},disabled:s,className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:s?"Saving...":"Save Changes"})]})]})}function Rx(e){let{userEmail:s,userFullName:t,profileImageUrl:a}=e;return a?(0,te.jsxs)("div",{className:"flex-shrink-0",children:[(0,te.jsx)("img",{src:a,alt:`${t||"User"} profile`,className:"h-8 w-8 rounded-lg object-cover border border-slate-500",title:`${t||"Unknown"} (${s||"No email"})`,onError:e=>{e.target.style.display="none";const s=e.target.nextElementSibling;s&&(s.style.display="flex")}}),(0,te.jsx)("div",{className:"h-8 w-8 rounded-lg \n                         text-slate-600 \n                        border border-slate-500\n                        items-center justify-center \n                        hover:bg-slate-500 hover:text-slate-100\n                        transition-all duration-150 ease-out\n                        font-medium select-none",style:{display:"none"},title:`${t||"Unknown"} (${s||"No email"})`,children:t?t.charAt(0).toUpperCase():"U"})]}):(0,te.jsx)("div",{className:"flex-shrink-0",children:(0,te.jsx)("div",{className:" h-8 w-8 rounded-lg \n                     text-slate-600 \n                    border border-slate-500\n                    flex items-center justify-center \n                    hover:bg-slate-500 hover:text-slate-100\n                    transition-all duration-150 ease-out\n                    font-medium select-none",title:`${t||"Unknown"} (${s||"No email"})`,children:t?t.charAt(0).toUpperCase():"U"})})}function Fx(){const{user:e}=ne();return e?(0,te.jsx)(Rx,{userEmail:null==e?void 0:e.email,userFullName:null==e?void 0:e.full_name,profileImageUrl:null==e?void 0:e.profile_image_url}):null}function zx(e){let{value:s,onChange:t,userEmail:a,userFullName:r}=e;const[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1),m=(0,Y.useRef)(null);return(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Profile Image"}),(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsxs)("div",{className:"relative cursor-pointer group inline-block",onClick:()=>{var e;null===(e=m.current)||void 0===e||e.click()},title:"Click to upload image",children:[s&&!n?(0,te.jsx)("img",{src:s,alt:"Profile",className:"h-12 w-12 rounded-lg object-cover border border-slate-300 group-hover:border-slate-400 transition-colors",onLoad:()=>{l(!1),o(!0)},onError:()=>{l(!0),o(!1)},style:{display:i&&!n?"block":"none"}}):null,(!s||n||!i)&&(0,te.jsx)("div",{className:"h-12 w-12 rounded-lg text-slate-600 border border-slate-300 flex items-center justify-center bg-slate-50 font-medium group-hover:border-slate-400 transition-colors",children:r?r.charAt(0).toUpperCase():"U"}),(0,te.jsx)("div",{className:"absolute inset-0 bg-black bg-opacity-0 group-hover:bg-opacity-30 rounded-lg flex items-center justify-center transition-all duration-200",children:(0,te.jsx)(zo.A,{className:"w-4 h-4 text-white opacity-0 group-hover:opacity-100 transition-opacity"})}),c&&(0,te.jsx)("div",{className:"absolute inset-0 bg-white bg-opacity-75 rounded-lg flex items-center justify-center",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-t-2 border-b-2 border-gray-900"})})]}),(0,te.jsx)("input",{ref:m,type:"file",accept:"image/jpeg,image/jpg,image/png,image/gif,image/webp",onChange:async e=>{const s=e.target.files[0];if(!s)return;if(!["image/jpeg","image/jpg","image/png","image/gif","image/webp"].includes(s.type))return void Ga.default.error("Please upload a valid image file (JPG, PNG, GIF, or WebP)");if(s.size>5242880)Ga.default.error("Image must be less than 5MB");else try{d(!0);const e=(await bs.uploadFile(s)).url;t(e),Ga.default.success("Profile image uploaded successfully!")}catch(a){Ga.default.error("Failed to upload image. Please try again.")}finally{d(!1)}},className:"hidden"})]})]})}function Ux(){const{user:e,updateUser:s}=ne(),t=Ix(),[a,r]=(0,Y.useState)(!1),n=cd(e),[l,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)({email:"",fullName:"",phoneNumber:"",profileImageUrl:"",notificationPreference:"every_prompt",enableBackendFunctionsByDefault:!1,enableAgentsByDefault:!1});(0,Y.useEffect)((()=>{if(e){const s=cd(e);m({email:e.email||"",fullName:e.full_name||"",phoneNumber:e.phone_number||"",profileImageUrl:e.profile_image_url||"",enableBackendFunctionsByDefault:s&&e.enable_backend_functions_by_default||!1,enableAgentsByDefault:e.enable_agents_by_default||!1,notificationPreference:e.notification_preference||"every_prompt"})}}),[e]);const u=e&&(d.fullName!==(e.full_name||"")||d.phoneNumber!==(e.phone_number||"")||d.profileImageUrl!==(e.profile_image_url||"")||d.enableBackendFunctionsByDefault!==(n&&e.enable_backend_functions_by_default||!1)||d.enableAgentsByDefault!==(e.enable_agents_by_default||!1)||d.notificationPreference!==(e.notification_preference||"every_prompt")),x=(e,s)=>{m((t=>({...t,[e]:s})))};return e?(0,te.jsxs)("div",{className:"h-full flex flex-col",children:[(0,te.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,te.jsx)("div",{className:(t?"px-5 pt-6":"px-6")+" pb-6 md:px-8 md:pb-8 lg:px-10 lg:pb-10 space-y-8",children:(0,te.jsxs)("div",{className:"space-y-6",children:[!t&&(0,te.jsx)("div",{className:"space-y-3",children:(0,te.jsx)("div",{className:"text-black text-base font-semibold",children:"Account"})}),(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Email"}),(0,te.jsx)("div",{className:"flex-1",children:(0,te.jsx)("input",{type:"email",value:d.email,disabled:!0,className:"w-full px-3 py-1.5 bg-zinc-100 rounded-md border border-gray-300 text-neutral-400 text-sm",placeholder:"No email set"})})]}),(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Full Name"}),(0,te.jsx)("div",{className:"flex-1",children:(0,te.jsx)("input",{type:"text",value:d.fullName,onChange:e=>x("fullName",e.target.value),className:"w-full px-3 py-1.5 bg-white rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter your full name",required:!0})})]}),(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Phone Number"}),(0,te.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,te.jsx)("input",{type:"tel",value:d.phoneNumber,onChange:e=>x("phoneNumber",e.target.value),className:"w-full px-3 py-1.5 bg-white rounded-md border border-gray-300 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",placeholder:"Enter your phone number"}),(0,te.jsx)("div",{className:"text-gray-500 text-xs",children:"By entering your phone number, you agree to receive SMS notifications from us."})]})]}),(0,te.jsx)(zx,{value:d.profileImageUrl,onChange:e=>x("profileImageUrl",e),userEmail:d.email,userFullName:d.fullName}),(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Notification Sound Preference"}),(0,te.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,te.jsxs)(ut,{value:d.notificationPreference,onValueChange:e=>x("notificationPreference",e),children:[(0,te.jsx)(pt,{advancedDropdown:!0,className:"w-full h-auto p-2 bg-white border border-gray-200 hover:bg-gray-50 hover:border-gray-300 transition-colors duration-200",children:(0,te.jsx)("div",{className:"w-full text-left",children:(0,te.jsx)("div",{className:"w-full flex flex-col gap-1",children:(0,te.jsx)("div",{className:"text-sm text-gray-900",children:(0,te.jsx)("span",{className:"font-[500]",children:(e=>{switch(e){case"on_first_prompt":return"On first prompt only";case"every_prompt":default:return"On every prompt";case"never":return"Disable notification sounds"}})(d.notificationPreference)})})})})}),(0,te.jsxs)(vt,{className:"w-[calc(100%-1rem)] max-w-[400px] z-50 p-1.5",sideOffset:4,children:[(0,te.jsx)(bt,{value:"on_first_prompt",className:"px-4 py-3 border-b border-gray-100 last:border-b-0 hover:bg-gray-50 transition-colors duration-200",hideCheckIcon:!0,children:(0,te.jsx)("div",{className:"w-full flex flex-col gap-1",children:(0,te.jsx)("div",{className:"text-sm leading-[17px] text-gray-900",children:(0,te.jsx)("span",{className:"font-bold",children:"On first prompt only"})})})}),(0,te.jsx)(bt,{value:"every_prompt",className:"px-4 py-3 border-b border-gray-100 last:border-b-0 hover:bg-gray-50 transition-colors duration-200",hideCheckIcon:!0,children:(0,te.jsx)("div",{className:"w-full flex flex-col gap-1",children:(0,te.jsx)("div",{className:"text-sm leading-[17px] text-gray-900",children:(0,te.jsx)("span",{className:"font-bold",children:"On every prompt"})})})}),(0,te.jsx)(bt,{value:"never",className:"px-4 py-3 border-b border-gray-100 last:border-b-0 hover:bg-gray-50 transition-colors duration-200",hideCheckIcon:!0,children:(0,te.jsx)("div",{className:"w-full flex flex-col gap-1",children:(0,te.jsx)("div",{className:"text-sm leading-[17px] text-gray-900",children:(0,te.jsx)("span",{className:"font-bold",children:"Disable notification sounds"})})})})]})]}),(0,te.jsx)("div",{className:"text-gray-500 text-xs",children:"Choose when to play notification sounds when your app completes prompts."})]})]}),(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Default Backend Functions"}),(0,te.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(Lc,{checked:d.enableBackendFunctionsByDefault,onCheckedChange:e=>x("enableBackendFunctionsByDefault",e),disabled:!n,className:"data-[state=checked]:bg-black"}),(0,te.jsx)("div",{className:"text-sm text-gray-700",children:"Enable backend functions for new apps by default"})]}),(0,te.jsx)("div",{className:"text-gray-500 text-xs",children:"When enabled, new apps will automatically have backend functions activated."}),!n&&(0,te.jsx)(dd,{})]})]}),(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"Default Agents"}),(0,te.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(Lc,{checked:d.enableAgentsByDefault,onCheckedChange:e=>x("enableAgentsByDefault",e),className:"data-[state=checked]:bg-black"}),(0,te.jsx)("div",{className:"text-sm text-gray-700",children:"Enable agents for new apps by default"})]}),(0,te.jsx)("div",{className:"text-gray-500 text-xs",children:"When enabled, new apps will automatically have agents enabled, allowing them to run autonomous tasks and use tools."})]})]}),(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start gap-3",children:[(0,te.jsx)("div",{className:"text-gray-700 text-sm font-medium lg:w-48 lg:flex-shrink-0 lg:mt-2",children:"API Key"}),(0,te.jsxs)("div",{className:"flex-1 space-y-2",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"flex-1 h-10 px-3 py-2 bg-zinc-100 rounded-md border border-gray-300 flex items-center min-w-0",children:(0,te.jsx)("div",{className:"text-black text-sm font-mono truncate",children:e.api_key})}),(0,te.jsxs)("button",{onClick:async()=>{try{await navigator.clipboard.writeText(e.api_key),c(!0),Ga.default.success("API key copied to clipboard!"),setTimeout((()=>c(!1)),2e3)}catch(s){Ga.default.error("Failed to copy API key")}},className:"w-9 h-9 bg-white rounded-md border border-stone-300 flex items-center justify-center hover:bg-gray-50 transition-colors relative flex-shrink-0",title:"Copy API key",children:[(0,te.jsx)(Ha.A,{size:16}),o&&(0,te.jsx)("div",{className:"absolute -top-8 left-1/2 transform -translate-x-1/2 bg-black text-white text-xs px-2 py-1 rounded",children:"Copied!"})]}),(0,te.jsxs)("button",{onClick:async()=>{i(!0);try{const t=await Q.regenerateApiKey(e.id);s(t),Ga.default.success("API key regenerated successfully!")}catch(t){Ga.default.error("Failed to regenerate API key: "+(t.detail||t.message||"Unknown error"))}finally{i(!1)}},disabled:l,className:"h-9 px-2 sm:px-4 py-1.5 bg-white rounded-md border border-stone-300 hover:bg-gray-50 transition-colors flex items-center gap-1 sm:gap-2 disabled:opacity-50 disabled:cursor-not-allowed flex-shrink-0",children:[(0,te.jsx)($c.A,{size:14,className:l?"animate-spin":""}),(0,te.jsx)("div",{className:"text-black text-xs sm:text-sm font-medium hidden sm:block",children:l?"Regenerating...":"Regenerate"}),(0,te.jsx)("div",{className:"text-black text-xs font-medium sm:hidden",children:l?"Regen...":"Regen"})]})]}),(0,te.jsx)("div",{className:"text-gray-500 text-xs",children:"Your API key provides access to your workspace. Do not share it with others."})]})]})]})]})})}),u&&(0,te.jsxs)("div",{className:"flex-shrink-0 p-4 bg-white border-t border-gray-200 flex justify-end items-center gap-3",children:[(0,te.jsx)("button",{onClick:()=>{if(e){const s=cd(e);m({email:e.email||"",fullName:e.full_name||"",phoneNumber:e.phone_number||"",profileImageUrl:e.profile_image_url||"",notificationPreference:e.notification_preference||"every_prompt",enableBackendFunctionsByDefault:s&&e.enable_backend_functions_by_default||!1,enableAgentsByDefault:e.enable_agents_by_default||!1})}},disabled:a,className:"px-4 py-2 bg-white rounded-md border border-gray-300 hover:bg-gray-50 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),(0,te.jsx)("button",{onClick:async()=>{r(!0);try{const t=await Q.updateUser(e.id,{full_name:d.fullName.length>0?d.fullName:null,phone_number:(d.phoneNumber||"").length>0?d.phoneNumber:null,profile_image_url:(d.profileImageUrl||"").length>0?d.profileImageUrl:null,notification_preference:d.notificationPreference,enable_backend_functions_by_default:!!n&&d.enableBackendFunctionsByDefault,enable_agents_by_default:d.enableAgentsByDefault});s(t);const a=cd(t);m({email:t.email||"",fullName:t.full_name||"",phoneNumber:t.phone_number||"",profileImageUrl:t.profile_image_url||"",notificationPreference:t.notification_preference||"every_prompt",enableBackendFunctionsByDefault:a&&t.enable_backend_functions_by_default||!1,enableAgentsByDefault:t.enable_agents_by_default||!1}),Ga.default.success("Account settings updated successfully!")}catch(t){Ga.default.error("Failed to update account settings: "+(t.detail||t.message||"Unknown error"))}finally{r(!1)}},disabled:a,className:"px-4 py-2 bg-black text-white rounded-md hover:bg-gray-800 transition-colors text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:a?"Saving...":"Save Changes"})]})]}):(0,te.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-gray-900"})})}function Bx(){const{user:e}=ne(),s=Ix(),[t,a]=(0,Y.useState)([]),[r,n]=(0,Y.useState)(!0),[l,i]=(0,Y.useState)(null),o=()=>{window.open("/billing","_blank")},c=e=>{const s=parseInt(e);if(s>=1e3){const e=s/1e3;return e%1==0?`${e}k`:`${e.toFixed(1)}k`}return s.toString()};(0,Y.useEffect)((()=>{(async()=>{try{n(!0);const e=await Qe.default.getMonthlyPlans();if(e&&e.plans){const s=["starter","builder","pro","elite"],t=e.plans.filter((e=>s.includes(e.tier))),r=t.sort(((e,s)=>s.price_data.unit_amount-e.price_data.unit_amount)).map((e=>((e,s)=>{var t,a;const r=(null===(t=s.metadata)||void 0===t?void 0:t.monthly_message_limit)||"0",n=(null===(a=s.metadata)||void 0===a?void 0:a.monthly_integration_credits)||"0",l=e.charAt(0).toUpperCase()+e.slice(1),i="pro"===e?"Upgrade to "+l:"Upgrade";return{name:l,monthlyCredits:c(r),integrationCredits:c(n),buttonText:i,isRecommended:"pro"===e,price:`$${Math.round(s.unit_amount/100)}`}})(e.tier,e.price_data)));a(r)}else i("Unable to load pricing information")}catch(e){i("Failed to load plans")}finally{n(!1)}})()}),[]);return r?(0,te.jsx)("div",{className:"self-stretch px-10 bg-white inline-flex flex-col justify-start items-start gap-10",children:(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-3",children:[(0,te.jsx)("div",{className:"text-black text-base font-semibold leading-normal",children:"Plan & Billing"}),(0,te.jsx)("div",{className:"flex items-center justify-center h-32",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-gray-900"})})]})}):l?(0,te.jsx)("div",{className:"self-stretch px-10 bg-white inline-flex flex-col justify-start items-start gap-10",children:(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-3",children:[(0,te.jsx)("div",{className:"text-black text-base font-semibold leading-normal",children:"Plan & Billing"}),(0,te.jsx)("div",{className:"text-red-500 text-sm",children:l})]})}):(0,te.jsx)("div",{className:`self-stretch ${s?"px-5 pt-6":"px-10"} bg-white inline-flex flex-col justify-start items-start gap-10`,children:(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-3",children:[!s&&(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-center items-start gap-2",children:(0,te.jsx)("div",{className:"justify-start text-black text-base font-semibold leading-normal",children:"Plan & Billing"})}),(0,te.jsxs)("div",{className:"self-stretch inline-flex justify-between items-center",children:[(0,te.jsxs)("div",{className:"justify-start text-gray-600 text-sm font-normal leading-tight",children:["You're currently on the ",e.subscription_tier.charAt(0).toUpperCase()+e.subscription_tier.slice(1)," Plan"]}),(0,te.jsx)("div",{"data-prefix":"Off","data-size":"Small","data-state":"Default","data-suffix":"Off","data-type":"Link",className:"inline-flex flex-col justify-start items-start cursor-pointer",onClick:o,children:(0,te.jsx)("div",{className:"py-1.5 rounded-md flex flex-col justify-center items-center gap-2.5",children:(0,te.jsx)("div",{className:"inline-flex justify-center items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-start text-text-default text-xs font-medium leading-none",children:"Compare Plans"})})})})]}),(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-start items-start",children:(0,te.jsx)("div",{className:"self-stretch inline-flex justify-start items-end gap-2",children:t.map((e=>{const s=e.isRecommended?"outline-orange-400":"outline-gray-200",t=e.isRecommended?"bg-orange-500":"bg-zinc-100",a=e.isRecommended?"text-white":"text-black";return(0,te.jsxs)("div",{className:`flex-1 rounded-xl outline outline-1 w-[171px] outline-offset-[-0.50px] ${s} inline-flex flex-col justify-end items-start overflow-hidden`,children:[(0,te.jsxs)("div",{className:"self-stretch px-3 pt-3 bg-white rounded-bl-xl rounded-br-xl flex flex-col justify-start items-start",children:[(0,te.jsxs)("div",{className:"self-stretch h-6 inline-flex justify-start items-start gap-1",children:[(0,te.jsx)("div",{className:"justify-center text-black text-sm font-normal",children:e.name}),e.isRecommended&&(0,te.jsx)("div",{className:"px-2 py-0.5 bg-red-100 rounded flex justify-center items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-center text-orange-500 text-xs font-medium leading-3",children:"Recommended"})})]}),(0,te.jsx)("div",{className:"self-stretch pt-1.5 inline-flex justify-start items-end gap-[3px]",children:(0,te.jsxs)("div",{className:"flex justify-start items-end gap-0.5",children:[(0,te.jsx)("div",{className:"justify-center text-black text-xl font-semibold",children:e.price}),(0,te.jsx)("div",{className:"w-7 h-6 justify-start text-stone-300 text-sm font-normal",children:"/mo"})]})}),(0,te.jsxs)("div",{className:"self-stretch pt-11 pb-3 flex flex-col justify-start items-start gap-1",children:[(0,te.jsxs)("div",{className:"self-stretch inline-flex justify-start items-start gap-1.5",children:[(0,te.jsx)("div",{className:"w-7 justify-center text-black text-xs font-semibold leading-none",children:e.monthlyCredits}),(0,te.jsx)("div",{className:"flex-1 justify-center text-zinc-600 text-xs font-normal leading-none",children:"monthly credits"})]}),(0,te.jsxs)("div",{className:"self-stretch inline-flex justify-start items-start gap-1.5",children:[(0,te.jsx)("div",{className:"w-7 justify-center text-black text-xs font-semibold leading-none",children:e.integrationCredits}),(0,te.jsx)("div",{className:"flex-1 justify-center text-zinc-600 text-xs font-normal leading-none",children:"integration credits"})]})]})]}),(0,te.jsx)("div",{className:"self-stretch p-2 inline-flex justify-center items-center gap-2.5",children:(0,te.jsx)("div",{className:`flex-1 h-8 ${t} rounded-md inline-flex flex-col justify-center items-center overflow-hidden`,children:(0,te.jsx)("div",{className:"self-stretch flex-1 px-4 rounded-md inline-flex justify-center items-center gap-1.5 cursor-pointer",onClick:o,children:(0,te.jsx)("div",{className:"inline-flex flex-col justify-center items-start",children:(0,te.jsx)("div",{className:`self-stretch justify-start text-sm font-medium leading-normal ${a}`,children:e.buttonText})})})})})]},e.name)}))})})]})})}function Wx(){var e;const{user:s}=ne(),t=Ix(),{toast:a}=Un(),[r,n]=(0,Y.useState)([]),[l,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!0),[d,m]=(0,Y.useState)(null);(0,Y.useEffect)((()=>{(async()=>{try{c(!0);const[e,s]=await Promise.all([Tn.getInvoices(),Qe.default.getStats()]);n(e.invoices||[]),i(s)}catch(e){m("Failed to load billing data")}finally{c(!1)}})()}),[]);const u=async()=>{try{const e="past_due"===s.stripe_subscription_status?"payment_method_update":void 0,t=await Tn.createPortalSession(e);"past_due"===s.stripe_subscription_status?window.location.href=t.url:window.open(t.url,"_blank")}catch(d){a({variant:"destructive",title:"Error",description:"Failed to open payment management. Please try again."})}},x=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:s}).format(e)},h=e=>e?new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A",p=!0===(null==l||null===(e=l.stripe_subscription)||void 0===e?void 0:e.cancel_at_period_end),g=e=>{switch(e.toLowerCase()){case"paid":return{background:"outline-emerald-700",text:"text-emerald-700"};case"pending":case"open":return{background:"outline-orange-500",text:"text-orange-500"};case"failed":case"past_due":return{background:"outline-red-500",text:"text-red-500"};default:return{background:"outline-gray-500",text:"text-gray-500"}}};return(0,te.jsx)("div",{className:"self-stretch bg-white flex flex-col justify-start items-start h-full overflow-y-auto",style:{scrollbarGutter:"stable"},children:(0,te.jsxs)("div",{className:`w-full ${t?"px-5 pt-6":"px-10 pt-0"} pb-10 flex flex-col justify-start items-start gap-10`,children:[(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-3",children:[!t&&(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-center items-start gap-2",children:(0,te.jsx)("div",{className:"justify-start text-black text-base font-semibold leading-normal",children:"Plan & Billing"})}),(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-2",children:[(0,te.jsx)("div",{className:"self-stretch px-4 py-3 bg-white rounded-xl outline outline-1 outline-offset-[-1px] outline-gray-200 flex flex-col justify-start items-start gap-2.5",children:(0,te.jsxs)("div",{className:"self-stretch inline-flex justify-between items-center",children:[(0,te.jsxs)("div",{className:(t?"text-sm flex-1 pr-2":"text-base")+" justify-start text-text-default font-normal leading-normal",children:["You're currently using the ",s.subscription_tier.charAt(0).toUpperCase()+s.subscription_tier.slice(1)," plan"]}),(0,te.jsxs)("div",{className:"flex justify-start items-center gap-2 flex-shrink-0",children:[!t&&(0,te.jsx)("div",{className:"inline-flex flex-col justify-start items-start",children:(0,te.jsx)("div",{className:"px-4 py-1.5 bg-bg-secondary rounded-md outline outline-1 outline-offset-[-1px] outline-zinc-200 flex flex-col justify-center items-center gap-2.5 cursor-pointer",onClick:u,children:(0,te.jsx)("div",{className:"inline-flex justify-center items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-start text-text-default text-sm font-medium leading-tight",children:"Manage Plan"})})})}),(0,te.jsx)("div",{className:"inline-flex flex-col justify-start items-start",children:(0,te.jsx)("div",{className:(t?"px-3 py-1.5":"px-4 py-1.5")+" bg-bg-secondary rounded-md outline outline-1 outline-offset-[-1px] outline-orange-500 flex flex-col justify-center items-center gap-2.5 cursor-pointer",onClick:u,children:(0,te.jsx)("div",{className:"inline-flex justify-center items-center gap-2.5",children:(0,te.jsx)("div",{className:`justify-start text-orange-500 ${t?"text-xs":"text-sm"} font-medium leading-tight`,children:"past_due"===s.stripe_subscription_status?"Update Payment":"Upgrade Plan"})})})})]})]})}),(0,te.jsxs)("div",{className:"flex flex-col gap-1",children:[(0,te.jsx)("div",{className:`justify-start text-gray-600 ${t?"text-xs":"text-sm"} font-normal leading-tight`,children:s.subscription_period_end?p?`Your subscription will end on ${h(s.subscription_period_end)}`:`Your subscription renews on ${h(s.subscription_period_end)}`:"No active subscription"}),p&&(0,te.jsxs)("div",{className:"justify-start text-gray-500 text-xs font-normal leading-tight",children:["Want to keep your subscription? Click ",(0,te.jsx)("span",{className:"underline text-blue-500 cursor-pointer",onClick:u,children:"Manage Plan"})," and Cancel the change."]})]})]})]}),"past_due"===s.stripe_subscription_status&&(0,te.jsx)("div",{className:"self-stretch mt-0 p-4 bg-orange-50 border border-orange-200 rounded-lg",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-5 h-5 bg-orange-500 rounded-full flex items-center justify-center mt-0.5",children:(0,te.jsx)("svg",{className:"w-3 h-3 text-white",fill:"currentColor",viewBox:"0 0 20 20",children:(0,te.jsx)("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("h3",{className:"text-orange-800 font-medium text-sm mb-1",children:"Payment overdue"}),(0,te.jsx)("p",{className:"text-orange-700 text-sm",children:"Your subscription payment is past due. Please update your payment method to restore full access to your plan features."})]})]})}),(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-6",children:[(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-center items-start gap-2",children:(0,te.jsx)("div",{className:"justify-start text-black text-base font-semibold leading-normal",children:"Billing History"})}),(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-4 pb-6 md:pb-8 lg:pb-10",children:[o&&(0,te.jsx)("div",{className:"self-stretch text-center text-gray-500 py-8",children:"Loading billing history..."}),d&&(0,te.jsx)("div",{className:"self-stretch text-center text-red-500 py-8",children:d}),!o&&!d&&0===r.length&&(0,te.jsx)("div",{className:"self-stretch text-center text-gray-500 py-8",children:"No billing history available"}),!o&&!d&&r.map(((e,a)=>{return(0,te.jsxs)(Y.Fragment,{children:[(0,te.jsxs)("div",{className:"w-full inline-flex justify-start items-center",children:[(0,te.jsx)("div",{className:"w-40 pr-3 flex justify-start items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-start text-gray-800 text-sm font-normal leading-tight",children:(n=e.date,new Date(1e3*n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))})}),(0,te.jsx)("div",{className:"w-28 px-3 flex justify-start items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-start text-gray-800 text-sm font-normal leading-tight",children:x(e.amount,e.currency)})}),(0,te.jsx)("div",{className:"w-28 px-3 flex justify-start items-center gap-2.5",children:(0,te.jsx)("div",{className:`px-2 py-0.5 rounded-[100px] outline outline-1 outline-offset-[-1px] ${g(e.status).background} flex justify-center items-center gap-2.5`,children:(0,te.jsx)("div",{className:`justify-start text-xs font-medium leading-none ${g(e.status).text}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})})}),!t&&(0,te.jsx)("div",{className:"flex-1 px-3 flex justify-start items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-start text-gray-800 text-sm font-normal leading-tight",children:e.description||`${s.subscription_tier.charAt(0).toUpperCase()+s.subscription_tier.slice(1)} Plan`})}),(0,te.jsx)("div",{className:"w-6 h-6 rounded-md flex justify-center items-center gap-2.5",children:e.invoice_pdf||e.hosted_invoice_url?(0,te.jsx)("div",{className:"relative cursor-pointer hover:text-blue-600",onClick:()=>{return s=e.invoice_pdf||e.hosted_invoice_url,void window.open(s,"_blank");var s},title:"Download Invoice",children:(0,te.jsxs)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,te.jsx)("path",{d:"M8.5 10V2",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,te.jsx)("path",{d:"M14.5 10V12.6667C14.5 13.0203 14.3595 13.3594 14.1095 13.6095C13.8594 13.8595 13.5203 14 13.1667 14H3.83333C3.47971 14 3.14057 13.8595 2.89052 13.6095C2.64048 13.3594 2.5 13.0203 2.5 12.6667V10",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,te.jsx)("path",{d:"M5.1665 6.6665L8.49984 9.99984L11.8332 6.6665",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]})}):(0,te.jsx)("div",{className:"relative text-gray-400",title:"Invoice not available for download",children:(0,te.jsxs)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",opacity:"0.5",children:[(0,te.jsx)("path",{d:"M8.5 10V2",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,te.jsx)("path",{d:"M14.5 10V12.6667C14.5 13.0203 14.3595 13.3594 14.1095 13.6095C13.8594 13.8595 13.5203 14 13.1667 14H3.83333C3.47971 14 3.14057 13.8595 2.89052 13.6095C2.64048 13.3594 2.5 13.0203 2.5 12.6667V10",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,te.jsx)("path",{d:"M5.1665 6.6665L8.49984 9.99984L11.8332 6.6665",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]})})})]}),a<r.length-1&&(0,te.jsx)("div",{className:"w-full",children:(0,te.jsx)("svg",{width:"100%",height:"2",viewBox:"0 0 709 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full",children:(0,te.jsx)("path",{d:"M0.5 1H708.5",stroke:"#E4E4E7"})})})]},e.id);var n}))]})]})]})})}function qx(){const{activeWorkspace:e}=xe(),s=Ix(),{toast:t}=Fr(),[a,r]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(null);(0,Y.useEffect)((()=>{(async()=>{if(null!=e&&e.id)try{l(!0);let s=(await de.getWorkspaceInvoices(e.id)).invoices||[];r(s)}catch(s){o("Failed to load workspace billing history")}finally{l(!1)}})()}),[null==e?void 0:e.id]);const c=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"USD";return new Intl.NumberFormat("en-US",{style:"currency",currency:s}).format(e)},d=e=>{switch(e.toLowerCase()){case"paid":return{background:"outline-emerald-700",text:"text-emerald-700"};case"pending":case"open":return{background:"outline-orange-500",text:"text-orange-500"};case"failed":case"past_due":return{background:"outline-red-500",text:"text-red-500"};default:return{background:"outline-gray-500",text:"text-gray-500"}}};return(0,te.jsx)("div",{className:"self-stretch bg-white flex flex-col justify-start items-start h-full overflow-y-auto",style:{scrollbarGutter:"stable"},children:(0,te.jsxs)("div",{className:`w-full ${s?"px-5 pt-6":"px-10 pt-0"} pb-10 flex flex-col justify-start items-start gap-10`,children:[(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-3",children:[!s&&(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-center items-start gap-2",children:(0,te.jsx)("div",{className:"justify-start text-black text-base font-semibold leading-normal",children:"Plan & Billing"})}),(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-2",children:[(0,te.jsx)("div",{className:"self-stretch px-4 py-3 bg-white rounded-xl outline outline-1 outline-offset-[-1px] outline-gray-200 flex flex-col justify-start items-start gap-2.5",children:(0,te.jsxs)("div",{className:"self-stretch inline-flex justify-between items-center",children:[(0,te.jsxs)("div",{className:(s?"text-sm flex-1 pr-2":"text-base")+" justify-start text-text-default font-normal leading-normal",children:["Managing billing for ",(0,te.jsx)("strong",{children:(null==e?void 0:e.name)||"workspace"})]}),(0,te.jsxs)("div",{className:"flex justify-start items-center gap-2 flex-shrink-0",children:[!s&&"owner"===(null==e?void 0:e.user_role)&&(0,te.jsx)("div",{className:"inline-flex flex-col justify-start items-start",children:(0,te.jsx)("div",{className:"px-4 py-1.5 bg-bg-secondary rounded-md outline outline-1 outline-offset-[-1px] outline-zinc-200 flex flex-col justify-center items-center gap-2.5 cursor-pointer",onClick:async()=>{if(null!=e&&e.id)try{const s=await de.createWorkspacePortalSession(e.id);s.url&&window.open(s.url,"_blank")}catch(i){t({variant:"destructive",title:"Error",description:"Failed to open billing portal. Please try again later."})}},children:(0,te.jsx)("div",{className:"inline-flex justify-center items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-start text-text-default text-sm font-medium leading-tight",children:"Manage"})})})}),(0,te.jsx)("div",{className:"inline-flex flex-col justify-start items-start",children:(0,te.jsx)("div",{className:(s?"px-3 py-1.5":"px-4 py-1.5")+" bg-bg-secondary rounded-md outline outline-1 outline-offset-[-1px] outline-orange-500 flex flex-col justify-center items-center gap-2.5 cursor-pointer",onClick:()=>{null!=e&&e.id&&window.open(`/workspace/${e.id}`,"_blank")},children:(0,te.jsx)("div",{className:"inline-flex justify-center items-center gap-2.5",children:(0,te.jsx)("div",{className:`justify-start text-orange-500 ${s?"text-xs":"text-sm"} font-medium leading-tight`,children:"Add Seats"})})})})]})]})}),(0,te.jsx)("div",{className:`justify-start text-gray-600 ${s?"text-xs":"text-sm"} font-normal leading-tight`,children:null!=e&&e.subscription_period_end?`Workspace subscription renews on ${m=e.subscription_period_end,m?new Date(m).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A"}`:"No active workspace subscription"})]})]}),(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-6",children:[(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-center items-start gap-2",children:(0,te.jsx)("div",{className:"justify-start text-black text-base font-semibold leading-normal",children:"Billing History"})}),(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-4 pb-6 md:pb-8 lg:pb-10",children:[n&&(0,te.jsx)("div",{className:"self-stretch text-center text-gray-500 py-8",children:"Loading billing history..."}),i&&(0,te.jsx)("div",{className:"self-stretch text-center text-red-500 py-8",children:i}),!n&&!i&&0===a.length&&(0,te.jsx)("div",{className:"self-stretch text-center text-gray-500 py-8",children:"No billing history available"}),!n&&!i&&a.map(((e,t)=>{return(0,te.jsxs)(Y.Fragment,{children:[(0,te.jsxs)("div",{className:"w-full inline-flex justify-start items-center",children:[(0,te.jsx)("div",{className:"w-40 pr-3 flex justify-start items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-start text-gray-800 text-sm font-normal leading-tight",children:(r=e.date,new Date(1e3*r).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}))})}),(0,te.jsx)("div",{className:"w-28 px-3 flex justify-start items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-start text-gray-800 text-sm font-normal leading-tight",children:c(e.amount,e.currency)})}),(0,te.jsx)("div",{className:"w-28 px-3 flex justify-start items-center gap-2.5",children:(0,te.jsx)("div",{className:`px-2 py-0.5 rounded-[100px] outline outline-1 outline-offset-[-1px] ${d(e.status).background} flex justify-center items-center gap-2.5`,children:(0,te.jsx)("div",{className:`justify-start text-xs font-medium leading-none ${d(e.status).text}`,children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})})}),!s&&(0,te.jsx)("div",{className:"flex-1 px-3 flex justify-start items-center gap-2.5",children:(0,te.jsx)("div",{className:"justify-start text-gray-800 text-sm font-normal leading-tight",children:e.description||"Workspace Seats"})}),(0,te.jsx)("div",{className:"w-6 h-6 rounded-md flex justify-center items-center gap-2.5",children:e.invoice_pdf||e.hosted_invoice_url?(0,te.jsx)("div",{className:"relative cursor-pointer hover:text-blue-600",onClick:()=>{return s=e.invoice_pdf||e.hosted_invoice_url,void window.open(s,"_blank");var s},title:"Download Invoice",children:(0,te.jsxs)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,te.jsx)("path",{d:"M8.5 10V2",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,te.jsx)("path",{d:"M14.5 10V12.6667C14.5 13.0203 14.3595 13.3594 14.1095 13.6095C13.8594 13.8595 13.5203 14 13.1667 14H3.83333C3.47971 14 3.14057 13.8595 2.89052 13.6095C2.64048 13.3594 2.5 13.0203 2.5 12.6667V10",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,te.jsx)("path",{d:"M5.1665 6.6665L8.49984 9.99984L11.8332 6.6665",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]})}):(0,te.jsx)("div",{className:"relative text-gray-400",title:"Invoice not available for download",children:(0,te.jsxs)("svg",{width:"17",height:"16",viewBox:"0 0 17 16",fill:"none",xmlns:"http://www.w3.org/2000/svg",opacity:"0.5",children:[(0,te.jsx)("path",{d:"M8.5 10V2",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,te.jsx)("path",{d:"M14.5 10V12.6667C14.5 13.0203 14.3595 13.3594 14.1095 13.6095C13.8594 13.8595 13.5203 14 13.1667 14H3.83333C3.47971 14 3.14057 13.8595 2.89052 13.6095C2.64048 13.3594 2.5 13.0203 2.5 12.6667V10",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"}),(0,te.jsx)("path",{d:"M5.1665 6.6665L8.49984 9.99984L11.8332 6.6665",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round"})]})})})]}),t<a.length-1&&(0,te.jsx)("div",{className:"w-full",children:(0,te.jsx)("svg",{width:"100%",height:"2",viewBox:"0 0 709 2",fill:"none",xmlns:"http://www.w3.org/2000/svg",className:"w-full",children:(0,te.jsx)("path",{d:"M0.5 1H708.5",stroke:"#E4E4E7"})})})]},e.id);var r}))]})]})]})});var m}function Vx(){const{activeWorkspace:e}=xe(),s=Ix(),[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)(!0),[l,i]=(0,Y.useState)(null);(0,Y.useEffect)((()=>{(async()=>{if(null!=e&&e.id)try{n(!0);const s=await de.getMySeatInfo(e.id);a(s)}catch(s){i("Failed to load seat information")}finally{n(!1)}})()}),[null==e?void 0:e.id]);const o=e=>{if(null==e||!e.user_seat)return"No seat assigned";const{user_seat:s}=e;return"assigned"===s.status&&s.seat_type?`${s.seat_type} seat assigned`:"No seat assigned"},c=e=>"assigned"===e?{background:"outline-emerald-700",text:"text-emerald-700"}:{background:"outline-gray-500",text:"text-gray-500"};return(0,te.jsxs)("div",{className:`self-stretch ${s?"px-5 pt-6":"px-10"} bg-white flex flex-col justify-start items-start gap-10`,children:[!s&&(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-start items-start gap-3",children:(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-center items-start gap-2",children:(0,te.jsx)("div",{className:"justify-start text-black text-base font-semibold leading-normal",children:"Plan & Billing"})})}),r?(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-center items-center py-16",children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-t-2 border-b-2 border-slate-700"}),(0,te.jsx)("div",{className:"mt-4 text-gray-600",children:"Loading seat information..."})]}):l?(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-center items-center py-16",children:(0,te.jsx)("div",{className:"text-red-500 text-center",children:l})}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-4",children:[(0,te.jsx)("div",{className:"self-stretch px-4 py-3 bg-white rounded-xl outline outline-1 outline-offset-[-1px] outline-gray-200 flex flex-col justify-start items-start gap-2.5",children:(0,te.jsxs)("div",{className:"self-stretch inline-flex justify-between items-center",children:[(0,te.jsx)("div",{className:"justify-start text-text-default text-base font-normal leading-normal",children:(0,te.jsx)("strong",{children:(null==e?void 0:e.name)||"Workspace"})}),(0,te.jsx)("div",{className:"text-sm text-gray-600",children:(null==t?void 0:t.user_role)&&(0,te.jsxs)("span",{className:"capitalize",children:[t.user_role," access"]})})]})}),(0,te.jsx)("div",{className:"self-stretch px-4 py-3 bg-white rounded-xl outline outline-1 outline-offset-[-1px] outline-gray-200 flex flex-col justify-start items-start gap-2.5",children:(0,te.jsxs)("div",{className:"self-stretch inline-flex justify-between items-center",children:[(0,te.jsx)("div",{className:"justify-start text-text-default text-base font-normal leading-normal",children:o(t)}),(0,te.jsx)("div",{className:`px-2 py-0.5 rounded-[100px] outline outline-1 outline-offset-[-1px] ${c(null==t||null===(d=t.user_seat)||void 0===d?void 0:d.status).background} flex justify-center items-center gap-2.5`,children:(0,te.jsx)("div",{className:`justify-start text-xs font-medium leading-none ${c(null==t||null===(m=t.user_seat)||void 0===m?void 0:m.status).text}`,children:"assigned"===(null==t||null===(u=t.user_seat)||void 0===u?void 0:u.status)?"Active":"No Seat"})})]})}),"assigned"===(null==t||null===(x=t.user_seat)||void 0===x?void 0:x.status)&&(0,te.jsx)("div",{className:"self-stretch px-4 py-3 bg-white rounded-xl outline outline-1 outline-offset-[-1px] outline-gray-200 flex flex-col justify-start items-start gap-2.5",children:(0,te.jsxs)("div",{className:"self-stretch flex flex-col gap-2",children:[(0,te.jsx)("div",{className:"text-sm font-medium text-gray-700",children:"Seat Details"}),t.user_seat.seat_id&&(0,te.jsxs)("div",{className:"text-sm text-gray-600",children:["Seat ID: ",t.user_seat.seat_id]}),(0,te.jsxs)("div",{className:"text-sm text-gray-600",children:["Plan: ",t.user_seat.seat_type]})]})}),(null==e?void 0:e.subscription_period_end)&&(0,te.jsxs)("div",{className:"justify-start text-gray-600 text-sm font-normal leading-tight",children:["Workspace subscription renews on ",(p=e.subscription_period_end,p?new Date(p).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric"}):"N/A")]})]}),(null==t?void 0:t.workspace_admins)&&t.workspace_admins.length>0&&(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-6",children:[(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-center items-start gap-2",children:(0,te.jsx)("div",{className:"justify-start text-black text-base font-semibold leading-normal",children:"Workspace Administrators"})}),(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-4",children:[(0,te.jsx)("div",{className:"justify-start text-gray-600 text-sm font-normal leading-tight",children:"Contact your workspace administrators for seat assignments:"}),(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-start items-start gap-2",children:t.workspace_admins.map(((e,s)=>(0,te.jsxs)("div",{className:"self-stretch px-4 py-2 bg-gray-50 rounded-lg flex justify-between items-center",children:[(0,te.jsx)("div",{className:"text-sm text-gray-800",children:e.email}),(0,te.jsx)("div",{className:"text-xs text-gray-600 capitalize",children:e.role})]},e.email)))})]})]}),"assigned"!==(null==t||null===(h=t.user_seat)||void 0===h?void 0:h.status)&&(0,te.jsxs)("div",{className:"self-stretch flex flex-col justify-start items-start gap-6",children:[(0,te.jsx)("div",{className:"self-stretch flex flex-col justify-center items-start gap-2",children:(0,te.jsx)("div",{className:"justify-start text-black text-base font-semibold leading-normal",children:"Need a Seat?"})}),(0,te.jsx)("div",{className:"self-stretch px-4 py-3 bg-blue-50 rounded-xl outline outline-1 outline-offset-[-1px] outline-blue-200 flex flex-col justify-start items-start gap-2.5",children:(0,te.jsx)("div",{className:"text-sm text-blue-800",children:"You don't currently have a seat assigned in this workspace. Contact your workspace administrators to request a seat assignment."})})]})]})]});var d,m,u,x,h,p}function Yx(){const{user:e}=ne(),{activeWorkspace:s}=xe();if(s&&!s.is_personal){return s.user_role&&["admin","owner"].includes(s.user_role)?(0,te.jsx)(qx,{}):(0,te.jsx)(Vx,{})}return e.stripe_customer_id||e.stripe_subscription_status?(0,te.jsx)(Wx,{}):(0,te.jsx)(Bx,{})}const Hx={WORKSPACE:"workspace",ACCOUNT:"account",PLAN_BILLING:"plan-billing"},Gx=[{key:Hx.WORKSPACE,label:"Workspace"},{key:Hx.PLAN_BILLING,label:"Plan & Billing"},{key:Hx.ACCOUNT,label:"Account"}];function Jx(e){let{isOpen:s,onClose:t}=e;const[a,r]=(0,Y.useState)(Hx.WORKSPACE),[n,l]=(0,Y.useState)("sidebar"),[i,o]=(0,Y.useState)(0),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(0),[x,h]=(0,Y.useState)(!1),p=(0,Y.useRef)(0),g=(0,Y.useRef)(0),f=(0,Y.useRef)(null),v=Ix();(0,Y.useEffect)((()=>{if(v){const e=()=>{const e=.01*window.innerHeight;document.documentElement.style.setProperty("--vh",`${e}px`)};return e(),window.addEventListener("resize",e),window.addEventListener("orientationchange",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("orientationchange",e)}}}),[v]),(0,Y.useEffect)((()=>{if(v&&s){const e=window.getComputedStyle(document.body).overflow;return document.body.style.overflow="hidden",document.body.style.position="fixed",document.body.style.width="100%",document.body.style.height="100%",()=>{document.body.style.overflow=e,document.body.style.position="",document.body.style.width="",document.body.style.height=""}}}),[v,s]);const j=e=>{r(e),v&&l("content")},b=()=>{l("sidebar")},y=()=>{v&&(l("sidebar"),o(0),d(!1),u(0),h(!1),f.current=null),t()},N=(0,Y.useCallback)((e=>{v&&(e.stopPropagation(),p.current=e.touches[0].clientY,d(!0))}),[v]),w=(0,Y.useCallback)((e=>{if(!v||!c)return;e.preventDefault(),e.stopPropagation();const s=e.touches[0].clientY-p.current;s>0&&o(s)}),[v,c]),k=(0,Y.useCallback)((e=>{v&&c&&(e.stopPropagation(),d(!1),i>150?y():o(0))}),[v,c,i,y]),_=(0,Y.useCallback)((e=>{v&&"content"===n&&(e.stopPropagation(),g.current=e.touches[0].clientX,p.current=e.touches[0].clientY,f.current=null)}),[v,n]),S=(0,Y.useCallback)((e=>{if(!v||"content"!==n)return;const s=e.touches[0].clientX,t=e.touches[0].clientY,a=s-g.current,r=t-p.current;null===f.current&&(Math.abs(a)>10||Math.abs(r)>10)&&(f.current=Math.abs(a)>Math.abs(r)?"horizontal":"vertical"),"horizontal"===f.current&&(e.preventDefault(),e.stopPropagation(),x||h(!0),a>0&&u(a))}),[v,n,x]),C=(0,Y.useCallback)((e=>{v&&"content"===n&&(e.stopPropagation(),x&&(h(!1),m>100&&b(),u(0)),f.current=null)}),[v,n,x,m,b]),A=()=>{switch(a){case Hx.WORKSPACE:return(0,te.jsx)(Ox,{});case Hx.ACCOUNT:return(0,te.jsx)(Ux,{});case Hx.PLAN_BILLING:return(0,te.jsx)(Yx,{});default:return(0,te.jsx)(Ox,{})}};var E;return v?(0,te.jsxs)(na,{open:s,onOpenChange:y,children:[(0,te.jsx)("div",{className:"fixed inset-0 z-50 bg-black/80 transition-opacity duration-300",style:{opacity:s?.8:0,pointerEvents:s?"auto":"none",touchAction:"none"},onTouchStart:e=>e.preventDefault(),onTouchMove:e=>e.preventDefault(),onTouchEnd:e=>e.preventDefault()}),(0,te.jsx)("div",{className:"fixed inset-x-0 bottom-0 z-50 w-full transform-gpu",style:{height:"calc(var(--vh, 1vh) * 90)",maxHeight:"calc(var(--vh, 1vh) * 90)",transform:`translateY(${s?`${i}px`:"100%"})`,transition:c?"none":"transform 0.3s ease-out",touchAction:"none"},onTouchStart:N,onTouchMove:w,onTouchEnd:k,children:(0,te.jsxs)("div",{className:"w-full h-full bg-white rounded-t-xl flex flex-col overflow-hidden relative",children:[(0,te.jsx)("div",{className:"w-full flex justify-center pt-2 pb-1",children:(0,te.jsx)("div",{className:"w-10 h-1 bg-gray-300 rounded-full"})}),(0,te.jsx)("div",{className:"flex-shrink-0 px-3 py-3 bg-white border-b border-gray-200 flex items-center justify-center relative",children:"sidebar"===n?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"text-black text-lg font-bold",children:"Settings"}),(0,te.jsx)("button",{onClick:y,className:"absolute right-3 w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full",children:(0,te.jsx)(Ds.A,{size:18})})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{className:"absolute left-3 flex items-center",children:[(0,te.jsx)("button",{onClick:b,className:"w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full",children:(0,te.jsx)($t.A,{size:18})}),(0,te.jsx)("button",{onClick:b,className:"text-gray-600 text-sm font-medium hover:text-gray-800 transition-colors -ml-1.5",children:"Settings"})]}),(0,te.jsx)("div",{className:"text-black text-lg font-bold",children:null===(E=Gx.find((e=>e.key===a)))||void 0===E?void 0:E.label}),(0,te.jsx)("button",{onClick:y,className:"absolute right-3 w-8 h-8 flex items-center justify-center hover:bg-gray-100 rounded-full",children:(0,te.jsx)(Ds.A,{size:18})})]})}),(0,te.jsxs)("div",{className:"flex-1 overflow-hidden relative",children:[x&&m>0&&(0,te.jsx)("div",{className:"absolute inset-0 bg-black/10 z-10 pointer-events-none",style:{opacity:Math.min(m/100,.3)}}),(0,te.jsxs)("div",{className:"flex w-[200%] h-full transition-transform duration-300 ease-in-out",style:{transform:"sidebar"===n?"translateX(0%)":`translateX(calc(-50% + ${m}px))`,transition:x?"none":"transform 0.3s ease-in-out"},children:[(0,te.jsx)("div",{className:"w-1/2 h-full overflow-y-auto",children:(0,te.jsx)("div",{className:"flex flex-col space-y-2 px-2 py-4",children:Gx.map((e=>(0,te.jsxs)("button",{onClick:()=>j(e.key),className:"px-4 py-4 rounded-xl flex items-center justify-between text-left transition-all active:scale-95 text-gray-700 font-medium hover:bg-gray-100 active:bg-gray-200",children:[(0,te.jsx)("div",{className:"text-base",children:e.label}),(0,te.jsx)(pr.A,{size:20,className:"text-gray-400"})]},e.key)))})}),(0,te.jsxs)("div",{className:"w-1/2 h-full relative",onTouchStart:_,onTouchMove:S,onTouchEnd:C,children:["content"===n&&!x&&(0,te.jsx)("div",{className:"absolute left-0 top-1/2 transform -translate-y-1/2 w-1 h-12 bg-gray-300 rounded-r-full opacity-30 z-20"}),A()]})]})]})]})})]}):(0,te.jsx)(na,{open:s,onOpenChange:y,children:(0,te.jsx)(da,{className:"max-w-6xl w-[90vw] max-w-[1000px] h-[90vh] p-0 [&>button]:hidden",children:(0,te.jsxs)("div",{className:"w-full h-full bg-white rounded-xl flex overflow-hidden",children:[(0,te.jsxs)("div",{className:"w-52 flex-shrink-0 bg-gray-50 border-r border-gray-200 flex flex-col",children:[(0,te.jsx)("div",{className:"px-4 py-6 flex items-center",children:(0,te.jsx)("div",{className:"text-black text-lg font-bold",children:"Settings"})}),(0,te.jsx)("div",{className:"flex flex-col space-y-1 px-3",children:Gx.map((e=>(0,te.jsx)("button",{onClick:()=>j(e.key),className:"p-3 rounded-md flex items-center text-left transition-colors "+(a===e.key?"bg-gray-100 text-black font-semibold":"text-gray-600 font-medium hover:bg-gray-100"),children:(0,te.jsx)("div",{className:"text-sm",children:e.label})},e.key)))})]}),(0,te.jsxs)("div",{className:"flex-1 flex flex-col min-w-0",children:[(0,te.jsx)("div",{className:"flex-shrink-0 p-3 bg-white flex justify-end items-center",children:(0,te.jsx)("button",{onClick:y,className:"w-6 h-6 flex items-center justify-center hover:bg-gray-100 rounded",children:(0,te.jsx)(Ds.A,{size:16})})}),(0,te.jsx)("div",{className:"flex-1 min-h-0",children:A()})]})]})})})}const Zx=e=>{let{app:s,currentUsage:t,onShareModalOpen:a,onLogout:r,user:n}=e;const[l,i]=(0,Y.useState)(!1),o="Upgrade Plan",c=e=>{var t,a;Se("User clicked upgrade",{app_id:(null==s?void 0:s.id)||null,user_id:(null==n?void 0:n.id)||null,conversation_id:(null==s||null===(t=s.conversation)||void 0===t?void 0:t.id)||null,cta:e,origin:"editor account menu",target_route:"/billing"}),Fe({user_id:(null==n?void 0:n.id)||null,app_id:(null==s?void 0:s.id)||null,conversation_id:(null==s||null===(a=s.conversation)||void 0===a?void 0:a.id)||null},{cta:e,origin:"editor account menu",target_route:"/billing"})};return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)(wx,{children:[(0,te.jsx)(kx,{asChild:!0,children:(0,te.jsxs)("div",{className:"flex items-center gap-3 cursor-pointer flex-1 p-1 rounded-md hover:bg-gray-200 transition-colors",children:[(0,te.jsx)(bx,{className:"h-6 w-6 rounded-xl",children:(0,te.jsx)(yx,{src:Ye,alt:"Base44"})}),(0,te.jsx)("div",{className:"flex-1 min-w-0",children:(0,te.jsx)(ct.A,{className:"h-4 w-4 text-muted-foreground"})})]})}),(0,te.jsxs)(_x,{align:"start",className:"w-[240px] p-2 shadow-lg border border-slate-200 rounded-lg",children:[(0,te.jsx)(Sx,{asChild:!0,children:(0,te.jsxs)(J.Link,{to:"/",className:"flex items-center gap-2 cursor-pointer",children:[(0,te.jsx)($t.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Back to Workspace"})]})}),(0,te.jsx)(Ax,{}),(0,te.jsx)(Cx,{asChild:!0,children:(0,te.jsx)("div",{className:"px-2 py-1.5 text-gray-500",children:null==n?void 0:n.email})}),t&&(0,te.jsxs)("div",{className:"border border-slate-200 rounded-[10px] p-2 my-2",children:[(0,te.jsx)(Cx,{children:(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsx)("span",{children:"Credits"}),(0,te.jsx)("span",{className:"text-xs bg-slate-100 px-2 py-0.5 rounded",children:t.tier.charAt(0).toUpperCase()+t.tier.slice(1).toLowerCase()})]})}),(0,te.jsxs)("div",{className:"px-2 py-1.5",children:[(0,te.jsxs)("div",{className:"flex justify-between text-xs mb-1",children:[(0,te.jsx)("span",{children:"Monthly Credits"}),(0,te.jsxs)("span",{children:[(d=t.monthly_usage,d%1==0?d:d.toFixed(1)),"/",t.monthly_limit,t.extra_credits>0&&` (+${t.extra_credits})`]})]}),(0,te.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:(0,te.jsx)("div",{className:"h-1.5 rounded-full "+(t.is_over_limit?"bg-red-500":"bg-primary"),style:{width:`${Math.min(t.monthly_usage/t.monthly_limit*100,100)}%`}})})]}),t.daily_limit&&(0,te.jsx)("div",{className:"px-2 py-1.5",children:(0,te.jsxs)("div",{className:"flex justify-between text-xs",children:[(0,te.jsx)("span",{children:"Daily Credits"}),(0,te.jsxs)("span",{children:[t.daily_usage,"/",t.daily_limit]})]})}),(0,te.jsxs)("div",{className:"px-2 pb-1 text-xs text-muted-foreground",children:["Credits renew on: ",t.next_period_start_date]})]}),t&&a&&(0,te.jsxs)("div",{className:"border border-blue-200 rounded-[10px] h-10 flex items-center px-3 my-2 cursor-pointer bg-blue-50 hover:bg-blue-100",onClick:a,children:[(0,te.jsx)(gx.A,{className:"h-4 w-4 mr-2 text-blue-600"}),(0,te.jsx)("span",{className:"text-sm flex-1 text-blue-600",children:"Win Free Credits"}),(0,te.jsx)(pr.A,{className:"h-4 w-4 text-blue-600"})]}),(0,te.jsx)(Ax,{}),(0,te.jsx)(Sx,{asChild:!0,children:(0,te.jsxs)(J.Link,{to:"https://docs.base44.com",className:"flex items-center gap-2 cursor-pointer",target:"_blank",children:[(0,te.jsx)(fx.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Documentation"})]})}),(0,te.jsxs)(Sx,{onClick:()=>i(!0),className:"flex items-center gap-2 cursor-pointer",children:[(0,te.jsx)(Vi.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Settings"})]}),(0,te.jsx)(Sx,{asChild:!0,children:(0,te.jsxs)(J.Link,{target:"_blank",onClick:()=>c("Billing"),to:"/billing",className:"flex items-center gap-2 cursor-pointer",children:[(0,te.jsx)(Ze.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Billing"})]})}),(0,te.jsx)(Sx,{asChild:!0,children:(0,te.jsxs)(J.Link,{target:"_blank",to:`/support?appId=${null==s?void 0:s.id}`,className:"flex items-center gap-2 cursor-pointer",children:[(0,te.jsx)(rl.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Help Center"})]})}),(0,te.jsx)(Sx,{asChild:!0,children:(0,te.jsxs)(J.Link,{target:"_blank",to:"/billing",className:"flex items-center gap-2 cursor-pointer",onClick:()=>c(o),children:[(0,te.jsx)(vx.A,{className:"h-4 w-4 text-orange-600 group-hover:text-orange-700"}),(0,te.jsx)("span",{className:"text-orange-600 group-hover:text-orange-700",children:o})]})}),(0,te.jsx)(Ax,{}),(0,te.jsxs)(Sx,{onClick:r,className:"flex items-center gap-2 cursor-pointer text-gray-800 hover:bg-gray-100",children:[(0,te.jsx)(jx.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Sign Out"})]})]})]}),(0,te.jsx)(Jx,{isOpen:l,onClose:()=>i(!1)})]});var d},Kx={"#130":"Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: %s. This often happens due to incorrect import/export statements. Check default vs named exports.","#310":"Rendered more hooks than during the previous render. Never call hooks inside conditionals/loops/early returns. Hooks must be called in the same order every render.","#31":"Objects are not valid as a React child. If you meant to render a collection of children, use an array instead.","#185":"Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.","#300":"Cannot update a component while rendering a different component. To locate the bad setState() call, follow the stack trace.","#301":"Rendered fewer hooks than expected. This may be caused by an accidental early return statement.","#181":"Invalid hook call. Hooks can only be called inside of the body of a function component. Check for: 1) Mismatching versions of React and React DOM, 2) Breaking the Rules of Hooks, 3) Multiple copies of React.","#321":"Invalid argument passed as callback. Expected a function. Instead received: %s.","#60":"ReactDOM.render(): Invalid component element. Instead of passing a string like 'div', pass React.createElement('div').","#62":"The root container is not a DOM element."},Xx=e=>{if(e.title&&e.title.includes("Minified React error"))for(const[s,t]of Object.entries(Kx))if(e.title.includes(`Minified React error ${s}`))return{...e,details:t};return e},Qx=e=>{let{children:s,menuControl:t,toggleControl:a,actionControl:r,isMobile:n}=e;return n?(0,te.jsxs)("div",{className:"flex flex-col h-full overflow-hidden",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[(0,te.jsx)("div",{className:"w-[60px] flex justify-start",children:(0,te.jsx)(eh,{})}),(0,te.jsx)("div",{className:"flex-1 flex justify-center",children:a}),(0,te.jsx)("div",{className:"w-[60px] flex justify-end",children:r})]}),(0,te.jsx)("div",{className:"flex-1 overflow-auto",children:s})]}):(0,te.jsxs)("div",{className:"flex flex-col h-full overflow-hidden pr-2",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between py-1",children:[(0,te.jsx)("div",{className:"flex items-center gap-2",children:t}),(0,te.jsx)("div",{children:r})]}),(0,te.jsx)("div",{className:"flex-1 overflow-auto border border-slate-200 rounded-[10px] mb-2",children:s})]})},eh=()=>{const{app:e,currentUsage:s}=vs(),{logout:t,user:a}=ne(),r=(0,Z.Zp)();return(0,te.jsx)(Zx,{app:e,currentUsage:s,onShareModalOpen:null,onLogout:()=>{t(),r("/login")},user:a})};function sh(e){var s,t;let{view:a,selectedCheckpoint:r,setSelectedCheckpoint:n,isLeftPanelHidden:l,toggleLeftPanel:i}=e;const{user:o}=ne(),{app:c,updateApp:d,undoMessage:m,appErrors:u,addChatMessage:x,setAppErrors:h,onAppError:p,runtimeAuthToken:g}=vs(),f=(0,Y.useRef)(null),[v,j]=(0,Y.useState)(!1),[b,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(!1),k=(0,Z.Zp)(),_=(0,Xe.Ub)({maxWidth:767}),[S,C]=(0,Y.useState)(!1),A=e=>{if(f.current){const s=e||f.current.src;f.current.src="",setTimeout((()=>{f.current&&(f.current.src=s)}),50)}};(0,Y.useEffect)((()=>{var e,s;r?"workspace"===a.toLowerCase()?k(`/apps/${c.id}/editor/preview/${c.main_page}`):A(I()):(null===(e=c.conversation)||void 0===e||null===(s=e.messages)||void 0===s?void 0:s.length)<=2?setTimeout((()=>{A(I())}),1e3):A(I())}),[r,a,c.app_code_hash]);const E=async()=>{if(window.confirm("Are you sure you want to restore this checkpoint? This action is irreversible.")){w(!0);try{await ar.loadCheckpoint(c.id,r.id),n(void 0)}catch(e){}finally{w(!1)}}};function I(){const e=window.location.pathname.split("/preview")[1],s=r?function(e,s){return Kt(`checkpoint--${e.id}--${s.id}`)}(c,r):function(e){return Kt(`preview--${e.slug}`)}(c);return`${s}${e}?${new URLSearchParams({access_token:g,hide_badge:"true"}).toString()}`}(0,Y.useEffect)((()=>{if(c.slug&&f.current&&!f.current.src.includes(c.slug)){const e=I();f.current.src=e,setTimeout((()=>{f.current&&(f.current.src=e)}),50)}return window.addEventListener("message",T),()=>{window.removeEventListener("message",T)}}),[c.slug,null==f?void 0:f.current]);const L=async()=>{j(!0);const e=`the following errors happened in the app:\n${u.map((e=>(e=>{const s=Xx(e),t=ss().escape(s.title),a=ss().escape(s.details||"no details");return ss().escape(s.componentName),`\n\n<error title="${t}" details="${a}"></error>\n\n`})(e))).join("\n\n")}\n---\nplease help me fix these errors`;(async e=>{try{var s,t;Se("User clicked resolve with AI",{user_id:(null==o?void 0:o.id)||null,app_id:c.id,app_name:c.name,conversation_id:(null==c||null===(s=c.conversation)||void 0===s?void 0:s.id)||null,error_message:e}),Fe({user_id:(null==o?void 0:o.id)||null,app_id:(null==c?void 0:c.id)||null,conversation_id:(null==c||null===(t=c.conversation)||void 0===t?void 0:t.id)||null},{cta:"resolve with ai",origin:"editor",target_route:"same_page",error_message:e})}catch(a){}})(e),await x({role:"user",content:e}),j(!1)},T=e=>{var s,t;if("app_error"===(null===(s=e.data)||void 0===s?void 0:s.type)&&e.data.error&&p(e.data.error.title,e.data.error.details,e.data.error.componentName),"app_changed_url"===(null===(t=e.data)||void 0===t?void 0:t.type)&&e.data.url&&window.location.href.includes("/preview")){const s=new URL(e.data.url),t=s.pathname,a=new URLSearchParams(s.search);a.delete("access_token"),a.delete("hide_badge");let r=t;if(t.startsWith("/apps"))return r="/"+t.split("/").pop(),r.includes(`${c.slug}`)?void 0:void k(`/apps/${c.id}/editor/preview${r}`);"/"===t||t===`/${c.slug}`?r=`/apps/${c.id}/editor/preview/${c.main_page}`:t.startsWith("/apps")||t.includes(`${c.slug}`)||(r=`/apps/${c.id}/editor/preview${t}`);const n=a.toString();n&&(r+=`?${n}`),_||k(r)}},$=(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[!_&&(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)("button",{onClick:i,className:"p-1.5 text-gray-500 hover:bg-gray-200 rounded-md transition-colors",children:l?(0,te.jsx)(Eu.A,{size:16}):(0,te.jsx)(Iu.A,{size:16})})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:l?"Show chat panel":"Hide chat panel"})})]}),(0,te.jsx)("div",{className:"h-6 w-[1px] bg-gray-300"})]}),(0,te.jsx)(lr,{value:"preview"===a?"preview":"workspace",onValueChange:e=>{"workspace"===e.toLowerCase()?k(`/apps/${c.id}/editor/workspace/overview`):k(`/apps/${c.id}/editor/preview/${c.main_page}`)},children:(0,te.jsxs)(ir,{className:"h-7 rounded-lg",children:[(0,te.jsx)(or,{value:"workspace",className:"h-6 rounded-md cursor-pointer",children:"Dashboard"}),(0,te.jsx)("div",{className:"h-6 w-[2px] bg-gray-100"}),(0,te.jsx)(or,{value:"preview",className:"h-6 rounded-md cursor-pointer",children:"Preview"})]})}),!_&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{children:(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)("button",{onClick:()=>A(),className:"p-1.5 text-gray-500 hover:bg-gray-200 rounded-md transition-colors",children:(0,te.jsx)($c.A,{size:16})})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Refresh preview"})})]})}),(0,te.jsx)("div",{children:"preview"===a&&(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)(lr,{defaultValue:S?"mobile":"desktop",children:(0,te.jsxs)(ir,{className:"h-7 rounded-lg",children:[(0,te.jsx)(or,{value:"desktop",onClick:()=>C(!1),className:"h-6 rounded-md",children:(0,te.jsx)(Lu.A,{size:15})}),(0,te.jsx)("div",{className:"h-6 w-[2px] bg-gray-100"}),(0,te.jsx)(or,{value:"mobile",onClick:()=>C(!0),className:"h-6 rounded-md",children:(0,te.jsx)(Tu.A,{size:15})})]})})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:S?"Switch to desktop view":"Switch to mobile view"})})]})})]})]}),D=(0,te.jsx)("div",{className:"flex items-center gap-2",children:(0,te.jsxs)(ws,{children:[(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)(Zu,{})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Network requests"})})]}),(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)(Fu,{showFiles:"preview"===a})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Github & code editing"})})]}),(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:(0,te.jsx)(Rs,{onClick:()=>y(!0),variant:"outline",size:"sm",className:"gap-2",children:"Share"})}),(0,te.jsx)(Ss,{children:(0,te.jsx)("p",{children:"Share app"})})]}),(0,te.jsx)(px,{app:c,updateApp:d})]})}),P=(0,te.jsxs)("div",{className:"flex items-center gap-4 py-2",children:[(0,te.jsx)("p",{className:"text-sm font-medium",children:"Viewing checkpoint version"}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Rs,{variant:"outline",size:"sm",className:"h-8",onClick:E,disabled:N,children:N?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($u.A,{className:"mr-2 h-3 w-3 animate-spin"}),"Restoring..."]}):"Restore this version"}),(0,te.jsx)(Rs,{variant:"secondary",size:"sm",className:"h-8",onClick:()=>n(void 0),disabled:N,children:"Exit"})]})]}),M=(0,te.jsx)("div",{className:"flex items-center",children:(0,te.jsx)(px,{app:c,isMobile:"icon"})});return(0,te.jsxs)("div",{className:"flex-grow h-full overflow-y-auto",children:[(0,te.jsx)(Qx,{isMobile:_,menuControl:_||r?null:$,toggleControl:_?$:null,actionControl:_?M:r?P:D,children:"preview"===a?(0,te.jsx)("div",{className:"w-full h-full flex justify-center "+(S?"items-start pt-4":""),children:(0,te.jsx)("iframe",{title:"App Preview",allow:"accelerometer; autoplay; camera; encrypted-media; fullscreen; geolocation; gyroscope; microphone; midi; clipboard-read; clipboard-write; payment; usb; vr; xr-spatial-tracking; screen-wake-lock; magnetometer; ambient-light-sensor; battery; gamepad; picture-in-picture; display-capture; bluetooth;",ref:f,id:"preview-iframe",className:"transition-all duration-300 ease-in-out "+(S?"w-[375px] h-[667px] border border-gray-300 rounded-xl shadow-md":"w-full h-full"),style:_&&!S?{height:"100vh"}:{}})}):(0,te.jsx)(Au,{})}),(0,te.jsx)(kc,{isVisible:b,onCancel:()=>y(!1),onInviteSuccess:()=>y(!1)}),r&&!_&&(0,te.jsx)("div",{className:"fixed top-0 left-0 right-0 z-50 bg-slate-50",children:(0,te.jsx)("div",{className:"max-w-4xl mx-auto px-4 pt-2",children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)("div",{className:"w-2 h-2 bg-orange-400 rounded-full"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-800",children:"Viewing Version History"}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:r.title})]})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Rs,{variant:"outline",size:"sm",className:"h-8 text-xs",onClick:E,disabled:N,children:N?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($u.A,{className:"mr-2 h-3 w-3 animate-spin"}),"Restoring..."]}):"Restore This Version"}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",className:"h-8 text-xs text-slate-600",onClick:()=>n(void 0),disabled:N,children:"Exit"})]})]})})}),u.length>0&&(0,te.jsx)("div",{className:`fixed ${_?"bottom-2 right-2 left-2 z-50 max-w-full":"bottom-4 right-4 z-50 max-w-md"} bg-white rounded-lg shadow-xl p-4 border border-gray-100`,children:(0,te.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsx)("div",{className:"font-medium text-gray-800",children:"Issues Found"}),(0,te.jsx)("button",{onClick:()=>h([]),className:"p-1 hover:bg-gray-100 rounded-md",children:(0,te.jsx)(Ds.A,{size:16})})]}),u.map((e=>(0,te.jsxs)("div",{className:"text-sm text-gray-600",children:[e.componentName&&(0,te.jsxs)("div",{className:"text-xs text-gray-500 mb-1",children:["In ",e.componentName," component:"]}),e.title]},e.title))),(0,te.jsx)("button",{onClick:()=>L(),disabled:"processing"===(null===(s=c.status)||void 0===s?void 0:s.state)||v,className:"px-4 py-2 bg-gray-900 hover:bg-gray-800 text-white text-sm rounded-md transition-colors mt-2 "+("processing"===(null===(t=c.status)||void 0===t?void 0:t.state)?"opacity-50 cursor-not-allowed":""),children:"Resolve with AI"}),"free"!==o.subscription_tier&&(0,te.jsx)("div",{className:"text-xs text-gray-500 mt-1 italic",children:"This action won't deduct credits from your account."})]})})]})}var th=t(28017);const ah=e=>{try{const s=er(e,"action_group");if(s.length>0)for(const e of s){const s=e.openingTag.match(/title=["']([^"']*)["']/i);if(s&&s[1])return s[1]}const t=/# (.*)/,a=e.match(t);if(a)return a[1]}catch(s){}return"Untitled Version"},rh=e=>{let{onClose:s,selectedCheckpoint:t,onSelectCheckpoint:a}=e;const{app:r}=vs(),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)([]),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!0);(0,Y.useEffect)((()=>{!async function(){try{h(!0);const e=await ar.listCheckpoints(r.id),s=r.conversation.messages.filter((e=>e.checkpoint_id&&e.content.includes("action_group"))),t=s.map((e=>e.checkpoint_id));let a={};e.forEach((e=>{a[e.id]=e}));const n=s.map((e=>{var s,t;return{id:e.checkpoint_id,timestamp:(null===(s=e.metadata)||void 0===s?void 0:s.created_date)||(new Date).toISOString(),title:(null===(t=a[e.checkpoint_id])||void 0===t?void 0:t.name)||ah(e.content)}})).reverse();o(n);const l=e.filter((e=>!t.includes(e.id)));d(l.map((e=>({id:e.id,timestamp:e.created_date,title:e.name}))))}catch(e){}finally{h(!1)}}()}),[]);const p=e=>{const s=Bt().utc(e);return{relative:s.fromNow(),absolute:s.format("MMM D, YYYY [at] h:mm A")}},g=e=>{a(e)};return x?(0,te.jsxs)("div",{className:"flex flex-col h-full p-4",children:[(0,te.jsxs)("div",{className:"flex items-center mb-4",children:[(0,te.jsx)(Rs,{variant:"ghost",size:"icon",onClick:s,children:(0,te.jsx)(pi.A,{className:"h-4 w-4"})}),(0,te.jsx)("h2",{className:"text-lg font-semibold ml-2",children:"Version History"})]}),(0,te.jsx)("div",{className:"space-y-4",children:[1,2,3].map((e=>(0,te.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 animate-pulse",children:[(0,te.jsx)("div",{className:"h-4 bg-gray-200 dark:bg-gray-700 rounded mb-2 w-3/4"}),(0,te.jsx)("div",{className:"h-3 bg-gray-200 dark:bg-gray-700 rounded w-1/2"})]},e)))})]}):(0,te.jsxs)("div",{className:"flex flex-col h-full p-4",children:[(0,te.jsxs)("div",{className:"flex items-center mb-4",children:[(0,te.jsx)(Rs,{variant:"ghost",size:"icon",onClick:s,children:(0,te.jsx)(pi.A,{className:"h-4 w-4"})}),(0,te.jsx)("h2",{className:"text-lg font-semibold ml-2",children:"Version History"})]}),(0,te.jsx)("div",{className:"space-y-4",children:i.map((e=>{const{relative:s,absolute:a}=p(e.timestamp);return(0,te.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-4 relative cursor-pointer transition-all "+((null==t?void 0:t.id)===e.id?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"hover:border-blue-200 dark:hover:border-blue-800 hover:bg-gray-50 dark:hover:bg-gray-800/50"),onClick:()=>g(e),children:[(0,te.jsx)("div",{className:"mb-2 font-medium pr-8",children:e.title}),(0,te.jsxs)("div",{className:"text-xs text-gray-400",children:[(0,te.jsx)("div",{className:"font-medium",children:s}),(0,te.jsx)("div",{className:"opacity-75",children:a})]}),(null==t?void 0:t.id)===e.id&&(0,te.jsx)("div",{className:"absolute top-2 right-2",children:(0,te.jsx)(mt.A,{className:"h-4 w-4 text-blue-500"})})]},e.id)}))}),c.length>0&&(0,te.jsxs)("div",{className:"mt-6 pt-4 border-t border-gray-200 dark:border-gray-700",children:[(0,te.jsx)(Rs,{variant:"ghost",className:"w-full justify-start p-3 h-auto text-left hover:bg-gray-50 dark:hover:bg-gray-800/50",onClick:()=>u(!m),children:(0,te.jsxs)("div",{className:"flex items-start justify-between w-full",children:[(0,te.jsxs)("div",{className:"flex-1 min-w-0 mr-3",children:[(0,te.jsx)("div",{className:"font-medium text-sm mb-1",children:"Alternative Versions"}),(0,te.jsxs)("div",{className:"text-xs text-gray-500 leading-relaxed",children:["These versions may be from alternative paths,",(0,te.jsx)("br",{}),"created when reverting to previous checkpoints"]})]}),(0,te.jsx)("div",{className:"flex-shrink-0 ml-2",children:m?(0,te.jsx)(ct.A,{className:"h-4 w-4 text-gray-400"}):(0,te.jsx)(pr.A,{className:"h-4 w-4 text-gray-400"})})]})}),m&&(0,te.jsx)("div",{className:"space-y-2 mt-3",children:c.map((e=>{const{relative:s,absolute:a}=p(e.timestamp);return(0,te.jsxs)("div",{className:"border border-gray-200 dark:border-gray-700 rounded-lg p-3 relative cursor-pointer transition-all "+((null==t?void 0:t.id)===e.id?"bg-blue-50 dark:bg-blue-900/20 border-blue-200 dark:border-blue-800":"hover:border-blue-200 dark:hover:border-blue-800 hover:bg-gray-50 dark:hover:bg-gray-800/50"),onClick:()=>g(e),children:[(0,te.jsx)("div",{className:"mb-2 font-medium text-sm pr-8",children:e.title}),(0,te.jsxs)("div",{className:"text-xs text-gray-400",children:[(0,te.jsx)("div",{className:"font-medium",children:s}),(0,te.jsx)("div",{className:"opacity-75",children:a})]}),(null==t?void 0:t.id)===e.id&&(0,te.jsx)("div",{className:"absolute top-2 right-2",children:(0,te.jsx)(mt.A,{className:"h-4 w-4 text-blue-500"})})]},e.id)}))})]}),(0,te.jsx)(Bm,{open:n,onOpenChange:l,children:(0,te.jsxs)(Ym,{children:[(0,te.jsxs)(Hm,{children:[(0,te.jsx)(Jm,{children:"Are you sure?"}),(0,te.jsxs)(Zm,{children:['This action is irreversible. Your app will be reverted to "',null==t?void 0:t.title,'".']})]}),(0,te.jsxs)(Gm,{children:[(0,te.jsx)(Xm,{children:"Cancel"}),(0,te.jsx)(Km,{onClick:()=>{alert(`Reverted to: ${t.title}`),l(!1)},children:"Revert"})]})]})})]})};var nh=t(319);function lh(){const{app:e}=vs();return(0,te.jsx)(Rs,{variant:"ghost",size:"sm",className:"w-7 h-7 p-0 text-gray-500 hover:text-gray-700 hover:bg-gray-100 ",onClick:()=>{const s=null!=e&&e.id?`/support?appId=${e.id}`:"/support";window.open(s,"_blank")},title:"Help Center",children:(0,te.jsx)(cm.A,{size:16})})}var ih=t(43558),oh=t(90770);const ch=e=>{var s;let{app:t}=e;return(0,te.jsxs)(wx,{children:[(0,te.jsx)(kx,{asChild:!0,children:(0,te.jsxs)("div",{className:"flex items-center gap-3 cursor-pointer flex-1 p-1 rounded-md hover:bg-gray-200 transition-colors",children:[(0,te.jsxs)(bx,{className:"h-6 w-6 rounded-xl",children:[(0,te.jsx)(yx,{src:null==t?void 0:t.logo_url,alt:(null==t?void 0:t.name)||"App"}),(0,te.jsx)(Nx,{children:(null==t||null===(s=t.name)||void 0===s?void 0:s[0])||"A"})]}),(0,te.jsx)("div",{className:"flex-1 min-w-0",children:(0,te.jsxs)("div",{className:"flex items-center gap-1",children:[(0,te.jsx)("div",{className:"max-w-[120px]",title:(null==t?void 0:t.name)||"My App",children:(0,te.jsx)("h3",{className:"text-sm font-medium truncate",children:(null==t?void 0:t.name)||"My App"})}),(0,te.jsx)(ct.A,{className:"h-4 w-4 text-muted-foreground"})]})})]})}),(0,te.jsxs)(_x,{align:"start",className:"w-[240px] p-1 shadow-lg border border-slate-200 rounded-lg",children:[(0,te.jsx)(Sx,{asChild:!0,children:(0,te.jsxs)(J.Link,{to:`/apps/${null==t?void 0:t.id}/editor/workspace/overview`,className:"flex items-center gap-2 cursor-pointer",children:[(0,te.jsx)(lo.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"App Overview"})]})}),(0,te.jsx)(Sx,{asChild:!0,children:(0,te.jsxs)(J.Link,{to:`/apps/${null==t?void 0:t.id}/editor/workspace/users`,className:"flex items-center gap-2 cursor-pointer",children:[(0,te.jsx)(ih.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Users"})]})}),(0,te.jsx)(Sx,{asChild:!0,children:(0,te.jsxs)(J.Link,{to:`/apps/${null==t?void 0:t.id}/editor/workspace/security`,className:"flex items-center gap-2 cursor-pointer",children:[(0,te.jsx)(Dl.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Security"})]})}),(0,te.jsx)(Sx,{asChild:!0,children:(0,te.jsxs)(J.Link,{to:`/apps/${null==t?void 0:t.id}/editor/workspace/app-settings`,className:"flex items-center gap-2 cursor-pointer",children:[(0,te.jsx)(oh.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"App Settings"})]})})]})]})};const dh=e=>{let{onToggleVersions:s,showVersions:t}=e;const{app:a,currentUsage:r}=vs(),{logout:n,user:l}=ne(),i=(0,Z.Zp)(),[o,c]=(0,Y.useState)(!1);return(0,te.jsxs)("div",{className:"py-1.5 px-1 flex items-center bg-slate-50 relative z-10 shadow-[0_10px_23px_rgba(248,250,252,252.15)]",children:[(0,te.jsx)("div",{className:"flex items-center gap-3 flex-1",children:(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(Zx,{app:a,currentUsage:r,user:l,onShareModalOpen:()=>c(!0),onLogout:()=>{n(),i("/login")}}),(0,te.jsx)("div",{className:"h-5 w-[1px] bg-slate-300 rotate-[25deg]"}),(0,te.jsx)(ch,{app:a})]})}),(0,te.jsxs)("div",{className:"flex items-center mr-2",children:[(0,te.jsx)(Rs,{variant:t?"secondary":"ghost",size:"sm",className:"transition-colors w-7 h-7 mr-1 p-0 "+(t?"text-gray-700 bg-gray-200":"text-gray-500 hover:text-gray-700 hover:bg-gray-100"),onClick:s,title:"Version history",children:(0,te.jsx)(nh.A,{size:16})}),(0,te.jsx)(lh,{})]}),(0,te.jsx)(ba,{app:a,isOpen:o,onClose:()=>c(!1)})]})};function mh(e){let{app:s}=e;return(0,te.jsx)("div",{className:"h-full flex items-center justify-center pt-4",children:(0,te.jsxs)("div",{className:"flex flex-col items-center space-y-8 max-w-md text-center px-4",children:[(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)("div",{className:"w-16 h-16 rounded-full bg-orange-500/20 backdrop-blur-sm flex items-center justify-center",children:(0,te.jsx)("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-orange-400 to-orange-500"})}),(0,te.jsx)("div",{className:"absolute top-0 left-0 w-16 h-16 rounded-full bg-orange-400/20 animate-ping"}),(0,te.jsx)("div",{className:"absolute top-2 left-2 w-12 h-12 rounded-full bg-orange-300/10 animate-ping",style:{animationDelay:"0.2s"}})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("h2",{className:"text-2xl font-medium tracking-tight text-slate-700",children:"Creating Your App"}),(0,te.jsx)("p",{className:"text-sm font-light text-teal-700/60 tracking-wide",children:"This might take a few minutes..."})]}),(0,te.jsx)("div",{className:"text-base text-teal-600/80 font-light tracking-wide",children:(0,te.jsx)(pn,{status:s.status.details})})]})})}const uh=e=>{var s,t;const{user:a}=ne(),r=(0,Y.useRef)(null),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!0),c=(0,Y.useRef)(null),d=(0,Y.useRef)(0);(0,Y.useEffect)((()=>{const e=()=>{o(!document.hidden)},s=()=>{o(!0)},t=()=>{o(!1)};return o(!document.hidden),document.addEventListener("visibilitychange",e),window.addEventListener("focus",s),window.addEventListener("blur",t),()=>{document.removeEventListener("visibilitychange",e),window.removeEventListener("focus",s),window.removeEventListener("blur",t)}}),[]),(0,Y.useEffect)((()=>{if(!a||"never"===(null==a?void 0:a.notification_preference))return;if(!r.current){const e=new Audio("/sounds/notification.mp3");let s=!1;e.addEventListener("error",(t=>{s||(s=!0),e.src="data:audio/wav;base64,UklGRnoGAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQoGAACBhYqFbF1fdJivrJBhNjVgodDbq2EcBj+a2/LDciUFLIHO8tiJNwgZaLvt559NEAxQp+PwtmMcBjiR1/LMeSwFJHfH8N2QQAoUXrTp66hVFApGn+DyvmwhBSuBzvLZiTYIG2m98OScTgwOUarm7blmGgU7k9n1unEiBC13yO/eizEIHWq+8+OWT"})),r.current=e}const e=()=>{n||(l(!0),(()=>{const e=new Audio("data:audio/wav;base64,UklGRiIAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAA=");e.volume=0,e.play().catch((()=>{}))})(),document.removeEventListener("click",e),document.removeEventListener("keydown",e))};return document.addEventListener("click",e),document.addEventListener("keydown",e),()=>{document.removeEventListener("click",e),document.removeEventListener("keydown",e)}}),[n,a,null==a?void 0:a.notification_preference]),(0,Y.useEffect)((()=>()=>{r.current&&(r.current.pause(),r.current=null)}),[]),(0,Y.useEffect)((()=>{var s,t,n,l,o;if(!r.current)return;const m=null===(s=e.status)||void 0===s?void 0:s.state,u=(null===(t=e.conversation)||void 0===t||null===(n=t.messages)||void 0===n?void 0:n.length)||0,x=(null===(l=e.conversation)||void 0===l||null===(o=l.messages)||void 0===o?void 0:o.some((e=>"user"===e.role)))||!1;if("processing"===c.current&&"ready"===m&&x){(()=>!i&&("never"!==(null==a?void 0:a.notification_preference)&&("every_prompt"===(null==a?void 0:a.notification_preference)||"on_first_prompt"===(null==a?void 0:a.notification_preference)&&u<=2)))()&&(r.current.volume=.5,r.current.play().catch((()=>{})))}c.current=m||null,d.current=u}),[null==e||null===(s=e.status)||void 0===s?void 0:s.state,null==e||null===(t=e.conversation)||void 0===t?void 0:t.messages,null==a?void 0:a.notification_preference,i])};function xh(e){var s,t,a;let{view:r}=e;const n=(0,Xe.Ub)({maxWidth:767}),[l,i]=(0,Y.useState)(!1),{app:o}=vs(),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(!1),[p,g]=(0,Y.useState)(null);uh(o);const f=e=>{u(e)};(0,Y.useEffect)((()=>{if(n){var e,s,t,a,r;const n="processing"===(null===(e=o.status)||void 0===e?void 0:e.state),l=(null===(s=o.conversation)||void 0===s||null===(t=s.messages)||void 0===t?void 0:t.length)<=3;n&&l&&i(!0),"processing"===p&&"processing"!==(null===(a=o.status)||void 0===a?void 0:a.state)&&l&&i(!1),g(null===(r=o.status)||void 0===r?void 0:r.state)}}),[null===(s=o.status)||void 0===s?void 0:s.state,null===(t=o.conversation)||void 0===t||null===(a=t.messages)||void 0===a?void 0:a.length,n,p]),(0,Y.useEffect)((()=>(null!=o&&o.name?document.title=`${o.name} | Base44`:document.title="Base44",()=>{document.title="Base44"})),[null==o?void 0:o.name]);let v=null;var j,b,y;"pending"===o.app_stage?v="processing"===(null===(j=o.status)||void 0===j?void 0:j.state)?(0,te.jsx)(mh,{app:o}):(0,te.jsx)("div",{className:"h-full flex items-center justify-center pt-4",children:(0,te.jsxs)("div",{className:"flex flex-col items-center space-y-6 max-w-md text-center px-4",children:[(0,te.jsx)("div",{className:"w-12 h-12 rounded-full bg-gray-100 flex items-center justify-center",onClick:()=>i(!0),children:(0,te.jsx)(th.A,{className:"w-6 h-6 text-gray-400"})}),(0,te.jsx)("h2",{className:"text-xl font-light text-gray-700",children:"Let's Build Your App"}),(0,te.jsx)("p",{className:"text-sm text-gray-500",children:"Tell me what you'd like to create using the chat"})]})}):v=(0,te.jsx)(sh,{view:r,selectedCheckpoint:m,setSelectedCheckpoint:u,isLeftPanelHidden:x,toggleLeftPanel:()=>h(!x)});return n?(0,te.jsx)("div",{className:"h-full bg-slate-50 rounded-tr-lg rounded-br-lg",children:(0,te.jsxs)("div",{className:"relative",children:[v,(0,te.jsx)(Rs,{className:"fixed bottom-6 right-6 rounded-full shadow-lg z-50 bg-gray-900 hover:bg-gray-800 flex items-center gap-2 px-4",onClick:()=>i(!0),children:"processing"===(null===(b=o.status)||void 0===b?void 0:b.state)?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"h-5 w-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),(0,te.jsx)("span",{className:"text-white text-sm",children:"Processing..."})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(th.A,{className:"h-5 w-5 text-white"}),(0,te.jsx)("span",{className:"text-white text-sm",children:"Edit App"})]})}),(0,te.jsx)(dc,{open:l,onOpenChange:i,children:(0,te.jsxs)(gc,{side:"left",className:"w-[90%] sm:w-[385px] p-0 flex flex-col rounded-tr-lg rounded-br-lg",children:[(0,te.jsx)(fc,{className:"p-4 flex-shrink-0 bg-slate-50 relative z-10 rounded-tr-lg rounded-br-lg",children:(0,te.jsx)("div",{className:"flex justify-between items-center",children:(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(J.Link,{to:`/apps/${null==o?void 0:o.id}/editor/workspace/logo`,children:(0,te.jsxs)(qt,{className:"h-8 w-8 rounded-xl cursor-pointer",children:[(0,te.jsx)(Vt,{src:null==o?void 0:o.logo_url,alt:(null==o?void 0:o.name)||"App"}),(0,te.jsx)(Yt,{children:(null==o||null===(y=o.name)||void 0===y?void 0:y[0])||"A"})]})}),(0,te.jsx)("div",{children:(0,te.jsx)(jc,{className:"m-0 text-sm",children:(null==o?void 0:o.name)||"AI App Editor"})})]})})}),(0,te.jsx)("div",{className:"flex-1 overflow-y-auto p-2",children:c?(0,te.jsx)(rh,{onClose:()=>{u(void 0),d(!1)},selectedCheckpoint:m,onSelectCheckpoint:f}):(0,te.jsx)(no,{})})]})})]})}):(0,te.jsx)("div",{className:"flex flex-row h-screen bg-slate-50",children:(0,te.jsxs)(nm,{direction:"horizontal",children:[(0,te.jsx)(lm,{defaultSize:x?0:33,minSize:x?0:28,maxSize:x?0:40,className:"h-full overflow-hidden relative  "+(x?"hidden":""),style:{minWidth:x?"0px":"250px"},children:(0,te.jsxs)("div",{className:"flex flex-col h-full",children:[(0,te.jsx)("div",{className:"flex-shrink-0",children:(0,te.jsx)(dh,{onToggleVersions:()=>{d(!c)},showVersions:c})}),(0,te.jsx)("div",{className:"flex-1 overflow-y-auto",children:c?(0,te.jsx)(rh,{onClose:()=>{d(!1),u(void 0)},selectedCheckpoint:m,onSelectCheckpoint:f}):(0,te.jsx)(no,{})})]})}),(0,te.jsx)(im,{withHandle:!0,className:"group transition-opacity "+(x?"hidden":"opacity-0 hover:opacity-100 focus:opacity-100")}),(0,te.jsx)(lm,{defaultSize:x?100:67,className:"flex-1 overflow-x-auto "+(x?"pl-4":""),children:v})]})})}const hh=e=>{let{view:s}=e;return(0,te.jsx)(fs,{children:(0,te.jsx)(Ya,{children:(0,te.jsx)(qu,{children:(0,te.jsx)(xh,{view:s})})})})};function ph(){const e=(0,Z.Zp)(),s=(0,Z.zy)(),t=new URLSearchParams(s.search),a=t.get("prompt"),[r,n]=(0,Y.useState)(null),{user:l}=ne();return(0,Y.useEffect)((()=>{!async function(){if(a)try{const s=t.get("app_platform_version"),r={status:{state:"processing",details:"Starting conversation..."}};s&&(r.platform_version=parseInt(s,10));const n=await pe.create(r);Ve(n.id,{content:a},null==l?void 0:l.id),e(`/apps/${n.id}/editor/preview`)}catch(s){n(s.message||"Error creating app")}else n("No prompt provided")}()}),[a,e,t]),r?(0,te.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,te.jsx)("div",{className:"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded",children:(0,te.jsx)("span",{children:r})})}):(0,te.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,te.jsx)("div",{"data-testid":"loading-spinner",className:"animate-spin rounded-full h-12 w-12 border-4 border-gray-300 border-t-blue-600"})})}var gh=t(85113),fh=t(58799),vh=t(35097),jh=t(73581),bh=t(2847),yh=t(56473);function Nh(e){let{stats:s}=e;const[t,a]=(0,Y.useState)("30days"),[r,n]=(0,Y.useState)(!1);return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-8",children:[(0,te.jsx)(Vs,{children:(0,te.jsxs)(Js,{className:"flex items-center p-6",children:[(0,te.jsx)(Wa.A,{className:"w-8 h-8 text-blue-500 mr-4"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm text-gray-600",children:"Total Users"}),(0,te.jsx)("p",{className:"text-2xl font-bold",children:s.total_users})]})]})}),(0,te.jsx)(Vs,{children:(0,te.jsxs)(Js,{className:"flex items-center p-6",children:[(0,te.jsx)(vh.A,{className:"w-8 h-8 text-green-500 mr-4"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm text-gray-600",children:"New Today"}),(0,te.jsx)("p",{className:"text-2xl font-bold",children:s.new_users_today})]})]})}),(0,te.jsx)(Vs,{children:(0,te.jsxs)(Js,{className:"flex items-center p-6",children:[(0,te.jsx)(jh.A,{className:"w-8 h-8 text-yellow-500 mr-4"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm text-gray-600",children:"Premium Users"}),(0,te.jsx)("p",{className:"text-2xl font-bold",children:s.paying_users})]})]})})]}),(0,te.jsx)(Vs,{className:"mb-8",children:(0,te.jsxs)(Js,{className:"p-6",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold",children:"User Growth"}),(0,te.jsxs)("div",{className:"flex space-x-2",children:[(0,te.jsx)(Rs,{variant:"7days"===t?"default":"outline",size:"sm",onClick:()=>a("7days"),children:"7 Days"}),(0,te.jsx)(Rs,{variant:"30days"===t?"default":"outline",size:"sm",onClick:()=>a("30days"),children:"30 Days"}),(0,te.jsx)(Rs,{variant:"90days"===t?"default":"outline",size:"sm",onClick:()=>a("90days"),children:"90 Days"}),(0,te.jsx)(Rs,{variant:"year"===t?"default":"outline",size:"sm",onClick:()=>a("year"),children:"1 Year"}),(0,te.jsx)(Rs,{variant:"all"===t?"default":"outline",size:"sm",onClick:()=>a("all"),children:"All Time"}),(0,te.jsx)(Rs,{variant:r?"default":"outline",size:"sm",onClick:()=>n(!r),children:r?"Show Today":"Hide Today"})]})]}),(0,te.jsx)("div",{className:"h-[200px] w-full",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)(bh.b,{data:(()=>{if(!s.new_users_by_day)return[];Bt()();let e;switch(t){case"7days":e=Bt()().subtract(7,"days");break;case"30days":default:e=Bt()().subtract(30,"days");break;case"90days":e=Bt()().subtract(90,"days");break;case"year":e=Bt()().subtract(1,"year");break;case"all":return r?s.new_users_by_day.filter((e=>!Bt()(e.date).isSame(Bt()(),"day"))):s.new_users_by_day}let a=s.new_users_by_day.filter((s=>Bt()(s.date).isAfter(e)));return r&&(a=a.filter((e=>!Bt()(e.date).isSame(Bt()(),"day")))),a})(),children:[(0,te.jsx)(Pd.W,{dataKey:"date",tickFormatter:e=>Bt()(e).format("MMM DD")}),(0,te.jsx)(Md.h,{}),(0,te.jsx)(Od.m,{labelFormatter:e=>Bt()(e).format("MMMM DD, YYYY"),formatter:e=>[`${e} new users`]}),(0,te.jsx)(yh.N,{type:"monotone",dataKey:"count",stroke:"#2563eb",strokeWidth:2})]})})})]})})]})}function wh(e){let{details:s,selectedUser:t,onUpdateUser:a,loading:r}=e;return s.is_personal?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Subscription Tier"}),(0,te.jsxs)(ut,{value:t.subscription_tier,onValueChange:e=>a(t.id,{subscription_tier:e}),disabled:r,children:[(0,te.jsx)(pt,{children:(0,te.jsx)(ht,{})}),(0,te.jsxs)(vt,{children:[(0,te.jsx)(bt,{value:"free",children:"Free"}),(0,te.jsx)(bt,{value:"starter",children:"Starter"}),(0,te.jsx)(bt,{value:"builder",children:"Builder"}),(0,te.jsx)(bt,{value:"pro",children:"Pro"}),(0,te.jsx)(bt,{value:"elite",children:"Elite"}),(0,te.jsx)(bt,{value:"enterprise",children:"Enterprise"})]})]})]}),(0,te.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Stripe Customer ID"}),(0,te.jsx)("p",{className:"text-sm text-gray-600 font-mono",children:s.stripe_customer_id||"-"})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Stripe Subscription ID"}),(0,te.jsx)("p",{className:"text-sm text-gray-600 font-mono",children:s.stripe_subscription_id||"-"})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Stripe Subscription Status"}),(0,te.jsx)("p",{className:"text-sm text-gray-600",children:s.stripe_subscription_status||"-"})]})]})]}):(0,te.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Workspace Role"}),(0,te.jsx)("span",{className:"px-2 py-1 rounded-full text-xs "+("owner"===s.user_role?"bg-purple-100 text-purple-800":"admin"===s.user_role?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:s.user_role})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Seat Status"}),(0,te.jsx)("span",{className:"px-2 py-1 rounded-full text-xs "+("assigned"===s.seat_status?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800"),children:"assigned"===s.seat_status?"Assigned":"No Seat"})]}),"assigned"===s.seat_status&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Seat Plan"}),(0,te.jsx)("p",{className:"text-sm text-gray-600",children:s.seat_type_name})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Seat Number"}),(0,te.jsxs)("p",{className:"text-sm text-gray-600",children:["#",s.seat_id]})]})]})]})}function kh(e){let{selectedUser:s,workspaceDetails:t,onUpdateUser:a,loading:r,loadingStates:n}=e;return s?(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Full Name"}),(0,te.jsx)(Qs,{type:"text",value:s.full_name||"",onChange:e=>a(s.id,{full_name:e.target.value}),disabled:r})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Username"}),(0,te.jsx)("p",{className:"text-gray-600",children:s.username||"-"})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Phone Number"}),(0,te.jsx)(Qs,{type:"text",value:s.phone_number||"",onChange:e=>a(s.id,{phone_number:e.target.value}),disabled:r})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Platform Role"}),(0,te.jsxs)(ut,{value:s.platform_role,onValueChange:e=>a(s.id,{platform_role:e}),disabled:r,children:[(0,te.jsx)(pt,{children:(0,te.jsx)(ht,{})}),(0,te.jsxs)(vt,{children:[(0,te.jsx)(bt,{value:"user",children:"User"}),(0,te.jsx)(bt,{value:"platform_admin",children:"Platform Admin"})]})]})]}),n.workspaces?(0,te.jsx)("div",{className:"bg-gray-50 p-4 rounded-lg",children:(0,te.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500",children:[(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin"}),"Loading workspace details..."]})}):t?(0,te.jsx)(wh,{details:t,selectedUser:s,onUpdateUser:a,loading:r}):null,(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"API Key"}),(0,te.jsx)("p",{className:"text-sm text-gray-600 font-mono break-all",children:s.api_key||"-"})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(zi,{id:"beta-tester",checked:s.is_beta_tester||!1,onCheckedChange:e=>a(s.id,{is_beta_tester:e}),disabled:r}),(0,te.jsx)("label",{htmlFor:"beta-tester",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Beta Tester"})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(zi,{id:"user-disabled",checked:s.disabled||!1,onCheckedChange:e=>a(s.id,{disabled:e}),disabled:r}),(0,te.jsx)("label",{htmlFor:"user-disabled",className:"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",children:"Disable User Account"})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"mb-2 font-medium",children:"Account Status"}),(0,te.jsx)("span",{className:"px-2 py-1 rounded-full text-xs "+(s.disabled?"bg-red-100 text-red-800":"bg-green-100 text-green-800"),children:s.disabled?"Disabled":"Active"})]})]}):null}var _h=t(75473);const Sh=Y.forwardRef(((e,s)=>{let{className:t,value:a,...r}=e;return(0,te.jsx)(_h.bL,{ref:s,className:ns("relative h-4 w-full overflow-hidden rounded-full bg-secondary",t),...r,children:(0,te.jsx)(_h.C1,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(a||0)}%)`}})})}));function Ch(e){let{userUsageStats:s,dateRange:t,onDateRangeChange:a,selectedWorkspace:r,onSwitchToCreditsTab:n,isLoading:l}=e;const[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(null),[m,u]=(0,Y.useState)(!1),x=(e,s)=>{d({startDate:e,endDate:s})};return l||!s?(0,te.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin mx-auto mb-4 text-gray-400"}),(0,te.jsx)("p",{className:"text-gray-500",children:"Loading usage statistics..."})]})}):(0,te.jsxs)("div",{className:"space-y-8",children:[(0,te.jsxs)("div",{className:"bg-white rounded-lg shadow p-4",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold mb-2",children:"Current Usage"}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,te.jsxs)("span",{className:"text-sm font-medium",children:["Monthly Usage: ",s.monthly_usage," / ",s.monthly_limit]}),(0,te.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(s.monthly_usage/s.monthly_limit*100),"%"]})]}),(0,te.jsx)(Sh,{value:s.monthly_usage/s.monthly_limit*100,className:"h-2",indicatorClassName:s.is_over_limit?"bg-red-500":void 0})]}),s.daily_limit&&(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex justify-between mb-1",children:[(0,te.jsxs)("span",{className:"text-sm font-medium",children:["Daily Usage: ",s.daily_usage," / ",s.daily_limit]}),(0,te.jsxs)("span",{className:"text-sm text-gray-500",children:[Math.round(s.daily_usage/s.daily_limit*100),"%"]})]}),(0,te.jsx)(Sh,{value:s.daily_usage/s.daily_limit*100,className:"h-2",indicatorClassName:s.is_over_limit?"bg-red-500":void 0})]})]})]}),s.usage_by_date&&(0,te.jsxs)("div",{className:"bg-white rounded-lg shadow p-6",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center mb-6",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold",children:"Usage History"}),(0,te.jsxs)(Mo,{open:i,onOpenChange:o,children:[(0,te.jsx)(Oo,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"outline",className:"flex items-center gap-2",disabled:m,children:[(0,te.jsx)(At.A,{className:"h-4 w-4"}),t.startDate&&t.endDate?`${Bt()(t.startDate).format("MMM D, YYYY")} - ${Bt()(t.endDate).format("MMM D, YYYY")}`:"Select Date Range"]})}),(0,te.jsx)(Ro,{className:"w-auto p-0",align:"end",children:(0,te.jsxs)("div",{className:"p-3 border-b",children:[(0,te.jsx)("h4",{className:"font-medium mb-2",children:"Select Date Range"}),(0,te.jsxs)("div",{className:"grid grid-cols-2 gap-2",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{className:"text-sm text-gray-600",children:"Start Date"}),(0,te.jsx)($o,{mode:"single",selected:(null==c?void 0:c.startDate)||t.startDate,onSelect:e=>x(e,(null==c?void 0:c.endDate)||t.endDate),className:"rounded-md border"})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{className:"text-sm text-gray-600",children:"End Date"}),(0,te.jsx)($o,{mode:"single",selected:(null==c?void 0:c.endDate)||t.endDate,onSelect:e=>x((null==c?void 0:c.startDate)||t.startDate,e),className:"rounded-md border"})]})]}),(0,te.jsxs)("div",{className:"flex justify-end gap-2 mt-3",children:[(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>{if(s){const e=new Date(s.current_credit_period_start_date),t=new Date(s.current_credit_period_end_date);u(!0),a(e,t,r,(()=>{u(!1)}))}d(null)},children:"Reset"}),(0,te.jsx)(Rs,{size:"sm",onClick:()=>{c&&(u(!0),a(c.startDate,c.endDate,r,(()=>{u(!1)}))),o(!1)},children:"Apply"})]})]})})]})]}),(0,te.jsx)("div",{className:"h-[300px]",children:(0,te.jsx)(Px,{usageByDate:s.usage_by_date,height:"h-[260px]"})})]}),(0,te.jsx)(Vs,{children:(0,te.jsxs)(Js,{className:"pt-6 space-y-6",children:[(0,te.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,te.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,te.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Subscription Tier"}),(0,te.jsx)("p",{className:"text-lg font-semibold capitalize",children:s.tier})]}),(0,te.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,te.jsx)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:"Bonus Credits"}),(0,te.jsx)("p",{className:"text-lg font-semibold",children:s.extra_credits})]})]}),(0,te.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,te.jsx)("h3",{className:"text-sm font-medium text-gray-700 mb-3",children:"Billing Period"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsx)("span",{className:"font-medium",children:"Start:"}),(0,te.jsx)("span",{children:Bt()(s.current_credit_period_start_date).format("MMM DD, YYYY")})]}),(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsx)("span",{className:"font-medium",children:"End:"}),(0,te.jsx)("span",{children:Bt()(s.current_credit_period_end_date).format("MMM DD, YYYY")})]}),(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsx)("span",{className:"font-medium",children:"Next Start:"}),(0,te.jsx)("span",{children:Bt()(s.next_period_start_date).format("MMM DD, YYYY")})]})]})]})]})}),s.is_over_limit&&(0,te.jsxs)("div",{className:"bg-red-50 border border-red-200 text-red-800 px-4 py-3 rounded-lg",children:[(0,te.jsx)("p",{className:"font-medium",children:"User is over their usage limit"}),(0,te.jsx)("p",{className:"text-sm",children:"Consider adding bonus credits or upgrading their subscription tier."})]}),(0,te.jsxs)(Rs,{onClick:n,className:"w-full mt-8",children:[(0,te.jsx)(gx.A,{className:"h-4 w-4 mr-2"}),"Add Bonus Credits"]})]})}function Ah(e){let{userBonusCredits:s,onAddBonusCredits:t,onDeleteBonusCredit:a,loading:r}=e;const[n,l]=(0,Y.useState)({numMessages:0,reason:""});return(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold",children:"Bonus Credits"}),s.length>0?(0,te.jsx)("div",{className:"space-y-3 mb-4",children:s.map(((e,s)=>(0,te.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md",children:[(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsxs)("span",{className:"font-medium",children:[e.num_messages," messages"]}),(0,te.jsx)("span",{className:"text-sm text-gray-600",children:Bt()(e.created_date).format("MMM DD, YYYY")})]}),(0,te.jsx)("p",{className:"text-sm text-gray-700 mt-1",children:e.reason}),(0,te.jsxs)("div",{className:"flex justify-between items-center mt-1",children:[(0,te.jsxs)("p",{className:"text-xs text-gray-500",children:["Expires: ",Bt()(e.expires_date).format("MMM DD, YYYY")]}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",className:"text-red-500 hover:text-red-700 hover:bg-red-50",onClick:()=>a(e.id),disabled:r,children:(0,te.jsx)(Tc.A,{className:"h-4 w-4"})})]})]},s)))}):(0,te.jsx)("p",{className:"text-gray-500 mb-4",children:"No bonus credits found for this user."}),(0,te.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,te.jsx)("h4",{className:"font-medium mb-3",children:"Add Bonus Credits"}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{className:"text-sm text-gray-600",children:"Number of Messages"}),(0,te.jsx)(Qs,{type:"number",min:"1",value:n.numMessages,onChange:e=>l({...n,numMessages:e.target.value}),disabled:r})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{className:"text-sm text-gray-600",children:"Reason"}),(0,te.jsx)(Qs,{type:"text",value:n.reason,onChange:e=>l({...n,reason:e.target.value}),placeholder:"e.g., Promotional offer, Customer support",disabled:r})]}),(0,te.jsxs)(Rs,{onClick:()=>{n.numMessages&&n.reason&&(t(parseInt(n.numMessages),n.reason),l({numMessages:0,reason:""}))},disabled:r||!n.numMessages||!n.reason,className:"w-full",children:[(0,te.jsx)(ys.A,{className:"h-4 w-4 mr-2"}),"Add Credits"]})]})]})]})}function Eh(e){let{workspaces:s,selectedWorkspace:t,onWorkspaceChange:a,loading:r,disabled:n=!1}=e;return(0,te.jsxs)("div",{className:"w-full relative",children:[(0,te.jsxs)(ut,{value:t||"",onValueChange:a,disabled:r||n,children:[(0,te.jsx)(pt,{className:"text-sm",children:(0,te.jsx)(ht,{placeholder:"Select workspace..."})}),(0,te.jsx)(vt,{children:s.map((e=>(0,te.jsx)(bt,{value:e.id,children:(0,te.jsx)("span",{children:e.is_personal?"Personal":e.name})},e.id)))})]}),r&&(0,te.jsx)("div",{className:"absolute right-8 top-1/2 transform -translate-y-1/2",children:(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin text-gray-400"})})]})}Sh.displayName=_h.bL.displayName;const Ih={workspaces:!1,usageStats:!1};function Lh(e){let{selectedUser:s,onClose:t,onUpdateUser:a,userBonusCredits:r,onAddBonusCredits:n,onDeleteBonusCredit:l,loading:i,userUsageStats:o,onDateRangeChange:c,dateRange:d}=e;const[m,u]=(0,Y.useState)("details"),[x,h]=(0,Y.useState)(d),[p,g]=(0,Y.useState)([]),[f,v]=(0,Y.useState)(null),[j,b]=(0,Y.useState)(null),[y,N]=(0,Y.useState)(Ih);(0,Y.useEffect)((()=>{h(d)}),[d]),(0,Y.useEffect)((()=>{if(o&&(null==d||!d.startDate)&&(null==x||!x.startDate)){const e=new Date(o.current_credit_period_start_date),s=new Date(o.current_credit_period_end_date);h({startDate:e,endDate:s})}}),[o,d,x]),(0,Y.useEffect)((()=>{if(!s)return g([]),v(null),void b(null);(async()=>{N((e=>({...e,workspaces:!0})));try{var e;const t=await Qe.default.getUserWorkspacesWithDetails(s.id);g(t.workspaces||[]);const a=null===(e=t.workspaces)||void 0===e?void 0:e.find((e=>e.is_personal));a&&(v(a.id),b(a))}catch(t){g([])}finally{N((e=>({...e,workspaces:!1})))}})()}),[s]);return(0,te.jsx)(dc,{open:!!s,onOpenChange:t,className:"bg-white",children:(0,te.jsxs)(gc,{className:"sm:max-w-xl overflow-y-auto",children:[(0,te.jsx)(fc,{children:(0,te.jsx)(jc,{children:"User Details"})}),s&&(0,te.jsxs)("div",{className:"py-6",children:[(0,te.jsxs)("div",{className:"mb-6",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold",children:s.full_name||s.email}),p&&p.length>1&&(0,te.jsx)("div",{className:"w-48",children:(0,te.jsx)(Eh,{workspaces:p,selectedWorkspace:f,onWorkspaceChange:e=>{v(e);const s=p.find((s=>s.id===e));b(s),x.startDate&&x.endDate&&(N((e=>({...e,usageStats:!0}))),c(x.startDate,x.endDate,e,(()=>{N((e=>({...e,usageStats:!1})))})))},loading:y.workspaces})})]}),(0,te.jsx)("p",{className:"text-gray-600",children:s.email}),j&&!j.is_personal&&(0,te.jsxs)("p",{className:"text-sm text-gray-500 mt-1",children:[j.name,` (${j.user_role})`]})]}),(0,te.jsxs)(lr,{defaultValue:"details",className:"w-full",onValueChange:u,value:m,children:[(0,te.jsxs)(ir,{className:"grid grid-cols-3 mb-6",children:[(0,te.jsxs)(or,{value:"details",className:"flex items-center gap-2",children:[(0,te.jsx)(Mm.A,{className:"h-4 w-4"}),"Details"]}),(0,te.jsxs)(or,{value:"usage",className:"flex items-center gap-2",children:[(0,te.jsx)(Va.A,{className:"h-4 w-4"}),"Usage"]}),(0,te.jsxs)(or,{value:"credits",className:"flex items-center gap-2",children:[(0,te.jsx)(gx.A,{className:"h-4 w-4"}),"Credits"]})]}),(0,te.jsx)(cr,{value:"details",children:(0,te.jsx)(kh,{selectedUser:s,workspaceDetails:j,onUpdateUser:a,loading:i,loadingStates:y})}),(0,te.jsx)(cr,{value:"usage",children:(0,te.jsx)(Ch,{userUsageStats:o,dateRange:x,onDateRangeChange:c,selectedWorkspace:f,onSwitchToCreditsTab:()=>u("credits"),isLoading:y.usageStats})}),(0,te.jsx)(cr,{value:"credits",children:(0,te.jsx)(Ah,{userBonusCredits:r,onAddBonusCredits:(e,t)=>{n(s.id,e,t)},onDeleteBonusCredit:e=>{l(e)},loading:i})})]})]})]})})}class Th extends K.y{getBaseURL(){return"/admin/analytics"}getAdminStats(){return this.axios.get("/overall")}getTopUsers(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100;return this.axios.get("/top-users",{params:{start_date:e,end_date:s,limit:t}})}getUserAnalytics(){return this.axios.get("/user-analytics")}getOrganizationsWithPlans(){return this.axios.get("/organizations-with-plans")}getOrganizationUsage(e){return this.axios.get(`/organization/${e}/usage`)}}const $h=new Th;function Dh(){const[e,s]=(0,Y.useState)(!1),[t,a]=(0,Y.useState)([]),[r,n]=(0,Y.useState)({startDate:Bt()().subtract(7,"days").format("YYYY-MM-DD"),endDate:Bt()().format("YYYY-MM-DD")}),[l,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{d()}),[r.startDate,r.endDate]);const d=async()=>{s(!0);try{const e=await $h.getTopUsers(r.startDate,r.endDate);a(e)}catch(e){}finally{s(!1)}},m=e=>{n("ever"===e?{startDate:"2020-01-01",endDate:Bt()().format("YYYY-MM-DD")}:{startDate:Bt()().subtract(e,"days").format("YYYY-MM-DD"),endDate:Bt()().format("YYYY-MM-DD")})};return(0,te.jsxs)(Vs,{className:"mb-8",children:[(0,te.jsx)(Ys,{children:(0,te.jsxs)(Hs,{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{children:"Top Users by Message Count"}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 text-sm",children:[(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>m(1),className:r.startDate===Bt()().subtract(1,"days").format("YYYY-MM-DD")?"bg-blue-50":"",children:"1 Day"}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>m(7),className:r.startDate===Bt()().subtract(7,"days").format("YYYY-MM-DD")?"bg-blue-50":"",children:"7 Days"}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>m(15),className:r.startDate===Bt()().subtract(15,"days").format("YYYY-MM-DD")?"bg-blue-50":"",children:"15 Days"}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>m(30),className:r.startDate===Bt()().subtract(30,"days").format("YYYY-MM-DD")?"bg-blue-50":"",children:"30 Days"}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:()=>m("ever"),className:"2020-01-01"===r.startDate?"bg-blue-50":"",children:"All Time"}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,te.jsxs)(Mo,{open:l,onOpenChange:i,children:[(0,te.jsx)(Oo,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[(0,te.jsx)(At.A,{className:"h-3.5 w-3.5"}),(0,te.jsx)("span",{children:r.startDate})]})}),(0,te.jsx)(Ro,{className:"w-auto p-0",children:(0,te.jsx)($o,{mode:"single",selected:new Date(r.startDate),onSelect:e=>{const s=Bt()(e).format("YYYY-MM-DD");n((e=>({...e,startDate:s}))),i(!1)},initialFocus:!0,disabled:e=>e>new Date(r.endDate)||e>new Date})})]}),(0,te.jsx)("span",{children:"to"}),(0,te.jsxs)(Mo,{open:o,onOpenChange:c,children:[(0,te.jsx)(Oo,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"outline",size:"sm",className:"flex items-center gap-1",children:[(0,te.jsx)(At.A,{className:"h-3.5 w-3.5"}),(0,te.jsx)("span",{children:r.endDate})]})}),(0,te.jsx)(Ro,{className:"w-auto p-0",children:(0,te.jsx)($o,{mode:"single",selected:new Date(r.endDate),onSelect:e=>{const s=Bt()(e).format("YYYY-MM-DD");n((e=>({...e,endDate:s}))),c(!1)},initialFocus:!0,disabled:e=>e<new Date(r.startDate)||e>new Date})})]})]})]})]})}),(0,te.jsx)(Js,{children:e?(0,te.jsx)("div",{className:"text-center py-8",children:"Loading top users data..."}):0===t.length?(0,te.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No data available for the selected date range"}):(0,te.jsx)("div",{className:"overflow-x-auto",children:(0,te.jsxs)(Ia,{children:[(0,te.jsx)(La,{children:(0,te.jsxs)(Da,{children:[(0,te.jsx)(Pa,{children:"Email"}),(0,te.jsx)(Pa,{children:"Full Name"}),(0,te.jsx)(Pa,{children:"Subscription"}),(0,te.jsx)(Pa,{children:"Role"}),(0,te.jsx)(Pa,{className:"text-right",children:(0,te.jsxs)("div",{className:"flex items-center justify-end",children:[(0,te.jsx)(mr.A,{className:"h-4 w-4 mr-2"}),"Messages"]})})]})}),(0,te.jsx)(Ta,{children:t.map(((e,s)=>{var t,a,r,n,l;return(0,te.jsxs)(Da,{children:[(0,te.jsx)(Ma,{className:"font-medium",children:e.email}),(0,te.jsx)(Ma,{children:e.full_name||"-"}),(0,te.jsx)(Ma,{children:(0,te.jsx)("span",{className:"px-2 py-1 rounded-full text-xs "+(null!==(t=e.subscription_tier)&&void 0!==t&&t.toLowerCase().includes("enterprise")?"bg-yellow-100 text-yellow-800":null!==(a=e.subscription_tier)&&void 0!==a&&a.toLowerCase().includes("elite")?"bg-purple-100 text-purple-800":null!==(r=e.subscription_tier)&&void 0!==r&&r.toLowerCase().includes("pro")?"bg-blue-100 text-blue-800":null!==(n=e.subscription_tier)&&void 0!==n&&n.toLowerCase().includes("builder")?"bg-indigo-100 text-indigo-800":null!==(l=e.subscription_tier)&&void 0!==l&&l.toLowerCase().includes("starter")?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.subscription_tier||"Free"})}),(0,te.jsx)(Ma,{children:(0,te.jsx)("span",{className:"px-2 py-1 rounded-full text-xs "+("platform_admin"===e.platform_role?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:e.platform_role})}),(0,te.jsx)(Ma,{className:"text-right font-semibold",children:e.message_count.toLocaleString()})]},s)}))})]})})})]})}var Ph=t(89284);class Mh extends K.y{getBaseURL(){return"/workspace"}updateWorkspace(e,s){const t={workspaceId:e};return this.axios.put("/admin/update",s,{params:t})}}const Oh=new Mh,Rh=[{value:"stripe",label:"Stripe Billing"},{value:"no_billing",label:"No Billing (Free)"}];function Fh(e){let{workspace:s,isOpen:t,onClose:a,onSave:r}=e;const[n,l]=(0,Y.useState)({billing_type:"stripe",plans:[]}),[i,o]=(0,Y.useState)({billing_type:"stripe",plans:[]}),[c,d]=(0,Y.useState)(!1),[m,u]=(0,Y.useState)(""),[x,h]=(0,Y.useState)([]),[p,g]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{t&&f()}),[t]),(0,Y.useEffect)((()=>{if(s){const e={billing_type:s.billing_type||"stripe",plans:s.plans?s.plans.map((e=>({name:e.name.toLowerCase(),price_id:e.price_id,total_seats:e.total_seats||0}))):[]};l(e),o(JSON.parse(JSON.stringify(e))),u("")}}),[s]);const f=async()=>{g(!0);try{const e=await de.getAvailablePlans();if(null==e||!e.plans)throw new Error("Failed to load available plans");{const s=e.plans.map((e=>({name:e.name.toLowerCase(),price_id:e.price_id,displayName:e.name.charAt(0).toUpperCase()+e.name.slice(1)})));h(s)}}catch(e){u("Failed to load available plans")}finally{g(!1)}},v=e=>{const s=n.plans.find((s=>s.name===e));return s?s.total_seats:0},j=()=>{if(n.billing_type!==i.billing_type)return!0;const e=[...n.plans].sort(((e,s)=>e.name.localeCompare(s.name))),s=[...i.plans].sort(((e,s)=>e.name.localeCompare(s.name)));if(e.length!==s.length)return!0;for(let t=0;t<e.length;t++){const a=e[t],r=s[t];if(a.name!==r.name||a.price_id!==r.price_id||a.total_seats!==r.total_seats)return!0}return!1},b=()=>{u(""),a()};return s?(0,te.jsx)(na,{open:t,onOpenChange:b,children:(0,te.jsxs)(da,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[(0,te.jsx)(ma,{children:(0,te.jsx)(xa,{className:"flex items-center gap-2",children:(0,te.jsxs)("span",{children:["Edit Workspace: ",s.name||s.domain||"Unknown"]})})}),(0,te.jsxs)("div",{className:"space-y-6",children:[m&&(0,te.jsxs)(is,{variant:"destructive",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4"}),(0,te.jsx)(cs,{children:m})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsx)(Hs,{className:"text-lg",children:"Billing Configuration"})}),(0,te.jsx)(Js,{children:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"billing-type",children:"Billing Type"}),(0,te.jsxs)(ut,{value:n.billing_type,onValueChange:e=>{l((s=>({...s,billing_type:e})))},children:[(0,te.jsx)(pt,{children:(0,te.jsx)(ht,{placeholder:"Select billing type"})}),(0,te.jsx)(vt,{children:Rh.map((e=>(0,te.jsx)(bt,{value:e.value,children:e.label},e.value)))})]})]})})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{className:"text-lg",children:"Seat Plans"}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"Set the total seat count for each plan. Set to 0 to remove a plan."})]}),(0,te.jsx)(Js,{children:p?(0,te.jsxs)("div",{className:"flex items-center justify-center py-8",children:[(0,te.jsx)(Je.A,{className:"h-6 w-6 animate-spin text-slate-600"}),(0,te.jsx)("span",{className:"ml-2 text-slate-600",children:"Loading plans..."})]}):(0,te.jsx)("div",{className:"space-y-4",children:x.map((e=>(0,te.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg",children:[(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("div",{className:"font-medium text-slate-900",children:e.displayName}),(0,te.jsxs)("div",{className:"text-sm text-slate-500",children:["Price ID: ",e.price_id]})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2 min-w-[120px]",children:[(0,te.jsx)(at,{htmlFor:`${e.name}-seats`,className:"text-sm whitespace-nowrap",children:"Total Seats:"}),(0,te.jsx)(Qs,{id:`${e.name}-seats`,type:"number",min:"0",value:v(e.name),onChange:s=>((e,s)=>{const t=parseInt(s)||0,a=x.find((s=>s.name===e));l((s=>{const r=[...s.plans],n=r.findIndex((s=>s.name===e));if(t>0){const s={name:e,price_id:a.price_id,total_seats:t};n>=0?r[n]=s:r.push(s)}else n>=0&&r.splice(n,1);return{...s,plans:r}}))})(e.name,s.target.value),className:"w-20 text-center",placeholder:"0"})]})]},e.name)))})})]}),(0,te.jsxs)("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[(0,te.jsxs)(Rs,{variant:"outline",onClick:b,disabled:c,children:[(0,te.jsx)(Ds.A,{className:"h-4 w-4 mr-2"}),"Cancel"]}),(0,te.jsxs)(Rs,{onClick:async()=>{if(s)if(j()){d(!0),u("");try{await r(s.id||s.organization_id,n),a()}catch(e){u(e.message||"Failed to update workspace")}finally{d(!1)}}else a()},disabled:c||!j(),className:"bg-orange-600 hover:bg-orange-700 disabled:bg-slate-300 disabled:text-slate-500",children:[(0,te.jsx)(Wd.A,{className:"h-4 w-4 mr-2"}),c?"Saving...":j()?"Save Changes":"No Changes"]})]})]})]})}):null}function zh(){const[e,s]=(0,Y.useState)(null),[t,a]=(0,Y.useState)(!0),[r,n]=(0,Y.useState)(""),[l,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(null);(0,Y.useEffect)((()=>{d()}),[]);const d=async()=>{try{const e=await $h.getOrganizationsWithPlans();if(null==e||!e.success)return void s(null);const t=e.data,a=t.organizations||[],r=t.all_plans||[],n=a.length;let l=0,i=0;a.forEach((e=>{e.plans&&e.plans.forEach((e=>{l+=e.total_seats||0,i+=e.used_seats||0}))}));const o=l>0?Math.round(i/l*100*100)/100:0,c={};a.forEach((e=>{e.plans&&e.plans.forEach((e=>{if(e.created_date){const s=new Date(e.created_date).toISOString().split("T")[0];c[s]=(c[s]||0)+(e.total_seats||0)}}))})),a.forEach((e=>{if(e.plans){const s=e.plans.reduce(((e,s)=>e+(s.total_seats||0)),0),t=e.plans.reduce(((e,s)=>e+(s.used_seats||0)),0),a=s>0?Math.round(t/s*100*100)/100:0;e.plan_summary={total_seats:s,used_seats:t,utilization_rate:a}}else e.plan_summary={total_seats:0,used_seats:0,utilization_rate:0}}));s({organizations:a,all_plans:r,total_organizations_with_plans:n,total_seats_purchased:l,total_seats_used:i,overall_utilization_rate:o,seats_by_day:c})}catch(e){s(null)}finally{a(!1)}};if(t)return(0,te.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600 mx-auto mb-4"}),(0,te.jsx)("p",{className:"text-slate-600",children:"Loading organizations..."})]})});if(!e)return(0,te.jsxs)("div",{className:"text-center py-8",children:[(0,te.jsx)("p",{className:"text-slate-600",children:"Failed to load organizations data"}),(0,te.jsx)("p",{className:"text-sm text-slate-500 mt-2",children:"Check console for debugging information"})]});const m=e.organizations||[],u=e.seats_by_day||{},x=m.reduce(((e,s)=>{var t;return e+((null===(t=s.plan_summary)||void 0===t?void 0:t.total_seats)||0)}),0),h=m.reduce(((e,s)=>{var t;return e+((null===(t=s.plan_summary)||void 0===t?void 0:t.used_seats)||0)}),0),p=x>0?Math.round(h/x*100*100)/100:0,g=m.reduce(((e,s)=>{var t;const a=null===(t=s.plans)||void 0===t?void 0:t.find((e=>{var s;return null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes("starter")}));return e+((null==a?void 0:a.total_seats)||0)}),0),f=m.reduce(((e,s)=>{var t;const a=null===(t=s.plans)||void 0===t?void 0:t.find((e=>{var s;return null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes("builder")}));return e+((null==a?void 0:a.total_seats)||0)}),0),v=m.reduce(((e,s)=>{var t;const a=null===(t=s.plans)||void 0===t?void 0:t.find((e=>{var s;return null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes("pro")}));return e+((null==a?void 0:a.total_seats)||0)}),0),j=m.reduce(((e,s)=>{var t;return e+((null===(t=s.plans)||void 0===t?void 0:t.filter((e=>{var s;return null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes("elite")})))||[]).reduce(((e,s)=>e+(s.total_seats||0)),0)}),0),b=m.filter((e=>{var s,t;return!r.trim()||(null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes(r.toLowerCase()))||(null===(t=e.domain)||void 0===t?void 0:t.toLowerCase().includes(r.toLowerCase()))})).sort(((e,s)=>{var t,a;const r=(null===(t=e.plan_summary)||void 0===t?void 0:t.total_seats)||0;return((null===(a=s.plan_summary)||void 0===a?void 0:a.total_seats)||0)-r}));return(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,te.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Ph.A,{className:"h-8 w-8 text-slate-600"}),(0,te.jsxs)("div",{className:"ml-3",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Orgs with Plans"}),(0,te.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:e.total_organizations_with_plans||0})]})]})}),(0,te.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Ge.A,{className:"h-8 w-8 text-slate-600"}),(0,te.jsxs)("div",{className:"ml-3",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Total Seats Purchased"}),(0,te.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:x})]})]})}),(0,te.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(Wa.A,{className:"h-8 w-8 text-slate-600"}),(0,te.jsxs)("div",{className:"ml-3",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Total Seats Used"}),(0,te.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:h})]})]})}),(0,te.jsx)("div",{className:"bg-white p-4 rounded-lg shadow",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(ea.A,{className:"h-8 w-8 text-slate-600"}),(0,te.jsxs)("div",{className:"ml-3",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Utilization Rate"}),(0,te.jsxs)("p",{className:"text-2xl font-bold text-slate-900",children:[p,"%"]})]})]})})]}),(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,te.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-green-500",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("div",{className:"h-8 w-8 bg-green-100 rounded-lg flex items-center justify-center",children:(0,te.jsx)("span",{className:"text-green-600 font-bold text-sm",children:"S"})}),(0,te.jsxs)("div",{className:"ml-3",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Starter Seats"}),(0,te.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:g})]})]})}),(0,te.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-blue-500",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("div",{className:"h-8 w-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,te.jsx)("span",{className:"text-blue-600 font-bold text-sm",children:"B"})}),(0,te.jsxs)("div",{className:"ml-3",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Builder Seats"}),(0,te.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:f})]})]})}),(0,te.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-purple-500",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("div",{className:"h-8 w-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,te.jsx)("span",{className:"text-purple-600 font-bold text-sm",children:"P"})}),(0,te.jsxs)("div",{className:"ml-3",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Pro Seats"}),(0,te.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:v})]})]})}),(0,te.jsx)("div",{className:"bg-white p-4 rounded-lg shadow border-l-4 border-orange-500",children:(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("div",{className:"h-8 w-8 bg-orange-100 rounded-lg flex items-center justify-center",children:(0,te.jsx)("span",{className:"text-orange-600 font-bold text-sm",children:"E"})}),(0,te.jsxs)("div",{className:"ml-3",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-600",children:"Elite Seats"}),(0,te.jsx)("p",{className:"text-2xl font-bold text-slate-900",children:j})]})]})})]}),Object.keys(u).length>0&&(0,te.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,te.jsxs)("h3",{className:"text-lg font-semibold text-slate-900 mb-4 flex items-center",children:[(0,te.jsx)(At.A,{className:"h-5 w-5 mr-2"}),"Seats Purchased by Day"]}),(0,te.jsx)("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-6 gap-3",children:Object.entries(u).sort(((e,s)=>{let[t]=e,[a]=s;return new Date(t)-new Date(a)})).map((e=>{let[s,t]=e;return(0,te.jsxs)("div",{className:"text-center p-3 bg-slate-50 rounded-lg",children:[(0,te.jsx)("div",{className:"text-sm font-medium text-slate-600",children:Bt()(s).format("MMM DD")}),(0,te.jsx)("div",{className:"text-lg font-bold text-slate-900",children:t}),(0,te.jsx)("div",{className:"text-xs text-slate-500",children:"seats"})]},s)}))})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsxs)("div",{className:"relative w-72",children:[(0,te.jsx)(Na.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-slate-500"}),(0,te.jsx)(Qs,{placeholder:"Search organizations...",className:"pl-8",value:r,onChange:e=>n(e.target.value)})]}),(0,te.jsxs)("div",{className:"text-sm text-slate-600",children:[b.length," of ",m.length," organizations"]})]}),(0,te.jsxs)("div",{className:"bg-white rounded-lg shadow",children:[(0,te.jsx)("div",{className:"p-6 border-b",children:(0,te.jsx)("h3",{className:"text-lg font-semibold text-slate-900",children:"Organizations with Plans"})}),(0,te.jsxs)(Ia,{children:[(0,te.jsx)(La,{children:(0,te.jsxs)(Da,{children:[(0,te.jsx)(Pa,{children:"Organization Name"}),(0,te.jsx)(Pa,{children:"Total Seats"}),(0,te.jsx)(Pa,{children:"Used Seats"}),(0,te.jsx)(Pa,{children:"Starter"}),(0,te.jsx)(Pa,{children:"Builder"}),(0,te.jsx)(Pa,{children:"Pro"}),(0,te.jsx)(Pa,{children:"Elite"}),(0,te.jsx)(Pa,{children:"Utilization Rate"}),(0,te.jsx)(Pa,{children:"Created Date"}),(0,te.jsx)(Pa,{children:"Actions"})]})}),(0,te.jsx)(Ta,{children:0===b.length?(0,te.jsx)(Da,{children:(0,te.jsx)(Ma,{colSpan:10,className:"text-center py-8",children:r?"No organizations found matching your search":"No organizations with plans found"})}):b.map((e=>{var s,t,a,r,n,l,o;const d=(null===(s=e.plans)||void 0===s?void 0:s.find((e=>{var s;return null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes("starter")})))||{total_seats:0,used_seats:0},m=(null===(t=e.plans)||void 0===t?void 0:t.find((e=>{var s;return null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes("builder")})))||{total_seats:0,used_seats:0},u=(null===(a=e.plans)||void 0===a?void 0:a.find((e=>{var s;return null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes("pro")})))||{total_seats:0,used_seats:0},x=(null===(r=e.plans)||void 0===r?void 0:r.filter((e=>{var s;return null===(s=e.name)||void 0===s?void 0:s.toLowerCase().includes("elite")})))||[],h=x.reduce(((e,s)=>e+(s.total_seats||0)),0),p=x.reduce(((e,s)=>e+(s.used_seats||0)),0);return(0,te.jsxs)(Da,{className:"hover:bg-slate-50 transition-colors",children:[(0,te.jsx)(Ma,{className:"font-medium",children:e.name||e.domain||"No name"}),(0,te.jsx)(Ma,{children:(0,te.jsx)("span",{className:"px-2 py-1 rounded-full text-xs bg-slate-100 text-slate-800",children:(null===(n=e.plan_summary)||void 0===n?void 0:n.total_seats)||0})}),(0,te.jsx)(Ma,{children:(0,te.jsx)("span",{className:"px-2 py-1 rounded-full text-xs bg-orange-100 text-orange-800",children:(null===(l=e.plan_summary)||void 0===l?void 0:l.used_seats)||0})}),(0,te.jsx)(Ma,{children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"text-sm font-medium text-slate-900",children:d.total_seats}),(0,te.jsxs)("div",{className:"text-xs text-slate-500",children:[d.used_seats," used"]})]})}),(0,te.jsx)(Ma,{children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"text-sm font-medium text-slate-900",children:m.total_seats}),(0,te.jsxs)("div",{className:"text-xs text-slate-500",children:[m.used_seats," used"]})]})}),(0,te.jsx)(Ma,{children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"text-sm font-medium text-slate-900",children:u.total_seats}),(0,te.jsxs)("div",{className:"text-xs text-slate-500",children:[u.used_seats," used"]})]})}),(0,te.jsx)(Ma,{children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"text-sm font-medium text-slate-900",children:h}),(0,te.jsxs)("div",{className:"text-xs text-slate-500",children:[p," used"]})]})}),(0,te.jsx)(Ma,{children:(0,te.jsxs)("span",{className:"px-2 py-1 rounded-full text-xs bg-blue-100 text-blue-800",children:[(null===(o=e.plan_summary)||void 0===o?void 0:o.utilization_rate)||0,"%"]})}),(0,te.jsx)(Ma,{children:(0,te.jsx)("span",{className:"text-sm text-slate-600",children:e.created_date?Bt().utc(e.created_date).format("YYYY-MM-DD"):"-"})}),(0,te.jsx)(Ma,{children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(e.id||e.organization_id)&&(0,te.jsxs)("a",{href:`/workspace/${e.id||e.organization_id}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-md transition-colors",title:"Manage workspace",children:[(0,te.jsx)(ur.A,{className:"h-3 w-3"}),"Manage"]}),(0,te.jsxs)("button",{onClick:()=>(c(e),void i(!0)),className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-slate-600 hover:text-slate-900 hover:bg-slate-100 rounded-md transition-colors",title:"Edit workspace configuration",children:[(0,te.jsx)(Ba.A,{className:"h-3 w-3"}),"Edit"]})]})})]},e.id||e.organization_id)}))})]})]}),(0,te.jsx)(Fh,{workspace:o,isOpen:l,onClose:()=>{i(!1),c(null)},onSave:async(e,s)=>{try{await Oh.updateWorkspace(e,s),await d()}catch(t){throw t}}})]})}var Uh=t(9449);const Bh=()=>{const[e,s]=(0,Y.useState)([]),[t,a]=(0,Y.useState)(!0),{register:r,handleSubmit:n,reset:l,formState:{errors:i}}=(0,Uh.useForm)({defaultValues:{code:"",numMessages:"",maxNumberOfPeople:"",domain:""}}),o=async()=>{try{a(!0);const e=await al.getCouponCodes();s(e||[])}catch(e){Rr({title:"Error",description:"Failed to fetch coupon codes",variant:"destructive"})}finally{a(!1)}};(0,Y.useEffect)((()=>{o()}),[]);return(0,te.jsxs)("div",{className:"container mx-auto py-8 space-y-6",children:[(0,te.jsx)("h1",{className:"text-3xl font-bold",children:"Coupon Code Management"}),(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Create Coupon Code"}),(0,te.jsx)(Gs,{children:"Create a new coupon code for users to redeem"})]}),(0,te.jsx)(Js,{children:(0,te.jsxs)("form",{onSubmit:n((async e=>{try{a(!0),await al.createCouponCode(e.code,parseInt(e.numMessages),parseInt(e.maxNumberOfPeople),e.domain||null),Rr({title:"Success",description:"Coupon code created successfully"}),l(),o()}catch(s){Rr({title:"Error",description:"Failed to create coupon code",variant:"destructive"})}finally{a(!1)}})),className:"space-y-4",children:[(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"code",children:"Code"}),(0,te.jsx)(Qs,{id:"code",placeholder:"SUMMER2023",...r("code",{required:"Code is required"})}),i.code&&(0,te.jsx)("span",{className:"text-sm text-red-500",children:i.code.message})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"numMessages",children:"Number of Messages"}),(0,te.jsx)(Qs,{id:"numMessages",type:"number",placeholder:"100",...r("numMessages",{required:"Number of messages is required",min:{value:1,message:"Must be at least 1"}})}),i.numMessages&&(0,te.jsx)("span",{className:"text-sm text-red-500",children:i.numMessages.message})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"maxNumberOfPeople",children:"Max Number of People"}),(0,te.jsx)(Qs,{id:"maxNumberOfPeople",type:"number",placeholder:"50",...r("maxNumberOfPeople",{required:"Max number of people is required",min:{value:1,message:"Must be at least 1"}})}),i.maxNumberOfPeople&&(0,te.jsx)("span",{className:"text-sm text-red-500",children:i.maxNumberOfPeople.message})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"domain",children:"Domain (Optional)"}),(0,te.jsx)(Qs,{id:"domain",placeholder:"example.com",...r("domain")}),(0,te.jsx)("p",{className:"text-xs text-gray-500",children:"Limit code to specific email domain"})]})]}),(0,te.jsx)(Rs,{type:"submit",disabled:t,children:"Create Coupon Code"})]})})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Existing Coupon Codes"}),(0,te.jsx)(Gs,{children:"View and manage all available coupon codes"})]}),(0,te.jsx)(Js,{children:t?(0,te.jsx)("div",{className:"flex justify-center items-center py-8",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-gray-900"})}):0===e.length?(0,te.jsx)("div",{className:"text-center py-8 text-gray-500",children:"No coupon codes found"}):(0,te.jsx)("div",{className:"rounded-md border",children:(0,te.jsxs)(Ia,{children:[(0,te.jsx)(La,{children:(0,te.jsxs)(Da,{children:[(0,te.jsx)(Pa,{children:"Code"}),(0,te.jsx)(Pa,{children:"Messages"}),(0,te.jsx)(Pa,{children:"Max Users"}),(0,te.jsx)(Pa,{children:"Domain"}),(0,te.jsx)(Pa,{children:"Usage"})]})}),(0,te.jsx)(Ta,{children:e.map(((e,s)=>(0,te.jsxs)(Da,{children:[(0,te.jsx)(Ma,{className:"font-medium",children:e.code}),(0,te.jsx)(Ma,{children:e.num_messages}),(0,te.jsx)(Ma,{children:e.max_number_of_people}),(0,te.jsx)(Ma,{children:e.domain||"Any"}),(0,te.jsxs)(Ma,{children:[e.used_credits||0," / ",e.max_number_of_people]})]},s)))})]})})})]})]})};function Wh(){const{user:e}=ne(),[s,t]=(0,J.useSearchParams)(),[a,r]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(null),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(""),[m,u]=(0,Y.useState)({key:"created_date",direction:"desc"}),[x,h]=(0,Y.useState)({totalUsers:0,newUsersToday:0,premiumUsers:0}),[p,g]=(0,Y.useState)([]),[f,v]=(0,Y.useState)(null),[j,b]=(0,Y.useState)(null),[y,N]=(0,Y.useState)({startDate:null,endDate:null}),w=(0,Y.useRef)(0);(0,Y.useEffect)((()=>{S()}),[]),(0,Y.useEffect)((()=>(f&&clearTimeout(f),v(setTimeout((()=>{c.trim()?_(c):k()}),500)),()=>{f&&clearTimeout(f)})),[c]),(0,Y.useEffect)((()=>{n?(C(n.id),A(n.id),y.startDate||N({startDate:null,endDate:null})):(b(null),N({startDate:null,endDate:null}))}),[n]),(0,Y.useEffect)((()=>{const e=s.get("userId");if(e&&a.length>0){const s=a.find((s=>s.id===e));s?l(s):E(e)}}),[a,s]);const k=async()=>{o(!0);try{const e=await Q.listUsers({limit:100});r(e)}catch(e){}finally{o(!1)}},_=async e=>{o(!0);try{const s=await Q.listUsers({limit:100,q:JSON.stringify({$or:[{email:{$regex:e,$options:"i"}},{full_name:{$regex:e,$options:"i"}}]})});r(s)}catch(s){}finally{o(!1)}},S=async()=>{const e=await $h.getUserAnalytics();h(e)},C=async e=>{try{const s=await al.getBonusCredits(e);g(s)}catch(s){g([])}},A=async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,r=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null;const n=Date.now();w.current=n,null!==a&&b(null);try{const r=await Qe.default.getUserStats(e,s,t,a);n>=w.current&&b(r)}catch(l){n>=w.current&&b(null)}finally{r&&r()}},E=async e=>{o(!0);try{const s=await Q.get(e);l(s)}catch(a){const e=new URLSearchParams(s);e.delete("userId"),t(e)}finally{o(!1)}},I=e=>{u({key:e,direction:m.key===e&&"asc"===m.direction?"desc":"asc"})},L=a.sort(((e,s)=>"created_date"===m.key?"asc"===m.direction?new Date(e[m.key])-new Date(s[m.key]):new Date(s[m.key])-new Date(e[m.key]):"asc"===m.direction?e[m.key]>s[m.key]?1:-1:s[m.key]>e[m.key]?1:-1));return e.platform_role.includes("admin")?(0,te.jsxs)("div",{className:"container mx-auto py-10 px-4",children:[(0,te.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Admin Portal"}),(0,te.jsxs)(lr,{defaultValue:"users",className:"mb-8",children:[(0,te.jsxs)(ir,{className:"grid grid-cols-4 w-[500px] mb-4",children:[(0,te.jsx)(or,{value:"users",children:"User Management"}),(0,te.jsx)(or,{value:"organizations",children:"Organizations"}),(0,te.jsx)(or,{value:"statistics",children:"Statistics"}),(0,te.jsx)(or,{value:"coupons",children:"Coupon Codes"})]}),(0,te.jsxs)(cr,{value:"users",children:[(0,te.jsxs)("div",{className:"mb-4",children:[(0,te.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"User Management"}),(0,te.jsx)(Nh,{stats:x}),(0,te.jsxs)("div",{className:"flex justify-between items-center mb-6 mt-6",children:[(0,te.jsxs)("div",{className:"relative w-72",children:[(0,te.jsx)(Na.A,{className:"absolute left-2 top-2.5 h-4 w-4 text-gray-500"}),(0,te.jsx)(Qs,{placeholder:"Search users...",className:"pl-8",value:c,onChange:e=>d(e.target.value)})]}),(0,te.jsxs)(Rs,{onClick:()=>{const e=L.map((e=>[e.email,e.full_name||"",e.platform_role,Bt().utc(e.created_date).format("YYYY-MM-DD HH:mm:ss"),e.subscription_tier||"Free",e.stripe_customer_id||"",e.api_key||""])),s=[["Email","Full Name","Platform Role","Created Date","Subscription Tier","Stripe Customer ID","API Key"].join(","),...e.map((e=>e.map((e=>`"${e}"`)).join(",")))].join("\n"),t=new Blob([s],{type:"text/csv;charset=utf-8;"}),a=document.createElement("a"),r=URL.createObjectURL(t);a.setAttribute("href",r),a.setAttribute("download",`users_${Bt()().format("YYYY-MM-DD")}.csv`),a.style.visibility="hidden",document.body.appendChild(a),a.click(),document.body.removeChild(a)},className:"flex items-center gap-2",children:[(0,te.jsx)(vo.A,{className:"h-4 w-4"}),"Download CSV"]})]})]}),(0,te.jsx)("div",{className:"bg-white rounded-lg shadow",children:(0,te.jsxs)(Ia,{children:[(0,te.jsx)(La,{children:(0,te.jsxs)(Da,{children:[(0,te.jsx)(Pa,{className:"cursor-pointer",onClick:()=>I("email"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Email",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Pa,{className:"cursor-pointer",onClick:()=>I("full_name"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Full Name",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Pa,{className:"cursor-pointer",onClick:()=>I("platform_role"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Platform Role",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Pa,{className:"cursor-pointer",onClick:()=>I("created_date"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Created Date",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Pa,{className:"cursor-pointer",onClick:()=>I("subscription_tier"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Subscription Plan",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Pa,{children:"Actions"})]})}),(0,te.jsx)(Ta,{children:i?(0,te.jsx)(Da,{children:(0,te.jsx)(Ma,{colSpan:6,className:"text-center py-8",children:"Loading users..."})}):0===L.length?(0,te.jsx)(Da,{children:(0,te.jsx)(Ma,{colSpan:6,className:"text-center py-8",children:"No users found"})}):L.map((e=>{var a,r,n,i,o;return(0,te.jsxs)(Da,{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>{l(e);const a=new URLSearchParams(s);a.set("userId",e.id),t(a)},children:[(0,te.jsx)(Ma,{className:"font-medium",children:e.email}),(0,te.jsx)(Ma,{children:e.full_name||"-"}),(0,te.jsx)(Ma,{children:(0,te.jsx)("span",{className:"px-2 py-1 rounded-full text-xs "+("platform_admin"===e.platform_role?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800"),children:e.platform_role})}),(0,te.jsx)(Ma,{children:Bt().utc(e.created_date).fromNow()}),(0,te.jsx)(Ma,{children:(0,te.jsx)("span",{className:"px-2 py-1 rounded-full text-xs "+(null!==(a=e.subscription_tier)&&void 0!==a&&a.toLowerCase().includes("enterprise")?"bg-yellow-100 text-yellow-800":null!==(r=e.subscription_tier)&&void 0!==r&&r.toLowerCase().includes("elite")?"bg-purple-100 text-purple-800":null!==(n=e.subscription_tier)&&void 0!==n&&n.toLowerCase().includes("pro")?"bg-blue-100 text-blue-800":null!==(i=e.subscription_tier)&&void 0!==i&&i.toLowerCase().includes("builder")?"bg-indigo-100 text-indigo-800":null!==(o=e.subscription_tier)&&void 0!==o&&o.toLowerCase().includes("starter")?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"),children:e.subscription_tier||"Free"})}),(0,te.jsx)(Ma,{children:(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:a=>{a.stopPropagation(),l(e);const r=new URLSearchParams(s);r.set("userId",e.id),t(r)},children:"Edit"})})]},e.id)}))})]})})]}),(0,te.jsx)(cr,{value:"organizations",children:(0,te.jsx)(zh,{})}),(0,te.jsx)(cr,{value:"statistics",children:(0,te.jsxs)("div",{children:[(0,te.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"User Statistics"}),(0,te.jsx)(Dh,{})]})}),(0,te.jsx)(cr,{value:"coupons",children:(0,te.jsxs)("div",{children:[(0,te.jsx)("h2",{className:"text-2xl font-bold mb-4",children:"Coupon Code Management"}),(0,te.jsx)(Bh,{})]})})]}),(0,te.jsx)(Lh,{selectedUser:n,onClose:()=>{l(null);const e=new URLSearchParams(s);e.delete("userId"),t(e)},onUpdateUser:async(e,s)=>{o(!0);try{const t=await Q.updateUser(e,s);r(a.map((s=>s.id===e?t:s))),l(t)}catch(t){}finally{o(!1)}},userBonusCredits:p,onAddBonusCredits:async(e,s,t)=>{o(!0);try{await al.addBonusCredits(e,s,t),await C(e)}catch(a){}finally{o(!1)}},onDeleteBonusCredit:async e=>{if(n&&e){o(!0);try{await Tn.deleteBonusCredits(n.id,e),await C(n.id)}catch(s){}finally{o(!1)}}},loading:i,userUsageStats:j,onDateRangeChange:(e,s,t,a)=>{N({startDate:e,endDate:s}),n?A(n.id,e,s,t,a):a&&a()},dateRange:y})]}):(0,te.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)(gh.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,te.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,te.jsx)("p",{className:"text-gray-600",children:"You are not authorized to access this page"})]})})}const qh=function(){var e,s;const[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)([]),[l,i]=(0,Y.useState)(!0);if((0,Y.useEffect)((()=>{(async()=>{try{const[e,s]=await Promise.all([$h.getAdminStats(),ta.getTrendingApps()]);a(e),n(s.trending_apps)}catch(e){}finally{i(!1)}})()}),[]),l)return(0,te.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})});const o=(null==t||null===(e=t.usage_by_date)||void 0===e?void 0:e.map((e=>({date:e._id,messages:e.total_messages}))))||[],c=(null==t||null===(s=t.tokens_by_user_7d)||void 0===s?void 0:s.map((e=>({user:e._id,tokens:e.total_tokens}))))||[],d=r.map((e=>({name:e.name,visits:e.total_visits,users:e.unique_users})));return(0,te.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,te.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Platform Analytics"}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsx)(Hs,{children:"Messages Per Day"})}),(0,te.jsx)(Js,{children:(0,te.jsx)("div",{className:"h-[400px]",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)($d.Q,{data:o,children:[(0,te.jsx)(Dd.d,{strokeDasharray:"3 3"}),(0,te.jsx)(Pd.W,{dataKey:"date"}),(0,te.jsx)(Md.h,{}),(0,te.jsx)(Od.m,{}),(0,te.jsx)(Rd.G,{type:"monotone",dataKey:"messages",stroke:"#8884d8",fill:"#8884d8",fillOpacity:.3})]})})})})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsx)(Hs,{children:"Top Users by Token Usage (Last 7 Days)"})}),(0,te.jsx)(Js,{children:(0,te.jsx)("div",{className:"h-[400px]",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)($x.E,{data:c,children:[(0,te.jsx)(Dd.d,{strokeDasharray:"3 3"}),(0,te.jsx)(Pd.W,{dataKey:"user",angle:-45,textAnchor:"end",height:100}),(0,te.jsx)(Md.h,{}),(0,te.jsx)(Od.m,{}),(0,te.jsx)(Dx.y,{dataKey:"tokens",fill:"#82ca9d"})]})})})})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsx)(Hs,{children:"Trending Apps (Last 7 Days)"})}),(0,te.jsx)(Js,{children:(0,te.jsx)("div",{className:"h-[400px]",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)($x.E,{data:d,children:[(0,te.jsx)(Dd.d,{strokeDasharray:"3 3"}),(0,te.jsx)(Pd.W,{dataKey:"name",angle:-45,textAnchor:"end",height:100}),(0,te.jsx)(Md.h,{}),(0,te.jsx)(Od.m,{}),(0,te.jsx)(Dx.y,{dataKey:"visits",fill:"#8884d8",name:"Total Visits"}),(0,te.jsx)(Dx.y,{dataKey:"users",fill:"#82ca9d",name:"Unique Users"})]})})})})]}),(0,te.jsx)(Ud,{appId:"all"})]})},Vh=(0,ts.cva)("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-slate-950 disabled:pointer-events-none disabled:opacity-50 dark:focus-visible:ring-slate-300",{variants:{variant:{default:"bg-slate-900 text-slate-50 shadow hover:bg-slate-900/90",destructive:"bg-red-500 text-slate-50 shadow-sm hover:bg-red-500/90",outline:"border border-slate-200 bg-white shadow-sm hover:bg-slate-100 hover:text-slate-900",secondary:"bg-slate-100 text-slate-900 shadow-sm hover:bg-slate-100/80",ghost:"hover:bg-slate-100 hover:text-slate-900",link:"text-slate-900 underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Yh=Y.forwardRef(((e,s)=>{let{className:t,variant:a,size:r,asChild:n=!1,...l}=e;const i=n?Ms.DX:"button";return(0,te.jsx)(i,{className:ns(Vh({variant:a,size:r,className:t})),ref:s,...l})}));Yh.displayName="Button";const Hh=Y.forwardRef(((e,s)=>{let{className:t,type:a,...r}=e;return(0,te.jsx)("input",{type:a,className:ns("flex h-9 w-full rounded-md border border-slate-200 bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-slate-500 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-slate-950 disabled:cursor-not-allowed disabled:opacity-50 dark:border-slate-800 dark:placeholder:text-slate-400 dark:focus-visible:ring-slate-300",t),ref:s,...r})}));Hh.displayName="Input";const Gh=e=>{let{buttonText:s={default:"Continue with Google",loading:"Please wait..."}}=e;const t=(0,Z.zy)(),a=new URLSearchParams(t.search),[r,n]=(0,Y.useState)(!1);return(0,te.jsxs)(Yh,{variant:"outline",className:"w-full h-10 bg-white border border-[#E4E4E7] hover:bg-slate-50 py-2 px-4 gap-2.5 rounded-md shadow-xs",type:"button",onClick:async()=>{n(!0);try{const e=a.get("from_url")||"/";let s=`${(0,bd.Zk)()}/auth/login?from_url=${e}`;window.location.href=s}catch(e){n(!1)}},disabled:r,children:[(0,te.jsxs)("svg",{className:"h-4 w-4",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,te.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),(0,te.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),(0,te.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),(0,te.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),r?s.loading:s.default]})},Jh=e=>{let{name:s,value:t,onChange:a,placeholder:r="Enter your email address",required:n=!1,disabled:l=!1,label:i="Email",onValidationChange:o}=e;const[c,d]=Y.useState(null);return(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("label",{htmlFor:s,className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:i}),(0,te.jsx)(Hh,{name:s,type:"email",placeholder:r,value:t,onChange:e=>{const{value:s}=e.target;c&&(d(null),null==o||o(!0)),a(e)},onBlur:e=>{const{value:s}=e.target;s&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?(d("That's not a valid email. Try a different email address."),null==o||o(!1)):s&&(d(null),null==o||o(!0))},required:n,disabled:l,className:"bg-white text-[#09090B] h-9 px-3 py-1 rounded-md shadow-xs "+(c?"border border-[#DC2626]":"border border-[#E4E4E7]")}),c&&(0,te.jsx)("p",{className:"text-[14px] leading-[20px] tracking-[0%] text-[#DC2626] font-normal mt-1",children:c})]})},Zh=()=>(0,te.jsxs)("svg",{width:"147",height:"24",viewBox:"0 0 147 36",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:[(0,te.jsx)("path",{d:"M28.2533 31.4621C28.2999 31.4621 28.3204 31.5214 28.2833 31.5498C25.3198 33.8234 21.6115 35.1751 17.5875 35.1751C13.5635 35.1751 9.85519 33.8238 6.8917 31.5498C6.85457 31.5214 6.87509 31.4621 6.92166 31.4621H28.2537H28.2533ZM32.8411 26.3487C32.2268 27.416 31.5034 28.4127 30.6869 29.3236C30.656 29.3582 30.6117 29.3777 30.5654 29.3777H4.60988C4.56364 29.3777 4.51934 29.3582 4.4884 29.3236C3.67156 28.4127 2.94852 27.416 2.33426 26.3487C2.30918 26.3054 2.34077 26.251 2.39093 26.251H32.7844C32.8346 26.251 32.8661 26.3054 32.8411 26.3487ZM34.8272 21.0855C34.6181 22.1209 34.3181 23.1234 33.9361 24.0845C33.9162 24.134 33.868 24.1666 33.8146 24.1666H1.36043C1.30702 24.1666 1.25882 24.134 1.23895 24.0845C0.856909 23.1237 0.556944 22.1212 0.347848 21.0855C0.339706 21.0451 0.370647 21.0074 0.41201 21.0074H34.763C34.804 21.0074 34.8353 21.0451 34.8272 21.0855ZM17.4686 0.000392079C27.2365 -0.0640954 35.175 7.83464 35.175 17.5876C35.175 18.0162 35.1597 18.4412 35.1297 18.8623C35.1274 18.8965 35.0988 18.9229 35.0646 18.9229H0.110743C0.076545 18.9229 0.0478839 18.8965 0.045604 18.8623C0.0156401 18.4467 0.000332489 18.0269 6.79435e-06 17.6035C-0.00846126 8.0343 7.89972 0.0639025 17.4686 0.000392079Z",fill:"black"}),(0,te.jsx)("path",{d:"M28.2533 31.4621C28.2999 31.4621 28.3204 31.5214 28.2833 31.5498C25.3198 33.8234 21.6115 35.1751 17.5875 35.1751C13.5635 35.1751 9.85519 33.8238 6.8917 31.5498C6.85457 31.5214 6.87509 31.4621 6.92166 31.4621H28.2537H28.2533ZM32.8411 26.3487C32.2268 27.416 31.5034 28.4127 30.6869 29.3236C30.656 29.3582 30.6117 29.3777 30.5654 29.3777H4.60988C4.56364 29.3777 4.51934 29.3582 4.4884 29.3236C3.67156 28.4127 2.94852 27.416 2.33426 26.3487C2.30918 26.3054 2.34077 26.251 2.39093 26.251H32.7844C32.8346 26.251 32.8661 26.3054 32.8411 26.3487ZM34.8272 21.0855C34.6181 22.1209 34.3181 23.1234 33.9361 24.0845C33.9162 24.134 33.868 24.1666 33.8146 24.1666H1.36043C1.30702 24.1666 1.25882 24.134 1.23895 24.0845C0.856909 23.1237 0.556944 22.1212 0.347848 21.0855C0.339706 21.0451 0.370647 21.0074 0.41201 21.0074H34.763C34.804 21.0074 34.8353 21.0451 34.8272 21.0855ZM17.4686 0.000392079C27.2365 -0.0640954 35.175 7.83464 35.175 17.5876C35.175 18.0162 35.1597 18.4412 35.1297 18.8623C35.1274 18.8965 35.0988 18.9229 35.0646 18.9229H0.110743C0.076545 18.9229 0.0478839 18.8965 0.045604 18.8623C0.0156401 18.4467 0.000332489 18.0269 6.79435e-06 17.6035C-0.00846126 8.0343 7.89972 0.0639025 17.4686 0.000392079Z",fill:"#FF983B"}),(0,te.jsx)("path",{d:"M45.675 6.95605H55.3324C59.9211 6.95605 62.1243 9.07361 62.1243 12.4343C62.1243 14.6432 60.9159 16.248 59.2275 17.003C61.3117 17.6071 63 19.2435 63 21.9335C63 25.7753 60.3449 27.9561 55.3324 27.9561H45.675V6.95605ZM54.2465 10.4362H49.9905V15.6405H54.2465C56.5689 15.6405 57.7178 14.9452 57.7178 13.0383C57.7178 11.1315 56.5724 10.4362 54.2465 10.4362ZM54.912 18.938H49.994V24.476H54.912C57.2974 24.476 58.5935 23.7209 58.5935 21.7228C58.5935 19.7246 57.2939 18.938 54.912 18.938Z",fill:"black"}),(0,te.jsx)("path",{d:"M74.486 27.919V25.5781C73.3926 27.3477 71.3255 28.2186 68.9834 28.2186C66.0662 28.2186 63.7875 26.658 63.7875 23.8364C63.7875 21.1959 65.7946 19.6945 68.74 19.1824L74.2109 18.2524V17.8936C74.2109 16.2737 72.994 15.5527 71.262 15.5527C69.4384 15.5527 68.5565 16.3643 68.4366 17.6253H64.3343C64.486 14.4449 67.0398 12.7311 71.2656 12.7311C75.9146 12.7311 78.225 14.6226 78.225 18.5833V27.919H74.486ZM74.2144 21.7358V21.0461L70.1121 21.7672C68.4719 22.0389 67.71 22.5161 67.71 23.6587C67.71 24.648 68.5918 25.2785 70.1121 25.2785C72.0874 25.2785 74.2144 24.0175 74.2144 21.7358Z",fill:"black"}),(0,te.jsx)("path",{d:"M86.4047 12.7311C90.0182 12.7311 93.1215 14.26 93.181 17.5337H89.1445C89.0537 16.4227 88.0612 15.552 86.2824 15.552C84.8355 15.552 83.8116 16.1511 83.8116 17.0531C83.8116 17.9551 84.5036 18.2232 85.8001 18.4636L89.204 19.1253C91.9159 19.6337 93.45 21.0164 93.45 23.4159C93.45 26.3275 91.0701 28.2186 86.6738 28.2186C82.2774 28.2186 79.6878 26.2683 79.5375 23.1164H83.7522C83.871 24.3772 84.8356 25.3976 86.8241 25.3976C88.6623 25.3976 89.5325 24.708 89.5325 23.8373C89.5325 22.9667 88.8405 22.608 87.544 22.3676L84.1401 21.7373C81.4317 21.2288 79.894 19.8183 79.894 17.4153C79.894 14.5351 82.5151 12.7345 86.3977 12.7345L86.4047 12.7311Z",fill:"black"}),(0,te.jsx)("path",{d:"M101.797 12.7311C106.609 12.7311 109.463 15.5834 109.463 20.3825V21.6746H98.099C98.1897 23.5065 99.5713 25.2165 101.766 25.2165C103.36 25.2165 104.683 24.4364 105.042 23.1164H109.25C108.59 26.418 105.611 28.2186 101.762 28.2186C97.314 28.2186 93.975 25.4568 93.975 20.4765C93.975 15.8237 97.0104 12.7345 101.79 12.7345L101.797 12.7311ZM105.342 18.9128C105.251 16.9939 103.748 15.6112 101.885 15.6112C99.84 15.6112 98.3677 17.1401 98.1269 18.9128H105.342Z",fill:"black"}),(0,te.jsx)("path",{d:"M124.283 27.9561V23.598H113.925V20.0863L123.469 6.95605H128.363V27.9561H124.283ZM124.283 11.4651L118.061 20.1811H124.283V11.4651Z",fill:"black"}),(0,te.jsx)("path",{d:"M140.333 23.5952H129.938V20.0841L139.514 6.95605H144.425V20.1789H147V23.5988H144.425V27.9561H140.333V23.5952ZM140.333 11.4643L134.089 20.1789H140.333V11.4643Z",fill:"black"})]}),Kh=e=>{let{className:s=""}=e;return(0,te.jsx)("div",{className:`hidden lg:block relative min-h-screen p-4 ${s}`,children:(0,te.jsx)("div",{className:"h-full w-full bg-white rounded-2xl p-4",children:(0,te.jsxs)("div",{className:"relative h-full w-full",children:[(0,te.jsx)("img",{src:"/assets/auth/auth-page-image.jpg",alt:"Creative workspace",className:"absolute inset-0 h-full w-full object-cover rounded-2xl"}),(0,te.jsx)("div",{className:"absolute inset-0 flex items-center justify-center py-6 px-12 xl:px-16 2xl:px-20",children:(0,te.jsx)("div",{className:"w-full max-w-3xl",children:(0,te.jsx)("div",{className:"bg-gradient-to-br from-white/80 to-white/30 backdrop-blur-md rounded-[12px] xl:rounded-[16px] 2xl:rounded-[20px] p-3 border border-white/30",children:(0,te.jsxs)("div",{className:"flex items-center gap-4",children:[(0,te.jsxs)("div",{className:"flex-1 flex items-center gap-3",children:[(0,te.jsx)("span",{className:"text-slate-400 text-[22px] xl:text-[30px] 2xl:text-[40px] pl-2 font-normal bg-gradient-to-r from-[#BCD2EB] via-[#A7BDD5] to-[#A7BDD5] bg-clip-text text-transparent",children:"Turn your ideas into apps"}),(0,te.jsx)("div",{className:"w-0.5 h-[30px] xl:h-[40px] 2xl:h-[54px] bg-gradient-to-b from-slate-300 to-slate-400"})]}),(0,te.jsx)("div",{className:"flex-shrink-0",children:(0,te.jsx)("div",{className:"w-[30px] h-[30px] xl:w-[40px] xl:h-[40px] 2xl:w-[54px] 2xl:h-[54px] rounded-md xl:rounded-[8px] 2xl:rounded-[12px] bg-gradient-to-br from-slate-400/80 to-slate-300/80 flex items-center justify-center",children:(0,te.jsx)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",className:"text-white",children:(0,te.jsx)("path",{d:"M12 4L12 20M12 4L18 10M12 4L6 10",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})})})]})})})})]})})})},Xh=e=>{let{className:s=""}=e;return(0,te.jsx)("div",{className:`lg:hidden absolute inset-0 ${s}`,children:(0,te.jsx)("img",{src:"/assets/auth/auth-page-image.jpg",alt:"Creative workspace",className:"absolute inset-0 h-full w-full object-cover"})})},Qh=e=>{let{title:s,subtitle:t,showImageColumn:a=!0,backLink:r,footerContent:n,children:l,className:i=""}=e;return(0,te.jsx)("div",{className:"min-h-screen bg-white",children:(0,te.jsxs)("div",{className:(a?"grid grid-cols-1 lg:grid-cols-2":"")+" min-h-screen",children:[(0,te.jsxs)("div",{className:"relative min-h-screen",children:[(0,te.jsx)(Xh,{}),(0,te.jsx)("div",{className:"absolute top-6 lg:top-8 z-10",children:(0,te.jsx)(J.Link,{to:"/",children:(0,te.jsx)(Zh,{})})}),(0,te.jsx)("div",{className:"flex items-center justify-center min-h-screen p-6 lg:p-8 relative z-10",children:(0,te.jsxs)("div",{className:`w-full max-w-md bg-white rounded-2xl p-6 lg:p-8 lg:bg-transparent lg:rounded-none space-y-6 shadow-lg lg:shadow-none ${i}`,children:[r&&(0,te.jsx)("div",{className:"mb-6",children:(0,te.jsxs)(J.Link,{to:r.href,className:"inline-flex items-center text-sm text-[#71717A] hover:text-[#09090B] font-medium",children:[(0,te.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,te.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 19l-7-7 7-7"})}),r.text]})}),(0,te.jsxs)("div",{className:"space-y-2 text-center",children:[(0,te.jsx)("h1",{className:"text-[20px] lg:text-[48px] font-semibold text-[#09090B] leading-[61px] tracking-[0%] text-center",children:s}),t&&(0,te.jsx)("p",{className:"text-[#71717A] text-base leading-6",children:t})]}),l]})}),n&&(0,te.jsx)("div",{className:"absolute bottom-6 left-6 right-6 lg:bottom-8 lg:left-8 lg:right-8 z-20",children:n})]}),a&&(0,te.jsx)(Kh,{})]})})},ep=()=>{const[e,s]=(0,Y.useState)(!1),[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)({email:"",password:""}),d=(0,Z.Zp)(),m=(0,Z.zy)();(0,Y.useEffect)((()=>{const e=m.state;null!=e&&e.message&&(n(e.message),e.email&&c((s=>({...s,email:e.email}))))}),[m]);const u=e=>{const{name:s,value:l}=e.target;c((e=>({...e,[s]:l}))),t&&a(null),r&&n(null)};return(0,te.jsxs)(Qh,{title:"Welcome to Base44",showImageColumn:!0,children:[(0,te.jsx)(Gh,{buttonText:{default:"Log in with Google",loading:"Logging in..."}}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,te.jsx)(Xs,{})}),(0,te.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,te.jsx)("span",{className:"bg-white px-2 text-slate-500",children:"Or"})})]}),l&&(0,te.jsxs)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:["Please verify your email before logging in. Check your email for the verification code.",(0,te.jsx)("div",{className:"mt-2",children:(0,te.jsx)("button",{onClick:async()=>{if(o.email)try{s(!0),await Q.resendOtp(o.email),d("/verify-email",{state:{email:o.email,isFromLogin:!0}})}catch(t){a("Failed to resend verification code. Please try again.")}finally{s(!1)}else a("Please enter your email address first.")},disabled:e,className:"text-orange-600 hover:text-orange-500 underline",children:"Resend verification code"})})]}),(0,te.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),s(!0),a(null),n(null),i(!1);try{const e=await Q.login(o.email,o.password,null);if(e.success&&e.access_token){(0,se.O5)(e.access_token);const s=new URLSearchParams(window.location.search).get("from_url");window.location.href=s||"/"}else a("Login failed. Please try again.")}catch(t){var r;if(400===(null===(r=t.response)||void 0===r?void 0:r.status)){var l;const s=(null===(l=t.response.data)||void 0===l?void 0:l.detail)||"Invalid email or password";s.includes("verify your email")?(i(!0),a("Please verify your email before logging in. Check your email for the verification code.")):a(s)}else a("Login failed. Please try again.")}finally{s(!1)}},className:"space-y-6",children:[(0,te.jsx)(Jh,{name:"email",value:o.email,onChange:e=>{u(e)},placeholder:"Enter your email address",required:!0,disabled:e,label:"Email"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("label",{htmlFor:"password",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"Password"}),(0,te.jsx)(J.Link,{to:"/forgot-password",className:"text-sm font-medium leading-5 tracking-normal text-[#71717A]",children:"Forgot password?"})]}),(0,te.jsx)(Hh,{name:"password",type:"password",placeholder:"Enter your password",value:o.password,onChange:u,required:!0,disabled:e,className:"bg-white text-[#09090B] h-9 px-3 py-1 rounded-md shadow-xs "+(t&&!l?"border border-[#DC2626]":"border border-[#E4E4E7]")}),t&&!l&&(0,te.jsx)("p",{className:"text-[14px] leading-[20px] tracking-[0%] text-[#DC2626] font-normal mt-1",children:t})]}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)(Yh,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:e,children:e?"Logging in...":"Log In"}),r&&(0,te.jsx)("div",{className:"p-4 text-sm text-green-600 bg-green-50 border border-green-200 rounded-md",children:r}),(0,te.jsxs)("p",{className:"text-center text-sm text-[#71717A]",children:["Don't have an account?"," ",(0,te.jsx)(J.Link,{to:"/register",className:"font-medium text-black underline",children:"Sign up"})]})]})]})]})},sp=(0,Y.forwardRef)(((e,s)=>{let{siteKey:t,onSuccess:a,onError:r,onExpired:n,theme:l="light",size:i="normal",className:o=""}=e;const c=(0,Y.useRef)(null),[d,m]=(0,Y.useState)(null),[u,x]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{const e=()=>{window.turnstile?x(!0):setTimeout(e,100)};e()}),[]),(0,Y.useEffect)((()=>{if(u&&c.current&&!d)try{const e=window.turnstile.render(c.current,{sitekey:t,theme:l,size:i,callback:e=>{null==a||a(e)},"error-callback":e=>{null==r||r(e)},"expired-callback":()=>{null==n||n()}});m(e)}catch(e){null==r||r("Failed to load security verification")}return()=>{if(d&&window.turnstile)try{window.turnstile.remove(d)}catch(e){}}}),[u,t,l,i,d,a,r,n]);const h=()=>{if(d&&window.turnstile)try{window.turnstile.reset(d)}catch(e){}},p=()=>{if(d&&window.turnstile)try{return window.turnstile.getResponse(d)}catch(e){return""}return""};return(0,Y.useImperativeHandle)(s,(()=>({reset:h,getResponse:p}))),(0,te.jsx)("div",{className:`turnstile-container ${o}`,children:(0,te.jsx)("div",{ref:c})})}));sp.displayName="Turnstile";const tp=sp,ap="0x4AAAAAABkwg1ZNNlkay6SI",rp="light",np="normal",lp=!0,ip=e=>e&&e.length>0,op=e=>{let{onSuccess:s,onError:t,onExpired:a,isVerified:r=!1,className:n=""}=e;return lp?r?null:(0,te.jsx)("div",{className:`space-y-2 ${n}`,children:(0,te.jsx)(tp,{siteKey:ap,theme:rp,size:np,onSuccess:s,onError:t,onExpired:a,className:"flex justify-center"})}):null},cp=e=>{const s=e.length>=8,t=/[a-z]/.test(e)&&/[A-Z]/.test(e),a=/[#$&@!%*?&]/.test(e);let r=0;s&&r++,t&&r++,a&&r++;let n="Weak password";return r>=3?n="Strong password":r>=2&&(n="Average password"),{score:r,label:n,hasMinLength:s,hasUpperLower:t,hasSymbol:a}},dp=e=>e>=3?"bg-green-500":e>=2?"bg-yellow-500":"bg-orange-500",mp=e=>{const s=[];for(let t=0;t<3;t++)s.push((0,te.jsx)("div",{className:`h-1 flex-1 rounded-full ${t<e?dp(e):"bg-gray-200"}`},t));return s},up=e=>{let{password:s,showTooltip:t,onMouseEnter:a,onMouseLeave:r}=e;const n=cp(s);return t&&s?(0,te.jsxs)("div",{className:"absolute left-full top-1/2 -translate-y-1/2 ml-3 w-[265px] bg-white border border-[#E4E4E7] rounded-lg shadow-lg py-3 px-3 z-10",style:{borderRadius:"8px"},onMouseEnter:a,onMouseLeave:r,children:[(0,te.jsx)("div",{className:"absolute right-full top-1/2 -translate-y-1/2 w-0 h-0 border-t-[6px] border-b-[6px] border-r-[6px] border-t-transparent border-b-transparent border-r-[#E4E4E7]"}),(0,te.jsx)("div",{className:"absolute right-full top-1/2 -translate-y-1/2 translate-x-px w-0 h-0 border-t-[6px] border-b-[6px] border-r-[6px] border-t-transparent border-b-transparent border-r-white"}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("div",{className:"flex justify-between items-center mb-2",children:(0,te.jsx)("span",{className:"text-sm font-medium text-[#09090B]",children:n.label})}),(0,te.jsx)("div",{className:"flex space-x-1",children:mp(n.score)})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm text-[#71717A] mb-2",children:"Password must include:"}),(0,te.jsxs)("ul",{className:"space-y-1 text-sm",children:[(0,te.jsxs)("li",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-[18px] h-[18px] rounded-full border-2 flex items-center justify-center border-[#71717A]",children:n.hasMinLength&&(0,te.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",children:(0,te.jsx)("path",{d:"M9 1L3.5 6.5L1 4",stroke:"#71717A",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,te.jsx)("span",{className:"text-[#09090B]",children:"At least 8 characters"})]}),(0,te.jsxs)("li",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-[18px] h-[18px] rounded-full border-2 flex items-center justify-center border-[#71717A]",children:n.hasUpperLower&&(0,te.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",children:(0,te.jsx)("path",{d:"M9 1L3.5 6.5L1 4",stroke:"#71717A",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,te.jsx)("span",{className:"text-[#09090B]",children:"Upper & lower case letters"})]}),(0,te.jsxs)("li",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-[18px] h-[18px] rounded-full border-2 flex items-center justify-center border-[#71717A]",children:n.hasSymbol&&(0,te.jsx)("svg",{width:"10",height:"8",viewBox:"0 0 10 8",fill:"none",children:(0,te.jsx)("path",{d:"M9 1L3.5 6.5L1 4",stroke:"#71717A",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,te.jsx)("span",{className:"text-[#09090B]",children:"A symbol (#$&)"})]})]})]})]})]}):null},xp=e=>{let{password:s,showTooltip:t}=e;const a=cp(s);return t&&s?(0,te.jsxs)("div",{className:"w-full bg-[#F8F9FA] border border-[#E4E4E7] rounded-xl p-4 space-y-3",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-[#09090B] mb-3",children:"Password must include:"}),(0,te.jsxs)("ul",{className:"space-y-3",children:[(0,te.jsxs)("li",{className:"flex items-center gap-3",children:[(0,te.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+(a.hasMinLength?"bg-[#71717A] border-[#71717A]":"border-[#71717A] bg-transparent"),children:a.hasMinLength&&(0,te.jsx)("svg",{width:"12",height:"10",viewBox:"0 0 12 10",fill:"none",children:(0,te.jsx)("path",{d:"M10 2L4.5 7.5L2 5",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,te.jsx)("span",{className:"text-sm text-[#09090B]",children:"At least 8 characters"})]}),(0,te.jsxs)("li",{className:"flex items-center gap-3",children:[(0,te.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+(a.hasUpperLower?"bg-[#71717A] border-[#71717A]":"border-[#71717A] bg-transparent"),children:a.hasUpperLower&&(0,te.jsx)("svg",{width:"12",height:"10",viewBox:"0 0 12 10",fill:"none",children:(0,te.jsx)("path",{d:"M10 2L4.5 7.5L2 5",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,te.jsx)("span",{className:"text-sm text-[#09090B]",children:"Upper & lower case letters"})]}),(0,te.jsxs)("li",{className:"flex items-center gap-3",children:[(0,te.jsx)("div",{className:"w-5 h-5 rounded-full border-2 flex items-center justify-center "+(a.hasSymbol?"bg-[#71717A] border-[#71717A]":"border-[#71717A] bg-transparent"),children:a.hasSymbol&&(0,te.jsx)("svg",{width:"12",height:"10",viewBox:"0 0 12 10",fill:"none",children:(0,te.jsx)("path",{d:"M10 2L4.5 7.5L2 5",stroke:"white",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})})}),(0,te.jsx)("span",{className:"text-sm text-[#09090B]",children:"At least one symbol (#$&)"})]})]})]}):null},hp=e=>{let{email:s,onSuccess:t,successRedirectPath:a="/login",isFromLogin:r=!1}=e;const[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(["","","","","",""]),[m,u]=(0,Y.useState)([!1,!1,!1,!1,!1,!1]),[x,h]=(0,Y.useState)(null),p=(0,Z.Zp)(),g=(0,Y.useRef)([]);(0,Y.useEffect)((()=>{var e;null===(e=g.current[0])||void 0===e||e.focus()}),[]);const f=e=>{e.preventDefault();const s=e.clipboardData.getData("text").slice(0,6),t=[...c];for(let l=0;l<s.length;l++)/^\d$/.test(s[l])&&(t[l]=s[l]);d(t);const a=t.findIndex((e=>!e));var r,n;-1!==a?null===(r=g.current[a])||void 0===r||r.focus():null===(n=g.current[5])||void 0===n||n.focus()};return(0,te.jsxs)(Qh,{title:"Verify your email",subtitle:`We sent a verification code to ${s}`,showImageColumn:!0,children:[i&&(0,te.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:i}),(0,te.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l(!0),o(null),h(null);const n=c.map((e=>!e));if(n.some((e=>e)))return u(n),h("Please fill out all fields."),void l(!1);const d=c.join("");try{const e=await Q.verifyOtp(s,d);e.success?(r||(cl("registration_completed",{email:(0,ml.sha256)(s),user_id:e.id,registration_method:"email&password"}),we(e.id)),t?t():p(a,{state:{message:r?"Email verified successfully! You can now log in.":"Email verified successfully! Please log in to continue.",email:s}})):o("Invalid verification code. Please try again.")}catch(i){var m,x;if(400===(null===(m=i.response)||void 0===m?void 0:m.status)||429===(null===(x=i.response)||void 0===x?void 0:x.status)){var g;const s=(null===(g=i.response.data)||void 0===g?void 0:g.detail)||"Invalid verification code";o(s)}else o("Verification failed. Please try again.")}finally{l(!1)}},className:"space-y-6",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("label",{htmlFor:"otpCode",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"Verification Code"}),(0,te.jsx)("div",{className:"flex gap-2",children:c.map(((e,s)=>(0,te.jsx)(Hh,{name:`otpCode${s}`,type:"text",inputMode:"numeric",pattern:"\\d{1}",value:e,onChange:e=>((e,s)=>{if(s.length>1)return;const t=[...c];if(t[e]=s,d(t),s){const s=[...m];s[e]=!1,u(s),t.every((e=>e))&&h(null)}var a;s&&e<5&&(null===(a=g.current[e+1])||void 0===a||a.focus())})(s,e.target.value),onKeyDown:e=>((e,s)=>{var t;"Backspace"===s.key&&!c[e]&&e>0&&(null===(t=g.current[e-1])||void 0===t||t.focus())})(s,e),onPaste:0===s?f:void 0,disabled:n,className:"w-11 h-11 text-center text-lg font-semibold bg-white text-[#09090B] rounded-md shadow-xs "+(m[s]?"border border-[#DC2626]":"border border-[#E4E4E7] focus:border-slate-400 focus:ring-slate-400"),maxLength:1,ref:e=>g.current[s]=e},s)))}),x&&(0,te.jsx)("p",{className:"text-[14px] leading-[20px] tracking-[0%] text-[#DC2626] font-normal mt-1",children:x}),(0,te.jsx)("p",{className:"text-xs text-slate-500 mt-3",children:"Enter the verification code sent to your email"})]}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)(Yh,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:n,children:n?"Verifying...":"Verify Email"}),(0,te.jsxs)("p",{className:"text-sm text-slate-600",children:["Didn't receive the code?"," ",(0,te.jsx)("button",{type:"button",onClick:async()=>{try{var e;l(!0),o(null),await Q.resendOtp(s),o("New verification code sent to your email."),d(["","","","","",""]),null===(e=g.current[0])||void 0===e||e.focus()}catch(i){o("Failed to resend verification code. Please try again.")}finally{l(!1)}},disabled:n,className:"font-medium text-black hover:text-slate-700 underline",children:"Resend email"})]})]})]})]})},pp=()=>{const[e,s]=(0,Y.useState)(!1),[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)(!1),[l,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)(null),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)({score:0,label:"Weak password",hasMinLength:!1,hasUpperLower:!1,hasSymbol:!1}),[g,f]=(0,Y.useState)({email:"",password:""}),{user:v,isAuthenticated:j}=ne();(0,Y.useEffect)((()=>{const e="sign_up",s={user_id:j&&null!=v&&v.id?v.id:null,app_id:null,conversation_id:null};Re(s,{page_name:e}),Se("Page View",{page_name:e,page_url:window.location.pathname,user_id:s.user_id})}),[]);const{turnstileToken:b,isVerified:y,handleTurnstileSuccess:N,handleTurnstileError:w,handleTurnstileExpired:k,validateTurnstileToken:_}=(e=>{const[s,t]=(0,Y.useState)(null),a=ip(s),r=(0,Y.useCallback)((s=>{t(s),e&&e("")}),[e]),n=(0,Y.useCallback)((s=>{t(null),e&&e((e=>{switch(e){case"timeout":return"Security verification timed out. Please try again.";case"network-error":return"Network error during security verification. Please check your connection.";case"invalid-sitekey":return"Invalid security configuration. Please contact support.";default:return"Security verification failed. Please try again."}})(s))}),[e]),l=(0,Y.useCallback)((()=>{t(null)}),[]),i=(0,Y.useCallback)((()=>!(lp&&!ip(s)&&(e&&e("Please complete the security verification"),1))),[s,e]),o=(0,Y.useCallback)((s=>{e&&e(s)}),[e]),c=(0,Y.useCallback)((()=>{e&&e("")}),[e]);return{turnstileToken:s,isVerified:a,handleTurnstileSuccess:r,handleTurnstileError:n,handleTurnstileExpired:l,validateTurnstileToken:i,setError:o,clearError:c}})(a);(0,Y.useEffect)((()=>()=>{d&&clearTimeout(d)}),[d]);const S=e=>{const{name:s,value:r}=e.target;f((e=>({...e,[s]:r}))),"password"===s&&p(cp(r)),t&&a(null)};return r?(0,te.jsx)(hp,{email:l,isFromLogin:!1}):(0,te.jsxs)(Qh,{title:"Create your account",showImageColumn:!0,footerContent:(0,te.jsxs)("p",{className:"text-center text-xs text-slate-500",children:['By clicking "Sign Up", you agree to our'," ",(0,te.jsx)("a",{href:"https://base44.com/terms-of-service",target:"_blank",rel:"noopener noreferrer",className:"font-medium underline hover:text-slate-700 cursor-pointer",children:"Terms of Service"})," ","and"," ",(0,te.jsx)("a",{href:"https://base44.com/privacy-policy",target:"_blank",rel:"noopener noreferrer",className:"font-medium underline hover:text-slate-700 cursor-pointer",children:"Privacy Policy"}),"."]}),children:[(0,te.jsx)(Gh,{buttonText:{default:"Sign up with Google",loading:"Signing up..."}}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,te.jsx)(Xs,{})}),(0,te.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,te.jsx)("span",{className:"bg-white px-2 text-slate-500",children:"Or"})})]}),t&&(0,te.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:t}),(0,te.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),s(!0),a(null),_())try{(await Q.register(g.email,g.password,b)).id?(i(g.email),n(!0),a(null)):a("Registration failed. Please try again.")}catch(t){var r;if(400===(null===(r=t.response)||void 0===r?void 0:r.status)){var l;const s=(null===(l=t.response.data)||void 0===l?void 0:l.detail)||"Registration failed";a(s)}else a("Registration failed. Please try again.")}finally{s(!1)}else s(!1)},className:"space-y-6",children:[(0,te.jsx)(Jh,{name:"email",value:g.email,onChange:e=>{S(e)},placeholder:"Enter your email address",required:!0,disabled:e,label:"Email"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("label",{htmlFor:"password",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"Password"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Hh,{name:"password",type:u?"text":"password",placeholder:"Enter your password",value:g.password,onChange:S,onFocus:()=>{d&&(clearTimeout(d),m(null)),c(!0)},onBlur:()=>{const e=setTimeout((()=>{c(!1)}),150);m(e)},required:!0,disabled:e,className:"bg-white text-[#09090B] h-9 px-3 py-1 pr-20 border border-[#E4E4E7] rounded-md shadow-xs",minLength:8}),g.password&&(0,te.jsx)("div",{className:"absolute right-9 top-1/2 -translate-y-1/2 h-[18px] flex items-center",children:(0,te.jsx)("span",{className:"text-xs text-[#71717A] font-normal leading-none tracking-normal",children:h.label.replace(" password","")})}),g.password&&(0,te.jsx)("button",{type:"button",onClick:()=>x(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 w-[18px] h-[18px] flex items-center justify-center text-[#71717A] hover:text-[#09090B]",children:u?(0,te.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,te.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),(0,te.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,te.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,te.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,te.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}),(0,te.jsx)("div",{className:"hidden lg:block",children:(0,te.jsx)(up,{password:g.password,showTooltip:o,onMouseEnter:()=>{d&&(clearTimeout(d),m(null))},onMouseLeave:()=>{c(!1)}})})]})]}),(0,te.jsx)("div",{className:"lg:hidden",children:(0,te.jsx)(xp,{password:g.password,showTooltip:!!g.password})}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)(Yh,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:e||h.score<3,children:e?"Creating account...":"Sign Up"}),(0,te.jsx)(op,{onSuccess:N,onError:w,onExpired:k,isVerified:y,className:"flex justify-center"}),(0,te.jsxs)("p",{className:"text-center text-sm text-[#71717A]",children:["Already have a Base44 account?"," ",(0,te.jsx)(J.Link,{to:"/login",className:"font-medium text-black underline",children:"Log in"})]})]})]})]})},gp=()=>{var e,s;const t=(0,Z.zy)(),a=(0,Z.g)(),r=(null===(e=t.state)||void 0===e?void 0:e.email)||a.email||new URLSearchParams(t.search).get("email"),n=(null===(s=t.state)||void 0===s?void 0:s.isFromLogin)||!1;return r?(0,te.jsx)(hp,{email:r,isFromLogin:n,successRedirectPath:"/login"}):(0,te.jsx)(Z.C5,{to:"/login",replace:!0})},fp=()=>{const[e,s]=(0,Y.useState)(!1),[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)(""),l=(0,Z.Zp)();return(0,te.jsxs)(Qh,{title:"Reset your password",subtitle:"Enter the email address you used to sign up, and we'll send you a link to reset your password.",showImageColumn:!0,backLink:{href:"/login",text:"Back to log in"},children:[t&&(0,te.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:t}),(0,te.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),s(!0),a(null);try{await Q.resetPasswordRequest(r,null);l("/check-email",{state:{email:r}})}catch(t){var n;if(400===(null===(n=t.response)||void 0===n?void 0:n.status)){var i;const s=(null===(i=t.response.data)||void 0===i?void 0:i.detail)||"Invalid email address";a(s)}else a("Failed to send reset link. Please try again.")}finally{s(!1)}},className:"space-y-6",children:[(0,te.jsx)(Jh,{name:"email",value:r,onChange:e=>{(e=>{n(e.target.value),t&&a(null)})(e)},placeholder:"e.g., name@email.com",required:!0,disabled:e,label:"Login email"}),(0,te.jsx)("div",{className:"space-y-4",children:(0,te.jsx)(Yh,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:e,children:e?"Sending...":"Verify Email"})})]})]})},vp=()=>{const[e,s]=(0,Y.useState)(!1),[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)(""),l=(0,Z.zy)(),i=(0,Z.Zp)();(0,Y.useEffect)((()=>{const e=l.state;null!=e&&e.email&&n(e.email)}),[l]);return(0,te.jsxs)(Qh,{title:"Check your email",subtitle:(0,te.jsxs)(te.Fragment,{children:["We've sent password reset instructions to"," ",(0,te.jsx)("span",{className:"font-medium text-[#09090B]",children:r}),"."]}),showImageColumn:!0,backLink:{href:"/forgot-password",text:"Back to Reset password"},children:[(0,te.jsx)("div",{className:"py-3 px-4 bg-[#FAFAFA] border border-[#E4E4E7] rounded-lg gap-x-3",children:(0,te.jsxs)("p",{className:"text-sm text-[#71717A] text-center leading-relaxed",children:[(0,te.jsx)("span",{className:"block",children:"Please check your email for the password reset link."}),(0,te.jsx)("span",{className:"block",children:"It may take a few minutes to arrive."})]})}),t&&(0,te.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:t}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)(Yh,{onClick:()=>i("/login"),className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs p-2 px-4 gap-2.5",children:"Go to Sign In"}),(0,te.jsx)("div",{className:"text-center",children:(0,te.jsxs)("span",{className:"text-sm text-[#71717A]",children:["Didn't get the email?"," ",(0,te.jsx)("button",{onClick:async()=>{if(r){s(!0),a(null);try{await Q.resetPasswordRequest(r),a("New password reset email sent. Please check your inbox.")}catch(t){var e;if(400===(null===(e=t.response)||void 0===e?void 0:e.status)){var n;const e=(null===(n=t.response.data)||void 0===n?void 0:n.detail)||"Failed to send email";a(e)}else a("Failed to resend email. Please try again.")}finally{s(!1)}}else a("Email address not found. Please go back and try again.")},disabled:e,className:"font-medium text-black hover:underline",children:e?"Resending...":"Resend email"})]})})]})]})},jp=()=>{const[e,s]=(0,Y.useState)(!1),[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)(""),[d,m]=(0,Y.useState)(!1),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(null),[v,j]=(0,Y.useState)({score:0,label:"Weak password",hasMinLength:!1,hasUpperLower:!1,hasSymbol:!1}),[b]=(0,J.useSearchParams)(),y=(0,Z.Zp)(),N=b.get("token");Y.useEffect((()=>{N||y("/forgot-password")}),[N,y]),(0,Y.useEffect)((()=>()=>{g&&clearTimeout(g)}),[g]);return(0,te.jsxs)(Qh,{title:"Set new password",subtitle:"Enter your new password for Base44",showImageColumn:!1,children:[t&&(0,te.jsx)("div",{className:"p-4 text-sm text-red-600 bg-red-50 border border-red-200 rounded-md",children:t}),(0,te.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),N)if(l===o)if(v.score<3)a("Please create a strong password that meets all requirements.");else{s(!0),a(null),n(null);try{const e=await Q.resetPassword(N,l,null);e&&e.id?(n("Password reset successfully! Redirecting to login..."),setTimeout((()=>{y("/login",{state:{message:"Password reset successfully! Please log in with your new password."}})}),2e3)):a("Failed to reset password. Please try again.")}catch(t){var r;if(400===(null===(r=t.response)||void 0===r?void 0:r.status)){var i;const s=(null===(i=t.response.data)||void 0===i?void 0:i.detail)||"Invalid or expired reset token";a(s)}else a("Failed to reset password. Please try again.")}finally{s(!1)}}else a("Passwords do not match. Please try again.");else a("Invalid or missing reset token. Please request a new password reset.")},className:"space-y-6",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("label",{htmlFor:"newPassword",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"New password"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Hh,{name:"newPassword",type:d?"text":"password",placeholder:"Enter your new password",value:l,onChange:e=>{const s=e.target.value;i(s),j(cp(s)),t&&a(null),r&&n(null)},onFocus:()=>{g&&(clearTimeout(g),f(null)),p(!0)},onBlur:()=>{const e=setTimeout((()=>{p(!1)}),150);f(e)},required:!0,disabled:e,className:"bg-white text-[#09090B] h-9 px-3 py-1 pr-20 border border-[#E4E4E7] rounded-md shadow-xs",minLength:8}),l&&(0,te.jsx)("div",{className:"absolute right-9 top-1/2 -translate-y-1/2 h-[18px] flex items-center",children:(0,te.jsx)("span",{className:"text-xs text-[#71717A] font-normal leading-none tracking-normal",children:v.label.replace(" password","")})}),l&&(0,te.jsx)("button",{type:"button",onClick:()=>m(!d),className:"absolute right-3 top-1/2 -translate-y-1/2 w-[18px] h-[18px] flex items-center justify-center text-[#71717A] hover:text-[#09090B]",children:d?(0,te.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,te.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),(0,te.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,te.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,te.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,te.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})}),(0,te.jsx)("div",{className:"hidden lg:block",children:(0,te.jsx)(up,{password:l,showTooltip:h,onMouseEnter:()=>{g&&(clearTimeout(g),f(null))},onMouseLeave:()=>{p(!1)}})})]})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("label",{htmlFor:"confirmPassword",className:"text-sm font-medium leading-5 tracking-normal text-[#09090B]",children:"Confirm new password"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Hh,{name:"confirmPassword",type:u?"text":"password",placeholder:"Confirm your new password",value:o,onChange:e=>{c(e.target.value),t&&a(null),r&&n(null)},required:!0,disabled:e,className:"bg-white text-[#09090B] h-9 px-3 py-1 pr-10 border border-[#E4E4E7] rounded-md shadow-xs",minLength:8}),o&&(0,te.jsx)("button",{type:"button",onClick:()=>x(!u),className:"absolute right-3 top-1/2 -translate-y-1/2 w-[18px] h-[18px] flex items-center justify-center text-[#71717A] hover:text-[#09090B]",children:u?(0,te.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,te.jsx)("path",{d:"M17.94 17.94A10.07 10.07 0 0 1 12 20c-7 0-11-8-11-8a18.45 18.45 0 0 1 5.06-5.94M9.9 4.24A9.12 9.12 0 0 1 12 4c7 0 11 8 11 8a18.5 18.5 0 0 1-2.16 3.19m-6.72-1.07a3 3 0 1 1-4.24-4.24"}),(0,te.jsx)("line",{x1:"1",y1:"1",x2:"23",y2:"23"})]}):(0,te.jsxs)("svg",{width:"18",height:"18",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",children:[(0,te.jsx)("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),(0,te.jsx)("circle",{cx:"12",cy:"12",r:"3"})]})})]})]}),(0,te.jsx)("div",{className:"lg:hidden",children:(0,te.jsx)(xp,{password:l,showTooltip:!!l})}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)(Yh,{type:"submit",className:"w-full h-[40px] bg-black text-[#FAFAFA] border border-[#E4E4E7] rounded-md shadow-xs px-4 py-2",disabled:e||v.score<3,children:e?"Resetting...":"Reset Password"}),r&&(0,te.jsx)("div",{className:"p-4 text-sm text-green-600 bg-green-50 border border-green-200 rounded-md",children:r}),(0,te.jsx)("div",{className:"text-center",children:(0,te.jsx)(J.Link,{to:"/login",className:"text-sm font-medium text-[#09090B] underline hover:text-[#71717A] leading-5 tracking-normal",children:"Back to Log In"})})]})]})]})};function bp(e){let{children:s}=e;return(0,te.jsx)(Za.o,{className:"base44-markdown prose",remarkPlugins:[Ja.A],children:s})}const yp=()=>{const e=(0,Z.Zp)();return(0,te.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-slate-50",children:(0,te.jsxs)("div",{className:"max-w-md mx-auto text-center px-6",children:[(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsx)("h1",{className:"text-8xl font-light text-slate-300 mb-4",children:"404"}),(0,te.jsx)("h2",{className:"text-2xl font-medium text-slate-900 mb-3",children:"Page not found"}),(0,te.jsx)("p",{className:"text-slate-600 leading-relaxed",children:"The page you're looking for doesn't exist or has been moved."})]}),(0,te.jsx)("button",{onClick:()=>e("/"),className:"inline-flex items-center px-6 py-3 text-sm font-medium text-white bg-orange-500 rounded-lg hover:bg-orange-600 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:ring-offset-2",children:"Go home"})]})})};class Np extends K.y{getBaseURL(){return"/integrations/StripeIntegration"}getOrCreateAccount(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"express";return this.axios.post("/get-or-create-account",{account_type:e})}getAccount(){return this.axios.get("/get-account")}createAccountLink(e,s){if(!e)throw new Error("Account ID is required for this operation");return this.axios.post(`/${e}/create-account-link`)}checkAccountStatus(e){if(!e)throw new Error("Account ID is required for this operation");return this.axios.get(`/${e}/check-account-status`)}refreshProductCatalog(e){if(!e)throw new Error("Account ID is required for this operation");return this.axios.post(`/${e}/refresh-product-catalog`)}connectToApp(e,s){if(!e)throw new Error("Account ID is required for this operation");return this.axios.get(`/${e}/connect-to-app/${s}`)}createCheckoutSession(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1;if(!e)throw new Error("Account ID is required for this operation");const a=window.location.href;return this.axios.post(`/${e}/create-checkout-session`,{price_id:s,quantity:t,success_url:`${a}?checkout_status=success`,cancel_url:`${a}?checkout_status=canceled`})}deleteAccount(e){if(!e)throw new Error("Account ID is required for this operation");return this.axios.delete(`/${e}/delete-account`)}}const wp=new Np;function kp(e){let{onAccountCreated:s}=e;const[t,a]=(0,Y.useState)(!1),[r,n]=(0,Y.useState)("express"),{toast:l}=Fr();return(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Get Started with Stripe"}),(0,te.jsx)(Gs,{children:"Create a Stripe account to start accepting payments in your apps"})]}),(0,te.jsxs)(Js,{children:[(0,te.jsx)("p",{className:"text-muted-foreground mb-4",children:"With Stripe, you can accept payments, manage subscriptions, and more. Your Stripe account will be created using Stripe Connect, which will allow your users to pay you directly."}),(0,te.jsxs)("div",{className:"mt-6",children:[(0,te.jsx)("h3",{className:"text-lg font-medium mb-4",children:"Choose Account Type"}),(0,te.jsxs)(lt,{value:r,onValueChange:n,className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-start space-x-2 rounded-md border p-4",children:[(0,te.jsx)(it,{value:"express",id:"express",className:"mt-1"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)("div",{className:"flex space-x-2",children:[(0,te.jsx)(at,{htmlFor:"express",className:"font-medium",children:"Express Account"}),(0,te.jsx)("span",{className:"inline-flex items-center rounded-full bg-blue-50 px-2 py-1 text-xs font-medium text-blue-700",children:"Recommended for new users"})]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Best for people who don't have a Stripe account yet. Express accounts offer a simplified onboarding process with a Stripe-hosted setup and dashboard. This is the quickest way to get started."})]})]}),(0,te.jsxs)("div",{className:"flex items-start space-x-2 rounded-md border p-4",children:[(0,te.jsx)(it,{value:"standard",id:"standard",className:"mt-1"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)("div",{className:"flex space-x-2",children:[(0,te.jsx)(at,{htmlFor:"standard",className:"font-medium",children:"Standard Account"}),(0,te.jsx)("span",{className:"inline-flex items-center rounded-full bg-purple-50 px-2 py-1 text-xs font-medium text-purple-700",children:"For experienced users"})]}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Best for people who already have a Stripe account set up. Standard accounts provide more customization options and direct access to the full Stripe Dashboard. This option requires more setup steps but offers greater flexibility."})]})]})]})]})]}),(0,te.jsx)(Zs,{className:"flex justify-end",children:(0,te.jsx)(Rs,{onClick:async()=>{a(!0);try{const e=await wp.getOrCreateAccount(r);s(e),l({title:"Success",description:"Stripe account created successfully",variant:"success"})}catch(e){l({variant:"destructive",title:"Error",description:"Failed to create Stripe account"})}finally{a(!1)}},disabled:t,children:t?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating Account..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(ur.A,{className:"mr-2 h-4 w-4"}),"Create Stripe Account"]})})})]})}function _p(e){var s;let{account:t,onAccountVerified:a}=e;const[r,n]=(0,Y.useState)(!0),[l,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!1),{toast:d}=Fr();(0,Y.useEffect)((()=>{t&&m()}),[t]);const m=async()=>{n(!0);try{const e=await wp.checkAccountStatus(t.id);i(e),e.is_complete&&a()}catch(e){d({variant:"destructive",title:"Error",description:"Failed to check Stripe account status"})}finally{n(!1)}};if(r)return(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Checking Your Stripe Account"}),(0,te.jsx)(Gs,{children:"Verifying your Stripe account setup..."})]}),(0,te.jsx)(Js,{className:"flex justify-center items-center p-8",children:(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]});if(null!=l&&l.is_complete)return(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Stripe Account Setup Complete"}),(0,te.jsx)(Gs,{children:"Your Stripe account is fully set up and ready to use"})]}),(0,te.jsx)(Js,{children:(0,te.jsxs)(is,{className:"bg-green-50 border-green-200",children:[(0,te.jsx)(Ed.A,{className:"h-4 w-4 text-green-600"}),(0,te.jsx)(os,{className:"text-green-600",children:"Ready to accept payments"}),(0,te.jsx)(cs,{children:"Your Stripe account is ready to process payments and receive payouts."})]})}),(0,te.jsx)(Zs,{className:"flex justify-end",children:(0,te.jsx)(Rs,{onClick:a,children:"Continue to Next Step"})})]});const u=(null==l||null===(s=l.requirements)||void 0===s?void 0:s.currently_due)||[];return(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Complete Your Stripe Account Setup"}),(0,te.jsx)(Gs,{children:"Your Stripe account needs additional information to start accepting payments"})]}),(0,te.jsxs)(Js,{className:"space-y-4",children:[(0,te.jsxs)(is,{variant:"warning",className:"bg-yellow-50 border-yellow-200",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4 text-yellow-600"}),(0,te.jsx)(os,{className:"text-yellow-600",children:"Account setup incomplete"}),(0,te.jsx)(cs,{children:"Please continue the Stripe onboarding process to complete your account setup."})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("div",{className:"flex items-center gap-2",children:(0,te.jsxs)("div",{className:null!=l&&l.details_submitted?"text-green-600":"text-muted-foreground",children:[null!=l&&l.details_submitted?(0,te.jsx)(Ed.A,{className:"inline h-4 w-4 mr-1"}):(0,te.jsx)(Fd.A,{className:"inline h-4 w-4 mr-1"}),"Account details provided"]})}),(0,te.jsx)("div",{className:"flex items-center gap-2",children:(0,te.jsxs)("div",{className:null!=l&&l.charges_enabled?"text-green-600":"text-muted-foreground",children:[null!=l&&l.charges_enabled?(0,te.jsx)(Ed.A,{className:"inline h-4 w-4 mr-1"}):(0,te.jsx)(Fd.A,{className:"inline h-4 w-4 mr-1"}),"Charges enabled"]})}),(0,te.jsx)("div",{className:"flex items-center gap-2",children:(0,te.jsxs)("div",{className:null!=l&&l.payouts_enabled?"text-green-600":"text-muted-foreground",children:[null!=l&&l.payouts_enabled?(0,te.jsx)(Ed.A,{className:"inline h-4 w-4 mr-1"}):(0,te.jsx)(Fd.A,{className:"inline h-4 w-4 mr-1"}),"Payouts enabled"]})})]}),u.length>0&&(0,te.jsxs)("div",{className:"mt-4",children:[(0,te.jsx)("h4",{className:"text-sm font-medium mb-2",children:"Required Information:"}),(0,te.jsx)("ul",{className:"text-sm text-muted-foreground space-y-1 list-disc pl-5",children:u.map(((e,s)=>(0,te.jsx)("li",{children:e.split(".").join(" ").replace(/_/g," ")},s)))})]})]}),(0,te.jsxs)(Zs,{className:"flex justify-between items-center",children:[(0,te.jsx)(Rs,{variant:"outline",onClick:m,children:"Refresh Status"}),(0,te.jsx)(Rs,{onClick:async()=>{c(!0);try{const e=`${window.location.origin}/integrations/stripe`,s=await wp.createAccountLink(t.id,e);s.account_link_url&&(window.location.href=s.account_link_url)}catch(e){d({variant:"destructive",title:"Error",description:"Failed to create Stripe account link"}),c(!1)}},disabled:o,children:o?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Preparing Onboarding..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(ur.A,{className:"mr-2 h-4 w-4"}),"Complete Stripe Onboarding"]})})]})]})}var Sp=t(37656);function Cp(e){let{integrationInstance:s}=e;const[t,a]=(0,Y.useState)(null),[r,n]=(0,Y.useState)(!1),{toast:l}=Fr(),i=e=>{if(!e||!e.unit_amount)return"N/A";const s=e.unit_amount/100;return new Intl.NumberFormat("en-US",{style:"currency",currency:e.currency||"USD"}).format(s)},o=async()=>{try{n(!0),await wp.refreshProductCatalog(s.id),l({title:"Success",description:"Product catalog refreshed successfully from Stripe",variant:"success"})}catch(e){l({variant:"destructive",title:"Error",description:"Failed to refresh product catalog from Stripe"})}finally{n(!1)}};return s.product_catalog&&0!==s.product_catalog.length?(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,te.jsx)("h3",{className:"text-lg font-medium",children:"Product Catalog"}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:o,disabled:r,children:r?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($c.A,{className:"mr-2 h-4 w-4"}),"Refresh Catalog"]})})]}),(0,te.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.product_catalog.map((e=>(0,te.jsx)(Vs,{className:"overflow-hidden",children:(0,te.jsxs)("div",{className:"p-4",children:[(0,te.jsx)("h4",{className:"font-semibold",children:e.name}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground mt-1",children:e.description||"No description"}),e.images&&e.images.length>0&&(0,te.jsx)("div",{className:"mt-2",children:(0,te.jsx)("img",{src:e.images[0],alt:e.name,className:"w-full h-32 object-cover rounded-md"})}),e.prices&&e.prices.length>0?(0,te.jsxs)("div",{className:"mt-3",children:[(0,te.jsx)("h5",{className:"text-sm font-medium mb-1",children:"Prices:"}),(0,te.jsx)("div",{className:"space-y-1 max-h-32 overflow-y-auto",children:e.prices.map((e=>(0,te.jsxs)("div",{className:"bg-muted/30 p-2 rounded-md text-xs",children:[(0,te.jsxs)("div",{className:"flex justify-between",children:[(0,te.jsx)("span",{className:"font-medium",children:i(e)}),(0,te.jsx)("span",{className:"text-muted-foreground",children:e.recurring?`${e.recurring.interval_count} ${e.recurring.interval}`:"One-time"})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center mt-2",children:[(0,te.jsxs)("div",{className:"text-muted-foreground text-xs truncate",title:e.id,children:["ID: ",e.id.substring(0,10),"..."]}),(0,te.jsxs)(Rs,{size:"sm",variant:"secondary",className:"h-6 text-xs px-2",onClick:()=>(async e=>{try{a(e);const t=await wp.createCheckoutSession(s.id,e);t.checkout_url&&window.open(t.checkout_url,"_blank")}catch(t){}finally{a(null)}})(e.id),disabled:t===e.id,children:[t===e.id?(0,te.jsx)(Je.A,{className:"h-3 w-3 animate-spin mr-1"}):null,"Checkout"]})]})]},e.id)))})]}):(0,te.jsx)("div",{className:"mt-2 text-xs text-muted-foreground italic",children:"No prices defined for this product"}),(0,te.jsxs)("div",{className:"mt-2 text-xs text-muted-foreground",children:["ID: ",e.id]})]})},e.id)))})]}):(0,te.jsxs)("div",{className:"text-center py-6 bg-muted/30 rounded-lg",children:[(0,te.jsx)("p",{className:"text-muted-foreground mb-4",children:"No products available."}),(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:o,disabled:r,children:r?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($c.A,{className:"mr-2 h-4 w-4"}),"Refresh Products from Stripe"]})}),(0,te.jsx)("p",{className:"text-xs text-muted-foreground mt-2",children:"This will fetch the latest products and prices from your Stripe account."})]})}function Ap(e){let{account:s,onContinue:t}=e;const[a,r]=(0,Y.useState)(!1),{toast:n}=Fr();return(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Manage Your Product Catalog"}),(0,te.jsx)(Gs,{children:"Set up products and prices in Stripe to offer to your customers"})]}),(0,te.jsxs)(Js,{className:"space-y-4",children:[(0,te.jsxs)(is,{children:[(0,te.jsx)(Sp.A,{className:"h-4 w-4"}),(0,te.jsx)(os,{children:"Optional Step"}),(0,te.jsx)(cs,{children:"Create products in the Stripe dashboard to offer one-time purchases or subscriptions to your customers. This step is optional, but recommended if you want to offer paid content."})]}),(0,te.jsxs)("div",{className:"p-4 bg-muted/20 rounded-lg",children:[(0,te.jsx)("h3",{className:"text-sm font-medium mb-3",children:"Instructions"}),(0,te.jsxs)("ol",{className:"space-y-2 text-sm text-muted-foreground list-decimal pl-5",children:[(0,te.jsx)("li",{children:"Go to the Stripe Dashboard by clicking the button below"}),(0,te.jsx)("li",{children:'Navigate to "Products" in the sidebar'}),(0,te.jsx)("li",{children:"Create new products with appropriate pricing"}),(0,te.jsx)("li",{children:"For subscriptions, set up recurring prices with the desired interval"}),(0,te.jsx)("li",{children:"Return here and refresh your product catalog when complete"})]})]})]}),(0,te.jsxs)(Zs,{className:"flex justify-between",children:[(0,te.jsxs)(Rs,{variant:"outline",onClick:()=>window.open("https://dashboard.stripe.com/account","_blank"),children:[(0,te.jsx)(ur.A,{className:"mr-2 h-4 w-4"}),"Open Stripe Dashboard"]}),(0,te.jsx)(Rs,{onClick:async()=>{r(!0);try{await wp.refreshProductCatalog(s.id),n({title:"Success",description:"Product catalog refreshed successfully",variant:"success"})}catch(e){n({variant:"destructive",title:"Error",description:"Failed to refresh product catalog"})}finally{r(!1)}},disabled:a,children:a?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Refreshing..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)($c.A,{className:"mr-2 h-4 w-4"}),"Refresh Product Catalog"]})})]})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Current Product Catalog"}),(0,te.jsx)(Gs,{children:"Products and prices available for your apps"})]}),(0,te.jsx)(Js,{children:(0,te.jsx)(Cp,{integrationInstance:s})}),(0,te.jsx)(Zs,{className:"flex justify-end",children:(0,te.jsx)(Rs,{onClick:t,children:"Continue to Next Step"})})]})]})}var Ep=t(56150),Ip=t(2999);function Lp(){const e=(0,Z.Zp)();return(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsxs)("div",{className:"flex items-start justify-between",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)(Hs,{children:"Stripe Integration Complete"}),(0,te.jsx)(Gs,{children:"Your Stripe integration is ready to use with your apps"})]}),(0,te.jsx)("div",{className:"p-1.5 rounded-full bg-green-100",children:(0,te.jsx)(Ep.A,{className:"h-5 w-5 text-green-600"})})]})}),(0,te.jsx)(Js,{children:(0,te.jsxs)(lr,{defaultValue:"navigation",children:[(0,te.jsxs)(ir,{className:"grid w-full grid-cols-2",children:[(0,te.jsx)(or,{value:"navigation",children:"Navigation Instructions"}),(0,te.jsx)(or,{value:"code",children:"Code Integration"})]}),(0,te.jsxs)(cr,{value:"navigation",className:"space-y-4 mt-4",children:[(0,te.jsxs)("div",{className:"p-4 bg-muted/20 rounded-lg space-y-4",children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"How to Use Your Stripe Integration"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h4",{className:"text-sm font-medium",children:"1. Navigate to an App"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Go to your app dashboard and select the app you want to add payment functionality to."})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h4",{className:"text-sm font-medium",children:"2. Go to the Payments Tab"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:'Open the app editor and click on the "Payments" tab in the sidebar.'})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h4",{className:"text-sm font-medium",children:"3. Connect Your Stripe Account"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:'Click "Connect Payments" to link your Stripe account to the app.'})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h4",{className:"text-sm font-medium",children:"4. Use the Product Catalog"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Once connected, use your Stripe products and prices in the app through the Product Catalog interface."})]})]}),(0,te.jsx)("div",{className:"flex justify-end",children:(0,te.jsxs)(Rs,{onClick:()=>e("/apps"),children:["Go to My Apps ",(0,te.jsx)(pr.A,{className:"ml-2 h-4 w-4"})]})})]}),(0,te.jsx)(cr,{value:"code",className:"space-y-4 mt-4",children:(0,te.jsxs)("div",{className:"p-4 bg-muted/20 rounded-lg space-y-4",children:[(0,te.jsx)("h3",{className:"text-sm font-medium",children:"Code Integration"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h4",{className:"text-sm font-medium",children:"Using the API"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Access your Stripe integration programmatically by making API calls to create checkout sessions, access product catalogs, or check purchase history."})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("h4",{className:"text-sm font-medium",children:"Example: Create a Checkout Session"}),(0,te.jsx)("pre",{className:"p-3 bg-muted/40 rounded-md text-xs overflow-x-auto",children:(0,te.jsx)("code",{children:"// Example API call\nconst createCheckout = async (priceId) => {\n  try {\n    const response = await fetch('/api/integrations/stripe/{account_id}/create-checkout-session', {\n      method: 'POST',\n      headers: { 'Content-Type': 'application/json' },\n      body: JSON.stringify({\n        price_id: priceId,\n        quantity: 1,\n        success_url: window.location.origin + '/success',\n        cancel_url: window.location.origin + '/cancel'\n      })\n    });\n    \n    const data = await response.json();\n    window.location.href = data.checkout_url;\n  } catch (error) {\n    console.error('Error creating checkout session:', error);\n  }\n}"})})]})]})})]})}),(0,te.jsxs)(Zs,{className:"flex justify-between",children:[(0,te.jsxs)(Rs,{variant:"outline",onClick:()=>window.open("https://stripe.com/docs","_blank"),children:[(0,te.jsx)(Ip.A,{className:"mr-2 h-4 w-4"}),"Stripe Documentation"]}),(0,te.jsxs)(Rs,{variant:"outline",onClick:()=>window.open("https://dashboard.stripe.com","_blank"),children:[(0,te.jsx)(Ua.A,{className:"mr-2 h-4 w-4"}),"Stripe Dashboard"]})]})]})}var Tp=t(44153);function $p(e){let{currentStep:s,totalSteps:t}=e;return(0,te.jsx)("div",{className:"flex items-center justify-center my-6",children:(0,te.jsx)("div",{className:"flex items-center",children:Array.from({length:t}).map(((e,a)=>(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsxs)("div",{className:"flex flex-col items-center",children:[(0,te.jsx)("div",{className:"rounded-full flex items-center justify-center h-8 w-8 "+(a<s?"bg-green-100 text-green-600":a===s?"bg-blue-100 text-blue-600 border border-blue-300":"bg-muted text-muted-foreground"),children:a<s?(0,te.jsx)(Qa.A,{className:"h-5 w-5"}):a===s?(0,te.jsx)(nt.A,{className:"h-5 w-5"}):(0,te.jsx)(Tp.A,{className:"h-5 w-5"})}),(0,te.jsxs)("span",{className:"text-xs mt-1 font-medium",children:["Step ",a+1]})]}),a<t-1&&(0,te.jsx)("div",{className:"h-px w-8 "+(a<s?"bg-green-400":"bg-muted-foreground/30")})]},a)))})})}function Dp(e){let{account:s,onAccountDeleted:t}=e;const[a,r]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(null),{toast:c}=Fr();return(0,te.jsxs)(Vs,{className:"border-destructive/20 bg-destructive/5",children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{className:"text-destructive",children:"Delete Stripe Integration"}),(0,te.jsx)(Gs,{children:"Permanently remove this Stripe integration from your account"})]}),(0,te.jsx)(Js,{children:(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:"Deleting this integration will remove all configuration and connection to your Stripe account. This action cannot be undone. Your Stripe account will remain intact but will no longer be connected to this platform."})}),(0,te.jsx)(Zs,{children:(0,te.jsxs)(na,{open:n,onOpenChange:l,children:[(0,te.jsx)(la,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"destructive",children:[(0,te.jsx)(Tc.A,{className:"mr-2 h-4 w-4"}),"Delete Integration"]})}),(0,te.jsxs)(da,{children:[(0,te.jsxs)(ma,{children:[(0,te.jsx)(xa,{children:"Are you sure you want to delete this Stripe integration?"}),(0,te.jsx)(ha,{children:"This action cannot be undone. This will permanently delete the integration and remove its data from our servers."})]}),i&&(0,te.jsxs)(is,{variant:"destructive",children:[(0,te.jsx)(Zc.A,{className:"h-4 w-4"}),(0,te.jsx)(cs,{children:i})]}),(0,te.jsxs)(ua,{children:[(0,te.jsx)(Rs,{variant:"outline",onClick:()=>l(!1),disabled:a,children:"Cancel"}),(0,te.jsx)(Rs,{variant:"destructive",onClick:async()=>{r(!0),o(null);try{await wp.deleteAccount(s.id),c({title:"Account Deleted",description:"Your Stripe integration has been successfully deleted.",variant:"success"}),l(!1),t&&t()}catch(i){var e,a;const t=(null===(e=i.response)||void 0===e||null===(a=e.data)||void 0===a?void 0:a.detail)||"Failed to delete Stripe account. Please try again.";o(t),c({variant:"destructive",title:"Error",description:"Failed to delete Stripe account"})}finally{r(!1)}},disabled:a,children:a?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Deleting..."]}):"Delete Integration"})]})]})]})})]})}function Pp(){const{user:e}=ne(),[s,t]=(0,Y.useState)(!0),[a,r]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(0),[i,o]=(0,Y.useState)(null),{toast:c}=Fr(),d=(0,Z.Zp)();(0,Y.useEffect)((()=>{(async()=>{try{t(!0);const e=await wp.getAccount();e?(r(e),l(1)):l(0)}catch(i){o("Failed to load Stripe account information"),c({variant:"destructive",title:"Error",description:"Failed to load Stripe account information"})}finally{t(!1)}})()}),[c]);const m=e=>{r(e),l(1)},u=()=>{l(2)},x=()=>{l(3)};if("builder"!==e.subscription_tier&&"pro"!==e.subscription_tier&&"elite"!==e.subscription_tier&&"elite_2"!==e.subscription_tier&&"elite_3"!==e.subscription_tier&&"enterprise"!==e.subscription_tier)return(0,te.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,te.jsxs)("div",{className:"mb-6",children:[(0,te.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Stripe Integration"}),(0,te.jsx)("p",{className:"text-muted-foreground mt-2",children:"Set up Stripe to accept payments in your apps"})]}),(0,te.jsxs)(is,{children:[(0,te.jsx)(os,{children:"Subscription Required"}),(0,te.jsx)(cs,{children:"Stripe integration is currently available only for Pro and Enterprise users. Please upgrade your subscription to access this feature."})]}),(0,te.jsx)("div",{className:"mt-4",children:(0,te.jsx)(Rs,{onClick:()=>d("/billing"),children:"Upgrade Subscription"})})]});return s?(0,te.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,te.jsxs)("div",{className:"mb-6",children:[(0,te.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Stripe Integration"}),(0,te.jsx)("p",{className:"text-muted-foreground mt-2",children:"Set up Stripe to accept payments in your apps"})]}),(0,te.jsx)("div",{className:"flex justify-center items-center p-12",children:(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})})]}):i?(0,te.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,te.jsxs)("div",{className:"mb-6",children:[(0,te.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Stripe Integration"}),(0,te.jsx)("p",{className:"text-muted-foreground mt-2",children:"Set up Stripe to accept payments in your apps"})]}),(0,te.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-4 mb-4",children:(0,te.jsxs)("div",{className:"flex items-start",children:[(0,te.jsx)(Zc.A,{className:"h-5 w-5 text-amber-500 mt-0.5 mr-3"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium text-amber-800",children:"Something went wrong"}),(0,te.jsxs)("p",{className:"text-sm text-amber-700 mt-1",children:[i,". Refreshing the page might help resolve this issue."]})]})]})}),(0,te.jsx)("div",{className:"mt-4",children:(0,te.jsx)(Rs,{onClick:()=>window.location.reload(),children:"Refresh Page"})})]}):(0,te.jsxs)("div",{className:"p-6 max-w-4xl mx-auto",children:[(0,te.jsxs)("div",{className:"mb-6 flex justify-between items-center",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h2",{className:"text-3xl font-bold tracking-tight",children:"Stripe Integration"}),(0,te.jsx)("p",{className:"text-muted-foreground mt-2",children:"Set up Stripe to accept payments in your apps"})]}),n>0&&(0,te.jsxs)(Rs,{variant:"outline",onClick:()=>l(Math.max(0,n-1)),children:[(0,te.jsx)(pi.A,{className:"mr-2 h-4 w-4"}),"Back"]})]}),(0,te.jsx)($p,{currentStep:n,totalSteps:4}),(()=>{switch(n){case 0:default:return(0,te.jsx)(kp,{onAccountCreated:m});case 1:return(0,te.jsx)(_p,{account:a,onAccountVerified:u});case 2:return(0,te.jsx)(Ap,{account:a,onContinue:x});case 3:return(0,te.jsx)(Lp,{})}})(),a&&(0,te.jsx)("div",{className:"mt-8",children:(0,te.jsx)(Dp,{account:a,onAccountDeleted:()=>{r(null),l(0),c({title:"Account Deleted",description:"Your Stripe integration has been successfully removed.",variant:"success"})}})})]})}function Mp(){return(0,te.jsx)("div",{className:"p-9",children:(0,te.jsx)(bp,{children:"\n\n**Base44 Responsible Use Policy**\n\nLast Updated: March 23, 2025  \n\nThis Responsible Use Policy (\u201c**RUP**\u201d) supplements the Base44 Terms of Service, or any other agreement or order form between Base44, Inc. or its affiliates (\u201c**Base44**\u201d) and you, being any Customer or User thereof (\u201c**you**\u201d), governing the use of Base44\u2019s Platform, Website, the Generated Output or other products and services (each of the foregoing, together and separately, the \u201c**Agreement\u201d**). The RUP applies to your access and use of the Platform, Customer Data (including the Input Data you provide to the Platform and the Generated Output created on its basis), whether as part of your Platform or your use of Generated Output outside of it. Capitalized but undefined terms used in the RUP have the meanings set forth in your applicable Agreement with Base44.\n\nYou will not share with the Platform any Input Data that, nor knowingly use the Platform to generate any Generated Output or use or make available to others any Generated Output:\n\n1. That in any way violates any applicable national, federal, state, local or international law or regulation;\n2. Generating and distributing spam in violation of the CAN-SPAM Act of 2003 and other applicable laws;\n3. For the purpose of exploiting, harming or attempting to exploit or harm minors in any way;\n4. Contains pornographic, sexually explicit, or adult content;\n5. To generate or disseminate verifiably false, misleading or deceptive information and/or content (including with regard to medicine, health and science);\n6. To generate or disseminate personal identifiable information that can be used to harm an individual;\n7. To generate or disseminate information and/or content (e.g. images, code, posts, articles), and place the information and/or content in any context (e.g. bot generating tweets) without expressly and intelligibly disclaiming that the information and/or content is machine generated;\n8. To defame, disparage, cyber-bully or otherwise harass others, or encourage self-harm or harm to others;\n9. To impersonate or attempt to impersonate (e.g. deepfakes) others without their consent;\n10. For fully automated decision making that adversely impacts an individual\u2019s legal rights or otherwise creates or modifies a binding, enforceable obligation;\n11. For any use intended to or which has the effect of discriminating against or harming individuals or groups based on online or offline social behavior or known or predicted personal or personality characteristics, or in a manner that is obscene, violent, hateful, racist or discriminatory or is otherwise offensive;\n12. To exploit any of the vulnerabilities of a specific group of persons based on their age, social, physical or mental characteristics, in order to materially distort the behavior of a person pertaining to that group in a manner that causes or is likely to cause that person or another person physical or psychological harm;\n13. For any use intended to or which has the effect of discriminating against individuals or groups based on legally protected characteristics or categories;\n14. To engage in political lobbying or campaigns to actively influence the decisions of government officials, legislators, or regulatory agencies on legislative, regulatory, or policy matters;\n15. To provide medical advice and medical results interpretation, or promote pharmaceutical or medical products and services, without having the qualifications, licenses and permits required by applicable law;\n16. To engage in and promote regulated services and professions, and/or deliver any regulated products or services, including but not limited to legal and accounting services, investment advice, insurance, banking and securities, without having the qualifications, licenses and permits required by applicable law;\n17. To generate or disseminate information for the purpose to be used for administration of justice, law enforcement, immigration or asylum processes, such as predicting an individual will commit fraud/crime commitment (e.g. by text profiling, drawing causal relationships between assertions made in documents, indiscriminate and arbitrarily-targeted use);\n18. To infringe, violate or misappropriate any patent, trademark, trade secret, copyright, or other intellectual property or other proprietary rights of any other person;\n19. To transmit or otherwise makes available any malicious code, including any virus, worm, trojan horse, time bomb, web bug, spyware, or any other malicious or harmful computer code, library, file, or program;\n20. To circumvent the technical and other safeguards set out by Base44 or our Third- Party Service providers meant to ensure adherence with the RUP and such Third- Party Service providers' equivalent usage policies, as applicable.\n\nTo the extent the Platform or Generated Output generate Generated Output containing any of the above, you will notify us in writing without undue delay upon becoming aware of it.\n\nEnforcing the RUP, including the determination whether a violation occurred and determining its severity, is at Baser44\u2019s sole and complete discretion, and failure to enforce it in one instance does not constitute a waiver to enforce it in any other instances.\n\nYou will promptly cease use of any Customer Data, Input Data or Generated Output violating this RUP, and Base44 has the right to promptly remove or delete any violating Customer Data, remove violating Generated Output from the Platform and Website in its sole discretion or modify the Platform to ensure compliance with the RUP and applicable law.\n\n"})})}function Op(e){let{onLoadMore:s,hasMore:t=!0,isLoading:a=!1,threshold:r=.1}=e;const[n,l]=(0,Y.useState)(!1),i=(0,Y.useRef)(null),o=(0,Y.useRef)(null),c=(0,Y.useCallback)((()=>{t&&!a&&s&&s()}),[t,a,s]);return(0,Y.useEffect)((()=>{const e=i.current;if(e)return o.current=new IntersectionObserver((e=>{const[s]=e;l(s.isIntersecting),s.isIntersecting&&t&&!a&&c()}),{threshold:r,rootMargin:"50px"}),o.current.observe(e),()=>{o.current&&o.current.disconnect()}}),[c,t,a,r]),{targetRef:i,isIntersecting:n,hasMore:t}}const Rp=nr.bL,Fp=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(nr.B8,{ref:s,className:ns("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...a})}));Fp.displayName=nr.B8.displayName;const zp=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(nr.l9,{ref:s,className:ns("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...a})}));zp.displayName=nr.l9.displayName;const Up=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(nr.UC,{ref:s,className:ns("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...a})}));function Bp(e){let{activeTab:s,onTabChange:t}=e;const a="\n        relative h-12 rounded-none border-0 bg-transparent px-3 sm:px-6 pb-3 pt-3 \n        font-base44 font-medium text-gray-600 shadow-none transition-colors hover:text-gray-900 \n        focus-visible:ring-0 focus-visible:ring-offset-0 \n        data-[state=active]:bg-transparent data-[state=active]:text-black data-[state=active]:shadow-none \n        data-[state=active]:after:absolute data-[state=active]:after:bottom-0 data-[state=active]:after:left-0 \n        data-[state=active]:after:right-0 data-[state=active]:after:h-0.5 data-[state=active]:after:bg-black \n        data-[state=active]:after:content-['']\n    ".trim().replace(/\s+/g," ");return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("h1",{className:"text-3xl sm:text-4xl lg:text-5xl font-base44 font-medium mb-4 mt-6",children:"Integrations"}),(0,te.jsx)("p",{className:"text-base sm:text-lg font-base44 mb-6",children:"Discover pre-built integrations that let you connect to APIs, services, and tools to extend your app's capabilities."}),(0,te.jsx)(Rp,{value:s,onValueChange:t,className:"mb-8",children:(0,te.jsxs)(Fp,{className:"h-auto w-full bg-transparent p-0 border-b border-gray-200 justify-start",children:[(0,te.jsx)(zp,{value:"catalog",className:a,children:"Integrations Catalog"}),(0,te.jsx)(zp,{value:"my-integrations",className:a,children:"My Integrations"})]})})]})}Up.displayName=nr.UC.displayName;const Wp=[{value:"most-upvoted",label:"Most Popular"},{value:"newest",label:"Newest first"},{value:"oldest",label:"Oldest first"}];function qp(e){let{searchTerm:s,onSearchChange:t,selectedCategory:a,onCategoryChange:r,sortBy:n,onSortByChange:l,privacyFilter:i,onPrivacyFilterChange:o,statusFilter:c,onStatusFilterChange:d,isAdmin:m}=e;const[u,x]=(0,Y.useState)(s),h=(0,Y.useCallback)((e=>setTimeout((()=>{t(e)}),300)),[t]);return(0,Y.useEffect)((()=>{const e=h(u);return()=>clearTimeout(e)}),[u,h]),(0,Y.useEffect)((()=>{x(s)}),[s]),(0,te.jsx)("div",{className:"mt-[42px] mb-6 font-base44",children:(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-3 w-full sm:justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center rounded-xl border border-[#E4E4E7] bg-white flex-1 sm:max-w-[420px] h-[40px] px-3 sm:px-[11px]",children:[(0,te.jsx)(Na.A,{className:"w-4 h-4 text-[#000] flex-shrink-0"}),(0,te.jsx)(Qn,{placeholder:"Search integrations...",value:u,onChange:e=>x(e.target.value),className:"border-0 bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 placeholder:text-[#B4B4B4] text-black"})]}),(0,te.jsx)("div",{className:"flex items-center gap-3 justify-end sm:justify-start",children:(0,te.jsxs)(pl,{value:n,onValueChange:l,children:[(0,te.jsx)(fl,{className:"w-auto min-w-[140px] h-[40px] font-base44 border-0 bg-transparent px-0 text-black focus-visible:ring-0 focus-visible:ring-offset-0 [&>svg]:text-black [&>svg]:ml-2",children:(0,te.jsx)(gl,{placeholder:"Sort by"})}),(0,te.jsx)(bl,{children:Wp.map((e=>(0,te.jsx)(yl,{value:e.value,className:"font-base44",children:e.label},e.value)))})]})})]})})}const Vp=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})}));Vp.displayName="Card";const Yp=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("flex flex-col space-y-1.5 p-6",t),...a})}));Yp.displayName="CardHeader";const Hp=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("h3",{ref:s,className:ns("text-2xl font-semibold leading-none tracking-tight",t),...a})}));Hp.displayName="CardTitle";const Gp=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("p",{ref:s,className:ns("text-sm text-muted-foreground",t),...a})}));Gp.displayName="CardDescription";const Jp=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("p-6 pt-0",t),...a})}));Jp.displayName="CardContent";const Zp=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("flex items-center p-6 pt-0",t),...a})}));Zp.displayName="CardFooter";const Kp=(0,ts.cva)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function Xp(e){let{className:s,variant:t,...a}=e;return(0,te.jsx)("div",{className:ns(Kp({variant:t}),s),...a})}var Qp=t(95445);const eg=e=>{var s,t;let{item:a,onSelect:r,isAdmin:n,currentUser:l}=e;const{item:i,usage:o}=a,c=(null==l?void 0:l.email)===i.owner_email,d=!("pending"===i.status&&!i.is_private)||n||c,m=`\n    h-full overflow-hidden transition-all duration-200 \n    bg-white flex flex-col  rounded-[16px] font-base44 shadow-none border-0\n    ${d?"hover:shadow-md cursor-pointer border-gray-100":"border-dashed border-gray-100 bg-slate-50 opacity-70 cursor-not-allowed"}\n  `;return(0,te.jsxs)(Vp,{className:m,onClick:()=>{d&&r(i.id)},children:[(0,te.jsx)(Yp,{className:"pb-1 px-4 pt-4",children:(0,te.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,te.jsxs)(bx,{className:"h-12 w-12 flex-shrink-0 rounded-md",children:[(0,te.jsx)(yx,{src:i.image_url,alt:i.name,className:"object-contain"}),(0,te.jsx)(Nx,{className:"bg-gradient-to-br from-blue-100 to-teal-100 text-teal-700 text-sm font-medium",children:(null===(s=i.name)||void 0===s||null===(t=s.charAt(0))||void 0===t?void 0:t.toUpperCase())||"I"})]}),(0,te.jsxs)("div",{className:"w-full",children:[(0,te.jsx)(Hp,{className:"text-[16px] font-regular",children:i.name}),(0,te.jsxs)("div",{className:"flex gap-1.5 flex-wrap",children:[i.official&&(0,te.jsxs)(Xp,{variant:"outline",className:"bg-blue-50 px-1.5 py-0 h-5 font-normal",children:[(0,te.jsx)(Qp.A,{className:"h-3 w-3 mr-0.5"}),(0,te.jsx)("span",{className:"text-xs",children:"Official"})]}),i.is_private&&(0,te.jsxs)(Xp,{variant:"outline",className:"bg-slate-100 text-slate-700 border-slate-200 px-1.5 py-0 h-5 font-normal",children:[(0,te.jsx)(Ls.A,{className:"h-3 w-3 mr-0.5"}),(0,te.jsx)("span",{className:"text-xs",children:"Private"})]}),"pending"===i.status&&!i.is_private&&(0,te.jsxs)(Xp,{variant:"outline",className:"bg-amber-50 text-amber-700 border-amber-200 px-1.5 py-0 h-5 font-normal",children:[(0,te.jsx)(St.A,{className:"h-3 w-3 mr-0.5"}),(0,te.jsx)("span",{className:"text-xs",children:"Pending Review"})]})]})]})]})}),(0,te.jsx)(Jp,{className:"pb-3 px-4 flex-1",children:(0,te.jsx)("div",{className:" overflow-hidden",children:(0,te.jsx)("p",{className:"text-sm font-light line-clamp-3 text-[#3C444C]",children:i.description||"No description provided."})})}),(0,te.jsx)(Zp,{className:"px-4 py-2 flex mt-auto",children:(0,te.jsx)("div",{className:"flex gap-1 text-sm",children:(0,te.jsxs)("span",{className:"font-light font-base44 text-[#3C444C]",children:[o||0," installs"]})})})]})},sg=()=>{const e=(0,Z.Zp)(),s=()=>{e("/integrations-catalog/editor")};return(0,te.jsxs)(Vp,{className:"\n    p-4 h-full overflow-hidden transition-all duration-300 ease-out\n    flex flex-col rounded-[16px] font-base44 shadow-lg border-0\n    hover:shadow-2xl cursor-pointer group relative\n    hover:scale-[1.03] hover:-translate-y-1\n  ",style:{background:" linear-gradient(211deg, rgba(48, 45, 56, 1) 0%, rgba(48, 45, 56, 1) 37%, rgba(140, 72, 55, 1) 85%, rgba(254, 127, 72, 1) 100%)"},onClick:s,children:[(0,te.jsx)(Yp,{className:"pb-1 px-4 pt-4 relative z-10",children:(0,te.jsx)(Hp,{className:"text-[16px] font-regular text-white leading-tight text-left",children:"Create Your Integration"})}),(0,te.jsx)(Jp,{className:"pb-3 px-4 flex-1 relative z-10",children:(0,te.jsx)("div",{className:"text-left",children:(0,te.jsx)("p",{className:"text-sm font-light line-clamp-3 text-white/90",children:"Automate your workflow or build for the community \u2013 create powerful integrations in just a few clicks"})})}),(0,te.jsx)(Zp,{className:"px-4 py-2 flex mt-auto relative z-10",children:(0,te.jsx)("button",{className:"bg-orange-500 hover:bg-orange-600 text-white font-medium py-2 px-4 rounded-[12px] transition-all duration-200 text-sm",onClick:e=>{e.stopPropagation(),s()},children:"Create Integration"})})]})},tg=()=>(0,te.jsxs)(Vp,{className:"h-full overflow-hidden bg-white flex flex-col rounded-[16px] font-base44 shadow-none border-0 border-gray-100 animate-pulse",children:[(0,te.jsx)(Yp,{className:"pb-1 px-4 pt-4",children:(0,te.jsxs)("div",{className:"flex flex-col gap-2",children:[(0,te.jsx)("div",{className:"h-12 w-12 flex-shrink-0 rounded-md bg-slate-200"}),(0,te.jsx)("div",{className:"w-full",children:(0,te.jsx)("div",{className:"h-5 bg-slate-200 rounded w-3/4 mb-2"})})]})}),(0,te.jsx)(Jp,{className:"pb-3 px-4 flex-1",children:(0,te.jsx)("div",{className:"overflow-hidden",children:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("div",{className:"h-4 bg-slate-200 rounded w-full"}),(0,te.jsx)("div",{className:"h-4 bg-slate-200 rounded w-5/6"}),(0,te.jsx)("div",{className:"h-4 bg-slate-200 rounded w-4/6"})]})})}),(0,te.jsx)(Zp,{className:"px-4 py-2 flex mt-auto",children:(0,te.jsx)("div",{className:"h-4 bg-slate-200 rounded w-20"})})]}),ag=e=>{let{count:s=12}=e;return(0,te.jsx)("div",{className:"space-y-6",children:(0,te.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5",children:Array.from({length:s}).map(((e,s)=>(0,te.jsx)(tg,{},`skeleton-${s}`)))})})},rg=e=>{let{isLoading:s,isLoadingMore:t,items:a,onCardClick:r,hasMore:n,targetRef:l,isAdmin:i,onCreateIntegration:o,activeTab:c,currentUser:d}=e;if(s)return(0,te.jsx)(ag,{});if(0===a.length)return"my-integrations"===c?(0,te.jsx)("div",{className:"text-center py-16 px-8",children:(0,te.jsxs)("div",{className:"max-w-sm mx-auto",children:[(0,te.jsx)("div",{className:"relative mb-6",children:(0,te.jsx)("div",{className:"w-16 h-16 mx-auto bg-gradient-to-br from-teal-100 to-blue-100 rounded-full flex items-center justify-center",children:(0,te.jsx)(qa.A,{className:"h-8 w-8 text-teal-600"})})}),(0,te.jsx)("h3",{className:"text-xl font-base44 font-medium text-slate-900 mb-3",children:"Create your first integration"}),(0,te.jsx)("p",{className:"text-slate-600 font-base44 mb-6 leading-relaxed",children:"Build custom integrations to connect your apps with external APIs and services. Share them with the community to earn credits!"}),(0,te.jsxs)("button",{onClick:o,className:"inline-flex items-center px-6 py-3 bg-teal-600 hover:bg-teal-700  text-white font-base44 font-medium rounded-lg transition-colors shadow-sm focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2",children:[(0,te.jsx)(ys.A,{className:"h-4 w-4 mr-2"}),"Create Integration"]})]})}):(0,te.jsxs)("div",{className:"text-center p-12 border rounded-lg bg-slate-50",children:[(0,te.jsx)("div",{className:"text-slate-400 mb-3",children:(0,te.jsx)(Na.A,{className:"h-12 w-12 mx-auto"})}),(0,te.jsx)("h3",{className:"text-lg font-medium text-slate-700 mb-1",children:"No matching integrations found"}),(0,te.jsx)("p",{className:"text-slate-500 text-sm",children:"Try adjusting your search or filter settings."})]});return(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-5",children:(()=>{const e=[];return a.forEach(((s,t)=>{5===t&&e.push((0,te.jsx)(sg,{},"create-integration-card")),e.push((0,te.jsx)(eg,{item:s,onSelect:r,isAdmin:i,currentUser:d},s.item.id))})),a.length<6&&e.push((0,te.jsx)(sg,{},"create-integration-card")),e})()}),t&&(0,te.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,te.jsx)(Je.A,{className:"h-6 w-6 text-teal-600 animate-spin mr-2"}),(0,te.jsx)("span",{className:"text-sm text-slate-500",children:"Loading more integrations..."})]}),n&&!t&&(0,te.jsx)("div",{ref:l,className:"h-1"}),!n&&a.length>0&&(0,te.jsx)("div",{className:"text-center py-8 text-sm text-slate-500",children:"You've reached the end of the integrations catalog"})]})};const ng=function(){const{user:e}=ne(),s=(0,Y.useRef)(0),[t,a]=(0,Y.useState)("catalog"),[r,n]=(0,Y.useState)([]),[l,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(""),[d,m]=(0,Y.useState)("all"),[u,x]=(0,Y.useState)("most-upvoted"),[h,p]=(0,Y.useState)("all"),[g,f]=(0,Y.useState)("all"),[v,j]=(0,Y.useState)(new Set),b=(0,Z.Zp)(),[y,N]=(0,Y.useState)(!0),[w,k]=(0,Y.useState)(!1),[_,S]=(0,Y.useState)(0),[C]=(0,Y.useState)(20),[A,E]=(0,Y.useState)(0),I="platform_admin"===(null==e?void 0:e.platform_role),L=e=>{switch(e){case"newest":return"-created_date";case"oldest":return"created_date";default:return"-usage"}},T=(0,Y.useCallback)((async function(){let a=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const r=++s.current;try{a?k(!0):(i(!0),E(0));const l=(()=>{const s={};return"my-integrations"===t&&null!=e&&e.email&&(s.created_by=e.email),o.trim()&&(s.$or=[{name:{$regex:o.trim(),$options:"i"}},{description:{$regex:o.trim(),$options:"i"}},{created_by:{$regex:o.trim(),$options:"i"}}]),"all"!==d&&(s.categories=d),I&&("private"===h?s.is_private=!0:"public"===h&&(s.is_private=!1),"pending"===g?s.status="pending":"approved"===g&&(s.status="approved")),s})(),c=a?A:0,m=await Bs.listCatalogItems({...l,limit:C,skip:c,sort_by:L(u)});if(r!==s.current)return;const x=m.data||m||[];a?(n((e=>[...e,...x])),E((e=>e+C))):(n(x),E(C)),N(x.length===C),S((e=>a?e+x.length:x.length));const p=new Set(x.filter((e=>e.did_current_user_upvote)).map((e=>e.item.id)));j(a?e=>new Set([...Array.from(e),...Array.from(p)]):p)}catch(l){if(r!==s.current)return;zn({title:"Error",description:"Failed to load integrations",variant:"destructive"}),a||n([])}finally{r===s.current&&(i(!1),k(!1))}}),[t,u,h,g,o,d,I,A,C,null==e?void 0:e.email]);(0,Y.useEffect)((()=>{T()}),[]),(0,Y.useEffect)((()=>{T(!1)}),[t,o,d,u,h,g]);const{targetRef:$}=Op({onLoadMore:()=>{y&&!w&&T(!0)},hasMore:y,isLoading:l||w}),D=r.length,P=_>0?`Showing ${D} of ${_} integrations`:"";return(0,te.jsxs)("div",{className:"px-4 sm:px-6 md:px-8 lg:px-12 max-w-[1600px] mx-auto",children:[(0,te.jsx)(Bp,{activeTab:t,onTabChange:e=>{e!==t&&(n([]),i(!0),a(e),E(0),N(!0),S(0))}}),(0,te.jsx)(qp,{searchTerm:o,onSearchChange:e=>{c(e)},selectedCategory:d,onCategoryChange:e=>{m(e)},sortBy:u,onSortByChange:e=>{x(e)},privacyFilter:h,onPrivacyFilterChange:e=>{p(e)},statusFilter:g,onStatusFilterChange:e=>{f(e)},totalItems:_,displayedItems:D,showingText:P,isLoading:l,isAdmin:I}),(0,te.jsx)(rg,{isLoading:l,isLoadingMore:w,items:r,onCardClick:e=>{b(`/integrations-catalog/item/${e}`)},hasMore:y,targetRef:$,isAdmin:I,onCreateIntegration:()=>{b("/integrations-catalog/editor")},activeTab:t})]})};var lg=t(68432),ig=t(32369);const og=Y.forwardRef(((e,s)=>{let{className:t,orientation:a="horizontal",decorative:r=!0,...n}=e;return(0,te.jsx)(Ks.b,{ref:s,decorative:r,orientation:a,className:ns("shrink-0 bg-border","horizontal"===a?"h-[1px] w-full":"h-full w-[1px]",t),...n})}));og.displayName=Ks.b.displayName;const cg=()=>(0,te.jsx)("div",{className:"min-h-screen bg-white font-base44 animate-pulse",children:(0,te.jsxs)("div",{className:"mx-auto",children:[(0,te.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4",children:(0,te.jsxs)("nav",{className:"flex items-center space-x-2 text-sm",children:[(0,te.jsx)("div",{className:"h-4 w-20 bg-slate-200 rounded"}),(0,te.jsx)("span",{children:"/"}),(0,te.jsx)("div",{className:"h-4 w-32 bg-slate-200 rounded"})]})}),(0,te.jsx)("div",{className:"border-b border-slate-200"}),(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row max-w-7xl mx-auto gap-6 lg:gap-8 p-4 sm:p-6",children:[(0,te.jsx)("div",{className:"w-full lg:w-80 lg:flex-shrink-0",children:(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsx)("div",{className:"flex gap-4 items-start mb-4",children:(0,te.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,te.jsx)("div",{className:"h-16 w-16 rounded-xl bg-slate-200"}),(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"h-6 w-40 bg-slate-200 rounded mb-2 mx-auto"}),(0,te.jsx)("div",{className:"h-4 w-16 bg-slate-200 rounded mx-auto"})]})]})}),(0,te.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"h-4 w-4 bg-slate-200 rounded"}),(0,te.jsx)("div",{className:"h-4 w-16 bg-slate-200 rounded"})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"h-4 w-4 bg-slate-200 rounded"}),(0,te.jsx)("div",{className:"h-4 w-24 bg-slate-200 rounded"})]})]}),(0,te.jsx)("div",{className:"w-full lg:w-[280px] h-12 bg-slate-200 rounded-[16px] mb-4"}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("div",{className:"h-4 w-12 bg-slate-200 rounded mb-2"}),(0,te.jsx)("div",{className:"h-4 w-28 bg-slate-200 rounded"})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded mb-1"}),(0,te.jsx)("div",{className:"h-4 w-3/4 bg-slate-200 rounded"})]})]}),(0,te.jsx)("div",{className:"h-px w-full bg-slate-200 my-6"}),(0,te.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,te.jsx)("div",{className:"h-4 w-36 bg-slate-200 rounded"}),(0,te.jsx)("div",{className:"h-4 w-4 bg-slate-200 rounded"})]}),(0,te.jsxs)("div",{className:"flex items-center justify-between w-full",children:[(0,te.jsx)("div",{className:"h-4 w-32 bg-slate-200 rounded"}),(0,te.jsx)("div",{className:"h-4 w-4 bg-slate-200 rounded"})]})]})]})}),(0,te.jsxs)("div",{className:"flex-1 border border-slate-200 p-6 rounded-[20px] min-w-0",children:[(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsx)("div",{className:"h-6 sm:h-8 w-28 bg-slate-200 rounded mb-4"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"}),(0,te.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"}),(0,te.jsx)("div",{className:"h-4 w-3/4 bg-slate-200 rounded"})]})]}),(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsx)("div",{className:"h-6 w-40 bg-slate-200 rounded mb-4"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("div",{className:"bg-slate-100 rounded-lg px-4 py-3",children:(0,te.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"})}),(0,te.jsx)("div",{className:"bg-slate-100 rounded-lg px-4 py-3",children:(0,te.jsx)("div",{className:"h-4 w-5/6 bg-slate-200 rounded"})}),(0,te.jsx)("div",{className:"bg-slate-100 rounded-lg px-4 py-3",children:(0,te.jsx)("div",{className:"h-4 w-4/5 bg-slate-200 rounded"})})]})]}),(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsxs)("div",{className:"bg-slate-100 p-1 mb-6 rounded-md flex gap-1",children:[(0,te.jsx)("div",{className:"h-8 w-24 bg-slate-200 rounded"}),(0,te.jsx)("div",{className:"h-8 w-32 bg-slate-200 rounded"})]}),(0,te.jsx)("div",{className:"space-y-4",children:(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,te.jsx)("div",{className:"h-5 w-32 bg-slate-200 rounded"}),(0,te.jsx)("div",{className:"h-4 w-24 bg-slate-200 rounded"})]}),(0,te.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded mb-4"}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"bg-slate-100 rounded-lg p-4 border border-slate-200",children:[(0,te.jsx)("div",{className:"h-5 w-24 bg-slate-200 rounded mb-2"}),(0,te.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"})]}),(0,te.jsxs)("div",{className:"bg-slate-100 rounded-lg p-4 border border-slate-200",children:[(0,te.jsx)("div",{className:"h-5 w-32 bg-slate-200 rounded mb-2"}),(0,te.jsx)("div",{className:"h-4 w-5/6 bg-slate-200 rounded"})]})]})]})})]}),(0,te.jsx)("div",{className:"mb-8 p-4 bg-slate-100 border border-slate-200 rounded-lg",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)("div",{className:"h-8 w-8 rounded-full bg-slate-200 flex-shrink-0"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("div",{className:"h-5 w-28 bg-slate-200 rounded mb-2"}),(0,te.jsx)("div",{className:"h-9 w-36 bg-slate-200 rounded"})]})]})})]})]}),(0,te.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 pb-8",children:(0,te.jsxs)("div",{className:"bg-slate-100 rounded-2xl border border-slate-200 p-6",children:[(0,te.jsxs)("div",{className:"mb-4",children:[(0,te.jsx)("div",{className:"h-6 w-48 bg-slate-200 rounded mb-2"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("div",{className:"h-4 w-full bg-slate-200 rounded"}),(0,te.jsx)("div",{className:"h-4 w-2/3 bg-slate-200 rounded"})]})]}),(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-3",children:[(0,te.jsx)("div",{className:"h-10 w-36 bg-slate-200 rounded-xl"}),(0,te.jsx)("div",{className:"h-10 w-28 bg-slate-200 rounded-xl"}),(0,te.jsx)("div",{className:"h-10 w-32 bg-slate-200 rounded-xl"}),(0,te.jsx)("div",{className:"h-10 w-20 bg-slate-200 rounded-xl"})]})]})})]})}),dg=()=>{var e;const{itemId:s}=(0,Z.g)(),t=(0,Z.Zp)(),{user:a}=ne(),[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(null),[d,m]=(0,Y.useState)("details"),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,j]=(0,Y.useState)(!1),[b,y]=(0,Y.useState)(!1),[N,w]=(0,Y.useState)(""),[k,_]=(0,Y.useState)(!1),S=a&&"platform_admin"===a.platform_role,C=a&&("free"===a.subscription_tier||"starter"===a.subscription_tier);(0,Y.useEffect)((()=>{s&&A()}),[s]);const A=async()=>{if(s)try{i(!0);const e=await Bs.getCatalogItem(s);n(e.data||e),i(!1)}catch(e){c("Failed to load item details"),i(!1)}};if(l)return(0,te.jsx)(cg,{});if(o)return(0,te.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-[500px] text-center p-4",children:[(0,te.jsxs)("div",{className:"text-red-500 text-xl font-semibold mb-2",children:["\u26a0\ufe0f ",o]}),(0,te.jsx)("button",{className:"px-4 py-2 bg-blue-500 text-white rounded-md hover:bg-blue-600 transition-colors",onClick:A,children:"Try Again"})]});if(!r)return null;const{item:E,is_user_the_owner:I}=r,L="approved"!==E.status,T=E.required_secrets&&E.required_secrets.length>0,$=E.requires_backend_functions&&C;return(0,te.jsx)("div",{className:"min-h-screen bg-white font-base44",children:(0,te.jsxs)("div",{className:"mx-auto",children:[(0,te.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 py-4",children:(0,te.jsxs)("nav",{className:"flex items-center space-x-2 text-sm text-slate-600",children:[(0,te.jsx)("button",{onClick:()=>{t("/integrations-catalog")},className:"hover:text-slate-900 transition-colors",children:"Integrations"}),(0,te.jsx)("span",{children:"/"}),(0,te.jsx)("span",{className:"text-slate-900 font-medium",children:E.name})]})}),(0,te.jsx)("div",{className:"border-b border-slate-200"}),(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row max-w-7xl mx-auto gap-6 lg:gap-8 p-4 sm:p-6",children:[(0,te.jsx)("div",{className:"w-full lg:w-80 lg:flex-shrink-0",children:(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsx)("div",{className:"flex gap-4 items-start mb-4",children:(0,te.jsxs)("div",{className:"flex flex-col gap-4",children:[(0,te.jsx)("div",{className:"h-16 w-16 rounded-xl overflow-hidden bg-white",children:E.image_url?(0,te.jsx)("img",{src:E.image_url,alt:E.name,className:"h-full w-full object-contain",onError:e=>{const s=e.target;s.src="",s.alt=""}}):(0,te.jsx)("div",{className:"h-full w-full bg-slate-50 flex items-center justify-center",children:(0,te.jsx)("span",{className:"text-slate-600 text-lg font-semibold",children:E.name.charAt(0).toUpperCase()})})}),(0,te.jsx)("div",{className:"text-center",children:(0,te.jsx)("h1",{className:"text-lg sm:text-xl font-semibold break-words",children:E.name})}),E.official&&(0,te.jsxs)("div",{className:"flex items-center gap-1 mt-2",children:[(0,te.jsx)(Qp.A,{className:"h-4 w-4 text-blue-600"}),(0,te.jsx)("span",{className:"text-sm text-blue-600 font-medium",children:"Official"})]})]})}),(0,te.jsxs)("div",{className:"space-y-3 mb-6",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,te.jsx)(Tt.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:E.is_private?"Private":"Public"})]}),E.created_at&&(0,te.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-600",children:[(0,te.jsx)(St.A,{className:"h-4 w-4"}),(0,te.jsxs)("span",{children:["Added ",Bt().utc(E.created_at).fromNow()]})]})]}),$?(0,te.jsx)(sl,{size:"lg",className:"w-full lg:w-[280px] bg-slate-200 text-slate-500 cursor-not-allowed mb-4 text-md rounded-[16px]",disabled:!0,children:"Use this integration"}):(0,te.jsx)(sl,{onClick:()=>{t(`/?integrations=${s}`)},size:"lg",className:"w-full lg:w-[280px] bg-orange-500 hover:bg-orange-600 text-white mb-4 text-md rounded-[16px]",children:"Use this integration"}),$&&(0,te.jsx)("div",{className:"bg-amber-50 border border-amber-200 rounded-md p-3 mb-4",children:(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4 text-amber-600 flex-shrink-0 mt-0.5"}),(0,te.jsx)("p",{className:"text-sm text-amber-800",children:"This integration requires backend functions, a feature available only on Builder tier and above."})]})}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"text-sm font-medium text-slate-900",children:"Status"}),"approved"===E.status?(0,te.jsxs)(Xp,{className:"bg-green-100 text-green-800 hover:bg-green-200",children:[(0,te.jsx)(Ed.A,{className:"h-3 w-3 mr-1"}),"Approved"]}):(0,te.jsx)(Xp,{className:"bg-amber-100 text-amber-800 hover:bg-amber-200",children:"Pending Approval"})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"text-sm font-medium text-slate-900 mb-3",children:"Share this integration"}),(0,te.jsxs)("div",{className:"flex items-center gap-1.5 p-1.5 bg-slate-50 rounded-md border border-slate-200",children:[(0,te.jsx)("div",{className:"flex-1 text-xs text-slate-600 truncate font-mono",children:window.location.href}),(0,te.jsx)(sl,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 hover:bg-slate-200",onClick:async()=>{try{f(!0);const e=window.location.href;await navigator.clipboard.writeText(e),zn({title:"Link copied",description:"Integration link has been copied to clipboard"}),setTimeout((()=>f(!1)),1e3)}catch(e){zn({title:"Error",description:"Failed to copy link to clipboard",variant:"destructive"}),f(!1)}},disabled:g,title:g?"Copied!":"Copy link",children:g?(0,te.jsx)(mt.A,{className:"h-3.5 w-3.5 text-green-600"}):(0,te.jsx)(Ha.A,{className:"h-3.5 w-3.5 text-slate-500"})})]})]}),E.requires_backend_functions&&(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm text-slate-600 break-words",children:"Using this integration will automatically activate backend functions."}),(0,te.jsx)("p",{className:"text-sm text-slate-600 mt-1 break-words",children:"Available on the Builder tier and above."})]})]}),(0,te.jsx)(og,{className:"my-6 bg-gray-400"}),T&&(0,te.jsxs)("div",{className:"mt-6 space-y-3",children:[(0,te.jsxs)("button",{className:"flex items-center justify-between w-full text-sm text-slate-600 hover:text-slate-900",children:[(0,te.jsx)("span",{children:"How to get your API key"}),(0,te.jsx)("span",{children:"\u2197"})]}),(0,te.jsxs)("button",{className:"flex items-center justify-between w-full text-sm text-slate-600 hover:text-slate-900",onClick:()=>t("/support"),children:[(0,te.jsx)("span",{children:"Base44 support hub"}),(0,te.jsx)("span",{children:"\u2197"})]})]})]})}),(0,te.jsxs)("div",{className:"flex-1 border border-slate-200 p-6 rounded-[20px] min-w-0",children:[(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-slate-900 mb-4",children:"Overview"}),(0,te.jsx)("p",{className:"text-slate-600 text-base leading-relaxed break-words",children:E.description})]}),E.example_asks&&E.example_asks.length>0&&(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-4",children:"Example prompts"}),(0,te.jsx)("div",{className:"space-y-2",children:E.example_asks.map(((e,s)=>(0,te.jsx)("div",{className:"bg-slate-50 rounded-lg px-4 py-3 text-sm text-slate-700 break-words",children:e},s)))})]}),(T||E.prompt)&&(0,te.jsx)("div",{className:"mb-8",children:(0,te.jsxs)(Rp,{defaultValue:T?"requirements":"instructions",className:"w-full",children:[(0,te.jsxs)(Fp,{className:"bg-slate-50 p-1 mb-6",children:[T&&(0,te.jsx)(zp,{value:"requirements",className:"text-sm data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"Requirements"}),E.prompt&&(0,te.jsx)(zp,{value:"instructions",className:"text-sm data-[state=active]:bg-white data-[state=active]:shadow-sm",children:"Instructions Set"})]}),T&&(0,te.jsx)(Up,{value:"requirements",children:(0,te.jsx)("div",{className:"space-y-4",children:(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,te.jsx)("h4",{className:"font-semibold text-slate-900",children:"Required API Keys"}),(0,te.jsxs)("button",{className:"text-sm text-blue-600 hover:text-blue-800 flex items-center gap-1",children:["Documentation ",(0,te.jsx)("span",{children:"\u2197"})]})]}),(0,te.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"You'll need these credentials to use this integration:"}),(0,te.jsx)("div",{className:"space-y-3",children:null===(e=E.required_secrets)||void 0===e?void 0:e.map(((e,s)=>(0,te.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 border border-slate-200",children:[(0,te.jsx)("h5",{className:"font-medium text-slate-900 mb-2 break-words",children:e.name}),(0,te.jsx)("p",{className:"text-sm text-slate-600 break-words",children:e.description||"Required for this integration to work properly."})]},s)))})]})})}),E.prompt&&(0,te.jsx)(Up,{value:"instructions",children:(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)("div",{children:(0,te.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"These instructions will be injected into Base44's AI when this integration is used"})}),(0,te.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsx)(lg.A,{className:"h-4 w-4 text-blue-600 flex-shrink-0 mt-0.5"}),(0,te.jsx)("div",{children:(0,te.jsxs)("p",{className:"text-sm text-blue-800",children:[(0,te.jsx)("span",{className:"font-medium",children:"How this works:"})," When you use this integration, these instructions are automatically injected into Base44's AI system, enabling it to perform the specific tasks defined here."]})})]})}),(0,te.jsx)("div",{className:"bg-slate-50 p-4 rounded-lg border border-slate-200 overflow-auto max-h-[500px]",children:(0,te.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-slate-700 font-mono break-words overflow-hidden",children:E.prompt})})]})})]})}),S&&L&&(0,te.jsx)("div",{className:"mb-8 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)("div",{className:"h-8 w-8 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:(0,te.jsx)(Dl.A,{className:"h-4 w-4 text-blue-600"})}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"font-medium text-slate-900",children:"Admin Actions"}),(0,te.jsx)("div",{className:"mt-2",children:(0,te.jsxs)(sl,{onClick:async()=>{if(s)try{x(!0),await Bs.approveItem(s),zn({title:"Success",description:"Integration has been approved"}),A()}catch(e){zn({title:"Error",description:"Failed to approve integration",variant:"destructive"})}finally{x(!1)}},disabled:u,size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",children:[(0,te.jsx)(Ed.A,{className:"h-4 w-4 mr-1.5"}),u?"Approving...":"Approve Integration"]})})]})]})})]})]}),I&&(0,te.jsx)(te.Fragment,{children:(0,te.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 pb-8",children:(0,te.jsxs)("div",{className:"bg-slate-50 rounded-2xl border border-slate-200 p-6",children:[(0,te.jsxs)("div",{className:"mb-4",children:[(0,te.jsx)("h3",{className:"text-lg font-semibold text-slate-900 mb-2",children:"Integration Management"}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"As the owner of this integration, you can manage its settings and visibility."})]}),(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row sm:flex-wrap gap-3",children:[(0,te.jsxs)(sl,{variant:"outline",size:"default",onClick:()=>{t(`/integrations-catalog/editor/${s}`)},className:"bg-white text-slate-700 border-slate-300 hover:bg-slate-50 rounded-xl px-6",children:[(0,te.jsx)(Ba.A,{className:"h-4 w-4 mr-2"}),"Edit Integration"]}),(0,te.jsx)(sl,{variant:"outline",size:"default",onClick:async()=>{if(s&&r)try{y(!0),await Bs.update(s,{is_private:!r.item.is_private}),zn({title:"Success",description:r.item.is_private?"Integration is now public":"Integration is now private"}),A()}catch(e){zn({title:"Error",description:"Failed to update integration privacy setting",variant:"destructive"})}finally{y(!1)}},disabled:b,className:"bg-white text-slate-700 border-slate-300 hover:bg-slate-50 rounded-xl px-6",children:b?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"h-4 w-4 mr-2 animate-spin rounded-full border-2 border-slate-400 border-t-transparent"}),"Updating..."]}):E.is_private?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Tt.A,{className:"h-4 w-4 mr-2"}),"Make Public"]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Ls.A,{className:"h-4 w-4 mr-2"}),"Make Private"]})}),(0,te.jsxs)(Bn,{open:k,onOpenChange:_,children:[(0,te.jsx)(Wn,{asChild:!0,children:(0,te.jsxs)(sl,{variant:"outline",size:"default",className:"bg-white text-slate-700 border-slate-300 hover:bg-slate-50 rounded-xl px-6",children:[(0,te.jsx)(vh.A,{className:"h-4 w-4 mr-2"}),"Invite Admin"]})}),(0,te.jsxs)(Yn,{className:"sm:max-w-[425px]",children:[(0,te.jsxs)(Hn,{children:[(0,te.jsx)(Jn,{children:"Invite User"}),(0,te.jsx)(Zn,{children:"Invite a user to edit and administer this catalog item"})]}),(0,te.jsx)("div",{className:"grid gap-4 py-4",children:(0,te.jsxs)("div",{className:"grid grid-cols-4 items-center gap-4",children:[(0,te.jsx)(td,{htmlFor:"email",className:"text-right",children:"Email"}),(0,te.jsx)(Qn,{id:"email",type:"email",placeholder:"user@example.com",className:"col-span-3",value:N,onChange:e=>w(e.target.value)})]})}),(0,te.jsx)(Gn,{children:(0,te.jsx)(sl,{onClick:async()=>{if(s&&N&&N.includes("@"))try{j(!0),await Bs.inviteAdmin(s,N),zn({title:"Success",description:`Invitation sent to ${N}`}),w(""),_(!1)}catch(e){zn({title:"Error",description:"Failed to send invitation",variant:"destructive"})}finally{j(!1)}else zn({title:"Invalid email",description:"Please enter a valid email address",variant:"destructive"})},disabled:v||!N,className:"bg-slate-900 hover:bg-slate-800 text-white",children:v?"Sending...":"Send Invitation"})})]})]}),(0,te.jsxs)(sl,{variant:"outline",size:"default",onClick:async()=>{if(s)try{p(!0),await Bs.archiveItem(s),zn({title:"Success",description:"Integration has been archived"}),t("/integrations-catalog")}catch(e){zn({title:"Error",description:"Failed to archive integration",variant:"destructive"}),p(!1)}},disabled:h,className:"bg-white text-red-600 border-red-200 hover:bg-red-50 rounded-xl px-6",children:[(0,te.jsx)(ig.A,{className:"h-4 w-4 mr-2"}),h?"Archiving...":"Archive"]})]})]})})})]})})};var mg=t(11464);const ug=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("textarea",{className:ns("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:s,...a})}));ug.displayName="Textarea";const xg=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Ic.bL,{className:ns("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",t),...a,ref:s,children:(0,te.jsx)(Ic.zi,{className:ns("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})}));xg.displayName=Ic.bL.displayName;const hg=(0,ts.cva)("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),pg=Y.forwardRef(((e,s)=>{let{className:t,variant:a,...r}=e;return(0,te.jsx)("div",{ref:s,role:"alert",className:ns(hg({variant:a}),t),...r})}));pg.displayName="Alert";Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("h5",{ref:s,className:ns("mb-1 font-medium leading-none tracking-tight",t),...a})})).displayName="AlertTitle";const gg=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,className:ns("text-sm [&_p]:leading-relaxed",t),...a})}));gg.displayName="AlertDescription";const fg=e=>{let{children:s}=e;return(0,te.jsx)(nx,{children:(0,te.jsxs)(lx,{delayDuration:300,children:[(0,te.jsx)(ix,{asChild:!0,children:(0,te.jsx)(cm.A,{className:"h-4 w-4 text-slate-400 ml-1.5 cursor-help"})}),(0,te.jsx)(ox,{className:"max-w-xs p-3 text-xs",children:s})]})})},vg=()=>{const{itemId:e}=(0,Z.g)(),s=(0,Z.Zp)(),{toast:t}=Un(),a=!!e,[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)(!!e),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)(!1),[u,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)({name:"",description:"",prompt:"",image_url:"",example_asks:[],required_secrets:[],requires_backend_functions:!0,is_private:!1}),[g,f]=(0,Y.useState)("metadata"),[v,j]=(0,Y.useState)(""),[b,y]=(0,Y.useState)(""),[N,w]=(0,Y.useState)("");(0,Y.useEffect)((()=>{e?(async()=>{if(e)try{i(!0);const s=await Bs.getCatalogItem(e),t=s.data||s;n(t);const a=t.item;p({name:a.name||"",description:a.description||"",prompt:a.prompt||"",image_url:a.image_url||"",example_asks:a.example_asks||[],required_secrets:a.required_secrets||[],requires_backend_functions:!1!==a.requires_backend_functions,is_private:a.is_private||!1})}catch(s){x("Failed to load integration. It may have been deleted or you may not have permission to view it.")}finally{i(!1)}})():i(!1)}),[e]);const k=e=>{const{name:s,value:t}=e.target;p((e=>({...e,[s]:t})))},_=(e,s)=>{p((t=>({...t,[e]:s})))},S=async r=>{if(r&&r.preventDefault(),h.name.trim()?h.description.trim()?!(h.prompt.trim().length<50&&(t({title:"Validation Error",description:"Integration prompt must be at least 50 characters",variant:"destructive"}),f("content"),1)):(t({title:"Validation Error",description:"Integration description is required",variant:"destructive"}),f("metadata"),0):(t({title:"Validation Error",description:"Integration name is required",variant:"destructive"}),f("metadata"),0)){c(!0),x(null);try{let r;if(a&&e)await Bs.update(e,h),r=e;else{var n;const e=await Bs.create(h);r=(null===(n=e.data)||void 0===n?void 0:n.id)||e.id}t({title:"Success",description:a?"Integration updated successfully":"Integration created successfully"}),s(`/integrations-catalog/item/${r}`)}catch(l){x("Failed to save integration. Please try again."),t({title:"Error",description:"Failed to save integration. Please try again.",variant:"destructive"}),c(!1)}}},C=()=>{s("/integrations-catalog")};return l?(0,te.jsxs)("div",{className:"flex items-center justify-center h-[80vh]",children:[(0,te.jsx)(Je.A,{className:"h-8 w-8 text-teal-600 animate-spin"}),(0,te.jsx)("span",{className:"ml-2 text-lg text-slate-700",children:"Loading integration..."})]}):u&&e&&!h.name?(0,te.jsxs)("div",{className:"flex flex-col items-center justify-center h-[80vh]",children:[(0,te.jsx)("div",{className:"text-red-500 text-lg mb-4",children:u}),(0,te.jsx)(sl,{onClick:C,className:"px-4 py-2 bg-teal-600 text-white rounded hover:bg-teal-700",children:"Return to Catalog"})]}):(0,te.jsxs)("div",{className:"max-w-screen-xl mx-auto px-4 py-8",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center mb-8",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(sl,{variant:"ghost",size:"icon",onClick:C,className:"h-10 w-10 rounded-full",children:(0,te.jsx)(pi.A,{className:"h-5 w-5"})}),(0,te.jsx)("h1",{className:"text-2xl font-bold text-slate-900",children:a?"Edit Integration":"Create New Integration"})]}),(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(sl,{variant:"outline",onClick:C,className:"px-4",children:"Cancel"}),(0,te.jsxs)(sl,{onClick:()=>S(),disabled:o,className:"bg-teal-600 hover:bg-teal-700 px-4",children:[o?(0,te.jsx)(Je.A,{className:"h-4 w-4 mr-2 animate-spin"}):(0,te.jsx)(Wd.A,{className:"h-4 w-4 mr-2"}),o?"Saving...":"Save Integration"]})]})]}),(0,te.jsxs)("div",{className:"bg-gradient-to-r from-amber-50 to-amber-100 border border-amber-200 rounded-lg p-4 mb-6 flex items-center",children:[(0,te.jsx)(Ct.A,{className:"h-5 w-5 text-amber-500 mr-3 flex-shrink-0"}),(0,te.jsxs)("p",{className:"text-amber-800",children:[(0,te.jsx)("span",{className:"font-semibold",children:"Earn 250 credits!"})," Create a public integration that gets approved and we'll reward you with 250 credits to your account."]})]}),u&&(0,te.jsx)(pg,{variant:"destructive",className:"mb-6",children:(0,te.jsx)(gg,{children:u})}),(0,te.jsx)("div",{className:"bg-white rounded-xl border shadow-sm overflow-hidden",children:(0,te.jsxs)(Rp,{value:g,onValueChange:f,className:"w-full",children:[(0,te.jsx)("div",{className:"px-6 pt-6 border-b",children:(0,te.jsxs)(Fp,{className:"grid w-full grid-cols-2 max-w-md",children:[(0,te.jsxs)(zp,{value:"metadata",className:"flex items-center gap-2",children:[(0,te.jsx)(Vi.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Integration Metadata"})]}),(0,te.jsxs)(zp,{value:"content",className:"flex items-center gap-2",children:[(0,te.jsx)(Ua.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{children:"Integration Content"})]})]})}),(0,te.jsx)(Up,{value:"metadata",className:"p-6 space-y-8",children:(0,te.jsxs)("div",{className:"grid gap-8 max-w-3xl mx-auto",children:[(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Integration Name"}),(0,te.jsx)(fg,{children:"A descriptive name for your integration that will be displayed in the catalog."})]}),(0,te.jsx)(Qn,{id:"name",name:"name",value:h.name,onChange:k,placeholder:"E.g., OpenAI Text-To-Speech",required:!0,className:"text-lg"})]}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Description"}),(0,te.jsx)(fg,{children:"A brief explanation of what this integration does and how it helps users."})]}),(0,te.jsx)(ug,{id:"description",name:"description",value:h.description,onChange:k,placeholder:"Describe what this integration does and how it can be useful...",rows:3,required:!0})]}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Integration Logo"}),(0,te.jsx)(fg,{children:"An image that represents your integration. Square images work best."})]}),(0,te.jsxs)("div",{className:"flex items-center gap-8",children:[h.image_url?(0,te.jsx)("div",{className:"w-32 h-32 rounded-lg overflow-hidden border shadow-sm flex-shrink-0",children:(0,te.jsx)("img",{src:h.image_url,alt:"Integration Logo",className:"h-full w-full object-cover",onError:e=>{const s=e.target;s.src="",s.alt=""}})}):(0,te.jsxs)("div",{className:"w-32 h-32 rounded-lg border border-dashed flex-shrink-0 bg-slate-50 flex flex-col items-center justify-center",children:[(0,te.jsx)(Cc.A,{className:"h-8 w-8 text-slate-400 mb-2"}),(0,te.jsx)("p",{className:"text-xs text-slate-500 text-center px-2",children:"No logo uploaded"})]}),(0,te.jsxs)("div",{className:"flex-1 max-w-sm",children:[(0,te.jsx)("input",{type:"file",id:"logo-upload",className:"hidden",accept:"image/*",onChange:async e=>{var s;const t=null===(s=e.target.files)||void 0===s?void 0:s[0];if(t)try{var a;m(!0);const e=await bs.uploadFile(t),s=(null===(a=e.data)||void 0===a?void 0:a.url)||e.url;p((e=>({...e,image_url:s})))}catch(r){x("Failed to upload logo. Please try again.")}finally{m(!1)}}}),(0,te.jsxs)(sl,{type:"button",variant:h.image_url?"outline":"default",disabled:d,className:"w-full mb-3",onClick:()=>{var e;return null===(e=document.getElementById("logo-upload"))||void 0===e?void 0:e.click()},children:[(0,te.jsx)(zo.A,{className:"h-4 w-4 mr-2"}),d?"Uploading...":h.image_url?"Change Logo":"Upload Logo"]}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"Upload a square image in PNG or JPG format (recommended size: 256\xd7256px)"})]})]})]}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsxs)("h2",{className:"text-lg font-semibold text-slate-900 flex items-center",children:[(0,te.jsx)(mr.A,{className:"h-4 w-4 mr-2 text-teal-600"}),"Example Prompts"]}),(0,te.jsx)(fg,{children:"Add examples of how users can ask for this integration in plain language"})]}),(0,te.jsxs)("div",{className:"grid gap-4",children:[(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsx)(Qn,{placeholder:"E.g., Convert text to speech",value:v,onChange:e=>j(e.target.value)}),(0,te.jsxs)(sl,{type:"button",onClick:()=>{v.trim()&&(p((e=>({...e,example_asks:[...e.example_asks,v.trim()]}))),j(""))},className:"bg-teal-600 hover:bg-teal-700 flex-shrink-0",children:[(0,te.jsx)(zt.A,{className:"h-4 w-4 mr-1"})," Add"]})]}),h.example_asks.length>0?(0,te.jsx)("div",{className:"flex flex-wrap gap-2",children:h.example_asks.map(((e,s)=>(0,te.jsxs)(Xp,{variant:"outline",className:"bg-teal-50 text-teal-700 border-teal-200 px-3 py-1 flex items-center gap-1",children:[e,(0,te.jsx)("button",{type:"button",onClick:()=>(e=>{p((s=>({...s,example_asks:s.example_asks.filter(((s,t)=>t!==e))})))})(s),className:"ml-1 text-teal-700 hover:text-teal-900",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]},s)))}):(0,te.jsx)("div",{className:"text-sm text-slate-500 p-4 bg-slate-50 rounded-md border text-center",children:"No example prompts added yet. Add 3-5 examples to help users understand how to use this integration."})]})]}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("h2",{className:"text-lg font-semibold text-slate-900",children:"Integration Visibility"}),(0,te.jsx)(fg,{children:"Control whether your integration is private or public"})]}),(0,te.jsxs)("div",{className:"bg-white rounded-lg p-4 border flex items-center gap-4",children:[(0,te.jsx)("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0",children:h.is_private?(0,te.jsx)(Ls.A,{className:"h-5 w-5 text-slate-700"}):(0,te.jsx)(Tt.A,{className:"h-5 w-5 text-teal-600"})}),(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("h3",{className:"font-medium text-slate-900",children:h.is_private?"Private Integration":"Public Integration"}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:h.is_private?"Only visible to you and invited collaborators":"Visible to all users and eligible for 250 credits when approved"})]}),(0,te.jsx)(xg,{checked:!h.is_private,onCheckedChange:e=>_("is_private",!e)})]})]}),(0,te.jsx)("div",{className:"flex justify-end",children:(0,te.jsx)(sl,{onClick:()=>f("content"),className:"bg-teal-600 hover:bg-teal-700",children:"Continue to Integration Content"})})]})}),(0,te.jsx)(Up,{value:"content",className:"p-6",children:(0,te.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,te.jsxs)("div",{className:"mb-8 bg-blue-50 rounded-lg p-4 border border-blue-100",children:[(0,te.jsxs)("h3",{className:"text-lg font-medium text-blue-800 mb-2 flex items-center",children:[(0,te.jsx)(rl.A,{className:"h-5 w-5 mr-2"}),"About Integration Content"]}),(0,te.jsx)("p",{className:"text-blue-700 text-sm",children:"This section contains the core functionality of your integration. The prompt provides implementation instructions, and you can specify any API keys needed to make it work."})]}),(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsxs)("div",{className:"flex items-center mb-2",children:[(0,te.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"Integration Settings"}),(0,te.jsx)(fg,{children:"Configure how your integration should behave and what capabilities it needs."})]}),(0,te.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"These settings determine how your integration functions and what features it can access."}),(0,te.jsx)(Vp,{className:"border-slate-200",children:(0,te.jsx)(Jp,{className:"pt-6 space-y-6",children:(0,te.jsxs)("div",{className:"flex items-center gap-4",children:[(0,te.jsx)("div",{className:"h-10 w-10 rounded-full bg-slate-100 flex items-center justify-center flex-shrink-0",children:(0,te.jsx)(mg.A,{className:"h-5 w-5 text-slate-700"})}),(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("h3",{className:"font-medium text-slate-900",children:"Backend Functions"}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"Most integrations with external APIs require backend functions"})]}),(0,te.jsx)(xg,{checked:h.requires_backend_functions,onCheckedChange:e=>_("requires_backend_functions",e)})]})})})]}),h.requires_backend_functions&&(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsxs)("div",{className:"flex items-center mb-2",children:[(0,te.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"Required API Keys"}),(0,te.jsx)(fg,{children:"API keys that users will need to configure to use this integration."})]}),(0,te.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Define the credentials needed to connect to external services and how users can obtain them."}),(0,te.jsxs)(Vp,{className:"border-slate-200 shadow-sm mb-4",children:[(0,te.jsxs)(Yp,{className:"pb-0",children:[(0,te.jsx)(Hp,{className:"text-base font-medium",children:"Add API Keys"}),(0,te.jsx)(Gp,{children:"Specify the API keys users will need to configure to use your integration"})]}),(0,te.jsx)(Jp,{className:"pt-4",children:(0,te.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)(td,{htmlFor:"newSecretName",className:"mb-1 block",children:"Secret Name"}),(0,te.jsx)(Qn,{id:"newSecretName",placeholder:"E.g., OPENAI_API_KEY",value:b,onChange:e=>y(e.target.value)}),(0,te.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"This is the environment variable name used in code"})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)(td,{htmlFor:"newSecretDescription",className:"mb-1 block",children:"Instructions for obtaining"}),(0,te.jsx)(Qn,{id:"newSecretDescription",placeholder:"E.g., Get from platform.openai.com/api-keys",value:N,onChange:e=>w(e.target.value)}),(0,te.jsx)("p",{className:"text-xs text-slate-500 mt-1",children:"Help users understand where to find this key"})]})]})}),(0,te.jsx)(Zp,{className:"border-t pt-4 bg-slate-50",children:(0,te.jsxs)(sl,{type:"button",onClick:()=>{if(b.trim()){const e={name:b.trim(),description:N.trim()};p((s=>({...s,required_secrets:[...s.required_secrets,e]}))),y(""),w("")}},className:"w-full bg-teal-600 hover:bg-teal-700",children:[(0,te.jsx)(zt.A,{className:"h-4 w-4 mr-2"})," Add API Key"]})})]}),h.required_secrets.length>0?(0,te.jsx)("div",{className:"space-y-3",children:h.required_secrets.map(((e,s)=>(0,te.jsxs)("div",{className:"bg-white rounded-lg p-4 border flex justify-between items-start",children:[(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(et.A,{className:"h-4 w-4 text-slate-600 mr-2"}),(0,te.jsx)("h4",{className:"font-medium text-slate-900",children:e.name})]}),(0,te.jsx)("p",{className:"text-sm text-slate-600 mt-1 ml-6",children:e.description||"Required for this integration"})]}),(0,te.jsx)(sl,{variant:"ghost",size:"sm",onClick:()=>(e=>{p((s=>({...s,required_secrets:s.required_secrets.filter(((s,t)=>t!==e))})))})(s),className:"text-red-500 hover:text-red-700 hover:bg-red-50",children:(0,te.jsx)(Tc.A,{className:"h-4 w-4"})})]},s)))}):(0,te.jsxs)("div",{className:"bg-slate-50 p-5 rounded-lg border text-center",children:[(0,te.jsx)(et.A,{className:"h-10 w-10 text-slate-400 mx-auto mb-2"}),(0,te.jsx)("p",{className:"text-slate-600 mb-1",children:"No API keys added yet"}),(0,te.jsx)("p",{className:"text-sm text-slate-500",children:"Add keys if your integration requires external API access"})]})]}),(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsxs)("div",{className:"flex items-center mb-2",children:[(0,te.jsx)("h2",{className:"text-xl font-semibold text-slate-900",children:"Integration Prompt"}),(0,te.jsx)(fg,{children:"The implementation guide for your integration."})]}),(0,te.jsx)("p",{className:"text-sm text-slate-600 mb-4",children:"Write detailed instructions on how to use this integration, including code examples and configuration guidance."}),(0,te.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,te.jsx)("div",{className:"lg:col-span-2",children:(0,te.jsxs)(Vp,{className:"h-full",children:[(0,te.jsxs)(Yp,{className:"pb-2",children:[(0,te.jsx)(Hp,{className:"text-base font-medium",children:"Implementation Guide"}),(0,te.jsx)(Gp,{children:"Provide detailed instructions on how to use this integration"})]}),(0,te.jsxs)(Jp,{children:[(0,te.jsx)(ug,{id:"prompt",name:"prompt",value:h.prompt,onChange:k,placeholder:"# Integration Name This integration allows you to... ## Example Code ```javascript\n// Code example\n``` ## Configuration Options - Option 1: Description\n- Option 2: Description ## Usage Tips ...",className:"font-mono min-h-[400px] bg-slate-50 border-slate-200"}),(0,te.jsxs)("div",{className:"flex justify-between items-center mt-2 text-xs",children:[(0,te.jsx)("div",{className:"text-slate-500",children:(0,te.jsx)("span",{children:"Supports Markdown formatting"})}),(0,te.jsx)("div",{children:(0,te.jsx)("span",{className:`font-medium ${h.prompt.length<50?"text-red-500":"text-green-600"} flex items-center`,children:h.prompt.length<50?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Ds.A,{className:"h-3 w-3 mr-1"}),h.prompt.length,"/50 characters (minimum)"]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(mt.A,{className:"h-3 w-3 mr-1"}),h.prompt.length," characters"]})})})]})]})]})}),(0,te.jsx)("div",{className:"lg:col-span-1",children:(0,te.jsxs)(Vp,{className:"bg-slate-50 border border-slate-200 h-full",children:[(0,te.jsxs)(Yp,{className:"pb-2",children:[(0,te.jsxs)(Hp,{className:"text-base font-medium flex items-center text-slate-700",children:[(0,te.jsx)(rl.A,{className:"h-4 w-4 mr-2 text-teal-600"}),"Tips for writing effective prompts"]}),(0,te.jsx)(Gp,{children:"Guidelines to help users implement your integration"})]}),(0,te.jsxs)(Jp,{className:"space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"font-medium text-slate-800 mb-1",children:"Structure your guide clearly"}),(0,te.jsxs)("ul",{className:"space-y-2 text-sm text-slate-600 list-disc pl-5",children:[(0,te.jsx)("li",{children:"Start with an introduction explaining what the integration does"}),(0,te.jsx)("li",{children:"Include complete code examples with explanations"}),(0,te.jsx)("li",{children:"Provide configuration and setup instructions"})]})]}),h.requires_backend_functions&&(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"font-medium text-slate-800 mb-1",children:"Backend Function Tips"}),(0,te.jsxs)("ul",{className:"space-y-2 text-sm text-slate-600 list-disc pl-5",children:[(0,te.jsxs)("li",{children:["Show how to implement with ",(0,te.jsx)("strong",{children:"Deno serve"})," (this is how backend functions run)"]}),(0,te.jsx)("li",{children:"Document the output schema for each function"}),(0,te.jsx)("li",{children:"Include examples of how to call these functions from frontend components"}),(0,te.jsx)("li",{children:"Provide error handling guidance"})]})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"font-medium text-slate-800 mb-1",children:"Recommended sections"}),(0,te.jsxs)("ul",{className:"space-y-2 text-sm text-slate-600 list-disc pl-5",children:[(0,te.jsxs)("li",{children:[(0,te.jsx)("strong",{children:"Introduction:"})," What the integration does"]}),(0,te.jsxs)("li",{children:[(0,te.jsx)("strong",{children:"API Reference:"})," Available functions and parameters"]}),(0,te.jsxs)("li",{children:[(0,te.jsx)("strong",{children:"Example Usage:"})," Practical implementation examples"]}),(0,te.jsxs)("li",{children:[(0,te.jsx)("strong",{children:"Troubleshooting:"})," Common issues and solutions"]})]})]}),(0,te.jsxs)("div",{className:"bg-blue-50 p-3 rounded-md text-sm text-blue-700 border border-blue-100",children:[(0,te.jsx)("p",{className:"font-medium mb-1",children:"Pro Tip"}),(0,te.jsx)("p",{children:"The better your documentation, the more likely users will successfully implement your integration!"})]})]})]})})]})]}),(0,te.jsxs)("div",{className:"flex justify-between pt-4 border-t",children:[(0,te.jsxs)(sl,{onClick:()=>f("metadata"),variant:"outline",children:[(0,te.jsx)(pi.A,{className:"h-4 w-4 mr-2"}),"Back to Metadata"]}),(0,te.jsx)(sl,{onClick:()=>S(),disabled:o,className:"bg-teal-600 hover:bg-teal-700",children:o?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"h-4 w-4 mr-2 animate-spin"}),"Saving..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Wd.A,{className:"h-4 w-4 mr-2"}),"Save Integration"]})})]})]})})]})})]})};var jg=t(37524);const bg=function(e){let{content:s}=e;return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("style",{dangerouslySetInnerHTML:{__html:"\n        .expandable-description h1 { font-size: 1.25rem; font-weight: 600; margin-bottom: 0.75rem; color: #0f172a; }\n        .expandable-description h2 { font-size: 1.125rem; font-weight: 600; margin-bottom: 0.5rem; color: #0f172a; }\n        .expandable-description h3 { font-size: 1rem; font-weight: 600; margin-bottom: 0.5rem; color: #0f172a; }\n        .expandable-description p { margin-bottom: 0.75rem; line-height: 1.6; color: #475569; }\n        .expandable-description ul, .expandable-description ol { margin-bottom: 0.75rem; padding-left: 1.5rem; color: #475569; }\n        .expandable-description li { margin-bottom: 0.25rem; }\n        .expandable-description strong { font-weight: 600; color: #334155; }\n        .expandable-description em { font-style: italic; }\n        .expandable-description blockquote { border-left: 3px solid #e2e8f0; padding-left: 1rem; margin: 0.75rem 0; color: #64748b; }\n        .expandable-description code { background: #f1f5f9; padding: 0.125rem 0.375rem; border-radius: 0.25rem; font-size: 0.875rem; color: #0f172a; }\n        .expandable-description pre { background: #f1f5f9; padding: 1rem; border-radius: 0.5rem; overflow-x: auto; margin-bottom: 0.75rem; }\n        .expandable-description a { color: #f97316; text-decoration: underline; }\n        .expandable-description a:hover { color: #ea580c; }\n        .expandable-description > *:last-child { margin-bottom: 0; }\n    "}}),(0,te.jsx)("div",{className:"relative",children:(0,te.jsx)("div",{className:"expandable-description text-sm",dangerouslySetInnerHTML:{__html:Oc(s)}})})]})},yg=e=>{let{className:s,children:t,...a}=e;return(0,te.jsxs)(ra.Portal,{children:[(0,te.jsx)(ra.Overlay,{className:"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0"}),(0,te.jsx)(ra.Content,{className:ns("fixed left-[50%] top-[50%] z-50 w-full translate-x-[-50%] translate-y-[-50%] bg-background shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] rounded-[16px]",s),...a,children:t})]})};const Ng=function(e){var s,t,a,r,n,l;let{isOpen:i,onClose:o,selectedItem:c,onItemUpdate:d}=e;const{user:m}=ne(),[u,x]=(0,Y.useState)(0),[h,p]=(0,Y.useState)(!1);return(0,Y.useEffect)((()=>{i&&c&&x(0)}),[i,c]),(0,te.jsx)(na,{open:i,onOpenChange:o,className:!0,children:(0,te.jsx)(yg,{className:"max-w-[80vw] md:max-w-[80vw] max-w-[95vw] h-[85vh] md:h-[85vh] h-[90vh] bg-white shadow-2xl",children:c&&(0,te.jsxs)("div",{className:"h-full flex flex-col",children:[(0,te.jsx)("div",{className:"flex-shrink-0 flex items-center justify-end rounded-t-[16px] px-3 pt-3",children:(0,te.jsx)(Rs,{variant:"ghost",size:"icon",onClick:o,className:"h-8 w-8",children:(0,te.jsx)(Ds.A,{className:"h-6 w-6"})})}),(0,te.jsx)("div",{className:"flex-1 p-[18px] md:p-[18px] p-4 overflow-y-auto md:overflow-y-auto overflow-visible",children:(0,te.jsxs)("div",{className:"flex flex-col md:flex-row md:h-full",children:[(0,te.jsxs)("div",{className:"w-full md:w-[65%] flex flex-col mb-6 md:mb-0",children:[(null===(s=c.item.screenshot_urls)||void 0===s?void 0:s.length)>0?(0,te.jsxs)("div",{className:"md:flex-1 relative rounded-[12px] overflow-hidden border border-black/10 rounded-[12px] min-h-[250px] md:min-h-0 aspect-video md:aspect-auto",children:[(0,te.jsx)("div",{className:"absolute inset-0",style:{backgroundImage:`url(${c.item.screenshot_urls[u]})`,backgroundSize:"auto",backgroundPosition:"center",backgroundRepeat:"no-repeat",width:"100%",height:"100%",filter:"blur(10px)",opacity:.5}}),(0,te.jsx)("div",{className:"absolute inset-0 flex items-center justify-center",children:(0,te.jsx)("img",{src:c.item.screenshot_urls[u],alt:`Screenshot ${u+1}`,className:"w-full h-full object-contain"})})]}):(0,te.jsx)("div",{className:"md:flex-1 rounded-[12px] flex items-center justify-center bg-slate-50 min-h-[250px] md:min-h-0 aspect-video md:aspect-auto",children:(0,te.jsx)(_t.A,{className:"w-16 h-16 text-slate-300"})}),(null===(t=c.item.screenshot_urls)||void 0===t?void 0:t.length)>1&&(0,te.jsxs)("div",{className:"flex items-center gap-4 mt-6 justify-center flex-shrink-0",children:[(0,te.jsx)("button",{onClick:()=>x((e=>e>0?e-1:c.item.screenshot_urls.length-1)),className:"p-2 rounded-full hover:bg-slate-100 transition-colors","aria-label":"Previous screenshot",children:(0,te.jsx)($t.A,{className:"w-5 h-5 text-slate-600"})}),(0,te.jsx)("div",{className:"flex gap-3",children:c.item.screenshot_urls.map(((e,s)=>(0,te.jsx)("button",{onClick:()=>x(s),className:ns("w-3 h-3 rounded-full transition-all",u===s?"bg-slate-900":"bg-slate-200 hover:bg-slate-300"),"aria-label":`Go to screenshot ${s+1}`},s)))}),(0,te.jsx)("button",{onClick:()=>x((e=>e<c.item.screenshot_urls.length-1?e+1:0)),className:"p-2 rounded-full hover:bg-slate-100 transition-colors","aria-label":"Next screenshot",children:(0,te.jsx)(pr.A,{className:"w-5 h-5 text-slate-600"})})]})]}),(0,te.jsxs)("div",{className:"w-full md:w-[35%] px-0 md:px-12 pb-6 md:overflow-y-auto",children:[(0,te.jsxs)("div",{className:"mb-4",children:[(0,te.jsx)("h1",{className:"text-[26px] font-semibold text-slate-900",children:c.item.name}),(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 mt-[18px]",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsxs)(qt,{className:"h-6 w-6",children:[(0,te.jsx)(Vt,{src:null===(a=c.item_creator)||void 0===a?void 0:a.profile_image_url}),(0,te.jsx)(Yt,{className:"text-xs bg-slate-100",children:(null===(r=c.item_creator)||void 0===r||null===(n=r.full_name)||void 0===n?void 0:n[0])||"U"})]}),(0,te.jsx)("span",{className:"text-sm text-slate-400",children:"by"}),(0,te.jsx)("span",{className:"text-sm text-slate-400 ",children:(null===(l=c.item_creator)||void 0===l?void 0:l.full_name)||"Unknown"})]}),(0,te.jsxs)("div",{className:"text-sm text-slate-400 flex items-center gap-2",children:[(0,te.jsx)("span",{className:"hidden sm:inline-block mx-2 w-1 h-1 rounded-full bg-slate-400"}),c.usage||0," Clones"]}),(c.item.is_private||c.is_user_the_owner)&&(0,te.jsx)("div",{className:"flex",children:c.item.is_private&&(0,te.jsxs)("div",{className:"flex items-center gap-2 text-sm text-slate-400",children:[(0,te.jsx)("span",{className:"hidden sm:inline-block mx-2 w-1 h-1 rounded-full text-slate-400 bg-slate-400"}),(0,te.jsx)(Ls.A,{className:"w-4 h-4"}),"Private App"]})})]})]}),(0,te.jsxs)("div",{className:"flex flex-col gap-3 mb-4 mt-[36px]",children:[(0,te.jsx)("div",{className:"flex gap-3",children:c.is_user_the_owner&&(0,te.jsxs)(Rs,{onClick:()=>{window.open(`/apps/${c.item.app_id}/editor/workspace/app-settings?tab=appListing`,"_blank"),o()},className:"h-10 flex-1 w-[128px] border border-orange-500 text-orange-500 bg-white hover:bg-orange-50 rounded-[12px]",children:["Manage Listing ",(0,te.jsx)(jg.A,{className:"w-4 h-4 ml-1"})]})}),(0,te.jsx)("div",{className:"flex gap-3",children:"platform_admin"===(null==m?void 0:m.platform_role)&&("approved"===c.item.status?(0,te.jsx)(Rs,{onClick:async()=>{p(!0);try{await Ec.declineItem(c.item.id),zn({title:"Success",description:"App listing declined successfully"}),d({...c,item:{...c.item,status:"pending"}})}catch(e){zn({title:"Error",description:"Failed to decline listing",variant:"destructive"})}finally{p(!1)}},disabled:h,className:"h-10 w-full border border-red-500 text-red-500 bg-white hover:bg-red-50 rounded-[12px]",children:h?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Declining..."]}):"Decline Listing"}):(0,te.jsx)(Rs,{onClick:async()=>{p(!0);try{await Ec.approveItem(c.item.id),zn({title:"Success",description:"App listing approved successfully"}),d({...c,item:{...c.item,status:"approved"}})}catch(e){zn({title:"Error",description:"Failed to approve listing",variant:"destructive"})}finally{p(!1)}},disabled:h,className:"h-10 w-full bg-green-500 text-white hover:bg-green-600 rounded-[12px]",children:h?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"w-4 h-4 mr-2 animate-spin"}),"Approving..."]}):"Approve Listing"}))}),(0,te.jsxs)("div",{className:"flex gap-3",children:[(0,te.jsx)(Rs,{onClick:()=>{window.open(`/remix-app/${c.item.app_id}`,"_blank")},className:"h-10 flex-1 bg-slate-900 hover:bg-slate-800 text-white rounded-[12px]",children:"Clone App"}),(0,te.jsxs)(Rs,{variant:"outline",onClick:async()=>{const e=`https://${(await pe.getLoginInfoById(c.item.app_id)).slug}.base44.app`;window.open(e,"_blank")},className:"h-10 w-[128px] rounded-[12px]",children:["View App ",(0,te.jsx)(jg.A,{className:"w-4 h-4 ml-1"})]})]}),(0,te.jsx)("div",{className:"mt-[36px]",children:(0,te.jsx)("div",{className:"flex flex-wrap gap-2",children:c.item.categories&&c.item.categories.length>0?c.item.categories.map(((e,s)=>(0,te.jsx)(qs,{variant:"outline",className:"px-3 py-1 text-[14px] font-normal bg-slate-100 border border-slate-200 text-slate-700 ",children:e},s))):(0,te.jsx)(qs,{variant:"secondary",className:"px-3 py-1 text-sm font-normal bg-slate-50 text-slate-700 border-slate-200",children:"No categories"})})})]}),(0,te.jsx)("div",{className:"space-y-8 mt-[18px]",children:(0,te.jsx)("div",{children:(0,te.jsx)(bg,{content:c.item.description||"<p>No description available</p>"})})})]})]})})]})})})};function wg(e){let{isHowToModalOpen:s,setIsHowToModalOpen:t}=e;return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("h1",{className:"text-5xl font-base44 font-medium mb-4 mt-6",children:"App Templates"}),(0,te.jsxs)(Bn,{open:s,onOpenChange:t,children:[(0,te.jsxs)("p",{className:"text-lg font-base44 max-w-2xl mb-4",children:["Explore a curated collection of applications built by our community."," ",(0,te.jsx)(Wn,{asChild:!0,children:(0,te.jsx)("button",{className:"text-orange-500 font-base44 hover:text-orange-600 text-lg font-medium hover:underline-offset-4 transition-all",children:"Learn more"})})]}),(0,te.jsxs)(Yn,{className:"max-w-2xl",children:[(0,te.jsx)(Hn,{children:(0,te.jsx)(Jn,{className:"text-xl font-semibold text-slate-900",children:"How to Share Your App with the Community"})}),(0,te.jsxs)("div",{className:"space-y-6 pt-2",children:[(0,te.jsx)("p",{className:"text-slate-600 leading-relaxed",children:"Follow these simple steps:"}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200",children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-orange-500 text-white text-sm font-medium flex items-center justify-center mt-0.5",children:"1"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("p",{className:"font-medium text-slate-900",children:"Open your app's builder"}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"Navigate to an app you created or have admin access to"})]})]}),(0,te.jsx)("div",{className:"flex items-center justify-center",children:(0,te.jsx)(hi.A,{className:"w-4 h-4 text-slate-400"})}),(0,te.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200",children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-orange-500 text-white text-sm font-medium flex items-center justify-center mt-0.5",children:"2"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("p",{className:"font-medium text-slate-900",children:"Go to catalog settings"}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:(0,te.jsx)("span",{className:"font-mono text-xs bg-white px-2 py-1 rounded border",children:"Workspace \u2192 Settings \u2192 App Templates \u2192 Manage Listing"})})]})]}),(0,te.jsx)("div",{className:"flex items-center justify-center",children:(0,te.jsx)(hi.A,{className:"w-4 h-4 text-slate-400"})}),(0,te.jsxs)("div",{className:"flex items-start gap-3 p-4 rounded-xl bg-slate-50 border border-slate-200",children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-6 h-6 rounded-full bg-orange-500 text-white text-sm font-medium flex items-center justify-center mt-0.5",children:"3"}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("p",{className:"font-medium text-slate-900",children:"Publish your listing"}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"Add a description, screenshots, and configure your listing visibility"})]})]})]}),(0,te.jsx)("div",{className:"p-4 rounded-xl bg-orange-50 border border-orange-200",children:(0,te.jsxs)("p",{className:"text-sm text-orange-800",children:[(0,te.jsx)("strong",{children:"Tip:"})," Make sure your app is deployed and has an engaging description to attract more users!"]})})]})]})]})]})}const kg=["Marketing & Sales","Operations","Data & Analytics","Content Generation","HR & Legal","Finance","Education","Community","Lifestyle & Hobbies","Games & Entertainment"],_g=[{value:"everyone",label:"Owned by everyone"},{value:"me",label:"Owned by me"},{value:"not_me",label:"Not owned by me"}],Sg=[{label:"English",value:"en"},{label:"Deutsch",value:"de"},{label:"Espa\xf1ol",value:"es"},{label:"Fran\xe7ais",value:"fr"},{label:"Italiano",value:"it"},{label:"\u65e5\u672c\u8a9e",value:"ja"},{label:"\u4e2d\u6587",value:"zh"},{label:"\u0939\u093f\u0928\u094d\u0926\u0940",value:"hi"},{label:"Portugu\xeas",value:"pt"},{label:"\u05e2\u05d1\u05e8\u05d9\u05ea",value:"he"},{label:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",value:"ar"},{label:"Bahasa Indonesia",value:"id"}];function Cg(e){let{searchTerm:s,onSearchChange:t,selectedCategory:a,onCategoryChange:r,ownership:n,onOwnershipChange:l,sortBy:i,onSortByChange:o,selectedLanguage:c,onLanguageChange:d}=e;return(0,te.jsxs)("div",{className:"mt-[42px] mb-6",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3 w-full justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center rounded-xl border border-[#E4E4E7] bg-white flex-1 max-w-[420px] h-[40px] px-3 sm:px-[11px]",children:[(0,te.jsx)(Na.A,{className:"w-4 h-4 text-[#000] flex-shrink-0"}),(0,te.jsx)(Qn,{placeholder:"Search apps...",value:s,onChange:e=>t(e.target.value),className:"border-0 bg-transparent focus-visible:ring-0 focus-visible:ring-offset-0 placeholder:text-[#B4B4B4] text-black"})]}),(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsxs)(pl,{value:n,onValueChange:l,children:[(0,te.jsx)(fl,{className:"w-auto min-w-[140px] h-[40px] font-base44 border-0 bg-transparent px-0 text-black focus-visible:ring-0 focus-visible:ring-offset-0 [&>svg]:text-black [&>svg]:ml-2",children:(0,te.jsx)(gl,{placeholder:"Ownership"})}),(0,te.jsx)(bl,{children:_g.map((e=>(0,te.jsx)(yl,{value:e.value,className:"font-base44",children:e.label},e.value)))})]}),(0,te.jsxs)(pl,{value:c,onValueChange:d,children:[(0,te.jsx)(fl,{className:"w-auto min-w-[120px] h-[40px] font-base44 border-0 bg-transparent px-0 text-black [&>svg]:text-black [&>svg]:ml-2",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Tt.A,{className:"w-4 h-4 text-black"}),(0,te.jsx)(gl,{placeholder:"Language"})]})}),(0,te.jsx)(bl,{children:Sg.map((e=>(0,te.jsx)(yl,{value:e.value,className:"font-base44",children:e.label},e.value)))})]})]})]}),(0,te.jsx)("div",{className:"w-full overflow-x-auto pb-2 mt-[18px]",children:(0,te.jsxs)("div",{className:"flex items-center space-x-2 min-w-max",children:[(0,te.jsx)(Xp,{variant:"all"===a?"default":"outline",className:ns("cursor-pointer text-sm px-3 font-base44 font-light py-1 bg-white","all"===a?"bg-slate-800 text-white hover:bg-slate-700":"hover:bg-slate-100 text-slate-800"),onClick:()=>r("all"),children:"All Apps"}),(0,te.jsx)("div",{className:"h-4 w-px bg-slate-200"}),kg.map((e=>(0,te.jsx)(Xp,{variant:a===e?"default":"outline",className:ns("cursor-pointer text-sm font-base44 font-light px-3 py-1 bg-white",a===e?"bg-slate-800 text-white hover:bg-slate-700":"hover:bg-slate-100 text-slate-800"),onClick:()=>r(e),children:e},e)))]})})]})}var Ag=t(79992);function Eg(e){var s,t,a;let{catalogItem:r,onCardClick:n,stripHtml:l}=e;const i=r.item,o=null===(s=i.screenshot_urls)||void 0===s?void 0:s[0],c=r.item_creator,d=null===(t=r.categories)||void 0===t?void 0:t[0];return(0,te.jsxs)(Vp,{className:ns("border-0 bg-white cursor-pointer shadow-none group rounded-[16px] ","overflow-hidden"),onClick:()=>n(r),children:[(0,te.jsxs)("div",{className:"relative aspect-video bg-gradient-to-br from-slate-100 to-slate-200 overflow-hidden",children:[o?(0,te.jsx)("img",{src:o,alt:i.name,className:"w-full h-full object-cover rounded-t-[16px] border border-gray-200",onError:e=>{e.currentTarget.style.display="none";const s=e.currentTarget.nextElementSibling;s&&(s.style.display="flex")}}):null,(0,te.jsx)("div",{className:ns("absolute inset-0 flex items-center justify-center",o?"hidden":"flex"),children:(0,te.jsx)(_t.A,{className:"w-12 h-12 text-slate-400"})}),(0,te.jsxs)("div",{className:"absolute inset-0 bg-black/60 opacity-0 group-hover:opacity-100 transition-opacity duration-200 flex items-center justify-center gap-3 rounded-t-[16px]",children:[(0,te.jsx)(sl,{onClick:e=>{e.stopPropagation(),window.open(`/remix-app/${i.app_id}`,"_blank")},className:"bg-orange-500 font-base44 hover:bg-orange-600 text-white font-medium px-6 py-2 rounded-[16px] transition-colors",children:"Clone App"}),(0,te.jsx)(sl,{onClick:e=>{e.stopPropagation(),null==n||n(r)},variant:"outline",className:"bg-white font-base44 hover:bg-gray-50 text-black border-gray-200 font-medium px-6 py-2 rounded-[16px] transition-colors",children:"View Details"})]}),(0,te.jsx)("div",{className:"absolute top-3 right-3",children:d&&(0,te.jsx)(Xp,{className:"bg-orange-500/90 backdrop-blur-sm border-orange-600 text-white font-medium",children:d})})]}),(0,te.jsxs)(Jp,{className:"p-4 space-y-3",children:[(0,te.jsxs)("div",{children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("h3",{className:"font-semibold font-base44 text-xl text-black line-clamp-1 hover:text-black transition-colors",children:i.name}),i.is_private&&(0,te.jsxs)("div",{className:"group/tooltip relative inline-flex bg-white border border-gray-200 p-1 rounded-[6px] w-[24px] h-[24px] items-center justify-center",children:[(0,te.jsx)(Ag.A,{}),(0,te.jsx)("div",{className:"pointer-events-none absolute -top-8 left-1/2 -translate-x-1/2 px-2 py-1 bg-slate-800 text-white text-xs rounded opacity-0 group-hover/tooltip:opacity-100 transition-opacity whitespace-nowrap",children:"This app is private and only visible to you"})]})]}),(0,te.jsx)("p",{className:"text-sm font-base44 text-gray-600 line-clamp-2 mt-1 leading-relaxed",children:l(i.description)||"No description available"})]}),(0,te.jsx)("div",{className:"flex items-center justify-between mt-1",children:(0,te.jsxs)("div",{className:"flex items-center gap-2 min-w-0 flex-1",children:[(0,te.jsxs)(bx,{className:"h-6 w-6 flex-shrink-0 border border-gray-200",children:[(0,te.jsx)(yx,{src:null==c?void 0:c.profile_image_url,alt:(null==c?void 0:c.full_name)||"User"}),(0,te.jsx)(Nx,{className:"text-xs bg-slate-100 text-slate-600",children:(null==c||null===(a=c.full_name)||void 0===a?void 0:a[0])||"U"})]}),(0,te.jsxs)("div",{className:"min-w-0 flex-1 flex items-center gap-2",children:[(0,te.jsx)("p",{className:"text-sm text-slate-600 truncate",children:(null==c?void 0:c.full_name)||"Unknown User"}),(0,te.jsx)("div",{className:"w-1 h-1 rounded-full bg-slate-300"}),(0,te.jsxs)("p",{className:"text-sm text-slate-600",children:[r.usage," Clones"]})]})]})})]})]})}function Ig(){return(0,te.jsxs)("div",{className:"group relative bg-white rounded-2xl border border-slate-200 shadow-sm hover:shadow-md transition-shadow overflow-hidden",children:[(0,te.jsx)("div",{className:"aspect-[16/9] bg-slate-100 animate-pulse"}),(0,te.jsxs)("div",{className:"p-5 space-y-4",children:[(0,te.jsx)("div",{className:"h-6 bg-slate-100 rounded-md animate-pulse w-3/4"}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("div",{className:"h-4 bg-slate-100 rounded-md animate-pulse"}),(0,te.jsx)("div",{className:"h-4 bg-slate-100 rounded-md animate-pulse w-4/5"})]}),(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsx)("div",{className:"h-6 w-16 bg-slate-100 rounded-full animate-pulse"}),(0,te.jsx)("div",{className:"h-6 w-20 bg-slate-100 rounded-full animate-pulse"})]}),(0,te.jsx)("div",{className:"flex items-center justify-between pt-2",children:(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)("div",{className:"w-8 h-8 bg-slate-100 rounded-full animate-pulse"}),(0,te.jsx)("div",{className:"h-4 w-24 bg-slate-100 rounded-md animate-pulse"})]})})]})]})}function Lg(){return(0,te.jsxs)("div",{className:"space-y-8",children:[(0,te.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-6",children:Array.from({length:8}).map(((e,s)=>(0,te.jsx)(Ig,{},s)))}),(0,te.jsx)("div",{className:"flex items-center justify-center mt-8",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-8 h-8 bg-slate-100 rounded-md animate-pulse"}),(0,te.jsx)("div",{className:"w-8 h-8 bg-slate-100 rounded-md animate-pulse"}),(0,te.jsx)("div",{className:"w-8 h-8 bg-slate-100 rounded-md animate-pulse"})]})})]})}function Tg(){return(0,te.jsxs)("div",{className:"text-center py-24",children:[(0,te.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 rounded-2xl bg-slate-100 mb-4",children:(0,te.jsx)(Ca.A,{className:"w-8 h-8 text-slate-400"})}),(0,te.jsx)("p",{className:"text-lg text-slate-600",children:"No apps found"}),(0,te.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:"Try adjusting your search or filters"})]})}function $g(e){let{isLoading:s,isLoadingMore:t=!1,items:a,onCardClick:r,stripHtml:n,hasMore:l=!1,targetRef:i}=e;return(0,te.jsx)("div",{className:"",children:s?(0,te.jsx)(Lg,{}):0===a.length?(0,te.jsx)(Tg,{}):(0,te.jsxs)("div",{className:"space-y-8",children:[(0,te.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 xl:grid-cols-4 gap-8",children:a.map((e=>(0,te.jsx)(Eg,{catalogItem:e,onCardClick:r,stripHtml:n},e.item.id)))}),(0,te.jsxs)("div",{ref:i,className:"w-full py-4",children:[t&&(0,te.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-600"}),(0,te.jsx)("span",{className:"ml-2 text-slate-600",children:"Loading more items..."})]}),!l&&a.length>0&&(0,te.jsx)("div",{className:"text-center py-8 text-slate-500",children:"No more apps to load"})]})]})})}function Dg(e){if(!e)return"";const s=document.createElement("div");return s.innerHTML=e,s.textContent||s.innerText||""}const Pg=function(){const{user:e}=ne(),[s,t]=(0,Y.useState)([]),[a,r]=(0,Y.useState)(!0),[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)("all"),[c,d]=(0,Y.useState)("everyone"),[m,u]=(0,Y.useState)("popular"),[x,h]=(0,Y.useState)("en"),[p,g]=(0,Y.useState)(new Set),[f,v]=(0,Y.useState)(!1),[j,b]=(0,Y.useState)(!0),[y,N]=(0,Y.useState)(!1),[w,k]=(0,Y.useState)(0),[_]=(0,Y.useState)(20),[S,C]=(0,Y.useState)(0),[A,E]=(0,Y.useState)(null),[I,L]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{const e=new URLSearchParams(window.location.search).get("category");if(e){const s=kg.find((s=>s.toLowerCase()===e.toLowerCase()));s?o(s):"my-apps"===e.toLowerCase()&&o("my-apps")}}),[]),(0,Y.useEffect)((()=>{const e=e=>{I&&("ArrowLeft"===e.key?M():"ArrowRight"===e.key&&O())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[I,A]),(0,Y.useEffect)((()=>{t([]),C(0),b(!0),T(!0)}),[n,i,c,m,x]);const T=(0,Y.useCallback)((async function(){let s=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{s?r(!0):N(!0);const a=s?0:S;let l={skip:a,limit:_,sort_by:$(m),categories:"all"!==i&&"my-apps"!==i?[i]:void 0};"me"===c||"my-apps"===i?l.created_by=e.email:"not_me"===c&&(l.created_by={$ne:e.email}),n&&"en"===x?l.$and=[{$or:[{name:{$regex:n,$options:"i"}},{description:{$regex:n,$options:"i"}},{categories:{$regex:n,$options:"i"}},{tags:{$regex:n,$options:"i"}},{created_by:{$regex:n,$options:"i"}}]},{$or:[{language:"en"},{language:{$exists:!1}},{language:null}]}]:n?(l.$or=[{name:{$regex:n,$options:"i"}},{description:{$regex:n,$options:"i"}},{categories:{$regex:n,$options:"i"}},{tags:{$regex:n,$options:"i"}},{created_by:{$regex:n,$options:"i"}}],x&&"en"!==x&&(l.language=x)):x&&("en"===x?l.$or=[{language:"en"},{language:{$exists:!1}},{language:null}]:l.language=x),Object.keys(l).forEach((e=>{void 0===l[e]&&delete l[e]}));const o=await Ec.listCatalogItems(l),d=o.items||o,u=o.total||d.length;s?(t(d),k(u)):t((e=>[...e,...d])),C(a+d.length),b(0!==d.length);const h=new Set(d.filter((e=>e.did_current_user_upvote)).map((e=>e.item.id)));g(s?h:e=>new Set([...e,...h]))}catch(a){zn({title:"Error",description:"Failed to load catalog items",variant:"destructive"})}finally{r(!1),N(!1)}}),[S,_,i,n,c,m,x,e.email]),$=e=>{switch(e){case"newest":return"created_at_desc";case"oldest":return"created_at_asc";default:return"usage"}},D=(0,Y.useCallback)((()=>{!j||y||a||T(!1)}),[j,y,a,T]),{targetRef:P}=Op({onLoadMore:D,hasMore:j,isLoading:y||a}),M=()=>{const e=s.findIndex((e=>e.item.id===A.item.id));e>0&&E(s[e-1])},O=()=>{const e=s.findIndex((e=>e.item.id===A.item.id));e<s.length-1&&E(s[e+1])},R=s.length,F=w>0?`Showing ${R} of ${w} items`:"";return(0,te.jsxs)("div",{className:"px-12 max-w-[1600px] mx-auto",children:[(0,te.jsx)(wg,{}),(0,te.jsx)(Cg,{searchTerm:n,onSearchChange:e=>{l(e)},selectedCategory:i,onCategoryChange:e=>{o(e)},showAllCategories:f,setShowAllCategories:v,totalItems:w,displayedItems:R,showingText:F,isLoading:a,ownership:c,onOwnershipChange:e=>{d(e)},sortBy:m,onSortByChange:e=>{u(e)},selectedLanguage:x,onLanguageChange:e=>{h(e)}}),(0,te.jsx)($g,{isLoading:a,isLoadingMore:y,items:s,upvotedItems:p,onCardClick:e=>{E(e),L(!0)},onUpvote:async(e,s)=>{e.stopPropagation();try{await Ec.upvoteItem(s),g((e=>new Set([...e,s]))),t((e=>e.map((e=>e.item.id===s?{...e,upvotes:e.upvotes+1,did_current_user_upvote:!0}:e)))),A&&A.item.id===s&&E((e=>({...e,upvotes:e.upvotes+1,did_current_user_upvote:!0}))),zn({title:"Success",description:"Upvoted successfully"})}catch(a){zn({title:"Error",description:"Failed to upvote",variant:"destructive"})}},stripHtml:Dg,hasMore:j,targetRef:P}),(0,te.jsx)(Ng,{isOpen:I,onClose:()=>{L(!1),E(null)},selectedItem:A,filteredItems:s,onPrevious:M,onNext:O,upvotedItems:p,onUpvote:e=>{g((s=>new Set([...s,e]))),t((s=>s.map((s=>s.item.id===e?{...s,upvotes:s.upvotes+1,did_current_user_upvote:!0}:s))))},onItemUpdate:e=>{E(e)}})]})};function Mg(){const{user:e}=ne(),{appId:s}=(0,Z.g)(),t=(0,Z.Zp)(),[a,r]=(0,Y.useState)(!0),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null),[m,u]=(0,Y.useState)({}),[x,h]=(0,Y.useState)(!1),p=new URLSearchParams(window.location.search).get("clone_history"),g=(0,Y.useCallback)((()=>{l(!0),o(null),pe.remixApp(s,{with_chat_history:"true"===p,secret_values:m}).then((e=>{t(`/apps/${e.id}/editor/preview`)})).catch((e=>{o(e.message||"An error occurred while cloning the app"),l(!1)}))}),[s,m,t]);(0,Y.useEffect)((()=>{r(!0),pe.remixAppRequirements(s).then((s=>{d(s);s&&(!s.app_secret_names||0===s.app_secret_names.length)&&!(s.requires_backend_functions&&("free"===e.subscription_tier||"starter"===e.subscription_tier))?g():s&&s.app_secret_names&&s.app_secret_names.length>0&&(!s.requires_backend_functions||"free"!==e.subscription_tier&&"starter"!==e.subscription_tier)&&h(!0),r(!1)})).catch((e=>{o(e.message||"An error occurred while fetching cloning requirements"),r(!1)}))}),[s,e.subscription_tier]);return a?(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,te.jsx)("div",{className:"flex flex-col items-center space-y-4",children:(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin"})})}):n?(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,te.jsx)("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-black rounded-full animate-spin"}),(0,te.jsxs)("p",{className:"text-gray-600",children:["Cloning ",(null==c?void 0:c.name)||"app","..."]})]})}):i?(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white rounded-lg shadow-xl max-w-md mx-auto",children:[(0,te.jsx)(Ke.A,{className:"h-12 w-12 text-red-500"}),(0,te.jsx)("div",{className:"text-red-600 text-lg font-medium",children:"Error"}),(0,te.jsx)("p",{className:"text-gray-600 text-center",children:i}),(0,te.jsx)(Rs,{onClick:()=>t(-1),variant:"outline",children:"Go Back"})]})}):c&&c.requires_backend_functions&&("free"===e.subscription_tier||"starter"===e.subscription_tier)?(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"flex flex-col items-center space-y-4 p-8 bg-white rounded-lg shadow-xl max-w-md mx-auto",children:[(0,te.jsx)(Ke.A,{className:"h-12 w-12 text-red-500"}),(0,te.jsx)("div",{className:"text-red-600 text-lg font-medium",children:"Clone Not Allowed"}),(0,te.jsx)("p",{className:"text-gray-600 text-center",children:"This app requires backend functions. You need to be on the Builder tier or above to remix it."}),(0,te.jsx)(Rs,{onClick:()=>t(-1),variant:"outline",children:"Go Back"})]})}):(0,te.jsx)("div",{className:"container mx-auto p-4 pt-10 max-w-2xl",children:x?(0,te.jsxs)("div",{className:"mb-6 p-6 border rounded-lg bg-slate-50",children:[(0,te.jsxs)("h1",{className:"text-2xl font-semibold mb-6",children:["Clone ",(null==c?void 0:c.name)||"App"]}),(0,te.jsx)("h2",{className:"text-lg font-medium mb-4 text-slate-700",children:"Configure Secrets"}),(0,te.jsx)(wt,{secretNames:c.app_secret_names.map((e=>({name:e}))),value:m,onChange:e=>{u(e)}}),(0,te.jsx)(Rs,{onClick:g,disabled:n,className:"w-full mt-4",children:n?`Cloning ${(null==c?void 0:c.name)||"App"}...`:`Clone ${(null==c?void 0:c.name)||"App"}`})]}):(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"flex flex-col items-center space-y-4",children:[(0,te.jsx)("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-black rounded-full animate-spin"}),(0,te.jsx)("p",{className:"text-gray-600",children:"Preparing..."})]})})})}var Og=t(35219),Rg=t(97104);const Fg=e=>{let{className:s}=e;return(0,te.jsx)("svg",{className:s,viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,te.jsx)("path",{d:"M18.8943 4.34399C17.5183 3.71467 16.057 3.256 14.5317 3C14.3396 3.33067 14.1263 3.77866 13.977 4.13067C12.3546 3.89599 10.7439 3.89599 9.14391 4.13067C8.99457 3.77866 8.77056 3.33067 8.58922 3C7.05325 3.256 5.59191 3.71467 4.22552 4.34399C1.46286 8.41865 0.716188 12.3973 1.08952 16.3226C2.92418 17.6559 4.69486 18.4666 6.4346 19C6.86126 18.424 7.24527 17.8053 7.57594 17.1546C6.9466 16.92 6.34927 16.632 5.77327 16.2906C5.9226 16.184 6.07194 16.0667 6.21061 15.9493C9.68793 17.5387 13.4543 17.5387 16.889 15.9493C17.0383 16.0667 17.177 16.184 17.3263 16.2906C16.7503 16.632 16.153 16.92 15.5236 17.1546C15.8543 17.8053 16.2383 18.424 16.665 19C18.4036 18.4666 20.185 17.6559 22.01 16.3226C22.4687 11.7787 21.2836 7.83202 18.8943 4.34399ZM8.05593 13.9013C7.01058 13.9013 6.15725 12.952 6.15725 11.7893C6.15725 10.6267 6.98925 9.67731 8.05593 9.67731C9.11191 9.67731 9.97588 10.6267 9.95454 11.7893C9.95454 12.952 9.11191 13.9013 8.05593 13.9013ZM15.065 13.9013C14.0196 13.9013 13.1652 12.952 13.1652 11.7893C13.1652 10.6267 13.9983 9.67731 15.065 9.67731C16.121 9.67731 16.985 10.6267 16.9636 11.7893C16.9636 12.952 16.1317 13.9013 15.065 13.9013Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})})},zg=e=>{let{icon:s,title:t,description:a,action:r,variant:n="default",external:l=!1}=e;return(0,te.jsxs)("div",{className:"group cursor-pointer relative overflow-hidden rounded-2xl transition-all duration-500 hover:scale-[1.02] hover:-translate-y-1",onClick:r,children:[(0,te.jsx)("div",{className:"absolute inset-0 transition-all duration-500 "+("primary"===n?"bg-gradient-to-br from-orange-500 to-orange-600 group-hover:from-orange-600 group-hover:to-orange-700":"secondary"===n?"bg-gradient-to-br from-teal-500 to-teal-600 group-hover:from-teal-600 group-hover:to-teal-700":"bg-gradient-to-br from-slate-700 to-slate-800 group-hover:from-slate-800 group-hover:to-slate-900")}),(0,te.jsxs)("div",{className:"relative z-10 p-8 text-white",children:[(0,te.jsxs)("div",{className:"flex items-start justify-between mb-6",children:[(0,te.jsx)("div",{className:"w-14 h-14 bg-white/20 backdrop-blur-sm rounded-xl flex items-center justify-center group-hover:scale-110 transition-transform duration-300",children:(0,te.jsx)(s,{className:"w-7 h-7"})}),l&&(0,te.jsx)(ur.A,{className:"w-5 h-5 opacity-60 group-hover:opacity-100 transition-opacity"})]}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("h3",{className:"text-xl font-bold leading-tight",children:t}),(0,te.jsx)("p",{className:"text-white/80 text-sm leading-relaxed",children:a})]}),(0,te.jsxs)("div",{className:"mt-6 inline-flex items-center text-sm font-semibold group-hover:translate-x-1 transition-transform duration-300",children:[(0,te.jsx)("span",{children:"Get Started"}),(0,te.jsx)(Ht.A,{className:"w-4 h-4 ml-2"})]})]})]})},Ug=e=>{let{icon:s,title:t,description:a,action:r,count:n}=e;return(0,te.jsx)("div",{className:"group cursor-pointer p-6 bg-white rounded-xl border border-slate-200 hover:border-slate-300 hover:shadow-lg transition-all duration-300",onClick:r,children:(0,te.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,te.jsx)("div",{className:"w-12 h-12 bg-slate-100 text-slate-600 rounded-lg flex items-center justify-center group-hover:bg-orange-100 group-hover:text-orange-600 transition-colors",children:(0,te.jsx)(s,{className:"w-6 h-6"})}),(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,te.jsx)("h4",{className:"font-semibold text-slate-900",children:t}),void 0!==n&&(0,te.jsx)("span",{className:"text-sm font-medium text-slate-500",children:n})]}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:a})]}),(0,te.jsx)(Ht.A,{className:"w-5 h-5 text-slate-400 group-hover:text-slate-600 group-hover:translate-x-1 transition-all"})]})})};function Bg(e){let{appId:s}=e;const[t]=(0,J.useSearchParams)(),a=(0,Z.Zp)(),[r,n]=(0,Y.useState)(s);(0,Y.useEffect)((()=>{const e=t.get("appId");n(e||s)}),[t,s]);return(0,te.jsx)(te.Fragment,{children:(0,te.jsxs)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:[(0,te.jsx)("div",{className:"text-center mb-16",children:(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)("h1",{className:"text-5xl font-bold text-slate-900 tracking-tight",children:"Help & Support"}),(0,te.jsx)("div",{className:"w-24 h-1 bg-gradient-to-r from-orange-500 to-teal-500 mx-auto rounded-full"}),(0,te.jsx)("p",{className:"text-xl text-slate-600 max-w-2xl mx-auto leading-relaxed",children:"Get the help you need to build amazing applications with BASE44"})]})}),r&&(0,te.jsx)("div",{className:"mb-12 p-6 bg-slate-50 border border-slate-200 rounded-xl",children:(0,te.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,te.jsx)("div",{className:"w-10 h-10 bg-slate-100 text-slate-600 rounded-lg flex items-center justify-center",children:(0,te.jsx)(Og.A,{className:"w-5 h-5"})}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"font-semibold text-slate-900",children:"App-Specific Support"}),(0,te.jsxs)("p",{className:"text-sm text-slate-600",children:["Support requests will be associated with app: ",(0,te.jsx)("span",{className:"font-mono bg-slate-100 px-2 py-1 rounded text-slate-800",children:r})]})]})]})}),(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-8 mb-16",children:[(0,te.jsx)(zg,{icon:fx.A,title:"Documentation",description:"Explore comprehensive guides, tutorials, FAQs,and best practices for building with Base44.",action:()=>{window.open("https://docs.base44.com","_blank")},variant:"primary",external:!0}),(0,te.jsx)(zg,{icon:Fg,title:"Discord Community",description:"Connect with fellow builders and get instant help from our active community.",action:()=>{window.open("https://discord.com/invite/ThpYPZpVts","_blank")},variant:"secondary",external:!0}),(0,te.jsx)(zg,{icon:Rg.A,title:"Open Support Ticket",description:"Submit a detailed support ticket and get personalized assistance.",action:()=>{const e=new URLSearchParams({openNew:"true"});r&&e.set("appId",r),a(`/support/conversations?${e.toString()}`)},variant:"default"})]}),(0,te.jsxs)("div",{className:"bg-slate-50 rounded-2xl p-8",children:[(0,te.jsxs)("div",{className:"mb-6",children:[(0,te.jsx)("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Quick Actions"}),(0,te.jsx)("p",{className:"text-slate-600",children:"Manage your support experience"})]}),(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,te.jsx)(Ug,{icon:mr.A,title:"My Support Tickets",description:"View and manage your existing support tickets",action:()=>{const e=new URLSearchParams;r&&e.set("appId",r),a("/support/conversations"+(e.toString()?`?${e.toString()}`:""))}}),(0,te.jsx)(Ug,{icon:Wa.A,title:"Community Forum",description:"Our brand-new reddit community",action:()=>{window.open("https://www.reddit.com/r/Base44","_blank")}})]})]})]})})}var Wg=t(82981),qg=t(83655);class Vg extends K.y{getBaseURL(){return"/support/conversations"}async addMessage(e,s){return await this.axios.post(`/${e}/messages`,s)}async updateConversationNotifications(e,s){return await this.axios.put(`/${e}/notifications`,s)}async closeTicket(e){return await this.axios.patch(`/${e}/close`)}}const Yg=new Vg;class Hg extends K.H{getBaseURL(){return"/support/admin"}async getTickets(e){const s=Object.fromEntries(Object.entries(e||{}).filter((e=>{let[s,t]=e;return null!==t})));return await this.axios.get("",{params:s})}async getTicketDetail(e){return await this.axios.get(`/${e}`)}async updateTicketStatus(e,s){return await this.axios.patch(`/${e}/status`,{status:s})}async polishResponse(e,s){return await this.axios.post(`/${e}/messages/polish`,{text:s})}async changeTicketStatus(e,s){return await this.axios.patch(`/${e}/change_ticket_status`,{status:s})}async assignTicket(e,s){return await this.axios.patch(`/${e}/assign`,{user_email:s})}async updateInternalCategories(e,s){return await this.axios.patch(`/${e}/internal_categories`,{internal_categories:s})}async updateInternalNotes(e,s){return await this.axios.patch(`/${e}/internal_notes`,{internal_notes:s})}async updateTicketCategory(e,s){return await this.axios.patch(`/${e}/category`,{category:s})}async resolveMany(e){return await this.axios.patch("/resolve-many",{ticket_ids:e})}async deleteMessage(e,s){return await this.axios.delete(`/${e}/messages`,{data:{message_id:s}})}}const Gg=new Hg;class Jg extends K.H{getBaseURL(){return"/docs"}async getArticles(){return await this.axios.get("/articles")}async createArticle(e){return await this.axios.post("/articles",e)}async updateArticle(e,s){return await this.axios.put(`/articles/${e}`,s)}async deleteArticle(e){return await this.axios.delete(`/articles/${e}`)}async getAgentProperties(){return await this.axios.get("/agent")}async updateAgentProperties(e){return await this.axios.put("/agent",e)}}const Zg=new Jg;class Kg extends K.H{getBaseURL(){return"/support/analytics"}async exportTicketsCSV(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={start_date:e,end_date:s};t&&(a.category=t);const r=await this.axios.get("/export-csv",{params:a,responseType:"blob"}),n=window.URL.createObjectURL(new Blob([r])),l=document.createElement("a");return l.href=n,l.setAttribute("download",`support_tickets_${e.split("T")[0]}_${s.split("T")[0]}.csv`),document.body.appendChild(l),l.click(),l.remove(),window.URL.revokeObjectURL(n),r}async runTrendAnalysis(e,s){let t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;const a={start_date:e,end_date:s};return t&&(a.category=t),await this.axios.post("/trend-analysis",a)}async getOperationalMetrics(e,s){const t={start_date:e,end_date:s};return await this.axios.get("/operational-metrics",{params:t})}}const Xg=new Kg;class Qg extends K.H{getBaseURL(){return"/support/bot"}async requestAnswer(e,s,t){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:[];return await this.axios.post("/request",{title:e,content:s,category:t,file_urls:a})}async logAnswer(e,s,t){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;return await this.axios.post("/log_answer",{support_ticket_id:e,answer:s,is_useful:t,ticket_body:a})}}const ef=new Qg;var sf=t(59027),tf=t(62702);const af=e=>{let{imageUrl:s,isOpen:t,onClose:a}=e;return t?(0,te.jsxs)("div",{className:"fixed inset-0 z-50 flex items-center justify-center",children:[(0,te.jsx)("div",{className:"absolute inset-0 bg-black/80 backdrop-blur-sm",onClick:a}),(0,te.jsxs)("div",{className:"relative z-10 max-w-7xl max-h-[90vh] mx-4",children:[(0,te.jsx)("button",{onClick:a,className:"absolute -top-12 right-0 w-10 h-10 bg-white/10 hover:bg-white/20 backdrop-blur-sm rounded-full flex items-center justify-center text-white transition-all duration-200 hover:scale-110",children:(0,te.jsx)(Ds.A,{size:20})}),(0,te.jsx)("img",{src:s,alt:"Full size image",className:"max-w-full max-h-[90vh] object-contain rounded-lg shadow-2xl"})]})]}):null},rf=e=>{var s,t,a;let{message:r,onImageClick:n,isAdmin:l=!1,conversationId:i,onMessageDeleted:o}=e;const c="user"===r.role,d=null===(s=r.additional_message_params)||void 0===s?void 0:s.is_admin_message,m=null===(t=r.metadata)||void 0===t?void 0:t.created_by_full_name,[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1);return(0,te.jsx)("div",{className:`flex ${c?"justify-end":"justify-start"} mb-4`,onMouseEnter:()=>p(!0),onMouseLeave:()=>p(!1),children:(0,te.jsxs)("div",{className:`flex max-w-[80%] ${c?"flex-row-reverse":"flex-row"} items-start space-x-3 relative`,children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center "+(c?"bg-slate-200 text-slate-600 ml-3":d?"bg-slate-700 text-white mr-3":"bg-teal-100 text-teal-600 mr-3"),children:c?(0,te.jsx)(Mm.A,{size:16}):d?(0,te.jsx)(Om.A,{size:16}):(0,te.jsx)(eo.A,{size:16})}),(0,te.jsxs)("div",{className:"flex flex-col "+(c?"items-end":"items-start"),children:[d&&m&&(0,te.jsxs)("div",{className:"mb-2 flex items-center space-x-2",children:[(0,te.jsx)("div",{className:"text-xs font-medium text-slate-700",children:m.split(" ")[0]}),(0,te.jsx)("div",{className:"w-1 h-1 bg-slate-300 rounded-full"}),(0,te.jsx)("div",{className:"text-xs text-slate-500",children:"Support Team"})]}),(0,te.jsxs)("div",{className:"rounded-2xl px-4 py-3 max-w-full "+(c?"bg-slate-700 text-white":"bg-white text-slate-900 border border-slate-200 shadow-sm"),children:[r.file_urls&&r.file_urls.length>0&&(0,te.jsx)("div",{className:"mb-3 flex flex-wrap gap-3",children:r.file_urls.map(((e,s)=>(0,te.jsx)("div",{className:"relative",children:e.match(/\.(jpg|jpeg|png|gif|webp)$/i)?(0,te.jsxs)("div",{className:"relative group cursor-pointer",onClick:()=>n(e),children:[(0,te.jsx)("img",{src:e,alt:"Attached content",className:"max-w-[250px] max-h-[250px] rounded-lg border border-slate-200 shadow-sm object-cover transition-all duration-200 group-hover:shadow-lg group-hover:scale-[1.02]"}),(0,te.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/20 rounded-lg transition-all duration-200 flex items-center justify-center",children:(0,te.jsx)("div",{className:"bg-white/90 backdrop-blur-sm rounded-full p-2 opacity-0 group-hover:opacity-100 transition-all duration-200 transform scale-75 group-hover:scale-100",children:(0,te.jsx)(tf.A,{size:16,className:"text-slate-700"})})})]}):(0,te.jsxs)("div",{className:"flex items-center gap-2 p-2 rounded-lg border "+(c?"bg-slate-600 border-slate-500 text-slate-200":"bg-slate-50 border-slate-200 text-slate-700"),children:[(0,te.jsxs)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"16",height:"16",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round",className:"flex-shrink-0",children:[(0,te.jsx)("path",{d:"M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"}),(0,te.jsx)("polyline",{points:"14 2 14 8 20 8"})]}),(0,te.jsx)("a",{href:e,target:"_blank",rel:"noopener noreferrer",className:"text-sm hover:underline "+(c?"text-slate-200":"text-blue-600"),children:"Attached file"})]})},s)))}),(0,te.jsx)("div",{className:"text-sm leading-relaxed prose prose-sm max-w-[550px]",children:(0,te.jsx)(Za.o,{components:{p:e=>{let{children:s}=e;return(0,te.jsx)("p",{className:"mb-2 last:mb-0",children:s})},ul:e=>{let{children:s}=e;return(0,te.jsx)("ul",{className:"list-disc list-inside mb-2 last:mb-0",children:s})},ol:e=>{let{children:s}=e;return(0,te.jsx)("ol",{className:"list-decimal list-inside mb-2 last:mb-0",children:s})},li:e=>{let{children:s}=e;return(0,te.jsx)("li",{className:"mb-1",children:s})},code:e=>{let{children:s,inline:t}=e;return t?(0,te.jsx)("code",{className:"px-1 py-0.5 rounded text-xs font-mono "+(c?"bg-slate-600 text-slate-200":"bg-slate-100 text-slate-800"),children:s}):(0,te.jsx)("pre",{className:"p-2 rounded text-xs font-mono overflow-x-auto "+(c?"bg-slate-600 text-slate-200":"bg-slate-100 text-slate-800"),children:(0,te.jsx)("code",{children:s})})},blockquote:e=>{let{children:s}=e;return(0,te.jsx)("blockquote",{className:"border-l-4 pl-3 italic "+(c?"border-slate-400":"border-slate-300"),children:s})},strong:e=>{let{children:s}=e;return(0,te.jsx)("strong",{className:"font-semibold",children:s})},em:e=>{let{children:s}=e;return(0,te.jsx)("em",{className:"italic",children:s})},h1:e=>{let{children:s}=e;return(0,te.jsx)("h1",{className:"text-lg font-bold mb-2",children:s})},h2:e=>{let{children:s}=e;return(0,te.jsx)("h2",{className:"text-base font-bold mb-2",children:s})},h3:e=>{let{children:s}=e;return(0,te.jsx)("h3",{className:"text-sm font-bold mb-1",children:s})}},children:r.content})})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2 mt-1 "+(c?"justify-end":"justify-start"),children:[(null===(a=r.metadata)||void 0===a?void 0:a.created_date)&&(0,te.jsx)("div",{className:"text-xs text-slate-500",children:(g=r.metadata.created_date,Bt().utc(g).fromNow())}),l&&!c&&"assistant"===r.role&&h&&(0,te.jsx)("button",{onClick:async()=>{if(!r.id||!i)return;if(window.confirm("Are you sure you want to delete this message?"))try{x(!0),await Gg.deleteMessage(i,r.id),o&&o()}catch(e){alert("Failed to delete message. Please try again.")}finally{x(!1)}},disabled:u,className:"ml-2 p-1 rounded-full transition-all duration-200 "+(u?"bg-red-100 text-red-400 cursor-not-allowed":"hover:bg-red-100 text-slate-400 hover:text-red-600"),title:"Delete message",children:u?(0,te.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-red-400"}):(0,te.jsx)(Tc.A,{size:14})})]})]})]})});var g},nf=()=>(0,te.jsx)("div",{className:"flex justify-start mb-4",children:(0,te.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center bg-teal-100 text-teal-600 mr-3",children:(0,te.jsx)(eo.A,{size:16})}),(0,te.jsx)("div",{className:"bg-white text-slate-900 border border-slate-200 shadow-sm rounded-2xl px-4 py-3",children:(0,te.jsxs)("div",{className:"flex space-x-1",children:[(0,te.jsx)("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce"}),(0,te.jsx)("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0.1s"}}),(0,te.jsx)("div",{className:"w-2 h-2 bg-slate-400 rounded-full animate-bounce",style:{animationDelay:"0.2s"}})]})})]})});function lf(e){let{messages:s,isTyping:t,isAdmin:a=!1,conversationId:r,onMessageDeleted:n}=e;const l=(0,Y.useRef)(null),[i,o]=(0,Y.useState)(null);(0,Y.useEffect)((()=>{var e;null===(e=l.current)||void 0===e||e.scrollIntoView({behavior:"smooth"})}),[s,t]);const c=e=>{o(e)};return(0,te.jsxs)("div",{className:"h-full overflow-y-auto px-4 py-4",children:[0===s.length?(0,te.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"w-16 h-16 bg-slate-100 text-slate-400 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,te.jsx)(eo.A,{size:24})}),(0,te.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Start the conversation"}),(0,te.jsx)("p",{className:"text-slate-600",children:"Send a message to begin your support conversation"})]})}):(0,te.jsxs)("div",{className:"space-y-4",children:[s.map(((e,s)=>(0,te.jsx)(rf,{message:e,onImageClick:c,isAdmin:a,conversationId:r,onMessageDeleted:n},e.id||s))),t&&(0,te.jsx)(nf,{}),(0,te.jsx)("div",{ref:l})]}),i&&(0,te.jsx)(af,{imageUrl:i,isOpen:!!i,onClose:()=>o(null)})]})}const of="support_templates",cf=()=>{try{const e=localStorage.getItem(of);return e?JSON.parse(e):[]}catch(e){return[]}},df=e=>{let{onTemplateSelect:s,className:t=""}=e;const[a,r]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!0);if((0,Y.useEffect)((()=>{r(cf());const e=e=>{e.key===of&&r(cf())};window.addEventListener("storage",e);const s=()=>{r(cf())};return window.addEventListener("templatesUpdated",s),()=>{window.removeEventListener("storage",e),window.removeEventListener("templatesUpdated",s)}}),[]),0===a.length||!i)return null;const c=["bg-blue-100 text-blue-800 border-blue-200 hover:bg-blue-200","bg-green-100 text-green-800 border-green-200 hover:bg-green-200","bg-purple-100 text-purple-800 border-purple-200 hover:bg-purple-200","bg-orange-100 text-orange-800 border-orange-200 hover:bg-orange-200","bg-teal-100 text-teal-800 border-teal-200 hover:bg-teal-200","bg-pink-100 text-pink-800 border-pink-200 hover:bg-pink-200","bg-indigo-100 text-indigo-800 border-indigo-200 hover:bg-indigo-200","bg-yellow-100 text-yellow-800 border-yellow-200 hover:bg-yellow-200","bg-red-100 text-red-800 border-red-200 hover:bg-red-200","bg-cyan-100 text-cyan-800 border-cyan-200 hover:bg-cyan-200"],d=a.length>10,m=n?a:a.slice(0,10);return(0,te.jsxs)("div",{className:`space-y-2 ${t}`,children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-1",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(It.A,{className:"w-3 h-3 text-slate-500"}),(0,te.jsx)("span",{className:"text-xs font-medium text-slate-700",children:"Quick Templates"}),(0,te.jsxs)("span",{className:"text-xs text-slate-500",children:["(",a.length,")"]})]}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>o(!1),className:"h-5 w-5 p-0 text-slate-400 hover:text-slate-600",children:(0,te.jsx)(Ds.A,{className:"w-3 h-3"})})]}),(0,te.jsxs)("div",{className:"flex flex-wrap gap-2",children:[m.map(((e,t)=>{const a=c[t%c.length];return(0,te.jsx)("button",{onClick:()=>s(e.content),className:`\n                                px-2 py-1 rounded-md border text-xs font-medium \n                                transition-all duration-200 hover:shadow-sm\n                                max-w-32 truncate\n                                ${a}\n                            `,title:`${e.name}\n\nPreview: ${e.content.substring(0,100)}...`,children:e.name},e.id)})),d&&(0,te.jsxs)("button",{onClick:()=>l(!n),className:"px-2 py-1 rounded-md border border-slate-300 bg-slate-50 text-slate-600 hover:bg-slate-100 text-xs font-medium transition-all duration-200 flex items-center space-x-1",children:[(0,te.jsx)(Ea.A,{className:"w-3 h-3"}),(0,te.jsx)("span",{children:n?"Less":"+"+(a.length-10)}),n?(0,te.jsx)(dt.A,{className:"w-3 h-3"}):(0,te.jsx)(ct.A,{className:"w-3 h-3"})]})]})]})};function mf(e){var s;let{conversationId:t,isAdmin:a=!1,onMessageSent:r}=e;const{user:n}=ne(),[l,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)(null),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(""),[v,j]=(0,Y.useState)(!1),[b,y]=(0,Y.useState)(""),[N,w]=(0,Y.useState)([]),[k,_]=(0,Y.useState)(!1),[S,C]=(0,Y.useState)(!1),[A,E]=(0,Y.useState)(!1),[I,L]=(0,Y.useState)(!1),T=a?null:500,$=t?`support-draft-${t}`:"support-draft-temp";(0,Y.useEffect)((()=>{if(t&&D(),a){const e=localStorage.getItem($);y(e||"")}}),[t,$,a]),(0,Y.useEffect)((()=>{a&&b&&localStorage.setItem($,b)}),[b,a,$]),(0,Y.useEffect)((()=>{a&&null!=l&&l.draft&&!h&&(p(!0),f(l.draft),j(!1))}),[null==l?void 0:l.draft,a]),(0,Y.useEffect)((()=>{void 0!==(null==l?void 0:l.notify_via_email_on_admin_response)&&C(l.notify_via_email_on_admin_response)}),[null==l?void 0:l.notify_via_email_on_admin_response]),(0,Y.useEffect)((()=>{if(!a)return;const e=e=>{(navigator.platform.toUpperCase().indexOf("MAC")>=0?e.metaKey&&"k"===e.key:e.ctrlKey&&"k"===e.key)&&(e.preventDefault(),b.trim()&&!k&&P())};return document.addEventListener("keydown",e),()=>document.removeEventListener("keydown",e)}),[a,b,k]);const D=async()=>{try{c(!0),m(null);return await Yg.fetchAndSubscribe(t,(e=>{i(e),c(!1)}))}catch(e){m("Failed to load conversation. Please try again."),c(!1)}},P=async()=>{if(b.trim())try{_(!0);const e=await Gg.polishResponse(t,b);y(e)}catch(d){}finally{_(!1)}};if(o)return(0,te.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-400 mx-auto mb-4"}),(0,te.jsx)("p",{className:"text-slate-600",children:"Loading conversation..."})]})});if(d)return(0,te.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"w-16 h-16 bg-red-100 text-red-500 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,te.jsx)(mr.A,{className:"w-8 h-8"})}),(0,te.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Error Loading Conversation"}),(0,te.jsx)("p",{className:"text-slate-600 mb-4",children:d}),(0,te.jsx)(Rs,{onClick:D,variant:"outline",size:"sm",children:"Try Again"})]})});if(!l)return(0,te.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"w-16 h-16 bg-slate-100 text-slate-400 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,te.jsx)(mr.A,{className:"w-8 h-8"})}),(0,te.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No Conversation Found"}),(0,te.jsx)("p",{className:"text-slate-600",children:"This conversation doesn't exist or you don't have access to it."})]})});const M="premium"==(((null==n?void 0:n.subscription_tier)||"free").toLowerCase().includes("elite")?"premium":"standard")?{tier:"Premium Support",message:"Priority support with faster response times",color:"text-slate-700 bg-slate-100 border-slate-200"}:{tier:"Standard Support",message:"Responses on standard support could take up to 48 hours, typically less",color:"text-slate-600 bg-slate-50 border-slate-200"},O="pending_admin_response"===(null==l?void 0:l.status),R=a?(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:P,disabled:!b.trim()||k,className:"text-slate-600 hover:text-slate-900 hover:bg-slate-100",title:"Improve Grammar",children:k?(0,te.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-slate-400"}):(0,te.jsx)(Ct.A,{className:"w-4 h-4"})}):null;return(0,te.jsxs)("div",{className:"flex flex-col h-full max-h-full overflow-hidden",children:[!a&&l&&(0,te.jsx)("div",{className:"flex-shrink-0 border-b border-slate-200 px-4 py-3 bg-slate-50",children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,te.jsx)("div",{className:"w-6 h-6 bg-orange-100 text-orange-600 rounded-full flex items-center justify-center text-sm",children:"\u{1f4b3}"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-sm font-medium text-slate-900 line-clamp-1",children:l.title||"Support Ticket"}),(0,te.jsx)("p",{className:"text-xs text-slate-500 capitalize",children:(null===(s=l.category)||void 0===s?void 0:s.replace(/_/g," "))||"General"})]})]}),"closed"!==l.status&&"resolved"!==l.ticket_status&&(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:async()=>{if(window.confirm("Are you sure you want to close this ticket? This will mark it as resolved."))try{L(!0),await Yg.closeTicket(t);const e=window.location.pathname;e.includes("/support")&&!e.includes("/support/conversations/")?window.location.reload():(await D(),r&&r({conversationId:t,action:"ticket_closed",role:a?"admin":"user",conversation:l}))}catch(d){alert("Failed to close ticket. Please try again.")}finally{L(!1)}},disabled:I,className:"text-teal-600 hover:text-teal-700 hover:bg-teal-50 border-teal-300 h-7 px-3 text-xs",children:I?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-teal-600 mr-1"}),"Closing..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Qa.A,{className:"w-3 h-3 mr-1"}),"Close Ticket"]})})]})}),(0,te.jsx)("div",{className:"flex-1 min-h-0 overflow-hidden",children:(0,te.jsx)(lf,{messages:l.messages||[],isTyping:l.is_bot_writing,isAdmin:a,conversationId:t,onMessageDeleted:async()=>{await D()}})}),(0,te.jsx)("div",{className:"flex-shrink-0",children:a&&h&&g?(0,te.jsx)("div",{className:"px-4 py-2 border-t border-slate-200 bg-teal-50",children:(0,te.jsx)(Vs,{className:"border-teal-200 bg-white",children:(0,te.jsxs)(Js,{className:"p-3",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(lg.A,{className:"w-4 h-4 text-teal-600"}),(0,te.jsx)("span",{className:"text-sm font-medium text-teal-800",children:"AI Suggested Response"})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>{j(!v)},className:"h-6 px-2 text-xs text-teal-700 hover:bg-teal-100",children:v?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(dt.A,{className:"w-3 h-3 mr-1"}),"Collapse"]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(ct.A,{className:"w-3 h-3 mr-1"}),"View All"]})}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>{p(!1),f(""),j(!1)},className:"h-6 w-6 p-0 text-slate-400 hover:text-slate-600",children:(0,te.jsx)(Ds.A,{className:"w-3 h-3"})})]})]}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"text-sm text-slate-700 bg-slate-50 p-3 rounded border transition-all duration-200 relative "+(v?"max-h-none":"max-h-20 overflow-hidden"),children:[(0,te.jsx)("pre",{className:"whitespace-pre-wrap font-sans text-xs leading-relaxed",children:g}),!v&&g.length>150&&(0,te.jsx)("div",{className:"absolute bottom-0 left-0 right-0 h-8 bg-gradient-to-t from-slate-50 to-transparent pointer-events-none"})]}),(0,te.jsx)("div",{className:"flex items-center",children:(0,te.jsxs)(Rs,{size:"sm",onClick:async()=>{y(g),p(!1),f(""),j(!1)},className:"bg-teal-600 hover:bg-teal-700 h-7 px-3 text-xs",children:[(0,te.jsx)(sf.A,{className:"w-3 h-3 mr-1"}),"Use"]})})]})]})})}):!a&&(0,te.jsx)("div",{className:"px-4 py-3 border-t border-slate-200 bg-slate-50",children:(0,te.jsxs)("div",{className:`p-3 rounded-lg border ${M.color}`,children:[(0,te.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,te.jsx)("div",{className:"w-2 h-2 rounded-full bg-current"}),(0,te.jsx)("span",{className:"text-sm font-medium",children:M.tier})]}),(0,te.jsx)("p",{className:"text-xs opacity-80",children:M.message}),O&&(0,te.jsx)("div",{className:"flex items-start space-x-2 mt-2 pt-2 border-t border-current/20",children:(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(zi,{id:"email-notifications",checked:S,onCheckedChange:async e=>{try{E(!0),await Yg.updateConversationNotifications(t,{notify_via_email_on_admin_response:e}),C(e)}catch(d){C(!e)}finally{E(!1)}},disabled:A,className:"h-3 w-3 data-[state=checked]:bg-slate-600 data-[state=checked]:border-slate-600 border-slate-400 rounded-sm"}),(0,te.jsxs)("label",{htmlFor:"email-notifications",className:"text-xs opacity-80 cursor-pointer flex items-center space-x-1",children:[(0,te.jsx)(tc.A,{className:"w-3 h-3 flex-shrink-0"}),(0,te.jsx)("span",{children:"Notify me when a Base44 representative responds"})]})]})})]})})}),(0,te.jsxs)("div",{className:"flex-shrink-0 p-2",children:[a&&(0,te.jsx)("div",{className:"mb-2",children:(0,te.jsx)(df,{onTemplateSelect:e=>{const s=T?e.substring(0,T):e;y(s),setTimeout((()=>{const e=document.querySelector('textarea[placeholder*="Type your"]');e&&(e.focus(),e.setSelectionRange(e.value.length,e.value.length))}),100)},className:"px-2"})}),"closed"===l.status?(0,te.jsx)("div",{className:"flex items-center justify-center py-4 text-slate-500 bg-slate-50 rounded-lg border",children:(0,te.jsx)("span",{className:"text-sm",children:"This conversation is closed"})}):"resolved"!==l.ticket_status||a?(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(Ps,{value:b,files:N,onSend:async e=>{let s,{text:n,files:l}=e;x(!0);try{s={id:`temp-${Date.now()}`,role:a?"assistant":"user",content:n,file_urls:l||[],created_date:(new Date).toISOString(),is_admin_message:a,is_temp:!0},i((e=>({...e,messages:[...(null==e?void 0:e.messages)||[],s]})));const e=await Yg.addMessage(t,{role:a?"assistant":"user",content:n,file_urls:l||[],additional_message_params:a?{is_admin_message:!0}:{}});a&&localStorage.removeItem($),r&&r({conversationId:t,action:"message_sent",role:a?"admin":"user",conversation:e})}catch(d){var o,c,m,u;if(s&&i((e=>({...e,messages:((null==e?void 0:e.messages)||[]).filter((e=>e.id!==s.id))}))),400===(null===(o=d.response)||void 0===o?void 0:o.status)&&null!==(c=d.response)&&void 0!==c&&null!==(m=c.data)&&void 0!==m&&null!==(u=m.detail)&&void 0!==u&&u.includes("already resolved"))return alert("This ticket has been resolved. Please create a new ticket for additional support."),void await D();throw d}finally{x(!1)}},placeholder:a?"Type your response...":"Type your message...",disabled:u||"resolved"===l.ticket_status&&!a,isProcessing:u,onValueChange:e=>{const s=T?e.substring(0,T):e;y(s)},onFilesChange:w,variant:"default",customButtomRight:R,isAdminMode:a}),T&&(0,te.jsxs)("div",{className:"flex justify-between items-center px-3 py-1 text-xs text-slate-500",children:[(0,te.jsx)("span",{}),(0,te.jsxs)("span",{className:""+(b.length>.9*T?"text-orange-600 font-medium":b.length===T?"text-red-600 font-medium":""),children:[b.length,"/",T]})]})]}):(0,te.jsxs)("div",{className:"flex flex-col items-center justify-center py-6 text-slate-500 bg-slate-50 rounded-lg border space-y-3",children:[(0,te.jsx)(Qa.A,{className:"w-8 h-8 text-teal-500"}),(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-700 mb-1",children:"This ticket has been resolved"}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"Please create a new ticket for additional support"})]})]})]})]})}const uf={authentication:"\u{1f510}",billing:"\u{1f4b3}",bug_report:"\u{1f41b}",integrations_and_backend_functions:"\u26a1",chat_issues:"\u{1f4ac}",security:"\u{1f6e1}\ufe0f",other:"\u2753"};function xf(e){let{conversationId:s,isOpen:t,onClose:a,ticketTitle:r,ticket:n,onTicketUpdated:l}=e;const{user:i}=ne();return t?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"fixed inset-0 bg-black/20 backdrop-blur-sm z-40 transition-opacity duration-300",onClick:a}),(0,te.jsxs)("div",{className:"fixed right-0 top-0 h-screen w-full max-w-2xl bg-white shadow-2xl z-50 transform transition-transform duration-300 ease-out flex flex-col "+(t?"translate-x-0":"translate-x-full"),children:[(0,te.jsxs)("div",{className:"flex-shrink-0 p-4 border-b border-slate-200 bg-white",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-3 flex-1 min-w-0",children:[(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:a,className:"p-1.5 hover:bg-slate-100",children:(0,te.jsx)(pi.A,{className:"w-4 h-4"})}),(0,te.jsx)("div",{className:"flex-1 min-w-0",children:(0,te.jsx)("h2",{className:"text-base font-semibold text-slate-900 leading-tight truncate",children:r||"Support Conversation"})})]}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:a,className:"p-1.5 hover:bg-slate-100",children:(0,te.jsx)(Ds.A,{className:"w-4 h-4"})})]}),(0,te.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-600",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,te.jsxs)("span",{className:"font-mono bg-slate-100 px-2 py-1 rounded text-xs",children:["#",null==s?void 0:s.slice(0,8)]}),(null==n?void 0:n.created_date)&&(0,te.jsxs)("span",{className:"flex items-center space-x-1",children:[(0,te.jsx)(At.A,{className:"w-3 h-3"}),(0,te.jsx)("span",{children:Bt().utc(n.created_date).fromNow()})]})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(null==n?void 0:n.category)&&(0,te.jsxs)("span",{className:"flex items-center space-x-1 text-xs",children:[(0,te.jsx)("span",{children:uf[n.category]||"\u{1f4cb}"}),(0,te.jsx)("span",{className:"hidden sm:inline",children:n.category.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase()))})]}),(null==n?void 0:n.app_id)&&(0,te.jsxs)("a",{href:`/apps/${n.app_id}`,className:"flex items-center space-x-1 text-blue-600 hover:text-blue-800 hover:underline",children:[(0,te.jsx)(qg.A,{className:"w-3 h-3"}),(0,te.jsx)("span",{className:"hidden sm:inline",children:"App"}),(0,te.jsx)(ur.A,{className:"w-3 h-3"})]})]})]})]}),(0,te.jsx)(mf,{conversationId:s,isAdmin:!1,onMessageSent:e=>{l&&null!=e&&e.conversation&&l(s,"message_sent","user",e.conversation)}})]})]}):null}const hf=[{value:"authentication",label:"Authentication",icon:Ls.A},{value:"billing",label:"Billing",icon:Ze.A},{value:"bug_report",label:"Bug Report",icon:Wg.A},{value:"integrations_and_backend_functions",label:"Integrations & Backend",icon:Gd.A},{value:"chat_issues",label:"Chat Issues",icon:fu.A},{value:"security",label:"Security",icon:Om.A},{value:"social_post_bonus_credits",label:"Social Post Bonus Credits",icon:gx.A},{value:"other",label:"Other",icon:cm.A}],pf=["billing","security","social_post_bonus_credits","other"],gf=(e,s)=>!s&&(e&&!pf.includes(e));function ff(e){let{value:s,onChange:t}=e;return(0,te.jsxs)(ut,{value:s,onValueChange:t,children:[(0,te.jsx)(pt,{className:"w-full",children:(0,te.jsx)(ht,{placeholder:"Select a category"})}),(0,te.jsx)(vt,{children:hf.map((e=>{const s=e.icon;return(0,te.jsx)(bt,{value:e.value,children:(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(s,{className:"w-4 h-4"}),(0,te.jsx)("span",{children:e.label})]})},e.value)}))})]})}function vf(e){var s,t,a;let{appId:r,onSubmit:n,onCancel:l}=e;const{user:i}=ne(),[o,c]=(0,Y.useState)(""),[d,m]=(0,Y.useState)(""),[u,x]=(0,Y.useState)([]),[h,p]=(0,Y.useState)(""),[g,f]=(0,Y.useState)(""),[v,j]=(0,Y.useState)(!1),[b,y]=(0,Y.useState)({}),[N,w]=(0,Y.useState)(null),[k,_]=(0,Y.useState)(!1),S=async()=>{j(!0);try{const e={title:o.trim(),content:d.trim(),category:h,app_id:r||null,app_link:g.trim()||null,file_urls:u||[]},s=await Yg.create(e);c(""),m(""),x([]),p(""),f(""),y({}),w(null),null==n||n(s)}catch(e){e.response&&e.response.data?y({submit:e.response.data.message}):y({submit:"Failed to submit your support ticket. Please try again."})}finally{j(!1)}},C=async e=>{if(null==e||e.preventDefault(),(()=>{const e={};return(!o.trim()||o.length<5)&&(e.title="Title must be at least 5 characters"),o.length>100&&(e.title="Title must be less than 100 characters"),(!d.trim()||d.length<20)&&(e.content="Please provide more details (at least 20 characters)"),d.length>500&&(e.content="Description must be less than 500 characters"),h||(e.category="Please select a category"),gf(h,r)&&!g.trim()&&(e.appLink="App link is required for technical issues. Please provide a link to your app."),g.trim()&&!g.match(/^https?:\/\/.+/)&&(e.appLink="Please enter a valid URL (starting with http:// or https://)"),y(e),0===Object.keys(e).length})()){_(!0),w(null),y({});try{const e=await ef.requestAnswer(o.trim(),d.trim(),h,u||[]);e.answer_exists?w(e):await S()}catch(s){await S()}finally{_(!1)}}},A=async()=>{if(N)try{const s=N;w(null),j(!0);const t={title:o.trim(),content:d.trim(),category:h,app_id:r||null,app_link:g.trim()||null,file_urls:u||[]},a=await Yg.create(t);try{const e=`category: ${h}\ntitle: ${o.trim()}\n\ncontent: ${d.trim()}`;await ef.logAnswer(a.id,s,!1,e)}catch(e){}c(""),m(""),x([]),p(""),f(""),y({}),null==n||n(a)}catch(s){s.response&&s.response.data?y({submit:s.response.data.message}):y({submit:"Failed to submit your support ticket. Please try again."})}finally{j(!1)}else await S()},E=async()=>{if(N)try{const e=`category: ${h}\ntitle: ${o.trim()}\n\ncontent: ${d.trim()}`;await ef.logAnswer(null,N,!0,e)}catch(e){}c(""),m(""),x([]),p(""),f(""),y({}),w(null),null==l||l()};return N&&N.answer_exists?(0,te.jsxs)("div",{className:"w-full p-6",children:[(0,te.jsx)("div",{className:"mb-4",children:(0,te.jsxs)("button",{onClick:()=>w(null),className:"inline-flex items-center text-xs text-slate-500 hover:text-slate-700 transition-colors",children:[(0,te.jsx)($t.A,{className:"w-3 h-3 mr-1"}),"Back"]})}),(0,te.jsxs)("div",{className:"mb-6",children:[(0,te.jsx)("h2",{className:"text-base font-medium text-slate-900 mb-1",children:"This might help"}),(0,te.jsx)("p",{className:"text-sm text-slate-500",children:"Here's what we found in our documentation"})]}),(0,te.jsx)("div",{className:"border-t border-b border-slate-200 py-6 mb-6",children:(0,te.jsx)("div",{children:(0,te.jsx)("div",{className:"prose prose-slate prose-sm max-w-none",children:(0,te.jsx)(Za.o,{remarkPlugins:[Ja.A],components:{a:e=>{let{node:s,...t}=e;return(0,te.jsx)("a",{...t,className:"text-slate-700 underline decoration-slate-300 hover:text-slate-900 hover:decoration-slate-500 transition-colors",target:"_blank",rel:"noopener noreferrer"})},code:e=>{let{node:s,inline:t,...a}=e;return t?(0,te.jsx)("code",{className:"bg-slate-100 px-1 py-0.5 rounded text-xs font-mono text-slate-700",...a}):(0,te.jsx)("code",{className:"block bg-white border border-slate-200 p-3 rounded text-xs font-mono overflow-x-auto text-slate-700",...a})},blockquote:e=>{let{node:s,...t}=e;return(0,te.jsx)("blockquote",{className:"border-l-2 border-slate-300 pl-4 text-slate-600",...t})},h1:e=>{let{node:s,...t}=e;return(0,te.jsx)("h1",{className:"text-lg font-semibold text-slate-900 mt-6 mb-3",...t})},h2:e=>{let{node:s,...t}=e;return(0,te.jsx)("h2",{className:"text-base font-medium text-slate-900 mt-5 mb-2",...t})},h3:e=>{let{node:s,...t}=e;return(0,te.jsx)("h3",{className:"text-sm font-medium text-slate-900 mt-4 mb-2",...t})},ul:e=>{let{node:s,...t}=e;return(0,te.jsx)("ul",{className:"list-disc pl-5 space-y-1 text-sm mb-4",...t})},ol:e=>{let{node:s,...t}=e;return(0,te.jsx)("ol",{className:"list-decimal pl-5 space-y-1 text-sm mb-4",...t})},li:e=>{let{node:s,...t}=e;return(0,te.jsx)("li",{className:"text-slate-600",...t})},p:e=>{var s;let{node:t,...a}=e;const r=(null===(s=a.children)||void 0===s?void 0:s.toString())||"",n=r.startsWith("Important")||r.startsWith("Source:");return(0,te.jsx)("p",{className:"text-slate-600 leading-relaxed text-sm "+(n?"mt-5 mb-3":"mb-3"),...a})}},children:N.answer})})})}),(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,te.jsxs)(Rs,{onClick:E,className:"flex-1 bg-slate-900 hover:bg-slate-800 text-white",children:[(0,te.jsx)(Qa.A,{className:"w-4 h-4 mr-2"}),"This helps"]}),(0,te.jsx)(Rs,{variant:"outline",onClick:A,disabled:v,className:"flex-1 border-slate-300 text-slate-700 hover:bg-slate-50",children:v?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-slate-600 border-t-transparent rounded-full animate-spin mr-2"}),"Submitting ticket..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(fu.A,{className:"w-4 h-4 mr-2"}),"Still need help"]})})]}),(0,te.jsx)("p",{className:"text-xs text-slate-400 mt-4 text-center",children:"Not the answer you're looking for? Submit a ticket for human support."})]}):(0,te.jsx)(te.Fragment,{children:(0,te.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8 p-6",children:[(0,te.jsx)("div",{className:"lg:col-span-2 space-y-6",children:(0,te.jsxs)("form",{onSubmit:C,className:"space-y-6",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{className:"text-sm font-medium text-gray-700",children:"Category"}),(0,te.jsx)(ff,{value:h,onChange:p}),b.category&&(0,te.jsx)("p",{className:"text-sm text-red-600",children:b.category}),h&&!r&&gf(h,r)&&(0,te.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-md p-2",children:(0,te.jsxs)("p",{className:"text-xs text-orange-700 flex items-start",children:[(0,te.jsx)(Ke.A,{className:"w-3 h-3 mr-1 mt-0.5 flex-shrink-0"}),(0,te.jsxs)("span",{children:["For ",h.replace(/_/g," ")," issues, you'll need to provide a link to your app."]})]})})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"title",className:"text-sm font-medium text-gray-700",children:"Subject"}),(0,te.jsx)(Qs,{id:"title",value:o,onChange:e=>c(e.target.value),placeholder:"Brief description of your issue",className:"w-full "+(b.title?"border-red-500":"")}),b.title&&(0,te.jsx)("p",{className:"text-sm text-red-600",children:b.title})]}),!r&&(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)(at,{htmlFor:"appLink",className:"text-sm font-medium text-gray-700",children:["App Link ",gf(h,r)?(0,te.jsx)("span",{className:"text-red-500",children:"*"}):(0,te.jsx)("span",{className:"text-gray-400",children:"(optional)"})]}),(0,te.jsx)(Qs,{id:"appLink",value:g,onChange:e=>f(e.target.value),placeholder:"https://your-app-url.com or https://yourapp.base44.app",className:"w-full "+(b.appLink?"border-red-500":"")}),(0,te.jsxs)("div",{className:"space-y-1",children:[gf(h,r)?(0,te.jsxs)("div",{className:"flex items-start space-x-1",children:[(0,te.jsx)(Ke.A,{className:"w-3 h-3 text-orange-500 mt-0.5 flex-shrink-0"}),(0,te.jsxs)("p",{className:"text-xs text-orange-600",children:["App link is required for ",null==h?void 0:h.replace(/_/g," ")," issues. This helps us investigate and resolve your issue faster."]})]}):(0,te.jsx)("p",{className:"text-xs text-gray-500",children:"Provide a link to your app to help us better understand the context of your issue."}),h&&pf.includes(h)&&(0,te.jsxs)("p",{className:"text-xs text-gray-400 italic",children:["App link is optional for ",h.replace(/_/g," ")," issues."]})]}),b.appLink&&(0,te.jsx)("p",{className:"text-sm text-red-600",children:b.appLink})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{className:"text-sm font-medium text-gray-700",children:"Steps to Reproduce / Description"}),(0,te.jsx)("div",{className:""+(b.content?"border border-red-500 rounded-lg":""),children:(0,te.jsx)(Ps,{value:d,files:u,placeholder:"Please provide detailed information about your issue, including any error messages, steps to reproduce, or relevant context...",disabled:v,isProcessing:!1,onValueChange:m,onFilesChange:x,variant:"default",customButtomRight:()=>null})}),(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsx)("p",{className:"text-xs text-gray-500",children:"Please provide: what happened, what you expected, steps to recreate the issue, relevant links, and screenshots. The more specific details you include, the faster we can resolve your issue."}),(0,te.jsxs)("p",{className:"text-xs "+(d.length>500?"text-red-500":d.length>450?"text-orange-500":"text-gray-400"),children:[d.length,"/500"]})]}),b.content&&(0,te.jsx)("p",{className:"text-sm text-red-600",children:b.content})]}),b.submit&&(0,te.jsx)(is,{variant:"destructive",children:(0,te.jsx)(cs,{children:b.submit})})]})}),(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsxs)("div",{className:"bg-gray-50 rounded-lg p-4 space-y-3",children:[(0,te.jsx)("h3",{className:"text-sm font-semibold text-gray-900",children:"Ticket Information"}),r&&(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("p",{className:"text-xs text-gray-500",children:"App ID"}),(0,te.jsx)("p",{className:"text-sm font-mono text-gray-900 bg-white px-2 py-1 rounded border",children:r})]}),!r&&g&&(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("p",{className:"text-xs text-gray-500",children:"App Link"}),(0,te.jsx)("p",{className:"text-sm text-gray-900 bg-white px-2 py-1 rounded border break-all",children:g})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("p",{className:"text-xs text-gray-500",children:"Support Tier"}),(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+(null!=i&&null!==(s=i.subscription_tier)&&void 0!==s&&s.toLowerCase().includes("elite")?"bg-purple-100 text-purple-800":null!=i&&null!==(t=i.subscription_tier)&&void 0!==t&&t.toLowerCase().includes("pro")?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"),children:(null==i?void 0:i.subscription_tier)||"free"}),(null==i||null===(a=i.subscription_tier)||void 0===a?void 0:a.toLowerCase().includes("elite"))&&(0,te.jsx)("span",{className:"text-xs text-purple-600",children:"Priority Support"})]})]})]}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)(Rs,{onClick:C,disabled:v||k,className:"w-full bg-blue-600 hover:bg-blue-700 text-white",children:k?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Checking for solutions..."]}):v?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Submitting..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(wc.A,{className:"w-4 h-4 mr-2"}),"Submit Ticket"]})}),(0,te.jsxs)(Rs,{variant:"outline",onClick:l,className:"w-full",children:[(0,te.jsx)(Ds.A,{className:"w-4 h-4 mr-2"}),"Cancel"]})]}),(0,te.jsx)("div",{className:"text-xs text-gray-500 space-y-2",children:(0,te.jsxs)("p",{children:[(0,te.jsx)("strong",{children:"Need immediate help?"})," Check our"," ",(0,te.jsx)("a",{href:"https://docs.base44.com",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"documentation"})," ","or join our"," ",(0,te.jsx)("a",{href:"https://discord.gg/ThpYPZpVts",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline",children:"Discord community"}),"."]})})]})]})})}const jf={authentication:Ls.A,billing:Ze.A,bug_report:Wg.A,integrations_and_backend_functions:Gd.A,chat_issues:fu.A,security:Om.A,other:cm.A},bf={open:{label:"Open",color:"bg-orange-100 text-orange-800 border-orange-200",icon:St.A},resolved:{label:"Resolved",color:"bg-green-100 text-green-800 border-green-200",icon:Ed.A}},yf=e=>{var s,t,a,r,n;let{ticket:l,onClick:i,isSelected:o}=e;const c=(null===(s=bf[l.ticket_status])||void 0===s?void 0:s.icon)||Ke.A,d=jf[l.category]||cm.A;return(0,te.jsxs)(Vs,{className:"group hover:shadow-lg transition-all duration-300 cursor-pointer "+(o?"border-orange-500 bg-orange-50 shadow-lg":"border-slate-200 hover:border-slate-300"),onClick:()=>i(l),children:[(0,te.jsx)(Ys,{className:"pb-3",children:(0,te.jsxs)("div",{className:"flex items-start justify-between",children:[(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsx)(Hs,{className:"text-lg font-semibold truncate transition-colors "+(o?"text-orange-900":"text-slate-900 group-hover:text-slate-700"),children:l.title}),(0,te.jsxs)("div",{className:"flex items-center space-x-3 mt-2",children:[(0,te.jsxs)(qs,{variant:"secondary",className:`${null===(t=bf[l.ticket_status])||void 0===t?void 0:t.color} border text-xs font-medium`,children:[(0,te.jsx)(c,{className:"w-3 h-3 mr-1"}),null===(a=bf[l.ticket_status])||void 0===a?void 0:a.label]}),l.category&&(0,te.jsxs)(qs,{variant:"outline",className:"text-xs",children:[(0,te.jsx)(d,{className:"w-3 h-3 mr-1"}),l.category.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase()))]})]})]}),(0,te.jsxs)("div",{className:"ml-4 flex items-center",children:[(0,te.jsx)(At.A,{className:"w-3 h-3 mr-2 text-slate-400"}),(e=>{if(!e)return"Not available";const s=Bt().utc(e);return(0,te.jsxs)("div",{className:"text-right text-xs text-slate-500",children:[(0,te.jsx)("div",{className:"font-medium",children:s.format("MMM DD, YYYY")}),(0,te.jsx)("div",{className:"text-slate-400 mt-0.5",children:s.fromNow()})]})})(l.created_date)]})]})}),(0,te.jsxs)(Js,{className:"pt-0",children:[(0,te.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed line-clamp-2 mb-3",children:l.content}),(0,te.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[(0,te.jsx)("div",{className:"flex items-center space-x-4",children:l.app_id&&(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(qg.A,{className:"w-3 h-3 mr-1"}),(0,te.jsxs)("span",{children:["App: ",l.app_id]})]})}),(0,te.jsx)(qs,{variant:"outline",className:"text-xs "+(null!==(r=l.user_subscription_tier)&&void 0!==r&&r.toLowerCase().includes("elite")?"border-purple-200 text-purple-700":null!==(n=l.user_subscription_tier)&&void 0!==n&&n.toLowerCase().includes("pro")?"border-blue-200 text-blue-700":"border-gray-200 text-gray-700"),children:l.user_subscription_tier||"free"})]})]})]})},Nf=e=>{let{filter:s,onCreateTicket:t}=e;return(0,te.jsxs)("div",{className:"text-center py-16",children:[(0,te.jsx)("div",{className:"mx-auto w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mb-6",children:(0,te.jsx)(Og.A,{className:"w-12 h-12 text-slate-400"})}),(0,te.jsxs)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:["No ","open"===s?"Open":"closed"===s?"Closed":""," Tickets"]}),(0,te.jsx)("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:"open"===s?"You don't have any open support tickets at the moment.":"closed"===s?"No closed tickets found.":"You haven't submitted any support tickets yet."}),(0,te.jsxs)(Rs,{className:"bg-orange-500 hover:bg-orange-600",onClick:t,children:[(0,te.jsx)(ys.A,{className:"w-4 h-4 mr-2"}),"Create New Ticket"]})]})};function wf(){const[e,s]=(0,J.useSearchParams)(),t=(0,Z.Zp)(),{toast:a}=Un(),r=e.get("appId"),n="true"===e.get("openNew"),[l,i]=(0,Y.useState)([]),[o,c]=(0,Y.useState)(!0),[d,m]=(0,Y.useState)(null),[u,x]=(0,Y.useState)("open"),[h,p]=(0,Y.useState)(null),[g,f]=(0,Y.useState)(!1),[v,j]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{b()}),[r]),(0,Y.useEffect)((()=>{if(n){j(!0);const t=new URLSearchParams(e);t.delete("openNew"),s(t,{replace:!0})}}),[n,e,s]);const b=async()=>{try{c(!0),m(null);const e=await Yg.list("-updated_date",1e3);e&&1e3===e.length&&a({title:"Ticket Limit Reached",description:"There are more tickets than can be loaded. Only the top 1000 most recent tickets were loaded.",variant:"default"});let s=e||[];r&&(s=s.filter((e=>e.app_id===r))),i(s)}catch(e){m("Failed to load support tickets. Please try again.")}finally{c(!1)}},y=e=>{p(e),f(!0)},N=()=>{j(!0)},w=(()=>{switch(u){case"open":return l.filter((e=>"open"===e.ticket_status));case"closed":return l.filter((e=>"resolved"===e.ticket_status));default:return l}})(),k=l.filter((e=>"open"===e.ticket_status)).length,_=l.filter((e=>"resolved"===e.ticket_status)).length;return o?(0,te.jsx)("div",{className:"w-full max-w-6xl mx-auto px-6 py-12",children:(0,te.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,te.jsx)("div",{className:"h-8 bg-slate-200 rounded w-1/3"}),(0,te.jsx)("div",{className:"space-y-4",children:[1,2,3].map((e=>(0,te.jsx)("div",{className:"h-32 bg-slate-200 rounded-lg"},e)))})]})}):d?(0,te.jsx)("div",{className:"w-full max-w-6xl mx-auto px-6 py-12",children:(0,te.jsxs)("div",{className:"text-center py-16",children:[(0,te.jsx)("div",{className:"mx-auto w-24 h-24 bg-red-100 rounded-full flex items-center justify-center mb-6",children:(0,te.jsx)(Ke.A,{className:"w-12 h-12 text-red-500"})}),(0,te.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Error Loading Tickets"}),(0,te.jsx)("p",{className:"text-slate-600 mb-6",children:d}),(0,te.jsx)(Rs,{onClick:b,variant:"outline",children:"Try Again"})]})}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{className:"w-full max-w-6xl mx-auto px-6 py-12",children:[(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,te.jsxs)(Rs,{variant:"ghost",size:"sm",onClick:()=>{t("/support")},className:"text-slate-600 hover:text-slate-900 hover:bg-slate-100",children:[(0,te.jsx)(pi.A,{className:"w-4 h-4 mr-2"}),"Back to Support"]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"My Support Tickets"}),r&&(0,te.jsxs)("p",{className:"text-slate-600 mt-1",children:["Showing tickets for App: ",(0,te.jsx)("span",{className:"font-mono text-sm",children:r})]})]})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,te.jsxs)(Rs,{onClick:b,variant:"outline",size:"sm",children:[(0,te.jsx)(Yu.A,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,te.jsxs)(Rs,{className:"bg-orange-500 hover:bg-orange-600",size:"sm",onClick:N,children:[(0,te.jsx)(ys.A,{className:"w-4 h-4 mr-2"}),"New Ticket"]})]})]}),r&&(0,te.jsx)("div",{className:"mb-6",children:(0,te.jsxs)("div",{className:"inline-flex items-center gap-2 bg-blue-50 border border-blue-200 rounded-lg px-4 py-2",children:[(0,te.jsx)(Yu.A,{className:"w-4 h-4 text-blue-600"}),(0,te.jsxs)("span",{className:"text-sm font-medium text-blue-800",children:["Filtered by App: ",(0,te.jsx)("span",{className:"font-mono",children:r})]}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>{window.location.href="/support/conversations"},className:"h-auto p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-100",children:(0,te.jsx)(Ds.A,{className:"w-4 h-4"})})]})})]}),(0,te.jsxs)(lr,{value:u,onValueChange:x,className:"mb-6",children:[(0,te.jsxs)(ir,{className:"grid w-full grid-cols-3 lg:w-96",children:[(0,te.jsxs)(or,{value:"open",className:"flex items-center space-x-2",children:[(0,te.jsx)(St.A,{className:"w-4 h-4"}),(0,te.jsxs)("span",{children:["Open (",k,")"]})]}),(0,te.jsxs)(or,{value:"closed",className:"flex items-center space-x-2",children:[(0,te.jsx)(Ed.A,{className:"w-4 h-4"}),(0,te.jsxs)("span",{children:["Closed (",_,")"]})]}),(0,te.jsxs)(or,{value:"all",className:"flex items-center space-x-2",children:[(0,te.jsx)(Og.A,{className:"w-4 h-4"}),(0,te.jsxs)("span",{children:["All (",l.length,")"]})]})]}),(0,te.jsx)(cr,{value:u,className:"mt-6",children:0===w.length?(0,te.jsx)(Nf,{filter:u,onCreateTicket:N}):(0,te.jsx)("div",{className:"grid grid-cols-1 gap-4",children:w.map((e=>(0,te.jsx)(yf,{ticket:e,onClick:y,isSelected:(null==h?void 0:h.id)===e.id},e.id)))})})]})]}),(0,te.jsx)(na,{open:v,onOpenChange:j,children:(0,te.jsxs)(da,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[(0,te.jsx)(ma,{children:(0,te.jsx)(xa,{className:"text-2xl font-bold",children:"Submit Support Ticket"})}),(0,te.jsx)(vf,{appId:r,onSubmit:async e=>{j(!1),await b();const s=await Yg.list("-updated_date",1e3);s&&1e3===s.length&&a({title:"Ticket Limit Reached",description:"There are more tickets than can be loaded. Only the top 1000 most recent tickets were loaded.",variant:"default"});let t=s||[];r&&(t=t.filter((e=>e.app_id===r)));const n=t.find((s=>s.title===e.title&&s.content===e.content));n&&(p(n),f(!0),i(t))},onCancel:()=>{j(!1)}})]})}),(0,te.jsx)(xf,{conversationId:null==h?void 0:h.id,isOpen:g,onClose:()=>{f(!1),p(null)},ticketTitle:null==h?void 0:h.title,ticket:h,onTicketUpdated:(e,s,t,a)=>{if(i((r=>r.map((r=>{if(r.id===e){if(a){let e="admin";if(a.messages&&a.messages.length>0){e="user"===a.messages[a.messages.length-1].role?"admin":"user"}return{...r,...a,pending_response_from:e,updated_date:(new Date).toISOString()}}if("message_sent"===s){const e="user"===t;return{...r,pending_response_from:e?"admin":"user",updated_date:(new Date).toISOString()}}return r}return r})))),h&&h.id===e&&a){let e="admin";if(a.messages&&a.messages.length>0){const s=a.messages[a.messages.length-1];e="user"===s.role?"admin":"user"}p((s=>({...s,...a,pending_response_from:e,updated_date:(new Date).toISOString()})))}}})]})}function kf(e){let{error:s,onRetry:t}=e;return(0,te.jsx)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:(0,te.jsxs)("div",{className:"text-center py-16",children:[(0,te.jsx)("div",{className:"mx-auto w-24 h-24 bg-red-100 rounded-full flex items-center justify-center mb-6",children:(0,te.jsx)(Ke.A,{className:"w-12 h-12 text-red-500"})}),(0,te.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Error Loading Tickets"}),(0,te.jsx)("p",{className:"text-slate-600 mb-6",children:s}),(0,te.jsx)(Rs,{onClick:t,variant:"outline",children:"Try Again"})]})})}var _f=t(45536),Sf=t(91412);const Cf={authentication:Ls.A,billing:Ze.A,bug_report:Wg.A,integrations_and_backend_functions:Gd.A,chat_issues:fu.A,security:Om.A,social_post_bonus_credits:gx.A,other:cm.A},Af=(St.A,Ed.A,{starter:{label:"Starter",color:"bg-green-100 text-green-800 border-green-200",icon:vx.A},starter_yearly:{label:"Starter(Yearly)",color:"bg-green-100 text-green-800 border-green-200",icon:vx.A},builder:{label:"Builder",color:"bg-blue-100 text-blue-800 border-blue-200",icon:nl.A},builder_yearly:{label:"Builder(Yearly)",color:"bg-blue-100 text-blue-800 border-blue-200",icon:nl.A},pro:{label:"Pro",color:"bg-indigo-100 text-indigo-800 border-indigo-200",icon:wa.A},pro_yearly:{label:"Pro(Yearly)",color:"bg-indigo-100 text-indigo-800 border-indigo-200",icon:wa.A},elite:{label:"Elite",color:"bg-purple-100 text-purple-800 border-purple-200",icon:_f.A},elite_yearly:{label:"Elite(Yearly)",color:"bg-purple-100 text-purple-800 border-purple-200",icon:_f.A},elite_2:{label:"Elite 2",color:"bg-violet-100 text-violet-800 border-violet-200",icon:Sf.A},elite_2_yearly:{label:"Elite 2(Yearly)",color:"bg-violet-100 text-violet-800 border-violet-200",icon:Sf.A},elite_3:{label:"Elite 3",color:"bg-pink-100 text-pink-800 border-pink-200",icon:Ct.A},elite_3_yearly:{label:"Elite 3 (Yearly)",color:"bg-pink-100 text-pink-800 border-pink-200",icon:Ct.A},free:{label:"Free",color:"bg-gray-100 text-gray-800 border-gray-200",icon:Wa.A}}),Ef=function(e){let s=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!e)return"Not available";const t=Bt().utc(e);return s?`${t.format("MMM DD, YYYY [at] HH:mm [UTC]")} (${t.fromNow()})`:`${t.format("MMM DD, YYYY")} (${t.fromNow()})`},If=[{value:"open",label:"Open",icon:St.A,color:"text-orange-600"},{value:"resolved",label:"Resolved",icon:Ed.A,color:"text-green-600"}],Lf=[{value:"authentication",label:"Authentication"},{value:"billing",label:"Billing"},{value:"bug_report",label:"Bug Report"},{value:"integrations_and_backend_functions",label:"Integrations & Backend"},{value:"chat_issues",label:"Chat Issues"},{value:"security",label:"Security"},{value:"social_post_bonus_credits",label:"Social Post Bonus Credits"},{value:"other",label:"Other"}],Tf=e=>{let{category:s}=e;const t=Cf[s]||Ke.A,a=s?s.replace(/_/g," ").replace(/\b\w/g,(e=>e.toUpperCase())):"Uncategorized";return(0,te.jsxs)(qs,{variant:"outline",className:"text-xs",children:[(0,te.jsx)(t,{className:"w-3 h-3 mr-1"}),a]})},$f=e=>{let{title:s,icon:t,children:a,isCollapsible:r=!1,defaultExpanded:n=!0}=e;const[l,i]=(0,Y.useState)(n);return(0,te.jsxs)(Vs,{className:"border-slate-200",children:[(0,te.jsx)("div",{className:"p-3 "+(r?"cursor-pointer":""),onClick:r?()=>i(!l):void 0,children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(t,{className:"w-4 h-4 text-slate-600"}),(0,te.jsx)("h3",{className:"text-sm font-semibold text-slate-900",children:s})]}),r&&(0,te.jsx)("div",{className:"text-slate-400",children:l?(0,te.jsx)(dt.A,{className:"w-4 h-4"}):(0,te.jsx)(ct.A,{className:"w-4 h-4"})})]})}),l&&(0,te.jsx)(Js,{className:"pt-0 pb-3 px-3",children:a})]})},Df=e=>{let{label:s,value:t,className:a=""}=e;return(0,te.jsxs)("div",{className:`flex justify-between items-start py-1.5 ${a}`,children:[(0,te.jsx)("span",{className:"text-xs text-slate-600 flex-shrink-0 w-20",children:s}),(0,te.jsx)("span",{className:"text-xs text-slate-900 text-right flex-1",children:t})]})};function Pf(e){var s,t,a,r,n;let{conversationId:l,onTicketUpdated:i}=e;const{conversationId:o}=(0,Z.g)(),[c]=(0,J.useSearchParams)(),d=c.get("conversationId"),m=l||o||d,[u,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)(!0),[g,f]=(0,Y.useState)(null),[v,j]=(0,Y.useState)(!1),[b,y]=(0,Y.useState)([]),[N,w]=(0,Y.useState)([]),[k,_]=(0,Y.useState)(!1),[S,C]=(0,Y.useState)([]),[A,E]=(0,Y.useState)(!1),[I,L]=(0,Y.useState)(""),[T,$]=(0,Y.useState)(""),[D,P]=(0,Y.useState)(!1),[M,O]=(0,Y.useState)(""),[R,F]=(0,Y.useState)(!1),[z,U]=(0,Y.useState)(""),[B,W]=(0,Y.useState)(!1),[q,V]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{m&&(x(null),p(!0),f(null),H())}),[m]);const H=async()=>{try{var e,s;p(!0),f(null);const[t,a]=await Promise.all([Gg.getTicketDetail(m),Zg.getAgentProperties()]);x(t),y((null==a?void 0:a.internal_category_options)||[]),w((null==t||null===(e=t.ticket)||void 0===e?void 0:e.internal_categories)||[]),O((null==t||null===(s=t.ticket)||void 0===s?void 0:s.internal_notes)||"")}catch(t){f("Failed to load ticket details. Please try again.")}finally{p(!1)}},G=async()=>{const e=(s=I).trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)?s.endsWith("@base44.com")||s.endsWith("@wix.com")?"":"Email must be from @base44.com or @wix.com domain":"Please enter a valid email address":"Email is required";var s;if(e)$(e);else try{P(!0),$(""),await Gg.assignTicket(m,I.trim()),await H(),i&&i(m,"assigned",I.trim()),E(!1),L("")}catch(t){$("Failed to assign ticket. Please try again.")}finally{P(!1)}};if(h)return(0,te.jsx)("div",{className:"h-full flex items-center justify-center",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-slate-400 mx-auto mb-3"}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"Loading conversation..."})]})});if(g)return(0,te.jsx)("div",{className:"h-full flex items-center justify-center p-6",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,te.jsx)(Ke.A,{className:"w-6 h-6 text-red-500"})}),(0,te.jsx)("h3",{className:"text-sm font-semibold text-slate-900 mb-2",children:"Error Loading Ticket"}),(0,te.jsx)("p",{className:"text-xs text-slate-600 mb-4",children:g}),(0,te.jsx)(Rs,{onClick:H,variant:"outline",size:"sm",children:"Try Again"})]})});const K=(null==u?void 0:u.ticket)||{id:m,title:"Loading...",content:"Loading ticket content...",status:"pending_admin_response",category:"other",app_id:null,created_by:"unknown@example.com",user_subscription_tier:"free",created_date:(new Date).toISOString(),updated_date:(new Date).toISOString()},X=(null==u?void 0:u.user)||{id:"unknown",email:K.created_by||"unknown@example.com",name:"Unknown User",stripe_customer_id:null,created_date:(new Date).toISOString()},Q=(null==u?void 0:u.subscriptions)||[];return(0,te.jsxs)("div",{className:"h-full flex flex-col min-h-0",children:[(0,te.jsx)("div",{className:"border-b border-slate-200 p-4 bg-slate-50 flex-shrink-0 min-h-fit",children:(0,te.jsx)("div",{className:"space-y-4",children:(0,te.jsxs)("div",{className:"flex items-start justify-between gap-4",children:[(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsx)("h2",{className:"text-lg font-semibold text-slate-900 leading-snug break-words",children:K.title}),(0,te.jsxs)("div",{className:"flex items-start justify-between mt-3 gap-4",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-3 flex-wrap min-w-0",children:[(0,te.jsx)(Tf,{category:K.category}),(0,te.jsx)("div",{className:"text-xs text-slate-600",children:(0,te.jsx)("span",{className:"font-medium capitalize",children:K.ticket_status})}),K.assigned_to&&(0,te.jsxs)("div",{className:"text-xs text-slate-600",children:[(0,te.jsx)(jh.A,{className:"w-3 h-3 inline mr-1"}),(0,te.jsx)("span",{className:"font-medium",children:K.assigned_to})]})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 flex-shrink-0 flex-wrap",children:["resolved"!==K.ticket_status&&(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>{L(""),$(""),E(!0)},className:"text-slate-600 hover:text-slate-900 hover:bg-slate-100 h-auto py-1 px-2 text-xs",children:[(0,te.jsx)(vh.A,{className:"w-3 h-3 mr-1"}),K.assigned_to?"Reassign":"Assign"]}),(0,te.jsxs)(ut,{value:K.category||"other",onValueChange:async e=>{try{V(!0),await Gg.updateTicketCategory(m,e),await H(),i&&i(m,"category_updated")}catch(s){f("Failed to change ticket category. Please try again.")}finally{V(!1)}},disabled:q,children:[(0,te.jsx)(pt,{className:"h-auto py-1 w-auto text-xs border-slate-300 hover:border-slate-400",children:(0,te.jsxs)("div",{className:"flex items-center",children:[q?(0,te.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-slate-400 mr-1"}):(0,te.jsx)(qg.A,{className:"w-3 h-3 mr-1"}),(0,te.jsx)("span",{className:"mr-1",children:"Category:"}),(0,te.jsx)(ht,{})]})}),(0,te.jsx)(vt,{children:Lf.map((e=>(0,te.jsx)(bt,{value:e.value,children:e.label},e.value)))})]}),(0,te.jsxs)(ut,{value:K.ticket_status,onValueChange:async e=>{try{j(!0),await Gg.changeTicketStatus(m,e),await H(),i&&i(m,e)}catch(s){f("Failed to change ticket status. Please try again.")}finally{j(!1)}},disabled:v,children:[(0,te.jsx)(pt,{className:"h-auto py-1 w-auto text-xs border-slate-300 hover:border-slate-400",children:(0,te.jsxs)("div",{className:"flex items-center",children:[v?(0,te.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-slate-400 mr-1"}):(()=>{const e=If.find((e=>e.value===K.ticket_status)),s=(null==e?void 0:e.icon)||St.A;return(0,te.jsx)(s,{className:"w-3 h-3 mr-1"})})(),(0,te.jsx)(ht,{})]})}),(0,te.jsx)(vt,{children:If.map((e=>{const s=e.icon;return(0,te.jsx)(bt,{value:e.value,children:(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(s,{className:`w-4 h-4 ${e.color}`}),(0,te.jsx)("span",{children:e.label})]})},e.value)}))})]})]})]})]}),(0,te.jsxs)("div",{className:"flex flex-col items-end space-y-1 text-xs text-slate-600 flex-shrink-0",children:[(0,te.jsxs)("span",{className:"font-mono bg-white px-2 py-1 rounded text-xs whitespace-nowrap",children:["id: ",K.id]}),(0,te.jsx)("span",{className:"text-right text-xs",children:Ef(K.created_date)})]})]})})}),(0,te.jsxs)(nm,{direction:"horizontal",className:"flex-1 overflow-hidden min-h-0",children:[(0,te.jsx)(lm,{defaultSize:90,minSize:20,children:(0,te.jsx)("div",{className:"h-full flex flex-col min-h-0",children:(0,te.jsx)(mf,{conversationId:m,isAdmin:!0,onMessageSent:e=>{"object"==typeof e&&e.conversationId?i&&i(e.conversationId,e.action,e.role,e.conversation):i&&i(m,"message_sent","admin")}},m)})}),(0,te.jsx)(im,{withHandle:!0,className:"hidden lg:flex group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,te.jsx)(lm,{defaultSize:30,minSize:15,maxSize:40,className:"hidden lg:block",children:(0,te.jsx)("div",{className:"w-full border-l border-slate-200 bg-slate-50 h-full flex flex-col",children:(0,te.jsxs)("div",{className:"flex-1 overflow-y-auto p-3 space-y-3",children:[(0,te.jsx)($f,{title:"User",icon:Mm.A,isCollapsible:!0,defaultExpanded:!0,children:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(Df,{label:"Email",value:X.email}),(0,te.jsx)(Df,{label:"Name",value:X.full_name||"Not provided"}),(0,te.jsx)(Df,{label:"Subscription Status",value:X.stripe_subscription_status||"Not provided"}),(0,te.jsx)(Df,{label:"Manage",value:(0,te.jsxs)(J.Link,{to:`/user-management?userId=${X.id}`,target:"_blank",className:"inline-flex items-center text-slate-600 hover:text-slate-900 text-xs transition-colors",children:["View Profile",(0,te.jsx)(ur.A,{className:"w-2 h-2 ml-1"})]})}),X.stripe_customer_id&&(0,te.jsx)(Df,{label:"Stripe",value:(0,te.jsxs)("a",{href:`https://dashboard.stripe.com/customers/${X.stripe_customer_id}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-800 text-xs",children:["View",(0,te.jsx)(ur.A,{className:"w-2 h-2 ml-1"})]})})]})}),(0,te.jsx)($f,{title:"Subscription",icon:Ze.A,isCollapsible:!0,defaultExpanded:!0,children:Q&&Q.length>0?(0,te.jsx)("div",{className:"space-y-2",children:Q.map(((e,s)=>{var t,a,r;return(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)(Df,{label:"Plan",value:(null===(t=e.plan)||void 0===t?void 0:t.nickname)||"Unknown"}),(0,te.jsx)(Df,{label:"Status",value:e.status}),(0,te.jsx)(Df,{label:"Amount",value:`$${((null===(a=e.plan)||void 0===a?void 0:a.amount)/100).toFixed(2)}/${null===(r=e.plan)||void 0===r?void 0:r.interval}`})]},s)}))}):(0,te.jsx)("p",{className:"text-xs text-slate-600",children:"No subscriptions found."})}),(0,te.jsx)($f,{title:"App",icon:mr.A,isCollapsible:!0,defaultExpanded:!0,children:(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(Df,{label:"Name",value:(null==u||null===(s=u.app)||void 0===s?void 0:s.name)||"None"}),(0,te.jsx)(Df,{label:"Link",value:null!=u&&null!==(t=u.app)&&void 0!==t&&t.id?(0,te.jsxs)("a",{href:`https://app.base44.com/apps/${u.app.id}`,target:"_blank",rel:"noopener noreferrer",className:"inline-flex items-center text-blue-600 hover:text-blue-800 text-xs",children:["View App",(0,te.jsx)(ur.A,{className:"w-2 h-2 ml-1"})]}):"No app linked"}),(0,te.jsx)(Df,{label:"App Visiblity",value:(null==u||null===(a=u.app)||void 0===a?void 0:a.visibility)||"Not available"}),(0,te.jsx)(Df,{label:"Created",value:null!=u&&null!==(r=u.app)&&void 0!==r&&r.created_date?Ef(u.app.created_date):"Not available"}),(0,te.jsx)(Df,{label:"Updated",value:null!=u&&null!==(n=u.app)&&void 0!==n&&n.updated_date?Ef(u.app.updated_date):"Not available"}),(0,te.jsx)(Df,{label:"App ID",value:(null==K?void 0:K.app_id)||"None"})]})}),(0,te.jsx)($f,{title:"Internal Categories",icon:qg.A,isCollapsible:!0,defaultExpanded:!0,children:(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("div",{className:"text-xs text-slate-600 mb-2",children:"Internal categories for admin organization and tracking."}),k?(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("div",{className:"space-y-2",children:b.map((e=>(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(zi,{id:`category-${e}`,checked:S.includes(e),onCheckedChange:()=>(e=>{C((s=>s.includes(e)?s.filter((s=>s!==e)):[...s,e]))})(e),className:"h-3 w-3"}),(0,te.jsx)("label",{htmlFor:`category-${e}`,className:"text-xs text-slate-700 cursor-pointer",children:e})]},e)))}),(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsxs)(Rs,{variant:"default",size:"sm",onClick:async()=>{try{await Gg.updateInternalCategories(m,S),w([...S]),_(!1),C([]),i&&i(m,"categories_updated")}catch(e){f("Failed to update internal categories. Please try again.")}},className:"h-6 px-2 text-xs",children:[(0,te.jsx)(Wd.A,{className:"w-3 h-3 mr-1"}),"Save"]}),(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>{C([]),_(!1)},className:"h-6 px-2 text-xs",children:[(0,te.jsx)(Ds.A,{className:"w-3 h-3 mr-1"}),"Cancel"]})]})]}):(0,te.jsxs)("div",{className:"space-y-2",children:[N.length>0?(0,te.jsx)("div",{className:"flex flex-wrap gap-1",children:N.map((e=>(0,te.jsx)(qs,{variant:"secondary",className:"text-xs",children:e},e)))}):(0,te.jsx)("p",{className:"text-xs text-slate-500 italic",children:"No internal categories assigned."}),(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>{C([...N]),_(!0)},className:"h-6 px-2 text-xs",children:[(0,te.jsx)(Ba.A,{className:"w-3 h-3 mr-1"}),"Edit Categories"]})]})]})}),(0,te.jsx)($f,{title:"Internal Notes",icon:It.A,isCollapsible:!0,defaultExpanded:!0,children:(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("div",{className:"text-xs text-slate-600 mb-2",children:"Private notes visible only to admins."}),R?(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)(Ui,{value:z,onChange:e=>U(e.target.value),placeholder:"Add internal notes here...",className:"min-h-[100px] text-xs resize-none",disabled:B}),(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(Rs,{variant:"default",size:"sm",onClick:async()=>{try{W(!0),await Gg.updateInternalNotes(m,z),O(z),F(!1),U(""),i&&i(m,"notes_updated")}catch(e){f("Failed to update internal notes. Please try again.")}finally{W(!1)}},disabled:B,className:"h-6 px-2 text-xs",children:B?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-white mr-1"}),"Saving..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Wd.A,{className:"w-3 h-3 mr-1"}),"Save"]})}),(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>{U(""),F(!1)},disabled:B,className:"h-6 px-2 text-xs",children:[(0,te.jsx)(Ds.A,{className:"w-3 h-3 mr-1"}),"Cancel"]})]})]}):(0,te.jsxs)("div",{className:"space-y-2",children:[M?(0,te.jsx)("div",{className:"p-2 bg-slate-50 rounded-lg border border-slate-200",children:(0,te.jsx)("p",{className:"text-xs text-slate-700 whitespace-pre-wrap",children:M})}):(0,te.jsx)("p",{className:"text-xs text-slate-500 italic",children:"No internal notes added."}),(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>{U(M),F(!0)},className:"h-6 px-2 text-xs",children:[(0,te.jsx)(Ba.A,{className:"w-3 h-3 mr-1"}),M?"Edit Notes":"Add Notes"]})]})]})})]})})})]}),(0,te.jsx)(na,{open:A,onOpenChange:E,children:(0,te.jsxs)(da,{className:"sm:max-w-md",children:[(0,te.jsx)(ma,{children:(0,te.jsxs)(xa,{className:"flex items-center",children:[(0,te.jsx)(vh.A,{className:"w-5 h-5 mr-2"}),K.assigned_to?"Reassign Ticket":"Assign Ticket"]})}),(0,te.jsxs)("div",{className:"space-y-4 py-4",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"assignEmail",children:"Agent Email"}),(0,te.jsx)(Qs,{id:"assignEmail",type:"email",value:I,onChange:e=>{L(e.target.value),T&&$("")},onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),G())},placeholder:"agent@base44.com",className:"w-full "+(T?"border-red-500":""),disabled:D}),T&&(0,te.jsx)("p",{className:"text-sm text-red-600",children:T}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"Email must be from @base44.com or @wix.com domain"})]}),K.assigned_to&&(0,te.jsxs)("div",{className:"p-3 bg-slate-50 rounded-lg",children:[(0,te.jsx)("p",{className:"text-xs text-slate-600 mb-1",children:"Currently assigned to:"}),(0,te.jsx)("p",{className:"text-sm font-medium text-slate-900",children:K.assigned_to})]})]}),(0,te.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,te.jsx)(Rs,{variant:"outline",onClick:()=>{L(""),$(""),E(!1)},disabled:D,children:"Cancel"}),(0,te.jsx)(Rs,{onClick:G,disabled:D||!I.trim(),children:D?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Assigning..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(jh.A,{className:"w-4 h-4 mr-2"}),K.assigned_to?"Reassign":"Assign"," Ticket"]})})]})]})})]})}const Mf=e=>{var s,t,a,r,n,l,i,o;let{filters:c,onFilterChange:d,onClearFilters:m,ticketCounts:u,searchQuery:x,onSearchChange:h,showResolved:p,onShowResolvedChange:g}=e;const f=[{value:"",label:"Open Only",count:u.total-u.resolved},{value:"admin",label:"Pending Admin",count:u.pending_admin},{value:"user",label:"Pending User",count:u.pending_user},{value:"resolved",label:"Resolved Only",count:u.resolved},{value:"all",label:"All Tickets",count:u.total}],v=[{value:"",label:"All",count:u.total},{value:"authentication",label:"Auth",count:(null===(s=u.category)||void 0===s?void 0:s.authentication)||0},{value:"billing",label:"Billing",count:(null===(t=u.category)||void 0===t?void 0:t.billing)||0},{value:"bug_report",label:"Bugs",count:(null===(a=u.category)||void 0===a?void 0:a.bug_report)||0},{value:"integrations_and_backend_functions",label:"Integrations",count:(null===(r=u.category)||void 0===r?void 0:r.integrations_and_backend_functions)||0},{value:"chat_issues",label:"Chat",count:(null===(n=u.category)||void 0===n?void 0:n.chat_issues)||0},{value:"security",label:"Security",count:(null===(l=u.category)||void 0===l?void 0:l.security)||0},{value:"other",label:"Other",count:(null===(i=u.category)||void 0===i?void 0:i.other)||0}],j=[{value:"",label:"All Assigned",count:u.total},{value:"unassigned",label:"Unassigned",count:(null===(o=u.assigned_to)||void 0===o?void 0:o.unassigned)||0},...Object.entries(u.assigned_to||{}).filter((e=>{let[s]=e;return"unassigned"!==s})).map((e=>{let[s,t]=e;return{value:s,label:s.split("@")[0],count:t}}))];return(0,te.jsxs)("div",{className:"w-full h-full bg-white border-r border-slate-200 flex flex-col",children:[(0,te.jsx)("div",{className:"flex-shrink-0 p-3 border-b border-slate-100",children:(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Na.A,{className:"absolute left-2 top-1/2 transform -translate-y-1/2 text-slate-400 w-3 h-3"}),(0,te.jsx)(Qs,{placeholder:"Search...",value:x,onChange:e=>h(e.target.value),className:"pl-7 text-xs h-8"})]})}),(0,te.jsxs)("div",{className:"flex-1 overflow-y-auto p-3 space-y-4 text-xs",children:[(0,te.jsx)("div",{className:"space-y-2",children:(0,te.jsxs)("div",{className:"flex items-center space-x-2 p-2 bg-slate-50 rounded border",children:[(0,te.jsx)(zi,{id:"show-resolved",checked:p,onCheckedChange:g,className:"h-4 w-4"}),(0,te.jsx)("label",{htmlFor:"show-resolved",className:"text-xs font-medium text-slate-700 cursor-pointer flex-1",children:"Include resolved tickets"})]})}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Pending Response"}),(0,te.jsx)("div",{className:"space-y-0.5",children:f.map((e=>(0,te.jsx)("button",{onClick:()=>d("status",c.status===e.value?"":e.value),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors "+(c.status===e.value?"bg-teal-100 text-teal-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("span",{className:"truncate",children:e.label}),void 0!==e.count&&(0,te.jsx)(qs,{variant:"secondary",className:"text-xs h-4 px-1",children:e.count})]})},e.value)))})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Assigned"}),(0,te.jsx)("div",{className:"space-y-0.5 max-h-32 overflow-y-auto",children:j.map((e=>(0,te.jsx)("button",{onClick:()=>d("assigned_to",c.assigned_to===e.value?"":e.value),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors "+(c.assigned_to===e.value?"bg-blue-100 text-blue-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("span",{className:"truncate",children:e.label}),void 0!==e.count&&(0,te.jsx)(qs,{variant:"secondary",className:"text-xs h-4 px-1",children:e.count})]})},e.value)))})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Subscription"}),(0,te.jsxs)("div",{className:"space-y-0.5 max-h-32 overflow-y-auto",children:[(0,te.jsx)("button",{onClick:()=>d("user_subscription_tier",(c.user_subscription_tier,"")),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors "+(""===c.user_subscription_tier?"bg-purple-100 text-purple-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("span",{className:"truncate",children:"All Tiers"}),u.tier&&(0,te.jsx)(qs,{variant:"secondary",className:"text-xs h-4 px-1",children:Object.values(u.tier).reduce(((e,s)=>e+s),0)})]})}),Object.entries(Af).map((e=>{var s;let[t,a]=e;const r=(null===(s=u.tier)||void 0===s?void 0:s[t])||0;return 0===r?null:(0,te.jsx)("button",{onClick:()=>d("user_subscription_tier",c.user_subscription_tier===t?"":t),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors "+(c.user_subscription_tier===t?"bg-purple-100 text-purple-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("span",{className:"truncate",children:a.label}),(0,te.jsx)(qs,{variant:"secondary",className:"text-xs h-4 px-1",children:r})]})},t)}))]})]}),(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Category"}),(0,te.jsx)("div",{className:"space-y-0.5",children:v.map((e=>(0,te.jsx)("button",{onClick:()=>d("category",c.category===e.value?"":e.value),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors "+(c.category===e.value?"bg-orange-100 text-orange-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("span",{className:"truncate",children:e.label}),void 0!==e.count&&(0,te.jsx)(qs,{variant:"secondary",className:"text-xs h-4 px-1",children:e.count})]})},e.value)))})]}),u.internal_categories&&Object.keys(u.internal_categories).length>0&&(0,te.jsxs)("div",{className:"space-y-1",children:[(0,te.jsx)("h3",{className:"text-xs font-semibold text-slate-600 uppercase tracking-wide",children:"Internal Categories"}),(0,te.jsx)("div",{className:"space-y-0.5 max-h-32 overflow-y-auto",children:Object.entries(u.internal_categories).map((e=>{let[s,t]=e;return(0,te.jsx)("button",{onClick:()=>d("internal_category",c.internal_category===s?"":s),className:"w-full text-left px-2 py-1 rounded text-xs transition-colors "+(c.internal_category===s?"bg-purple-100 text-purple-800 font-medium":"text-slate-600 hover:bg-slate-50"),children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("span",{className:"truncate",children:s}),(0,te.jsx)(qs,{variant:"secondary",className:"text-xs h-4 px-1",children:t})]})},s)}))})]}),(c.status||c.category||c.assigned_to||c.internal_category||c.user_subscription_tier||x||p)&&(0,te.jsx)(Rs,{variant:"outline",size:"sm",onClick:m,className:"w-full text-xs h-7",children:"Clear Filters"})]})]})},Of=e=>{let{ticket:s,isSelected:t,onClick:a,onCheckboxToggle:r,showCheckbox:n}=e;const l=Cf[s.category];return(0,te.jsxs)("div",{className:"flex items-start p-3 border-b border-slate-100 transition-colors "+(t?"bg-teal-50 border-l-4 border-l-teal-500":"hover:bg-slate-50"),children:["resolved"!==s.ticket_status&&(0,te.jsx)("div",{className:"mr-3 mt-1",children:(0,te.jsx)(zi,{checked:n,onCheckedChange:e=>{r(s.id,e)},onClick:e=>e.stopPropagation(),className:"h-4 w-4"})}),(0,te.jsxs)("div",{onClick:()=>a(s),className:"flex-1 cursor-pointer space-y-1.5",children:[(0,te.jsx)("h4",{className:"font-medium text-slate-900 text-sm line-clamp-2 leading-tight",children:s.title}),(0,te.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[(0,te.jsx)("span",{className:"truncate",children:s.created_by}),s.category&&(0,te.jsxs)("div",{className:"flex items-center space-x-1 flex-shrink-0 ml-2",children:[l&&(0,te.jsx)(l,{className:"w-3 h-3 text-slate-500"}),(0,te.jsx)("span",{className:"capitalize",children:"integrations_and_backend_functions"===s.category?"Integrations":s.category.replace("_"," ")})]})]}),(0,te.jsxs)("div",{className:"flex items-center justify-between text-xs text-slate-500",children:[(0,te.jsxs)("span",{children:[(0,te.jsx)("span",{className:"text-slate-400",children:"created:"})," ",Bt().utc(s.created_date).fromNow()]}),s.updated_date&&(0,te.jsxs)("span",{children:[(0,te.jsx)("span",{className:"text-slate-400",children:"last update:"})," ",Bt().utc(s.updated_date).fromNow()]})]}),(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)("div",{className:"flex items-center space-x-2",children:s.pending_response_from?(0,te.jsx)(qs,{variant:"secondary",className:"text-xs "+("admin"===s.pending_response_from?"bg-orange-100 text-orange-800 border-orange-200":"user"===s.pending_response_from?"bg-blue-100 text-blue-800 border-blue-200":"bg-gray-100 text-gray-800 border-gray-200"),children:"admin"===s.pending_response_from?"Pending Admin":"user"===s.pending_response_from?"Pending User":s.pending_response_from}):(0,te.jsx)(qs,{variant:"secondary",className:"text-xs bg-green-100 text-green-800 border-green-200",children:"Resolved"})}),(0,te.jsx)("div",{className:"flex items-center space-x-2",children:(0,te.jsx)("span",{className:"text-xs text-slate-500",children:s.assigned_to?(0,te.jsxs)("span",{children:[(0,te.jsx)("span",{className:"text-slate-400",children:"assigned:"})," ",s.assigned_to.split("@")[0]]}):(0,te.jsx)("span",{className:"text-slate-400 italic",children:"Unassigned"})})})]})]})]})};function Rf(){const e=(0,Z.Zp)(),[s]=(0,J.useSearchParams)(),t=s.get("conversationId"),[a,r]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(null),[m,u]=(0,Y.useState)(""),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)(new Set),[f,v]=(0,Y.useState)(!1),[j,b]=(0,Y.useState)("desc"),[y,N]=(0,Y.useState)("updated_date"),[w,k]=(0,Y.useState)(!1),[_,S]=(0,Y.useState)({status:"",category:"",user_subscription_tier:"",app_id:"",created_by:"",assigned_to:"",internal_category:""});(0,Y.useEffect)((()=>{C(!0)}),[]),(0,Y.useEffect)((()=>{a.length>0&&C()}),[w]),(0,Y.useEffect)((()=>{h(t||null)}),[t]),(0,Y.useEffect)((()=>{if(x&&a.length>0){if(!a.find((e=>e.id===x))){h(null);const s=new URLSearchParams(window.location.search);s.delete("conversationId"),e(`?${s.toString()}`,{replace:!0})}}}),[a,x,e]),(0,Y.useEffect)((()=>{const e=()=>{const e=new URLSearchParams(window.location.search).get("conversationId");if(e){a.find((s=>s.id===e))&&h(e)}else h(null)};return window.addEventListener("popstate",e),()=>window.removeEventListener("popstate",e)}),[a]);const C=async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];try{e?l(!0):o(!0),d(null);const s=await Gg.getTickets({show_resolved:w});r(s||[])}catch(s){d("Failed to load support tickets. Please try again.")}finally{l(!1),o(!1)}},A=s=>{h(s.id);const t=new URLSearchParams(window.location.search);t.set("conversationId",s.id),e(`?${t.toString()}`,{replace:!0})},E=(e,s)=>{g((t=>{const a=new Set(t);return s?a.add(e):a.delete(e),a}))},I=((e,s)=>{if(!s)return e;const t=s.toLowerCase();return e.filter((e=>{var s,a,r,n;return(null===(s=e.title)||void 0===s?void 0:s.toLowerCase().includes(t))||(null===(a=e.content)||void 0===a?void 0:a.toLowerCase().includes(t))||(null===(r=e.app_id)||void 0===r?void 0:r.toLowerCase().includes(t))||(null===(n=e.created_by)||void 0===n?void 0:n.toLowerCase().includes(t))}))})((()=>{let e=a;return"resolved"===_.status?e=e.filter((e=>"resolved"===e.ticket_status)):"all"===_.status||("admin"===_.status||"user"===_.status?e=e.filter((e=>"resolved"!==e.ticket_status&&e.pending_response_from===_.status)):w&&(e=e.filter((e=>"resolved"!==e.ticket_status)))),_.category&&(e=e.filter((e=>e.category===_.category))),_.user_subscription_tier&&(e=e.filter((e=>e.user_subscription_tier===_.user_subscription_tier))),_.assigned_to&&(e="unassigned"===_.assigned_to?e.filter((e=>!e.assigned_to)):e.filter((e=>e.assigned_to===_.assigned_to))),_.internal_category&&(e=e.filter((e=>e.internal_categories&&e.internal_categories.includes(_.internal_category)))),e})(),m),L=[...I].sort(((e,s)=>{let t=0;if("updated_date"===y||"created_date"===y){t=new Date(e[y])-new Date(s[y])}else"subject"===y?t=(e.subject||"").localeCompare(s.subject||""):"category"===y?t=(e.category||"").localeCompare(s.category||""):"assigned_to"===y&&(t=(e.assigned_to||"").localeCompare(s.assigned_to||""));return"desc"===j?-t:t})),T=(e=>{const s={status:{},tier:{},category:{},assigned_to:{},internal_categories:{}};return e.forEach((e=>{if("resolved"===e.ticket_status)return void(s.status.resolved=(s.status.resolved||0)+1);const t=e.pending_response_from;t&&(s.status[t]=(s.status[t]||0)+1);const a=e.user_subscription_tier||"free";s.tier[a]=(s.tier[a]||0)+1;const r=e.category;r&&(s.category[r]=(s.category[r]||0)+1);const n=e.assigned_to||"unassigned";s.assigned_to[n]=(s.assigned_to[n]||0)+1,e.internal_categories&&Array.isArray(e.internal_categories)&&e.internal_categories.forEach((e=>{s.internal_categories[e]=(s.internal_categories[e]||0)+1}))})),s.total=e.length,s.pending_admin=s.status.admin||0,s.pending_user=s.status.user||0,s.resolved=s.status.resolved||0,s})(a),$=x?a.find((e=>e.id===x)):null;return n?(0,te.jsx)("div",{className:"h-screen flex items-center justify-center",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-slate-400 mx-auto mb-4"}),(0,te.jsx)("p",{className:"text-slate-600",children:"Loading conversations..."})]})}):c&&0===a.length?(0,te.jsx)(kf,{error:c,onRetry:()=>C(!0)}):(0,te.jsxs)("div",{className:"w-full h-screen bg-slate-50",children:[(0,te.jsx)("div",{className:"bg-white border-b border-slate-200 px-4 md:px-6 py-3 relative z-10",children:(0,te.jsxs)("div",{className:"flex items-center justify-between flex-wrap gap-2",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-2 md:space-x-4",children:[(0,te.jsx)("h1",{className:"text-lg md:text-xl font-semibold text-slate-900",children:"Support Admin"}),(0,te.jsxs)("span",{className:"text-xs md:text-sm text-slate-500",children:[L.length," conversations"]}),i&&(0,te.jsxs)("div",{className:"flex items-center space-x-2 text-sm text-slate-500",children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border-b-2 border-slate-400"}),(0,te.jsx)("span",{children:"Refreshing..."})]})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[p.size>0&&(0,te.jsxs)(Rs,{onClick:async()=>{if(0===p.size)return;const e=`Are you sure you want to resolve ${p.size} ticket${p.size>1?"s":""}?`;if(window.confirm(e))try{v(!0);const e=Array.from(p),t=await Gg.resolveMany(e);if(t.resolved&&t.resolved.length>0){var s;g(new Set),await C();const e=t.resolved.length,a=(null===(s=t.errors)||void 0===s?void 0:s.length)||0;let r=`Successfully resolved ${e} ticket${e>1?"s":""}`;a>0&&(r+=` (${a} failed)`),alert(r)}}catch(t){alert("Failed to resolve tickets. Please try again.")}finally{v(!1)}},disabled:f,variant:"default",size:"sm",className:"bg-green-600 hover:bg-green-700",children:[f?(0,te.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):(0,te.jsx)(Qa.A,{className:"w-4 h-4 mr-2"}),"Resolve ",p.size," ticket",p.size>1?"s":""]}),(0,te.jsxs)(Rs,{onClick:()=>e("/support/admin/agent-backoffice"),variant:"outline",size:"sm",children:[(0,te.jsx)(Vi.A,{className:"w-4 h-4 mr-2"}),"AI Settings"]}),(0,te.jsxs)(Rs,{onClick:()=>C(),variant:"outline",size:"sm",disabled:i,children:[(0,te.jsx)($c.A,{className:"w-4 h-4 mr-2 "+(i?"animate-spin":"")}),"Refresh"]})]})]})}),(0,te.jsxs)(nm,{direction:"horizontal",style:{height:"calc(100vh - 80px)"},children:[(0,te.jsx)(lm,{defaultSize:8,minSize:5,maxSize:25,className:"hidden md:block",children:(0,te.jsx)(Mf,{filters:_,onFilterChange:(e,s)=>{S((t=>({...t,[e]:"all"===s?"":s})))},onClearFilters:()=>{S({status:"",category:"",user_subscription_tier:"",app_id:"",created_by:"",assigned_to:"",internal_category:""}),u(""),k(!1)},ticketCounts:T,searchQuery:m,onSearchChange:u,showResolved:w,onShowResolvedChange:k})}),(0,te.jsx)(im,{withHandle:!0,className:"hidden md:flex group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,te.jsxs)(lm,{defaultSize:10,minSize:5,maxSize:40,className:"bg-white border-r border-slate-200 flex flex-col",children:[L.some((e=>"resolved"!==e.ticket_status))&&(0,te.jsxs)("div",{className:"flex-shrink-0 bg-white border-b border-slate-200 p-3 flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,te.jsx)(zi,{checked:p.size>0&&p.size===L.filter((e=>"resolved"!==e.ticket_status)).length,onCheckedChange:()=>{const e=L.filter((e=>"resolved"!==e.ticket_status));p.size===e.length?g(new Set):g(new Set(e.map((e=>e.id))))},className:"h-4 w-4"}),(0,te.jsx)("span",{className:"text-xs text-slate-600",children:"Select all open tickets"})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-1 text-xs text-slate-500",children:[(0,te.jsx)("span",{children:"Sort:"}),(0,te.jsxs)("select",{value:y,onChange:e=>N(e.target.value),className:"bg-transparent border-none text-xs text-slate-600 focus:outline-none",children:[(0,te.jsx)("option",{value:"updated_date",children:"Updated"}),(0,te.jsx)("option",{value:"created_date",children:"Created"}),(0,te.jsx)("option",{value:"subject",children:"Subject"}),(0,te.jsx)("option",{value:"category",children:"Category"}),(0,te.jsx)("option",{value:"assigned_to",children:"Assigned"})]}),(0,te.jsx)(Rs,{onClick:()=>b("desc"===j?"asc":"desc"),variant:"ghost",size:"sm",className:"h-5 w-5 p-0",children:"desc"===j?(0,te.jsx)(hi.A,{className:"w-3 h-3"}):(0,te.jsx)(Ts.A,{className:"w-3 h-3"})})]})]}),(0,te.jsx)("div",{className:"flex-1 overflow-y-auto",children:0===I.length?(0,te.jsx)("div",{className:"p-8 text-center text-slate-500",children:(0,te.jsx)("p",{children:"No conversations found"})}):(0,te.jsx)("div",{children:L.map((e=>(0,te.jsx)(Of,{ticket:e,isSelected:x===e.id,onClick:A,onCheckboxToggle:E,showCheckbox:p.has(e.id)},e.id)))})})]}),(0,te.jsx)(im,{withHandle:!0,className:"group transition-opacity opacity-0 hover:opacity-100 focus:opacity-100"}),(0,te.jsx)(lm,{defaultSize:50,minSize:10,className:"bg-white min-w-0 overflow-hidden",children:$?(0,te.jsx)(Pf,{conversationId:x,isEmbedded:!0,onTicketUpdated:(e,s,t,a)=>{r((r=>r.map((r=>{if(r.id===e){if(a){let e="admin";if(a.messages&&a.messages.length>0){e="user"===a.messages[a.messages.length-1].role?"admin":"user"}return{...r,...a,pending_response_from:e,updated_date:(new Date).toISOString()}}if("assigned"===s)return{...r,assigned_to:t,updated_date:(new Date).toISOString()};if("categories_updated"===s)return{...r,updated_date:(new Date).toISOString()};if("message_sent"===s){const e="admin"===t;return{...r,pending_response_from:e?"user":"admin",updated_date:(new Date).toISOString()}}return"ticket_closed"===s?{...r,ticket_status:"resolved",updated_date:(new Date).toISOString()}:{...r,ticket_status:s,updated_date:(new Date).toISOString()}}return r}))))}}):(0,te.jsx)("div",{className:"h-full flex items-center justify-center text-slate-500 p-4",children:(0,te.jsxs)("div",{className:"text-center max-w-md",children:[(0,te.jsx)("div",{className:"w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,te.jsx)(Vi.A,{className:"w-8 h-8"})}),(0,te.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"Select a conversation"}),(0,te.jsx)("p",{className:"text-slate-600 text-sm",children:"Choose a support ticket from the list to view details and respond"})]})})})]})]})}const Ff=e=>{if(!e)return"Not available";const s=Bt().utc(e);return`${s.format("MMM DD, YYYY")} (${s.fromNow()})`},zf=e=>{let{article:s,onEdit:t,onDelete:a}=e;return(0,te.jsxs)(Vs,{className:"group hover:shadow-lg transition-all duration-300 border-slate-200 hover:border-slate-300",children:[(0,te.jsx)(Ys,{className:"pb-3",children:(0,te.jsxs)("div",{className:"flex items-start justify-between",children:[(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsx)(Hs,{className:"text-lg font-semibold text-slate-900 truncate group-hover:text-slate-700 transition-colors",children:s.title}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 mt-2",children:[(0,te.jsxs)(qs,{variant:"outline",className:"text-xs",children:[(0,te.jsx)(It.A,{className:"w-3 h-3 mr-1"}),"Article"]}),s.created_date&&(0,te.jsxs)("span",{className:"text-xs text-slate-500",children:["Created ",Ff(s.created_date)]})]})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>t(s),className:"opacity-0 group-hover:opacity-100 transition-opacity",children:(0,te.jsx)(Ba.A,{className:"w-4 h-4"})}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>a(s),className:"opacity-0 group-hover:opacity-100 transition-opacity text-red-600 hover:text-red-800",children:(0,te.jsx)(Tc.A,{className:"w-4 h-4"})})]})]})}),(0,te.jsx)(Js,{className:"pt-0",children:(0,te.jsx)("p",{className:"text-slate-600 text-sm leading-relaxed line-clamp-3",children:s.content||"No content available"})})]})},Uf=e=>{let{article:s,isOpen:t,onClose:a,onSave:r,isCreating:n}=e;const[l,i]=(0,Y.useState)(""),[o,c]=(0,Y.useState)(""),[d,m]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{s?(i(s.title||""),c(s.content||"")):(i(""),c(""))}),[s,t]);return(0,te.jsx)(na,{open:t,onOpenChange:a,children:(0,te.jsxs)(da,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,te.jsx)(ma,{children:(0,te.jsxs)(xa,{className:"flex items-center",children:[(0,te.jsx)(It.A,{className:"w-5 h-5 mr-2"}),n?"Create New Article":"Edit Article"]})}),(0,te.jsxs)("div",{className:"space-y-6 py-4",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"title",children:"Title"}),(0,te.jsx)(Qs,{id:"title",value:l,onChange:e=>i(e.target.value),placeholder:"Enter article title...",className:"w-full"})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"content",children:"Content"}),(0,te.jsx)(Ui,{id:"content",value:o,onChange:e=>c(e.target.value),placeholder:"Enter article content...",className:"min-h-[400px] resize-none"}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"You can use markdown formatting for better presentation."})]}),(0,te.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,te.jsx)(Rs,{variant:"outline",onClick:a,children:"Cancel"}),(0,te.jsx)(Rs,{onClick:async()=>{if(l.trim()&&o.trim()){m(!0);try{await r({id:null==s?void 0:s.id,title:l.trim(),content:o.trim()}),a()}catch(e){}finally{m(!1)}}},disabled:d||!l.trim()||!o.trim(),children:d?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Wd.A,{className:"w-4 h-4 mr-2"}),n?"Create Article":"Save Changes"]})})]})]})]})})},Bf=e=>{let{categories:s,onSave:t}=e;const[a,r]=(0,Y.useState)([]),[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{r(s||[])}),[s]);const m=()=>{const e=n.trim();e&&!a.includes(e)&&(r([...a,e]),l(""))};return(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)(Hs,{className:"flex items-center",children:[(0,te.jsx)(qg.A,{className:"w-5 h-5 mr-2"}),"Internal Category Options"]}),!i&&(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>o(!0),children:[(0,te.jsx)(Ba.A,{className:"w-4 h-4 mr-2"}),"Edit"]})]})}),(0,te.jsx)(Js,{children:i?(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"flex space-x-2",children:[(0,te.jsx)(Qs,{value:n,onChange:e=>l(e.target.value),placeholder:"Add new internal category...",onKeyPress:e=>{"Enter"===e.key&&(e.preventDefault(),m())},className:"flex-1"}),(0,te.jsx)(Rs,{onClick:m,disabled:!n.trim(),children:(0,te.jsx)(ys.A,{className:"w-4 h-4"})})]}),(0,te.jsxs)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:[a.map(((e,s)=>(0,te.jsxs)("div",{className:"flex items-center justify-between p-2 bg-slate-50 rounded-lg",children:[(0,te.jsx)("span",{className:"text-sm text-slate-700",children:e}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>{return s=e,void r(a.filter((e=>e!==s)));var s},className:"text-red-600 hover:text-red-800 h-6 w-6 p-0",children:(0,te.jsx)(Ds.A,{className:"w-3 h-3"})})]},s))),0===a.length&&(0,te.jsx)("p",{className:"text-sm text-slate-500 text-center py-4",children:"No internal categories defined yet"})]})]}),(0,te.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,te.jsxs)(Rs,{variant:"outline",onClick:()=>{r(s||[]),l(""),o(!1)},children:[(0,te.jsx)(Ds.A,{className:"w-4 h-4 mr-2"}),"Cancel"]}),(0,te.jsx)(Rs,{onClick:async()=>{d(!0);try{await t(a),o(!1)}catch(e){}finally{d(!1)}},disabled:c,children:c?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Wd.A,{className:"w-4 h-4 mr-2"}),"Save Categories"]})})]})]}):(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("div",{className:"flex flex-wrap gap-2",children:a.length>0?a.map(((e,s)=>(0,te.jsxs)(qs,{variant:"outline",className:"text-xs",children:[(0,te.jsx)(qg.A,{className:"w-3 h-3 mr-1"}),e]},s))):(0,te.jsx)("div",{className:"text-sm text-slate-500 bg-slate-50 rounded-lg p-4 text-center w-full",children:"No internal categories defined yet"})}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"These categories can be assigned to support tickets for internal organization and tracking."})]})})]})},Wf=e=>{let{title:s,systemPrompt:t,onSave:a,promptKey:r}=e;const[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{l(t||"")}),[t]);return(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)(Hs,{className:"flex items-center",children:[(0,te.jsx)(Gd.A,{className:"w-5 h-5 mr-2"}),s]}),!i&&(0,te.jsxs)(Rs,{variant:"outline",size:"sm",onClick:()=>o(!0),children:[(0,te.jsx)(Ba.A,{className:"w-4 h-4 mr-2"}),"Edit"]})]})}),(0,te.jsx)(Js,{children:i?(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)(Ui,{value:n,onChange:e=>l(e.target.value),placeholder:`Enter ${s.toLowerCase()} for AI assistance...`,className:"min-h-[200px] resize-none"}),(0,te.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,te.jsxs)(Rs,{variant:"outline",onClick:()=>{l(t||""),o(!1)},children:[(0,te.jsx)(Ds.A,{className:"w-4 h-4 mr-2"}),"Cancel"]}),(0,te.jsx)(Rs,{onClick:async()=>{d(!0);try{await a(r,n),o(!1)}catch(e){}finally{d(!1)}},disabled:c,children:c?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Wd.A,{className:"w-4 h-4 mr-2"}),"Save Prompt"]})})]})]}):(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("div",{className:"bg-slate-50 rounded-lg p-4 border",children:(0,te.jsx)("pre",{className:"whitespace-pre-wrap text-sm text-slate-700 font-sans leading-relaxed",children:n||`No ${s.toLowerCase()} configured`})}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"response_system_prompt"===r?"This prompt guides the AI when responding to support questions.":"This prompt guides the AI when polishing and improving message grammar."})]})})]})},qf="support_templates",Vf=()=>{try{const e=localStorage.getItem(qf);return e?JSON.parse(e):[]}catch(e){return[]}},Yf=e=>{try{localStorage.setItem(qf,JSON.stringify(e)),window.dispatchEvent(new CustomEvent("templatesUpdated"))}catch(s){}},Hf=e=>{let{onTemplateUpdated:s}=e;const[t,a]=(0,Y.useState)([]),[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(""),[d,m]=(0,Y.useState)(""),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(null);(0,Y.useEffect)((()=>{a(Vf())}),[]);const g=()=>{n(null),i(!0),c(""),m("")};return(0,te.jsxs)("div",{className:"space-y-6",children:[(l||r)&&(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsxs)(Hs,{className:"flex items-center",children:[(0,te.jsx)(It.A,{className:"w-5 h-5 mr-2"}),l?"Create New Template":"Edit Template"]})}),(0,te.jsxs)(Js,{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"templateName",children:"Template Name"}),(0,te.jsx)(Qs,{id:"templateName",value:o,onChange:e=>c(e.target.value),placeholder:"Enter template name...",className:"w-full"})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"templateContent",children:"Template Content"}),(0,te.jsx)(Ui,{id:"templateContent",value:d,onChange:e=>m(e.target.value),placeholder:"Enter template content...",className:"min-h-[200px] resize-none"})]}),(0,te.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,te.jsxs)(Rs,{variant:"outline",onClick:()=>{n(null),i(!1),c(""),m("")},children:[(0,te.jsx)(Ds.A,{className:"w-4 h-4 mr-2"}),"Cancel"]}),(0,te.jsx)(Rs,{onClick:async()=>{if(o.trim()&&d.trim()){x(!0);try{const e={id:(null==r?void 0:r.id)||Date.now().toString(),name:o.trim(),content:d.trim(),created_date:(null==r?void 0:r.created_date)||(new Date).toISOString(),updated_date:(new Date).toISOString()},l=r?t.map((s=>s.id===r.id?e:s)):[...t,e];a(l),Yf(l),n(null),i(!1),c(""),m(""),s&&s(l)}catch(e){}finally{x(!1)}}},disabled:u||!o.trim()||!d.trim(),children:u?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Saving..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Wd.A,{className:"w-4 h-4 mr-2"}),l?"Create Template":"Save Changes"]})})]})]})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsx)(Ys,{children:(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)(Hs,{className:"flex items-center",children:[(0,te.jsx)(It.A,{className:"w-5 h-5 mr-2"}),"Response Templates (",t.length,")"]}),!l&&!r&&(0,te.jsxs)(Rs,{onClick:g,children:[(0,te.jsx)(ys.A,{className:"w-4 h-4 mr-2"}),"New Template"]})]})}),(0,te.jsx)(Js,{children:0===t.length?(0,te.jsxs)("div",{className:"text-center py-8",children:[(0,te.jsx)("div",{className:"mx-auto w-16 h-16 bg-slate-100 rounded-full flex items-center justify-center mb-4",children:(0,te.jsx)(It.A,{className:"w-8 h-8 text-slate-400"})}),(0,te.jsx)("h3",{className:"text-lg font-medium text-slate-900 mb-2",children:"No Templates Yet"}),(0,te.jsx)("p",{className:"text-slate-600 mb-4",children:"Create reusable response templates to speed up your workflow."}),(0,te.jsxs)(Rs,{onClick:g,children:[(0,te.jsx)(ys.A,{className:"w-4 h-4 mr-2"}),"Create First Template"]})]}):(0,te.jsx)("div",{className:"space-y-3",children:t.map((e=>(0,te.jsxs)("div",{className:"border border-slate-200 rounded-lg p-4 hover:bg-slate-50 transition-colors",children:[(0,te.jsxs)("div",{className:"flex items-start justify-between mb-2",children:[(0,te.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,te.jsx)("h4",{className:"text-sm font-medium text-slate-900 truncate",children:e.name}),(0,te.jsxs)("p",{className:"text-xs text-slate-500 mt-1",children:["Created ",Ff(e.created_date),e.updated_date!==e.created_date&&(0,te.jsxs)("span",{children:[" \u2022 Updated ",Ff(e.updated_date)]})]})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-2 ml-4",children:[(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>(e=>{n(e),i(!1),c(e.name),m(e.content)})(e),className:"h-8 w-8 p-0",children:(0,te.jsx)(Ba.A,{className:"w-4 h-4"})}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>(e=>{p(e)})(e),className:"h-8 w-8 p-0 text-red-600 hover:text-red-800",children:(0,te.jsx)(Tc.A,{className:"w-4 h-4"})})]})]}),(0,te.jsx)("div",{className:"text-sm text-slate-600 bg-slate-50 rounded p-3 border",children:(0,te.jsx)("div",{className:"line-clamp-3",children:e.content})})]},e.id)))})})]}),(0,te.jsx)(na,{open:!!h,onOpenChange:()=>p(null),children:(0,te.jsxs)(da,{children:[(0,te.jsx)(ma,{children:(0,te.jsxs)(xa,{className:"flex items-center text-red-600",children:[(0,te.jsx)(Ke.A,{className:"w-5 h-5 mr-2"}),"Delete Template"]})}),(0,te.jsx)("div",{className:"py-4",children:(0,te.jsxs)("p",{className:"text-slate-600",children:['Are you sure you want to delete the template "',null==h?void 0:h.name,'"? This action cannot be undone.']})}),(0,te.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,te.jsx)(Rs,{variant:"outline",onClick:()=>p(null),children:"Cancel"}),(0,te.jsxs)(Rs,{variant:"destructive",onClick:()=>{if(h){const e=t.filter((e=>e.id!==h.id));a(e),Yf(e),p(null),s&&s(e)}},children:[(0,te.jsx)(Tc.A,{className:"w-4 h-4 mr-2"}),"Delete Template"]})]})]})})]})};function Gf(){const e=(0,Z.Zp)(),[s,t]=(0,Y.useState)([]),[a,r]=(0,Y.useState)(""),[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)([]),[c,d]=(0,Y.useState)([]),[m,u]=(0,Y.useState)(!0),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)(""),[f,v]=(0,Y.useState)(null),[j,b]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(!1),[w,k]=(0,Y.useState)(null);(0,Y.useEffect)((()=>{_(),d(Vf())}),[]);const _=async()=>{try{u(!0),h(null);const[e,s]=await Promise.all([Zg.getArticles(),Zg.getAgentProperties()]);t((null==e?void 0:e.articles)||e||[]),r((null==s?void 0:s.response_system_prompt)||""),l((null==s?void 0:s.polish_system_prompt)||""),o((null==s?void 0:s.internal_category_options)||[])}catch(e){h("Failed to load documentation data. Please try again.")}finally{u(!1)}},S=()=>{v(null),N(!0),b(!0)},C=e=>{v(e),N(!1),b(!0)},A=e=>{k(e)},E=async(e,s)=>{const t={};t[e]=s,await Zg.updateAgentProperties(t),"response_system_prompt"===e?r(s):"polish_system_prompt"===e&&l(s)},I=s.filter((e=>{var s,t;return(null===(s=e.title)||void 0===s?void 0:s.toLowerCase().includes(p.toLowerCase()))||(null===(t=e.content)||void 0===t?void 0:t.toLowerCase().includes(p.toLowerCase()))}));return m?(0,te.jsx)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:(0,te.jsxs)("div",{className:"animate-pulse space-y-6",children:[(0,te.jsx)("div",{className:"h-8 bg-slate-200 rounded w-1/3"}),(0,te.jsxs)("div",{className:"grid grid-cols-1 gap-6",children:[(0,te.jsx)("div",{className:"h-48 bg-slate-200 rounded-lg"}),(0,te.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[1,2,3,4,5,6].map((e=>(0,te.jsx)("div",{className:"h-32 bg-slate-200 rounded-lg"},e)))})]})]})}):x?(0,te.jsx)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:(0,te.jsxs)("div",{className:"text-center py-16",children:[(0,te.jsx)("div",{className:"mx-auto w-24 h-24 bg-red-100 rounded-full flex items-center justify-center mb-6",children:(0,te.jsx)(Ke.A,{className:"w-12 h-12 text-red-500"})}),(0,te.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Error Loading Documentation"}),(0,te.jsx)("p",{className:"text-slate-600 mb-6",children:x}),(0,te.jsx)(Rs,{onClick:_,variant:"outline",children:"Try Again"})]})}):(0,te.jsxs)("div",{className:"w-full max-w-7xl mx-auto px-6 py-12",children:[(0,te.jsx)("div",{className:"mb-8",children:(0,te.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,te.jsxs)(Rs,{variant:"ghost",size:"sm",onClick:()=>e("/support/admin/conversations"),className:"text-slate-600 hover:text-slate-900",children:[(0,te.jsx)(pi.A,{className:"w-4 h-4 mr-2"}),"Back to list"]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"AI Settings"}),(0,te.jsx)("p",{className:"text-slate-600 mt-1",children:"Manage support articles and AI system prompts"})]})]}),(0,te.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,te.jsxs)(Rs,{onClick:_,variant:"outline",size:"sm",children:[(0,te.jsx)($c.A,{className:"w-4 h-4 mr-2"}),"Refresh"]}),(0,te.jsxs)(Rs,{onClick:S,children:[(0,te.jsx)(ys.A,{className:"w-4 h-4 mr-2"}),"New Article"]})]})]})}),(0,te.jsxs)(lr,{defaultValue:"articles",className:"space-y-6",children:[(0,te.jsxs)(ir,{className:"grid w-full grid-cols-4 lg:w-[800px]",children:[(0,te.jsxs)(or,{value:"articles",className:"flex items-center space-x-2",children:[(0,te.jsx)(fx.A,{className:"w-4 h-4"}),(0,te.jsxs)("span",{children:["Articles (",s.length,")"]})]}),(0,te.jsxs)(or,{value:"system-prompts",className:"flex items-center space-x-2",children:[(0,te.jsx)(Vi.A,{className:"w-4 h-4"}),(0,te.jsx)("span",{children:"System Prompts"})]}),(0,te.jsxs)(or,{value:"templates",className:"flex items-center space-x-2",children:[(0,te.jsx)(It.A,{className:"w-4 h-4"}),(0,te.jsx)("span",{children:"Templates"})]}),(0,te.jsxs)(or,{value:"internal-categories",className:"flex items-center space-x-2",children:[(0,te.jsx)(qg.A,{className:"w-4 h-4"}),(0,te.jsx)("span",{children:"Categories"})]})]}),(0,te.jsxs)(cr,{value:"articles",className:"space-y-6",children:[(0,te.jsx)("div",{className:"flex items-center space-x-4",children:(0,te.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,te.jsx)(Na.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),(0,te.jsx)(Qs,{placeholder:"Search articles...",value:p,onChange:e=>g(e.target.value),className:"pl-10"})]})}),0===I.length?(0,te.jsxs)("div",{className:"text-center py-16",children:[(0,te.jsx)("div",{className:"mx-auto w-24 h-24 bg-slate-100 rounded-full flex items-center justify-center mb-6",children:(0,te.jsx)(It.A,{className:"w-12 h-12 text-slate-400"})}),(0,te.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:p?"No Articles Found":"No Articles Yet"}),(0,te.jsx)("p",{className:"text-slate-600 max-w-md mx-auto mb-6",children:p?"No articles match your search criteria. Try adjusting your search terms.":"Get started by creating your first support article."}),!p&&(0,te.jsxs)(Rs,{onClick:S,children:[(0,te.jsx)(ys.A,{className:"w-4 h-4 mr-2"}),"Create First Article"]})]}):(0,te.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:I.map((e=>(0,te.jsx)(zf,{article:e,onEdit:C,onDelete:A},e.id)))})]}),(0,te.jsxs)(cr,{value:"system-prompts",className:"space-y-6",children:[(0,te.jsx)(Wf,{title:"Response System Prompt",systemPrompt:a,onSave:E,promptKey:"response_system_prompt"}),(0,te.jsx)(Wf,{title:"Polish System Prompt",systemPrompt:n,onSave:E,promptKey:"polish_system_prompt"})]}),(0,te.jsx)(cr,{value:"templates",className:"space-y-6",children:(0,te.jsx)(Hf,{onTemplateUpdated:e=>{d(e)}})}),(0,te.jsx)(cr,{value:"internal-categories",className:"space-y-6",children:(0,te.jsx)(Bf,{categories:i,onSave:async e=>{await Zg.updateAgentProperties({internal_category_options:e}),o(e)}})})]}),(0,te.jsx)(Uf,{article:f,isOpen:j,onClose:()=>b(!1),onSave:async e=>{y?await Zg.createArticle(e):await Zg.updateArticle(e.id,e),await _()},isCreating:y}),(0,te.jsx)(na,{open:!!w,onOpenChange:()=>k(null),children:(0,te.jsxs)(da,{children:[(0,te.jsx)(ma,{children:(0,te.jsxs)(xa,{className:"flex items-center text-red-600",children:[(0,te.jsx)(Ke.A,{className:"w-5 h-5 mr-2"}),"Delete Article"]})}),(0,te.jsx)("div",{className:"py-4",children:(0,te.jsxs)("p",{className:"text-slate-600",children:['Are you sure you want to delete "',null==w?void 0:w.title,'"? This action cannot be undone.']})}),(0,te.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,te.jsx)(Rs,{variant:"outline",onClick:()=>k(null),children:"Cancel"}),(0,te.jsxs)(Rs,{variant:"destructive",onClick:async()=>{if(w)try{await Zg.deleteArticle(w.id),await _(),k(null)}catch(x){}},children:[(0,te.jsx)(Tc.A,{className:"w-4 h-4 mr-2"}),"Delete Article"]})]})]})})]})}const Jf=(0,Y.createContext)();function Zf(e){var s;let{children:t,workspaceId:a}=e;const[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(null),[d,m]=(0,Y.useState)([]),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(null),v=(0,Y.useRef)(null),j=(0,Y.useCallback)((async()=>{try{i(!0),c(null);const e=await de.getDashboard(a);n(e),v.current&&v.current(),v.current=de.subscribeToDashboard(a,e,((s,t)=>{var a,r;const l={...e,...s,workspace:{...e.workspace,...s.workspace,is_personal:void 0!==(null===(a=s.workspace)||void 0===a?void 0:a.is_personal)?s.workspace.is_personal:null===(r=e.workspace)||void 0===r?void 0:r.is_personal}};n(l)}))}catch(e){c(e)}finally{i(!1)}}),[a]),b=(0,Y.useCallback)((async()=>{try{const e=await de.getAvailablePlans();m(e.plans||[])}catch(o){m([])}}),[]),y=(0,Y.useCallback)((async()=>{await j()}),[j]),N=(0,Y.useCallback)((()=>{var e;return!(null!=r&&null!==(e=r.workspace)&&void 0!==e&&e.is_personal)&&["owner","admin"].includes(null==r?void 0:r.user_role)}),[r]),w=(0,Y.useCallback)((()=>["owner","admin"].includes(null==r?void 0:r.user_role)),[r]),k=(0,Y.useCallback)((async(e,s)=>{x(!0);try{await de.inviteUser(e,s,a)}catch(o){throw o}finally{x(!1)}}),[a]),_=(0,Y.useCallback)((async(e,s)=>{x(!0);try{await de.updateMemberRole(e,s,a)}catch(o){throw o}finally{x(!1)}}),[a]),S=(0,Y.useCallback)((async(e,s)=>{x(!0);try{await de.updateMemberSeat(e,s,a)}catch(o){throw o}finally{x(!1)}}),[a]),C=(0,Y.useCallback)((e=>{f(e),p(!0)}),[]),A=(0,Y.useCallback)((()=>{p(!1),f(null)}),[]),E=(0,Y.useCallback)((async()=>{if(g){p(!1),x(!0);try{await de.removeMember(g.email,a),f(null)}catch(o){throw o}finally{x(!1)}}}),[g,a]),I=(0,Y.useCallback)((async(e,s,t)=>{x(!0);try{let n;if(n="buy"===t?await de.buySeats(e,s,a):await de.removeSeats(e,s,a),!n)throw new Error("Invalid response from server");if("stripe_checkout_required"===n.status)try{const e=await Tn.createWorkspaceCheckoutSession(n.workspace_id,n.pending_changes);if(e.subscription_updated);else{if(!e.url)throw new Error("No checkout URL received from billing service");window.location.href=e.url}}catch(r){throw r}}catch(o){throw o}finally{x(!1)}}),[a]);(0,Y.useEffect)((()=>(j(),b(),()=>{v.current&&v.current()})),[j,b]);const L={loading:l,error:o,actionLoading:u,availablePlans:d,currentWorkspace:null==r?void 0:r.workspace,plans:(null==r||null===(s=r.workspace)||void 0===s?void 0:s.plans)||[],members:(null==r?void 0:r.members)||[],userRole:(null==r?void 0:r.user_role)||"member",currentUser:null==r?void 0:r.current_user,workspaceId:a,showRemoveDialog:h,memberToRemove:g,loadDashboard:j,inviteUser:k,updateMemberRole:_,updateMemberSeat:S,showRemoveMemberDialog:C,hideRemoveMemberDialog:A,confirmRemoveMember:E,manageSeat:I,handleCheckoutSuccess:y,canInviteUsers:N,canManageSeats:w};return(0,te.jsx)(Jf.Provider,{value:L,children:t})}function Kf(){const e=(0,Y.useContext)(Jf);if(!e)throw new Error("useWorkspaceDashboard must be used within a WorkspaceDashboardProvider");return e}const Xf=e=>{let{users:s,onSelectUser:t,anchorElement:a,onClose:r}=e;const[n,l]=(0,Y.useState)({left:0,top:0,width:0}),i=(0,Y.useRef)(null);(0,Y.useEffect)((()=>{const e=()=>{if(!a)return;const e=a.getBoundingClientRect(),s=window.innerHeight,t=window.innerWidth,r=Math.max(e.width,300),n=s-e.bottom,i=e.top,o=n<192&&i>192;let c=e.left;c+r>t&&(c=t-r-10),c<10&&(c=10),l({left:c,top:o?e.top-192-4:e.bottom+4,width:r})};e();const s=()=>e(),t=()=>e();return window.addEventListener("scroll",s,!0),window.addEventListener("resize",t),()=>{window.removeEventListener("scroll",s,!0),window.removeEventListener("resize",t)}}),[a]),(0,Y.useEffect)((()=>{const e=e=>{i.current&&!i.current.contains(e.target)&&a&&!a.contains(e.target)&&r()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[r,a]);const o=(0,te.jsx)("div",{ref:i,className:"fixed z-[1000] bg-white border border-slate-200 rounded-md shadow-xl max-h-48 overflow-y-auto",style:{left:`${n.left}px`,top:`${n.top}px`,width:`${n.width}px`},children:s.map((e=>(0,te.jsx)("div",{className:"px-3 py-2 hover:bg-orange-50 cursor-pointer transition-colors border-b border-slate-100 last:border-b-0",onClick:()=>t(e.email),children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-orange-100 to-orange-200 rounded-full flex items-center justify-center",children:(0,te.jsx)(Mm.A,{className:"w-3 h-3 text-orange-600"})}),(0,te.jsxs)("div",{className:"flex flex-col",children:[(0,te.jsx)("span",{className:"text-sm font-medium text-slate-700 truncate max-w-[200px]",children:e.email}),"pending"===e.status&&(0,te.jsx)("span",{className:"text-xs text-orange-500 font-medium",children:"Pending invitation"})]})]})},e.email)))});return Xl.createPortal(o,document.body)},Qf=e=>{let{anchorElement:s,onClose:t}=e;const[a,r]=(0,Y.useState)({left:0,top:0,width:0}),n=(0,Y.useRef)(null);(0,Y.useEffect)((()=>{const e=()=>{if(!s)return;const e=s.getBoundingClientRect(),t=window.innerWidth,a=Math.max(e.width,300);let n=e.left;n+a>t&&(n=t-a-10),n<10&&(n=10),r({left:n,top:e.bottom+4,width:a})};e();const t=()=>e(),a=()=>e();return window.addEventListener("scroll",t,!0),window.addEventListener("resize",a),()=>{window.removeEventListener("scroll",t,!0),window.removeEventListener("resize",a)}}),[s]),(0,Y.useEffect)((()=>{const e=e=>{n.current&&!n.current.contains(e.target)&&s&&!s.contains(e.target)&&t()};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)}),[t,s]);const l=(0,te.jsx)("div",{ref:n,className:"fixed z-[1000] bg-white border border-slate-200 rounded-md shadow-xl",style:{left:`${a.left}px`,top:`${a.top}px`,width:`${a.width}px`},children:(0,te.jsx)("div",{className:"px-3 py-2 text-sm text-slate-500 text-center",children:"No users found"})});return Xl.createPortal(l,document.body)},ev=e=>{let{open:s,onOpenChange:t,planName:a}=e;const[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)(!1),[o,c]=(0,Y.useState)(null),[d,m]=(0,Y.useState)(new Set),[u,x]=(0,Y.useState)(null),[h,p]=(0,Y.useState)(""),[g,f]=(0,Y.useState)(null),{workspaceId:v,members:j}=Kf();(0,Y.useEffect)((()=>{s&&a?b():s||(x(null),p(""),f(null))}),[s,a]),(0,Y.useEffect)((()=>{p(""),f(null)}),[u]);const b=async()=>{try{i(!0),c(null),n(null);const e=await de.getSeatUsage(a,v);n(e.data||e)}catch(t){var e,s;c((null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||"Failed to fetch seat usage data")}finally{i(!1)}},y=async function(e,s){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const l=`${a}_${s}`;try{if(m((e=>new Set([...e,l]))),x(null),p(""),f(null),t)await de.updateMemberSeat(e,null,v);else{var i;const t=null==r||null===(i=r.plan)||void 0===i?void 0:i.price_id;if(!t)throw new Error("Plan price ID not found");await de.updateMemberSeat(e,t,v,s)}n((a=>{if(!a)return a;const r=a.seats.map((a=>a.assigned_user===e&&a.seat_number!==s?{...a,assigned_user:null,status:"available"}:a.seat_number===s?{...a,assigned_user:t?null:e,status:t?"available":"assigned"}:a)),n=r.filter((e=>"assigned"===e.status)).length,l=a.plan.total_seats-n;return{...a,seats:r,summary:{...a.summary,total_assigned:n,total_available:l},plan:{...a.plan,used_seats:n,available_seats:l}}}))}catch(u){var o,d;c((null===(o=u.response)||void 0===o||null===(d=o.data)||void 0===d?void 0:d.detail)||"Failed to assign user to seat")}finally{m((e=>{const s=new Set(e);return s.delete(l),s}))}},N=e=>"assigned"===e?(0,te.jsx)(Mm.A,{className:"w-3 h-3"}):(0,te.jsx)(Wa.A,{className:"w-3 h-3"});return(0,te.jsx)(na,{open:s,onOpenChange:t,children:(0,te.jsxs)(da,{className:"max-w-5xl max-h-[90vh] flex flex-col",children:[(0,te.jsxs)(ma,{className:"pb-3",children:[(0,te.jsxs)(xa,{className:"flex items-center gap-2 text-lg",children:[(0,te.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-orange-100 to-orange-200 rounded-full flex items-center justify-center",children:(0,te.jsx)(Wa.A,{className:"w-4 h-4 text-orange-600"})}),(0,te.jsxs)("span",{className:"font-semibold text-slate-800",children:[a," Seats Usage"]})]}),(0,te.jsx)(ha,{className:"text-slate-600 text-sm ml-10",children:"Detailed view of seat allocation and usage for this plan. Click available seats to assign users."})]}),l&&(0,te.jsx)("div",{className:"flex items-center justify-center p-8",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-orange-500"})}),o&&(0,te.jsx)("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:(0,te.jsx)("p",{className:"text-red-800 text-sm",children:o})}),r&&(0,te.jsxs)("div",{className:"flex flex-col flex-1 min-h-0",children:[(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3 mb-4",children:[(0,te.jsxs)(Vs,{className:"p-3 bg-gradient-to-br from-orange-50 to-orange-100 border-orange-200",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,te.jsx)("div",{className:"w-6 h-6 bg-orange-500 rounded-full flex items-center justify-center",children:(0,te.jsx)(Wa.A,{className:"w-3 h-3 text-white"})}),(0,te.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Total Seats"})]}),(0,te.jsx)("div",{className:"text-xl font-bold text-slate-900",children:r.plan.total_seats})]}),(0,te.jsxs)(Vs,{className:"p-3 bg-gradient-to-br from-green-50 to-green-100 border-green-200",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,te.jsx)("div",{className:"w-6 h-6 bg-green-500 rounded-full flex items-center justify-center",children:(0,te.jsx)(Mm.A,{className:"w-3 h-3 text-white"})}),(0,te.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Assigned"})]}),(0,te.jsx)("div",{className:"text-xl font-bold text-slate-900",children:r.summary.total_assigned})]}),(0,te.jsxs)(Vs,{className:"p-3 bg-gradient-to-br from-teal-50 to-teal-100 border-teal-200",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,te.jsx)("div",{className:"w-6 h-6 bg-teal-500 rounded-full flex items-center justify-center",children:(0,te.jsx)(ea.A,{className:"w-3 h-3 text-white"})}),(0,te.jsx)("span",{className:"text-xs font-semibold text-slate-700",children:"Period Usage"})]}),(0,te.jsxs)("div",{className:"text-xl font-bold text-slate-900",children:[r.summary.current_month_usage,"/",r.summary.monthly_limit||0]}),(0,te.jsx)("div",{className:"text-xs text-slate-500 mt-1 font-medium",children:r.summary.period})]})]}),(0,te.jsx)(Xs,{className:"mb-4"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"text-base font-semibold text-slate-900 mb-3",children:"Individual Seats"}),(0,te.jsxs)("div",{className:"border rounded-xl overflow-hidden bg-white shadow-sm",children:[(0,te.jsx)(Ia,{children:(0,te.jsx)(La,{className:"bg-gradient-to-r from-slate-50 to-slate-100 border-b border-slate-200",children:(0,te.jsxs)(Da,{children:[(0,te.jsx)(Pa,{className:"w-20 font-semibold text-slate-700 py-2",children:"Seat #"}),(0,te.jsx)(Pa,{className:"w-24 font-semibold text-slate-700 py-2",children:"Status"}),(0,te.jsx)(Pa,{className:"font-semibold text-slate-700 py-2",children:"Assigned User"}),(0,te.jsx)(Pa,{className:"w-32 text-right font-semibold text-slate-700 py-2",children:"Period Usage"})]})})}),(0,te.jsx)("div",{className:"max-h-96 overflow-y-auto",children:(0,te.jsx)(Ia,{children:(0,te.jsx)(Ta,{children:r.seats.map((e=>{const s=(()=>{if(!j)return[];let e=j.filter((e=>"active"===e.status||"pending"===e.status));return h.trim()&&(e=e.filter((e=>e.email.toLowerCase().includes(h.toLowerCase())))),e})(),t=d.has(`${a}_${e.seat_number}`),r=u===e.seat_number;return(0,te.jsxs)(Da,{className:"hover:bg-slate-50/50 transition-colors",children:[(0,te.jsxs)(Ma,{className:"font-semibold w-20 text-slate-600 py-2",children:["#",e.seat_number]}),(0,te.jsx)(Ma,{className:"w-24 py-2",children:(0,te.jsxs)(qs,{className:"text-xs font-medium "+(n=e.status,"assigned"===n?"bg-green-100 text-green-800 border-green-200 hover:bg-green-100 hover:text-green-800":"bg-slate-100 text-slate-600 border-slate-200 hover:bg-slate-100 hover:text-slate-600"),children:[N(e.status),(0,te.jsx)("span",{className:"ml-1 capitalize",children:e.status})]})}),(0,te.jsx)(Ma,{className:"py-2",children:t?(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-orange-100 to-orange-200 rounded-full flex items-center justify-center",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-3 w-3 border border-orange-400 border-t-transparent"})}),(0,te.jsx)("span",{className:"text-sm font-medium text-orange-600 animate-pulse",children:"Updating..."})]}):e.assigned_user?(0,te.jsxs)("div",{className:"flex items-center gap-2 group",children:[(0,te.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-green-100 to-green-200 rounded-full flex items-center justify-center",children:(0,te.jsx)(Mm.A,{className:"w-3 h-3 text-green-600"})}),(0,te.jsx)("div",{className:"flex-1 min-w-0",children:(0,te.jsx)("span",{className:"text-sm font-medium text-slate-700 truncate block",children:e.assigned_user})}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",disabled:t,onClick:()=>y(e.assigned_user,e.seat_number,!0),className:"h-6 w-6 p-0 opacity-0 group-hover:opacity-100 transition-opacity hover:bg-red-50 hover:text-red-600 rounded-full",title:"Remove user from seat",children:"\xd7"})]}):r?(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Na.A,{className:"absolute left-2 top-2.5 h-3 w-3 text-slate-400"}),(0,te.jsx)(Qs,{placeholder:"Search users...",value:h,onChange:e=>p(e.target.value),className:"pl-7 pr-8 h-8 text-sm border-orange-200 focus:border-orange-400 focus:ring-orange-200",autoFocus:!0,ref:e=>{e&&!g&&f(e)}}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>{x(null),p(""),f(null)},className:"absolute right-1 top-1 h-6 w-6 p-0 hover:bg-slate-100 rounded-full",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3 text-slate-400"})})]}),g&&s.length>0&&(0,te.jsx)(Xf,{users:s,onSelectUser:s=>y(s,e.seat_number),anchorElement:g,onClose:()=>{x(null),p(""),f(null)}}),g&&h&&0===s.length&&(0,te.jsx)(Qf,{anchorElement:g,onClose:()=>{x(null),p(""),f(null)}})]}):(0,te.jsxs)("div",{className:"flex items-center gap-2 group",children:[(0,te.jsx)("div",{className:"w-6 h-6 bg-gradient-to-br from-slate-100 to-slate-200 rounded-full flex items-center justify-center",children:(0,te.jsx)(vh.A,{className:"w-3 h-3 text-slate-500"})}),(0,te.jsx)("span",{className:"text-sm text-slate-500 cursor-pointer hover:text-orange-600 hover:underline transition-colors font-medium",onClick:s=>{x(e.seat_number)},title:"Click to assign user",children:"Available for assignment"})]})}),(0,te.jsx)(Ma,{className:"text-right w-32 py-2",children:(0,te.jsxs)("div",{className:"font-semibold text-slate-700 bg-slate-50 px-2 py-1 rounded-md inline-block text-sm",children:[e.current_month_usage,"/",e.monthly_limit||0]})})]},e.seat_number);var n}))})})})]})]})]})]})})},sv={Starter:(0,te.jsx)(vx.A,{className:"text-orange-500"}),Builder:(0,te.jsx)(Zr.A,{className:"text-teal-500"}),Pro:(0,te.jsx)(Sf.A,{className:"text-orange-400"}),Elite:(0,te.jsx)(Gd.A,{className:"text-purple-500"})};function tv(e){let{onRemoveSeats:s,onBuySeats:t}=e;const{plans:a,canManageSeats:r}=Kf(),[n,l]=(0,Y.useState)({open:!1,planName:null});return a&&0!==a.length?(0,te.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-8",children:[a.map((e=>(0,te.jsxs)(Vs,{className:"bg-white rounded-xl shadow-sm p-6 flex flex-col gap-3",children:[(0,te.jsxs)("div",{className:"flex items-start justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)("div",{className:"flex-shrink-0",children:sv[e.name]}),(0,te.jsxs)("span",{className:"font-semibold text-lg",children:[e.name," Seats"]})]}),r()&&(0,te.jsxs)(gr,{children:[(0,te.jsx)(fr,{asChild:!0,children:(0,te.jsx)(Rs,{variant:"ghost",size:"sm",className:"h-6 w-6 p-0 text-slate-400 hover:text-slate-600 hover:bg-transparent",children:(0,te.jsx)(Xa.A,{className:"h-3 w-3"})})}),(0,te.jsxs)(kr,{align:"end",className:"w-40",children:[(0,te.jsxs)(_r,{onClick:()=>{return s=e.name,void l({open:!0,planName:s});var s},className:"text-slate-700 hover:bg-slate-50 focus:bg-slate-50",children:[(0,te.jsx)(io.A,{className:"w-4 h-4 mr-2"}),"Seats Usage"]}),(0,te.jsx)(_r,{onClick:()=>{return s=e.name,void t(s);var s},className:"text-slate-700 hover:bg-slate-50 focus:bg-slate-50",children:"Add Seats"}),e.used_seats<e.total_seats&&(0,te.jsx)(_r,{onClick:()=>{return t=e.name,void s(t);var t},className:"text-slate-700 hover:bg-slate-50 focus:bg-slate-50",children:"Remove Seats"})]})]})]}),(0,te.jsxs)("div",{className:"text-2xl font-bold",children:[e.used_seats," / ",e.total_seats]}),(0,te.jsxs)("div",{className:"text-slate-500 text-sm",children:[e.available_seats," seats available"]})]},e.name))),r()&&(0,te.jsxs)(Vs,{className:"bg-gradient-to-br from-orange-50 to-teal-50 border-orange-200/50 rounded-xl shadow-sm p-6 flex flex-col justify-center items-center text-center hover:shadow-md transition-all duration-200 cursor-pointer",onClick:()=>t(),children:[(0,te.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,te.jsx)("div",{className:"flex-shrink-0",children:(0,te.jsx)(ys.A,{className:"w-6 h-6 text-orange-500"})}),(0,te.jsx)("span",{className:"font-semibold text-lg text-slate-900",children:"Buy More Seats"})]}),(0,te.jsx)("div",{className:"text-slate-600 text-sm",children:"Expand your workspace size"})]}),(0,te.jsx)(ev,{open:n.open,onOpenChange:()=>{l({open:!1,planName:null})},planName:n.planName})]}):(0,te.jsx)("div",{className:"mb-8",children:(0,te.jsx)(Vs,{className:"bg-gradient-to-br from-orange-50 to-teal-50 border-orange-200/50 rounded-xl shadow-sm p-8",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"mx-auto w-16 h-16 bg-orange-100 rounded-full flex items-center justify-center mb-4",children:(0,te.jsx)(Wa.A,{className:"w-8 h-8 text-orange-600"})}),(0,te.jsx)("h3",{className:"text-xl font-semibold text-slate-900 mb-2",children:"Get Started with Workspace Seats"}),(0,te.jsx)("p",{className:"text-slate-600 mb-6 max-w-md mx-auto",children:"Purchase seats to invite workspace members and start collaborating. Choose from our flexible plans designed for workspaces of all sizes."}),r()&&(0,te.jsxs)(Rs,{onClick:()=>t(),className:"bg-orange-500 hover:bg-orange-600 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:[(0,te.jsx)(ys.A,{className:"w-4 h-4 mr-2"}),"Buy Your First Seats"]})]})})})}const av={Starter:(0,te.jsx)(vx.A,{className:"text-orange-500"}),Builder:(0,te.jsx)(Zr.A,{className:"text-teal-500"}),Pro:(0,te.jsx)(Sf.A,{className:"text-orange-400"}),Elite:(0,te.jsx)(Gd.A,{className:"text-purple-500"})};function rv(e){var s;let{member:t}=e;const{currentUser:a,plans:r,userRole:n,canManageSeats:l,updateMemberRole:i,updateMemberSeat:o,showRemoveMemberDialog:c,actionLoading:d}=Kf(),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),{displayStatus:p,seatPlan:g,seatTypeName:f}=(0,Y.useMemo)((()=>{let e=t.status;if("pending"===t.status){t.invitation_expires_at&&new Date(t.invitation_expires_at)<new Date&&(e="expired")}const s=t.seat_type?r.find((e=>e.price_id===t.seat_type)):null;return{displayStatus:e,seatPlan:s,seatTypeName:s?s.name:null}}),[t,r]),v=["owner","admin"].includes(n),j=v&&t.email!==(null==a?void 0:a.email),b=t.email===(null==a?void 0:a.email),y=v&&!b&&("owner"===n||"admin"===n&&"owner"!==t.role),N=v&&!b&&("owner"===n||"admin"===n&&"owner"!==t.role),w="owner"===n&&!b,k=async e=>{if(t.role!==e&&v){u(!0);try{await i(t.email,e)}finally{u(!1)}}},_=async e=>{if(t.seat_type!==e&&l()){h(!0);try{await o(t.email,e)}finally{h(!1)}}};return(0,te.jsxs)("div",{className:"flex items-center justify-between py-4 border-b border-slate-100 last:border-b-0",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(qt,{className:"h-10 w-10",children:(0,te.jsx)(Yt,{className:"bg-slate-100 text-slate-700 font-bold text-sm",children:null===(s=t.email[0])||void 0===s?void 0:s.toUpperCase()})}),(0,te.jsx)("div",{children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("span",{className:"font-medium text-slate-900",children:t.email}),"pending"===p&&(0,te.jsx)(qs,{variant:"secondary",className:"bg-orange-100 text-orange-700 border-orange-200 text-xs",children:"Pending"}),"expired"===p&&(0,te.jsx)(qs,{variant:"destructive",className:"bg-red-100 text-red-700 border-red-200 text-xs",children:"Expired"})]})})]}),(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsxs)(gr,{children:[(0,te.jsx)(fr,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"outline",size:"sm",className:"min-w-[100px] justify-between",disabled:m||d||!y&&!N&&!w,children:[(0,te.jsxs)("div",{className:"flex items-center gap-1",children:[m?(0,te.jsx)(Je.A,{className:"h-3 w-3 animate-spin"}):(0,te.jsx)(Mm.A,{className:"h-3 w-3"}),(0,te.jsx)("span",{className:"capitalize",children:t.role})]}),(0,te.jsx)(ct.A,{className:"h-3 w-3"})]})}),(0,te.jsxs)(kr,{align:"end",className:"w-40",children:[(0,te.jsxs)(_r,{onClick:()=>k("member"),disabled:"member"===t.role||!y||m,children:[(0,te.jsx)(Mm.A,{className:"mr-2 h-4 w-4"}),"Member"]}),(0,te.jsxs)(_r,{onClick:()=>k("admin"),disabled:"admin"===t.role||!N||m,children:[(0,te.jsx)(Mm.A,{className:"mr-2 h-4 w-4"}),"Admin"]}),(0,te.jsxs)(_r,{onClick:()=>k("owner"),disabled:"owner"===t.role||!w||m,children:[(0,te.jsx)(Mm.A,{className:"mr-2 h-4 w-4"}),"Owner"]}),j&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"border-t border-slate-100 my-1"}),(0,te.jsxs)(_r,{onClick:()=>{c(t)},disabled:d||m,className:"text-red-600 hover:text-red-700 focus:text-red-700",children:[d?(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,te.jsx)(Mm.A,{className:"mr-2 h-4 w-4"}),"Remove Member"]})]})]})]}),(0,te.jsxs)(gr,{children:[(0,te.jsx)(fr,{asChild:!0,children:(0,te.jsxs)(Rs,{variant:"outline",size:"sm",className:"min-w-[120px] justify-between",disabled:x||d,children:[(0,te.jsx)("div",{className:"flex items-center gap-1",children:x?(0,te.jsx)(Je.A,{className:"h-3 w-3 animate-spin"}):f?(0,te.jsxs)(te.Fragment,{children:[av[f],(0,te.jsx)("span",{children:f})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Mm.A,{className:"h-3 w-3"}),(0,te.jsx)("span",{children:"No Seat"})]})}),(0,te.jsx)(ct.A,{className:"h-3 w-3"})]})}),(0,te.jsxs)(kr,{align:"end",className:"w-50",children:[(0,te.jsxs)(_r,{onClick:()=>_(null),disabled:!t.seat_type||x,children:[(0,te.jsx)(Mm.A,{className:"mr-2 h-4 w-4"}),"No Seat"]}),r.length>0&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"border-t border-slate-100 my-1"}),r.map((e=>(0,te.jsxs)(_r,{onClick:()=>_(e.price_id),disabled:t.seat_type===e.price_id||!l()||x||0===e.available_seats,className:0===e.available_seats?"opacity-50":"",children:[(0,te.jsx)("div",{className:"flex items-center mr-2 h-4 w-4",children:av[e.name]}),(0,te.jsxs)("div",{className:"flex flex-col",children:[(0,te.jsx)("span",{children:e.name}),(0,te.jsxs)("span",{className:"text-xs text-slate-500",children:[e.available_seats," available"]})]})]},e.price_id)))]})]})]})]})]})}function nv(e){let{onInviteUser:s,onBulkInvite:t}=e;const{currentOrganization:a,members:r,canInviteUsers:n}=Kf(),l=r&&r.length>0;return(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{className:"flex flex-row items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Wa.A,{className:"text-slate-400"}),(0,te.jsxs)(Hs,{children:["Members (",(null==r?void 0:r.length)||0,")"]})]}),n()&&(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsxs)(Rs,{variant:"outline",onClick:t,className:"text-orange-600 border-orange-200 hover:bg-orange-50",children:[(0,te.jsx)(zo.A,{className:"h-4 w-4 mr-2"}),"Bulk Invite"]}),(0,te.jsxs)(Rs,{onClick:s,children:[(0,te.jsx)(ys.A,{className:"h-4 w-4"}),"Invite User"]})]})]}),(0,te.jsx)(Js,{children:l?(0,te.jsx)("div",{className:"space-y-0",children:r.map((e=>(0,te.jsx)(rv,{member:e},e.id)))}):(0,te.jsxs)("div",{className:"flex flex-col items-center justify-center py-12",children:[(0,te.jsx)(Wa.A,{className:"text-slate-200 text-5xl mb-2"}),(0,te.jsx)("div",{className:"font-semibold text-lg",children:"No workspace members yet"}),(0,te.jsx)("div",{className:"text-slate-500",children:null!=a&&a.is_personal?"Personal workspaces contain only you":"Start by inviting your first workspace member"})]})})]})}function lv(e){let{isOpen:s,onClose:t,onInvite:a}=e;const{actionLoading:r}=Kf(),[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)("member"),[c,d]=(0,Y.useState)(""),m=()=>{l(""),o("member"),d(""),t()};return(0,te.jsx)(na,{open:s,onOpenChange:m,children:(0,te.jsxs)(da,{className:"max-w-md",children:[(0,te.jsx)(ma,{children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"rounded bg-teal-100 p-2",children:(0,te.jsx)(tc.A,{className:"text-teal-600 w-5 h-5"})}),(0,te.jsx)(xa,{className:"text-2xl font-bold",children:"Invite Workspace Member"})]})}),(0,te.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n.trim())if(n.includes("@"))try{d(""),await a(n.trim(),i),m()}catch(r){var s,t;d((null==r||null===(s=r.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail)||r.message||"Failed to invite user")}else d("Please enter a valid email address");else d("Email is required")},className:"space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Email Address"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(tc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-slate-400 w-4 h-4"}),(0,te.jsx)(Qs,{type:"email",placeholder:"colleague@company.com",value:n,onChange:e=>l(e.target.value),disabled:r,className:"pl-10 focus:ring-2 focus:ring-teal-500",autoFocus:!0})]})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Role"}),(0,te.jsxs)("select",{className:"w-full border rounded px-3 py-2 focus:ring-2 focus:ring-teal-500",value:i,onChange:e=>o(e.target.value),disabled:r,children:[(0,te.jsx)("option",{value:"member",children:"Member"}),(0,te.jsx)("option",{value:"admin",children:"Admin"})]})]}),c&&(0,te.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,te.jsx)("p",{className:"text-red-700 text-sm",children:c})}),(0,te.jsxs)(ua,{children:[(0,te.jsx)(Rs,{type:"button",variant:"outline",onClick:m,disabled:r,children:"Cancel"}),(0,te.jsx)(Rs,{type:"submit",className:"bg-teal-600 hover:bg-teal-700 text-white",disabled:r||!n.trim(),children:r?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending Invite..."]}):"Send Invite"})]})]})]})})}const iv=[{value:"member",label:"Member"},{value:"admin",label:"Admin"}];function ov(e){let{isOpen:s,onClose:t,onSuccess:a}=e;const{workspaceId:r,plans:n,availablePlans:l}=Kf(),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)("member"),[m,u]=(0,Y.useState)(null),[x,h]=(0,Y.useState)(""),[p,g]=(0,Y.useState)([]),[f,v]=(0,Y.useState)([]),[j,b]=(0,Y.useState)(!1),[y,N]=(0,Y.useState)(!1),[w,k]=(0,Y.useState)(!1),_=(0,Y.useRef)(),S=Y.useMemo((()=>{const e=[{value:null,label:"No seat"}];return l&&l.length>0&&e.push(...l.map((e=>({value:e.name.toLowerCase(),label:e.name})))),e}),[l]),C=e=>"text/csv"===e.type||e.name.endsWith(".csv")?(o(e),h(""),A(e),!0):(h("Please upload a CSV file"),!1),A=e=>{const s=new FileReader;s.onload=e=>{try{const s=e.target.result.split("\n").filter((e=>e.trim()));if(0===s.length)return void h("CSV file is empty");const t=s[0].split(",").map((e=>e.trim().toLowerCase()));if(!t.includes("email"))return void h('CSV must contain an "email" column');const a=[];for(let e=1;e<s.length;e++){const r=s[e].split(",").map((e=>e.trim())),n={};t.forEach(((e,s)=>{n[e]=r[s]||""})),n.email&&a.push({email:n.email,role:n.role||"",seat:n.seat||""})}if(0===a.length)return void h("No valid email addresses found in CSV");v(a),b(!0),h("")}catch(s){const e="string"==typeof s.message?s.message:"Unknown parsing error";h("Error parsing CSV file: "+e)}},s.readAsText(e)},E=async e=>{if(e.preventDefault(),i)if(0!==p.length){N(!0),h("");try{const e=new FileReader;e.onload=async e=>{try{const s=e.target.result.split("\n").filter((e=>e.trim())),t=s[0].split(",").map((e=>e.trim().toLowerCase())),n=[];for(let e=1;e<s.length;e++){const a=s[e].split(",").map((e=>e.trim())),r={};t.forEach(((e,s)=>{r[e]=a[s]||""})),r.email&&n.push({email:r.email,role:r.role||c,seat:r.seat||m})}I(n),await de.bulkInviteUsers(n,r),a&&a(),L()}catch(n){var s,t;let e="Failed to send bulk invitations";null!=n&&null!==(s=n.response)&&void 0!==s&&null!==(t=s.data)&&void 0!==t&&t.detail?"string"==typeof n.response.data.detail?e=n.response.data.detail:Array.isArray(n.response.data.detail)?e=n.response.data.detail.map((e=>e.msg||e.message||e)).join(", "):"object"==typeof n.response.data.detail&&(e=n.response.data.detail.msg||n.response.data.detail.message||JSON.stringify(n.response.data.detail)):null!=n&&n.message&&(e=n.message),h(e)}finally{N(!1)}},e.readAsText(i)}catch(n){var s,t;let e="Failed to send bulk invitations";null!=n&&null!==(s=n.response)&&void 0!==s&&null!==(t=s.data)&&void 0!==t&&t.detail?"string"==typeof n.response.data.detail?e=n.response.data.detail:Array.isArray(n.response.data.detail)?e=n.response.data.detail.map((e=>e.msg||e.message||e)).join(", "):"object"==typeof n.response.data.detail&&(e=n.response.data.detail.msg||n.response.data.detail.message||JSON.stringify(n.response.data.detail)):null!=n&&n.message&&(e=n.message),h(e),N(!1)}}else h("No valid invitations to send");else h("Please upload a CSV file")},I=e=>{const s={};if(e.forEach((e=>{e.seat&&"none"!==e.seat&&(s[e.seat]=(s[e.seat]||0)+1)})),0===Object.keys(s).length)return;const t=[],a=[],r=[];if(Object.entries(s).forEach((e=>{let[s,i]=e;const o=l.find((e=>e.name.toLowerCase()===s.toLowerCase()));if(!o)return void r.push(`Invalid seat type: ${s}. Available types: ${l.map((e=>e.name.toLowerCase())).join(", ")}`);const c=n.find((e=>e.name.toLowerCase()===s.toLowerCase()));c?c.available_seats<i&&t.push({seat_type:s,plan_name:c.name,requested:i,available:c.available_seats,needed:i-c.available_seats}):a.push({seat_type:s,plan_name:o.name,requested:i,available:0,needed:i})})),a.length>0||t.length>0||r.length>0){let e="\u{1f6ab} Cannot proceed with bulk invite - seat issues detected:\n\n";throw a.length>0&&(e+="\u{1f4cb} Plans Not Purchased:\n",a.forEach((s=>{e+=`\u25b6 ${s.plan_name} Plan: You need to purchase this plan first (${s.requested} seat${s.requested>1?"s":""} needed)\n`})),e+="\n"),t.length>0&&(e+="\u{1f4ca} Insufficient Seats:\n",t.forEach((s=>{e+=`\u25b6 ${s.plan_name} Plan: Need to purchase ${s.needed} more seat${s.needed>1?"s":""}\n`,e+=`   (You're trying to assign ${s.requested} seats, but only ${s.available} are available)\n`})),e+="\n"),(a.length>0||t.length>0)&&(e+="\u{1f4a1} Next Steps:\n",e+="1. Go to Workspace Settings \u2192 Seat Management\n",e+="2. Purchase the required plans/seats\n",e+="3. Return here to complete the bulk invite\n\n",e+="\u{1f504} Alternatively, you can reduce the number of seat assignments in your CSV file."),r.length>0&&(e+="\n\n\u274c Invalid Seat Types:\n"+r.join("\n")),new Error(e)}},L=()=>{o(null),d("member"),u(null),h(""),g([]),v([]),b(!1),N(!1),k(!1),_.current&&(_.current.value=""),t()};return(0,Y.useEffect)((()=>{if(f.length>0){const e=f.map((e=>({email:e.email,role:e.role||c,seat:e.seat||m})));g(e)}}),[c,m,f]),(0,te.jsx)(na,{open:s,onOpenChange:L,children:(0,te.jsxs)(da,{className:"max-w-2xl max-h-[90vh] overflow-hidden flex flex-col",children:[(0,te.jsx)(ma,{children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"rounded bg-orange-100 p-2",children:(0,te.jsx)(Wa.A,{className:"text-orange-600 w-5 h-5"})}),(0,te.jsx)(xa,{className:"text-2xl font-bold",children:"Bulk Invite Members"})]})}),(0,te.jsx)("div",{className:"flex-1 overflow-y-auto",children:(0,te.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsx)(at,{className:"text-sm font-medium text-slate-700",children:"CSV File"}),(0,te.jsxs)(Rs,{type:"button",variant:"outline",size:"sm",onClick:()=>{var e,s;const t=(null===(e=l[0])||void 0===e?void 0:e.name.toLowerCase())||"starter",a=(null===(s=l[1])||void 0===s?void 0:s.name.toLowerCase())||"pro",r=new Blob([`email,role,seat\nexample@company.com,member,${t}\nuser2@company.com,admin,${a}`],{type:"text/csv"}),n=window.URL.createObjectURL(r),i=document.createElement("a");i.href=n,i.download="bulk_invite_template.csv",i.click(),window.URL.revokeObjectURL(n)},className:"text-orange-600 border-orange-200 hover:bg-orange-50",children:[(0,te.jsx)(vo.A,{className:"h-4 w-4 mr-1.5"}),"Download Template"]})]}),(0,te.jsxs)("div",{className:"border-2 border-dashed border-slate-200 rounded-lg p-6 text-center hover:border-orange-300 transition-colors "+(w?"border-orange-300 bg-orange-50":""),onDragOver:e=>{e.preventDefault(),e.stopPropagation(),w||k(!0)},onDragEnter:e=>{e.preventDefault(),e.stopPropagation(),k(!0)},onDragLeave:e=>{e.preventDefault(),e.stopPropagation();const s=e.currentTarget.getBoundingClientRect(),t=e.clientX,a=e.clientY;(t<s.left||t>=s.right||a<s.top||a>=s.bottom)&&k(!1)},onDrop:e=>{e.preventDefault(),e.stopPropagation(),k(!1);const s=e.dataTransfer.files;if(s.length>0){const e=s[0];C(e)}},children:[(0,te.jsx)(zo.A,{className:"mx-auto h-8 w-8 mb-2 transition-colors "+(w?"text-orange-500":"text-slate-400")}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("p",{className:"text-sm transition-colors "+(w?"text-orange-600 font-medium":"text-slate-600"),children:w?"Drop your CSV file here":"Drag & drop a CSV file or click to upload"}),(0,te.jsxs)("p",{className:"text-xs text-slate-500",children:["CSV should contain columns: ",(0,te.jsx)("span",{className:"font-mono text-orange-600",children:"email, role, seat"})]}),(0,te.jsx)(Qs,{ref:_,type:"file",accept:".csv",onChange:e=>{const s=e.target.files[0];s&&C(s)},disabled:y,className:"max-w-xs mx-auto"})]}),i&&(0,te.jsxs)("div",{className:"mt-3 flex items-center justify-center gap-2 text-sm text-green-600",children:[(0,te.jsx)(It.A,{className:"h-4 w-4"}),i.name]})]}),(0,te.jsxs)(is,{children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4"}),(0,te.jsx)(cs,{className:"text-sm",children:"CSV format: email (required), role (optional), seat (optional). If role or seat are empty, default values below will be used."})]})]}),(0,te.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"defaultRole",className:"text-sm font-medium text-slate-700",children:"Default Role"}),(0,te.jsxs)(ut,{value:c,onValueChange:d,children:[(0,te.jsx)(pt,{id:"defaultRole",className:"h-11 border-slate-200 focus:ring-orange-500 focus:border-orange-500",children:(0,te.jsx)(ht,{placeholder:"Select default role"})}),(0,te.jsx)(vt,{children:iv.map((e=>(0,te.jsx)(bt,{value:e.value,className:"py-3",children:(0,te.jsx)("div",{className:"flex flex-col",children:(0,te.jsx)("span",{className:"font-medium",children:e.label})})},e.value)))})]})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"defaultSeat",className:"text-sm font-medium text-slate-700",children:"Default Seat"}),(0,te.jsxs)(ut,{value:m||"none",onValueChange:e=>u("none"===e?null:e),children:[(0,te.jsx)(pt,{id:"defaultSeat",className:"h-11 border-slate-200 focus:ring-orange-500 focus:border-orange-500",children:(0,te.jsx)(ht,{placeholder:"Select default seat"})}),(0,te.jsx)(vt,{children:S.map((e=>(0,te.jsx)(bt,{value:e.value||"none",className:"py-3",children:(0,te.jsx)("div",{className:"flex flex-col",children:(0,te.jsx)("span",{className:"font-medium",children:e.label})})},e.value||"none")))})]})]})]}),j&&p.length>0&&(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)(at,{className:"text-sm font-medium text-slate-700",children:["Preview (",p.length," invitation",1!==p.length?"s":"",")"]}),(0,te.jsx)("div",{className:"bg-slate-50 rounded-lg border border-slate-200 max-h-48 overflow-y-auto",children:(0,te.jsxs)("table",{className:"w-full text-sm",children:[(0,te.jsx)("thead",{className:"bg-slate-100 sticky top-0",children:(0,te.jsxs)("tr",{children:[(0,te.jsx)("th",{className:"text-left p-3 font-medium",children:"Email"}),(0,te.jsx)("th",{className:"text-left p-3 font-medium",children:"Role"}),(0,te.jsx)("th",{className:"text-left p-3 font-medium",children:"Seat"})]})}),(0,te.jsx)("tbody",{children:p.map(((e,s)=>(0,te.jsxs)("tr",{className:"border-t border-slate-200",children:[(0,te.jsx)("td",{className:"p-3 font-mono text-xs",children:e.email}),(0,te.jsx)("td",{className:"p-3 capitalize",children:e.role}),(0,te.jsx)("td",{className:"p-3 capitalize",children:e.seat||"No seat"})]},s)))})]})})]})]})}),x&&(0,te.jsxs)("div",{className:"px-6 pb-4 relative",children:[(0,te.jsxs)(is,{variant:"destructive",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4"}),(0,te.jsx)(cs,{className:"whitespace-pre-line text-sm pr-8",children:x})]}),(0,te.jsx)(Rs,{variant:"ghost",size:"sm",onClick:()=>h(""),className:"absolute top-5 right-9 h-5 w-5 p-0 text-red-600 hover:text-red-800 hover:bg-red-100/50 transition-colors flex items-center justify-center rounded-sm",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]}),(0,te.jsxs)(ua,{className:"gap-3 pt-4 border-t",children:[(0,te.jsx)(Rs,{variant:"outline",type:"button",onClick:L,disabled:y,children:"Cancel"}),(0,te.jsx)(Rs,{onClick:E,className:"bg-orange-600 hover:bg-orange-700 text-white",disabled:y||!i||0===p.length,children:y?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"w-4 h-4 border-2 border-white/30 border-t-white rounded-full animate-spin mr-2"}),"Sending Invitations..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Wa.A,{className:"w-4 h-4 mr-2"}),"Send ",p.length," Invitation",1!==p.length?"s":""]})})]})]})})}function cv(e){let{isOpen:s,onClose:t,onAction:a,action:r="buy",selectedPlanName:n=null}=e;const{plans:l,availablePlans:i,currentWorkspace:o,actionLoading:c}=Kf(),[d,m]=(0,Y.useState)(""),[u,x]=(0,Y.useState)(1),[h,p]=(0,Y.useState)(""),[g,f]=(0,Y.useState)(!1);(0,Y.useEffect)((()=>{if(s)if(p(""),f(!1),n)m(n);else if("buy"===r&&i.length>0){const e=i.find((e=>"pro"===e.name.toLowerCase()));m(e?e.name:i[0].name)}else if("remove"===r&&l.length>0){var e;m((null===(e=l[0])||void 0===e?void 0:e.name)||"")}}),[s,r,i,l,n]);const v=()=>{m(""),x(1),p(""),f(!1),t()},j="buy"===r?i:l,b=j.find((e=>e.name===d)),y=c||g,N=o&&!o.is_personal,w=d&&u>=1&&("buy"===r||"remove"===r&&b&&u<=b.available_seats);return(0,te.jsx)(na,{open:s,onOpenChange:v,children:(0,te.jsxs)(da,{className:"max-w-md",children:[(0,te.jsx)(ma,{children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("div",{className:"buy"===r?"rounded bg-teal-100 p-2":"rounded bg-red-100 p-2",children:(0,te.jsx)(Wa.A,{className:"buy"===r?"text-teal-600 w-5 h-5":"text-red-600 w-5 h-5"})}),(0,te.jsx)(xa,{className:"text-2xl font-bold",children:"buy"===r?"Purchase Seats":"Remove Seats"})]})}),c&&!g?(0,te.jsx)("div",{className:"flex items-center justify-center py-8",children:(0,te.jsxs)("div",{className:"flex flex-col items-center gap-3",children:[(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin text-teal-600"}),(0,te.jsx)("p",{className:"text-slate-600",children:"Loading plans..."})]})}):(0,te.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),!d||u<1)p("Please select a valid plan and enter a quantity of at least 1");else{if("remove"===r){const e=l.find((e=>e.name===d));if(e&&u>e.available_seats)return void p(`Cannot remove ${u} seat${u>1?"s":""}. Only ${e.available_seats} seat${e.available_seats>1?"s are":" is"} available to remove.`);if(e&&0===e.available_seats)return void p(`No ${d} seats are available to remove.`)}try{p(""),f(!0),await a(d,u),v()}catch(n){var s,t;const e=(null==n||null===(s=n.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail)||n.message||`Failed to ${r} seats. Please try again.`;p(e)}finally{f(!1)}}},className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex gap-4",children:[(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Seat Type"}),(0,te.jsx)("select",{className:"w-full border rounded px-3 py-2 focus:ring-2 focus:ring-teal-500",value:d,onChange:e=>m(e.target.value),disabled:y,children:0===j.length?(0,te.jsx)("option",{children:"buy"===r?"No plans available":"No seats to remove"}):j.map((e=>(0,te.jsxs)("option",{value:e.name,children:[e.name," ","remove"===r?`(${e.available_seats} available)`:""]},e.name)))})]}),(0,te.jsxs)("div",{className:"flex-1",children:[(0,te.jsx)("label",{className:"block text-sm font-medium text-slate-700 mb-1",children:"Quantity"}),(0,te.jsx)("input",{type:"number",min:1,max:"remove"===r?(null==b?void 0:b.available_seats)||0:void 0,className:"w-full border rounded px-3 py-2 focus:ring-2 focus:ring-teal-500",value:u,onChange:e=>x(Math.max(1,Number(e.target.value))),disabled:y})]})]}),(0,te.jsxs)("div",{className:"bg-slate-50 rounded-xl p-4 border",children:[(0,te.jsxs)("div",{className:"flex justify-between text-slate-600 text-sm mb-1",children:[(0,te.jsx)("span",{children:"Seat Type"}),(0,te.jsx)("span",{className:"font-medium",children:d||"None selected"})]}),"buy"===r&&(null==b?void 0:b.price)&&(0,te.jsxs)("div",{className:"flex justify-between text-slate-600 text-sm mb-1",children:[(0,te.jsx)("span",{children:"Price per seat"}),(0,te.jsxs)("span",{className:"font-medium",children:["$",b.price,"/month"]})]}),(0,te.jsxs)("div",{className:"flex justify-between text-slate-600 text-sm mb-1",children:[(0,te.jsx)("span",{children:"Quantity"}),(0,te.jsxs)("span",{className:"font-medium",children:[u," seat",u>1?"s":""]})]}),"remove"===r&&b&&(0,te.jsxs)("div",{className:"flex justify-between text-slate-600 text-sm mb-1",children:[(0,te.jsx)("span",{children:"Available to remove"}),(0,te.jsxs)("span",{className:"font-medium",children:[b.available_seats," seat",b.available_seats>1?"s":""]})]}),(0,te.jsx)("hr",{className:"my-2"}),(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"font-bold text-lg",children:"buy"===r?"Total Cost":"Action"}),(0,te.jsx)("span",{className:"buy"===r?"font-bold text-2xl text-green-600":"font-bold text-2xl text-red-600",children:"buy"===r&&null!=b&&b.price?`$${(b.price*u).toLocaleString()}/month`:`${"buy"===r?"+":"-"}${u} seat${u>1?"s":""}`})]})]}),N&&(0,te.jsx)("div",{className:"bg-teal-50 border border-teal-200 rounded-lg p-3",children:(0,te.jsxs)("p",{className:"text-teal-800 text-sm",children:[(0,te.jsx)(ur.A,{className:"inline w-4 h-4 mr-1"}),"buy"===r?null!=o&&o.stripe_subscription_id?"Seats will be added immediately to your existing subscription.":"You'll be redirected to Stripe checkout to complete your payment. Seats will be added only after successful payment.":null!=o&&o.stripe_subscription_id?"Changes will be applied immediately to your existing subscription.":"You'll be redirected to Stripe billing to update your subscription. Changes will be applied after confirmation."]})}),h&&(0,te.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,te.jsx)("p",{className:"text-red-700 text-sm",children:h})}),(0,te.jsxs)(ua,{children:[(0,te.jsx)(Rs,{type:"button",variant:"outline",onClick:v,disabled:y,children:"Cancel"}),(0,te.jsx)(Rs,{type:"submit",className:"buy"===r?"bg-teal-600 hover:bg-teal-700 text-white":"bg-red-600 hover:bg-red-700 text-white",disabled:y||!w,children:y?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"buy"===r?"Processing...":"Removing..."]}):"buy"===r?"Purchase Seats":"Remove Seats"})]})]})]})})}function dv(){const{currentWorkspace:e,userRole:s,loading:t,actionLoading:a,inviteUser:r,manageSeat:n,handleCheckoutSuccess:l,showRemoveDialog:i,memberToRemove:o,hideRemoveMemberDialog:c,confirmRemoveMember:d}=Kf(),[m,u]=(0,J.useSearchParams)(),x=(0,Z.Zp)(),[h,p]=(0,Y.useState)(!1),[g,f]=(0,Y.useState)(!1),[v,j]=(0,Y.useState)(!1),[b,y]=(0,Y.useState)("buy"),[N,w]=(0,Y.useState)(null);(0,Y.useEffect)((()=>{const e=m.get("success"),s=m.get("subscription_update");"true"!==e&&"success"!==s||(m.delete("success"),m.delete("subscription_update"),u(m,{replace:!0}),l())}),[m,u,l]);const k=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;y(e),s?(w(s),j(!0)):(w(null),j(!0))};return t?(0,te.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,te.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-t-2 border-b-2 border-teal-500"})}):e?!e||e.is_personal||["owner","admin"].includes(s)?(0,te.jsxs)("div",{className:"container mx-auto px-4 sm:px-6 lg:px-8 py-6 sm:py-8 min-h-screen flex flex-col max-w-6xl",children:[(0,te.jsxs)("div",{className:"mb-8 relative",children:[(0,te.jsxs)("h1",{className:"text-4xl font-bold text-slate-900 mb-1",children:[e.name," Workspace Dashboard"]}),(0,te.jsx)("p",{className:"text-slate-500 text-lg",children:"Manage your workspace and seats"}),(0,te.jsx)("div",{className:"absolute -bottom-2.5 left-0 w-48 h-0.5 bg-orange-500 rounded-full"})]}),(0,te.jsx)(tv,{onRemoveSeats:e=>k("remove",e),onBuySeats:e=>k("buy",e)}),(0,te.jsx)(nv,{onInviteUser:()=>p(!0),onBulkInvite:()=>f(!0)}),(0,te.jsx)(lv,{isOpen:h,onClose:()=>p(!1),onInvite:async(e,s)=>{try{await r(e,s),p(!1)}catch(t){}}}),(0,te.jsx)(ov,{isOpen:g,onClose:()=>f(!1),onSuccess:()=>{}}),(0,te.jsx)(cv,{isOpen:v,onClose:()=>{j(!1),w(null)},onAction:async(e,s)=>{try{const t="remove"===b&&N?N:e;await n(t,s,b),j(!1),w(null)}catch(t){}},action:b,selectedPlanName:N}),(0,te.jsx)(Bm,{open:i,onOpenChange:c,children:(0,te.jsxs)(Ym,{children:[(0,te.jsxs)(Hm,{children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Zc.A,{className:"h-5 w-5 text-orange-500"}),(0,te.jsx)(Jm,{children:"Remove Member"})]}),(0,te.jsxs)(Zm,{className:"space-y-2 pt-2",children:[(0,te.jsxs)("p",{children:["Are you sure you want to remove ",(0,te.jsx)("strong",{children:null==o?void 0:o.email})," from this workspace?"]}),(0,te.jsx)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-3",children:(0,te.jsxs)("div",{className:"flex items-start gap-2",children:[(0,te.jsx)(Zc.A,{className:"h-4 w-4 text-orange-600 mt-0.5 flex-shrink-0"}),(0,te.jsxs)("div",{className:"text-sm text-orange-800",children:[(0,te.jsx)("strong",{children:"Warning:"})," This user will no longer have access to workspace apps and will be removed from all workspace applications with restricted access."]})]})})]})]}),(0,te.jsxs)(Gm,{children:[(0,te.jsx)(Xm,{children:"Cancel"}),(0,te.jsx)(Km,{onClick:d,className:"bg-red-600 hover:bg-red-700 focus:ring-red-600",children:"Remove Member"})]})]})})]}):(0,te.jsx)("div",{className:"flex items-center justify-center min-h-screen",children:(0,te.jsxs)("div",{className:"text-center max-w-md mx-auto p-8",children:[(0,te.jsx)(Ls.A,{className:"mx-auto h-16 w-16 text-slate-400 mb-4"}),(0,te.jsx)("h2",{className:"text-2xl font-bold text-slate-900 mb-2",children:"Access Restricted"}),(0,te.jsxs)("p",{className:"text-slate-500 mb-6",children:["You don't have permission to access the workspace dashboard for ",(0,te.jsx)("strong",{children:e.name}),". Only workspace administrators and owners can manage workspace settings."]}),(0,te.jsx)("button",{onClick:()=>x("/"),className:"bg-teal-600 hover:bg-teal-700 text-white px-6 py-2 rounded-lg font-medium transition-colors",children:"Go to Home"})]})}):(0,te.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)(Ph.A,{className:"mx-auto h-12 w-12 text-slate-400 mb-4"}),(0,te.jsx)("h2",{className:"text-xl font-bold text-slate-900 mb-2",children:"Workspace Not Found"}),(0,te.jsx)("p",{className:"text-slate-500",children:"The requested workspace could not be found or you don't have access to it."})]})})}function mv(){const{workspaceId:e}=(0,Z.g)();return(0,te.jsx)(Zf,{workspaceId:e,children:(0,te.jsx)(dv,{})})}function uv(){const e=(0,Z.Zp)(),[s,t]=(0,Y.useState)(""),[a,r]=(0,Y.useState)(!1),[n,l]=(0,Y.useState)("");return(0,te.jsx)("div",{className:"min-h-screen p-8",children:(0,te.jsxs)("div",{className:"max-w-2xl mx-auto",children:[(0,te.jsxs)("div",{className:"mb-8",children:[(0,te.jsxs)(Rs,{variant:"ghost",onClick:()=>e(-1),className:"mb-4 text-slate-600 hover:text-slate-800",children:[(0,te.jsx)(pi.A,{className:"mr-2 h-4 w-4"}),"Back"]}),(0,te.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,te.jsx)("div",{className:"rounded-lg bg-orange-100 p-3",children:(0,te.jsx)(Wa.A,{className:"h-6 w-6 text-orange-600"})}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Create a Workspace"}),(0,te.jsx)("p",{className:"text-slate-600",children:"Start collaborating with your workspace members"})]})]})]}),(0,te.jsxs)(Vs,{className:"shadow-sm",children:[(0,te.jsx)(Ys,{children:(0,te.jsxs)(Hs,{className:"flex items-center gap-2",children:[(0,te.jsx)(Wa.A,{className:"h-5 w-5 text-slate-600"}),"Workspace Information"]})}),(0,te.jsx)(Js,{children:(0,te.jsxs)("form",{onSubmit:async t=>{if(t.preventDefault(),s.trim()){r(!0),l("");try{const t=(await de.createWorkspace(s.trim())).workspace_id;e(`/workspace/${t}`)}catch(i){var a,n;const e=(null==i||null===(a=i.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.detail)||i.message||"Failed to create workspace";e.includes("Workspace limit reached")?l("Workspace limit reached. You can create a maximum of 3 workspaces."):l(e)}finally{r(!1)}}else l("Workspace name is required")},className:"space-y-6",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsxs)(at,{htmlFor:"workspaceName",className:"text-sm font-medium text-slate-700",children:["Workspace Name ",(0,te.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,te.jsx)(Qs,{id:"workspaceName",type:"text",placeholder:"Enter your workspace name",value:s,onChange:e=>t(e.target.value),disabled:a,className:"w-full",maxLength:100}),(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"Choose a name that represents your workspace"})]}),n&&(0,te.jsx)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-md",children:(0,te.jsx)("p",{className:"text-sm text-red-600",children:n})}),(0,te.jsxs)("div",{className:"flex gap-3",children:[(0,te.jsx)(Rs,{type:"button",variant:"outline",onClick:()=>e(-1),disabled:a,className:"flex-1",children:"Cancel"}),(0,te.jsx)(Rs,{type:"submit",disabled:a||!s.trim(),className:"flex-1 bg-orange-500 hover:bg-orange-600 text-white",children:a?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)("div",{className:"animate-spin rounded-full h-4 w-4 border-t-2 border-b-2 border-white mr-2"}),"Creating Workspace..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Wa.A,{className:"mr-2 h-4 w-4"}),"Create Workspace"]})})]})]})})]}),(0,te.jsx)(Vs,{className:"mt-6 bg-teal-50 border-teal-200",children:(0,te.jsx)(Js,{className:"pt-6",children:(0,te.jsxs)("div",{className:"flex items-start gap-3",children:[(0,te.jsx)("div",{className:"rounded-full bg-teal-100 p-2 mt-0.5",children:(0,te.jsx)(Wa.A,{className:"h-4 w-4 text-teal-600"})}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"font-medium text-teal-900 mb-1",children:"What happens next?"}),(0,te.jsxs)("ul",{className:"text-sm text-teal-800 space-y-1",children:[(0,te.jsx)("li",{children:"\u2022 You'll be the workspace owner with full management permissions"}),(0,te.jsx)("li",{children:"\u2022 You can invite workspace members and manage seats"}),(0,te.jsx)("li",{children:"\u2022 Access your workspace dashboard to get started"})]})]})]})})})]})})}const xv=()=>{var e,s,t,a;const[r,n]=(0,Y.useState)(null),[l,i]=(0,Y.useState)(!0),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)(null),u=(0,Z.zy)(),x=(0,Z.Zp)(),{user:h,logout:p}=ne(),{switchActiveWorkspace:g,refetchWorkspaces:f}=xe(),v=new URLSearchParams(u.search).get("token");(0,Y.useEffect)((()=>{if(!v)return m("Invalid invitation link"),void i(!1);j()}),[v]);const j=async()=>{try{const e=await de.getInvitationDetails(v);n(e)}catch(t){var e,s;404===(null===(e=t.response)||void 0===e?void 0:e.status)?m("Invitation not found"):410===(null===(s=t.response)||void 0===s?void 0:s.status)?m("This invitation has expired"):m("Failed to load invitation details")}finally{i(!1)}};return l?(0,te.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center",children:(0,te.jsxs)("div",{className:"flex items-center gap-3 text-slate-600",children:[(0,te.jsx)(Je.A,{className:"h-6 w-6 animate-spin"}),(0,te.jsx)("span",{children:"Loading invitation..."})]})}):d?(0,te.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:(0,te.jsxs)(Vs,{className:"w-full max-w-md",children:[(0,te.jsxs)(Ys,{className:"text-center",children:[(0,te.jsx)("div",{className:"mx-auto w-12 h-12 bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,te.jsx)(Ke.A,{className:"h-6 w-6 text-red-600"})}),(0,te.jsx)(Hs,{className:"text-red-900",children:"Invitation Error"}),(0,te.jsx)(Gs,{className:"text-red-600",children:d})]}),(0,te.jsx)(Js,{children:(0,te.jsx)(Rs,{onClick:()=>x("/"),className:"w-full",variant:"outline",children:"Go to Homepage"})})]})}):(0,te.jsx)("div",{className:"min-h-screen bg-slate-50 flex items-center justify-center p-4",children:(0,te.jsxs)(Vs,{className:"w-full max-w-lg",children:[(0,te.jsxs)(Ys,{className:"text-center",children:[(0,te.jsx)("div",{className:"mx-auto w-16 h-16 bg-gradient-to-br from-orange-400 to-orange-600 rounded-full flex items-center justify-center mb-4",children:(0,te.jsx)(Wa.A,{className:"h-8 w-8 text-white"})}),(0,te.jsx)(Hs,{className:"text-2xl text-slate-900",children:"You're Invited!"}),(0,te.jsx)(Gs,{className:"text-slate-600",children:"Join your workspace and start collaborating"})]}),(0,te.jsxs)(Js,{className:"space-y-6",children:[(0,te.jsxs)("div",{className:"bg-slate-50 rounded-lg p-4 space-y-3",children:[(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(Wa.A,{className:"h-5 w-5 text-slate-500"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"font-semibold text-slate-900",children:r.workspace.name}),(0,te.jsx)("p",{className:"text-sm text-slate-600",children:r.workspace.domain})]})]}),(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(tc.A,{className:"h-5 w-5 text-slate-500"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"Invited as"}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("span",{className:"font-medium text-slate-900",children:r.email}),(0,te.jsx)(qs,{className:(e=>{switch(e){case"owner":return"bg-purple-100 text-purple-800 hover:bg-purple-200";case"admin":return"bg-blue-100 text-blue-800 hover:bg-blue-200";case"member":return"bg-green-100 text-green-800 hover:bg-green-200";default:return"bg-slate-100 text-slate-800 hover:bg-slate-200"}})(r.role),children:r.role})]})]})]}),r.expires_at&&(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsx)(At.A,{className:"h-5 w-5 text-slate-500"}),(0,te.jsxs)("div",{children:[(0,te.jsx)("p",{className:"text-sm text-slate-600",children:"Expires"}),(0,te.jsx)("p",{className:"font-medium text-slate-900",children:(e=>{if(!e)return"";return new Date(e).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})})(r.expires_at)})]})]})]}),(null==h||null===(e=h.email)||void 0===e?void 0:e.toLowerCase())!==(null==r||null===(s=r.email)||void 0===s?void 0:s.toLowerCase())&&(0,te.jsxs)(is,{className:"border-amber-200 bg-amber-50",children:[(0,te.jsx)(Ke.A,{className:"h-4 w-4 text-amber-600"}),(0,te.jsx)(cs,{className:"text-amber-800",children:(0,te.jsxs)("div",{className:"flex flex-col gap-3",children:[(0,te.jsxs)("div",{children:["This invitation was sent to ",(0,te.jsx)("strong",{children:r.email}),", but you're logged in as ",(0,te.jsx)("strong",{children:h.email}),". Please log in with the correct account to accept this invitation."]}),(0,te.jsx)(Rs,{onClick:async()=>{try{await p(),Ga.toast.success("Logged out successfully. Please log in with the correct email address."),x("/login")}catch(e){Ga.toast.error("Failed to log out")}},size:"sm",className:"self-start bg-amber-600 hover:bg-amber-700 text-white",disabled:o,children:o?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-3 w-3 animate-spin"}),"Logging out..."]}):"Logout & Login with Correct Email"})]})})]}),(null==h||null===(t=h.email)||void 0===t?void 0:t.toLowerCase())===(null==r||null===(a=r.email)||void 0===a?void 0:a.toLowerCase())&&(0,te.jsxs)("div",{className:"flex gap-3",children:[(0,te.jsx)(Rs,{onClick:async()=>{var e,s;if((null==h||null===(e=h.email)||void 0===e?void 0:e.toLowerCase())===(null==r||null===(s=r.email)||void 0===s?void 0:s.toLowerCase())){c(!0);try{var t;const e=await de.acceptInvitation(v);await f(),null!==(t=e.workspace)&&void 0!==t&&t.id&&g(e.workspace.id),Ga.toast.success(`Welcome to ${e.workspace.name}!`),x("/")}catch(l){var a,n;const e=(null===(a=l.response)||void 0===a||null===(n=a.data)||void 0===n?void 0:n.detail)||l.message||"Failed to accept invitation";Ga.toast.error(e)}finally{c(!1)}}else Ga.toast.error("This invitation is for a different email address")},className:"flex-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 text-white",disabled:o,children:o?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Accepting..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Ed.A,{className:"mr-2 h-4 w-4"}),"Accept Invitation"]})}),(0,te.jsx)(Rs,{onClick:async()=>{c(!0);try{await de.declineInvitation(v),Ga.toast.success("Invitation declined"),x("/")}catch(t){var e,s;const a=(null===(e=t.response)||void 0===e||null===(s=e.data)||void 0===s?void 0:s.detail)||t.message||"Failed to decline invitation";Ga.toast.error(a)}finally{c(!1)}},variant:"outline",className:"flex-1 border-slate-300 text-slate-700 hover:bg-slate-50",disabled:o,children:o?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Declining..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Fd.A,{className:"mr-2 h-4 w-4"}),"Decline"]})})]}),(0,te.jsx)("div",{className:"text-center",children:(0,te.jsx)("p",{className:"text-xs text-slate-500",children:"If you didn't expect this invitation, you can safely ignore it."})})]})]})})};var hv=t(12671),pv=t(54203),gv=t(72528);const fv={primary:"#0ea5e9",secondary:"#64748b",success:"#10b981",warning:"#f59e0b",danger:"#ef4444",purple:"#8b5cf6",teal:"#14b8a6",orange:"#f97316"},vv=[fv.primary,fv.teal,fv.purple,fv.warning,fv.orange,fv.danger],jv=e=>{let{title:s,value:t,description:a,icon:r,trend:n,color:l=fv.primary}=e;return(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,te.jsx)(Hs,{className:"text-sm font-medium",children:s}),(0,te.jsx)(r,{className:"h-4 w-4",style:{color:l}})]}),(0,te.jsxs)(Js,{children:[(0,te.jsx)("div",{className:"text-2xl font-bold",children:t}),a&&(0,te.jsx)("p",{className:"text-xs text-muted-foreground",children:a}),n&&(0,te.jsxs)("div",{className:"flex items-center text-xs mt-2",children:[(0,te.jsx)(ea.A,{className:"h-3 w-3 mr-1",style:{color:n>0?fv.success:fv.danger}}),(0,te.jsxs)("span",{style:{color:n>0?fv.success:fv.danger},children:[Math.abs(n),"% from last period"]})]})]})]})},bv=e=>{let{ticketClass:s}=e;return(0,te.jsxs)(Vs,{className:"hover:shadow-lg transition-shadow",children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{className:"text-lg",children:s.class_name}),(0,te.jsx)(Gs,{children:s.description})]}),(0,te.jsxs)(Js,{className:"space-y-4",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"text-sm font-semibold mb-2",children:"Example Tickets:"}),(0,te.jsx)("ul",{className:"text-sm text-muted-foreground space-y-1",children:s.example_titles.slice(0,3).map(((e,s)=>(0,te.jsxs)("li",{className:"line-clamp-1",children:["\u2022 ",e]},s)))})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h4",{className:"text-sm font-semibold mb-2",children:"Common Issues:"}),(0,te.jsx)("div",{className:"flex flex-wrap gap-1",children:s.common_issues.slice(0,3).map(((e,s)=>(0,te.jsx)(qs,{variant:"secondary",className:"text-xs",children:e},s)))})]}),s.suggested_improvements&&(0,te.jsxs)("div",{className:"pt-2 border-t",children:[(0,te.jsx)("h4",{className:"text-sm font-semibold mb-1 text-teal-700",children:"Suggested Improvements:"}),(0,te.jsx)("p",{className:"text-xs text-muted-foreground",children:s.suggested_improvements})]}),(0,te.jsxs)("div",{className:"text-xs text-muted-foreground",children:[s.ticket_ids.length," tickets in this category"]})]})]})};function yv(){const[e,s]=(0,Y.useState)(!0),[t,a]=(0,Y.useState)(!1),[r,n]=(0,Y.useState)(!1),[l,i]=(0,Y.useState)(null),[o,c]=(0,Y.useState)(null),[d,m]=(0,Y.useState)(null),[u,x]=(0,Y.useState)({preset:"last7days",startDate:Bt()().subtract(7,"days").startOf("day").toISOString(),endDate:Bt()().endOf("day").toISOString()}),[h,p]=(0,Y.useState)(null),g=[{value:"today",label:"Today",getDates:()=>({startDate:Bt()().startOf("day").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"yesterday",label:"Yesterday",getDates:()=>({startDate:Bt()().subtract(1,"day").startOf("day").toISOString(),endDate:Bt()().subtract(1,"day").endOf("day").toISOString()})},{value:"last2days",label:"Last 2 Days",getDates:()=>({startDate:Bt()().subtract(2,"days").startOf("day").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"last3days",label:"Last 3 Days",getDates:()=>({startDate:Bt()().subtract(3,"days").startOf("day").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"last7days",label:"Last 7 Days",getDates:()=>({startDate:Bt()().subtract(7,"days").startOf("day").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"last14days",label:"Last 14 Days",getDates:()=>({startDate:Bt()().subtract(14,"days").startOf("day").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"last30days",label:"Last 30 Days",getDates:()=>({startDate:Bt()().subtract(30,"days").startOf("day").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"last60days",label:"Last 60 Days",getDates:()=>({startDate:Bt()().subtract(60,"days").startOf("day").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"last90days",label:"Last 90 Days",getDates:()=>({startDate:Bt()().subtract(90,"days").startOf("day").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"thisWeek",label:"This Week",getDates:()=>({startDate:Bt()().startOf("week").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"lastWeek",label:"Last Week",getDates:()=>({startDate:Bt()().subtract(1,"week").startOf("week").toISOString(),endDate:Bt()().subtract(1,"week").endOf("week").toISOString()})},{value:"thisMonth",label:"This Month",getDates:()=>({startDate:Bt()().startOf("month").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"lastMonth",label:"Last Month",getDates:()=>({startDate:Bt()().subtract(1,"month").startOf("month").toISOString(),endDate:Bt()().subtract(1,"month").endOf("month").toISOString()})},{value:"thisQuarter",label:"This Quarter",getDates:()=>({startDate:Bt()().startOf("quarter").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"lastQuarter",label:"Last Quarter",getDates:()=>({startDate:Bt()().subtract(1,"quarter").startOf("quarter").toISOString(),endDate:Bt()().subtract(1,"quarter").endOf("quarter").toISOString()})},{value:"thisYear",label:"This Year",getDates:()=>({startDate:Bt()().startOf("year").toISOString(),endDate:Bt()().endOf("day").toISOString()})},{value:"lastYear",label:"Last Year",getDates:()=>({startDate:Bt()().subtract(1,"year").startOf("year").toISOString(),endDate:Bt()().subtract(1,"year").endOf("year").toISOString()})}];(0,Y.useEffect)((()=>{f()}),[u]);const f=async()=>{try{s(!0),m(null);const e=await Xg.getOperationalMetrics(u.startDate,u.endDate);i(e)}catch(e){m("Failed to load analytics data")}finally{s(!1)}},v=e=>e?e<1?`${Math.round(60*e)}m`:e<24?`${e.toFixed(1)}h`:`${Math.round(e/24)}d`:"N/A",j=l?Object.entries(l.tickets_by_category).map((e=>{let[s,t]=e;return{name:"uncategorized"===s?"Uncategorized":s.replace(/_/g," "),value:t}})):[],b=l?Object.entries(l.tickets_by_user_tier).map((e=>{let[s,t]=e;return{name:"unknown"===s?"Unknown":s,value:t}})):[],y=(null==l?void 0:l.busiest_days)||[],N=(null==l?void 0:l.tickets_by_hour)||[];return e?(0,te.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):d?(0,te.jsx)("div",{className:"h-full w-full flex items-center justify-center",children:(0,te.jsxs)(Vs,{className:"p-6",children:[(0,te.jsxs)("div",{className:"flex items-center space-x-2 text-red-600",children:[(0,te.jsx)(Ke.A,{className:"h-5 w-5"}),(0,te.jsx)("p",{children:d})]}),(0,te.jsx)(Rs,{onClick:f,className:"mt-4",children:"Retry"})]})}):(0,te.jsxs)("div",{className:"container mx-auto py-6 space-y-6",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("h1",{className:"text-3xl font-bold text-slate-900",children:"Support Analytics"}),(0,te.jsx)("p",{className:"text-muted-foreground mt-1",children:"Analyze support ticket trends and performance metrics"}),(0,te.jsxs)("p",{className:"text-sm text-muted-foreground mt-2 flex items-center gap-1",children:[(0,te.jsx)(At.A,{className:"h-3 w-3"}),Bt()(u.startDate).format("MMM DD, YYYY")," - ",Bt()(u.endDate).format("MMM DD, YYYY")]})]}),(0,te.jsxs)("div",{className:"flex items-center gap-3",children:[(0,te.jsxs)(ut,{value:u.preset,onValueChange:e=>{const s=g.find((s=>s.value===e));if(s){const t=s.getDates();x({preset:e,...t})}},children:[(0,te.jsxs)(pt,{className:"w-[200px]",children:[(0,te.jsx)(At.A,{className:"h-4 w-4 mr-2"}),(0,te.jsx)(ht,{})]}),(0,te.jsxs)(vt,{className:"max-h-[400px]",children:[(0,te.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:"Quick Ranges"}),g.slice(0,9).map((e=>(0,te.jsx)(bt,{value:e.value,children:e.label},e.value))),(0,te.jsx)("div",{className:"my-1 h-px bg-border"}),(0,te.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:"Weekly/Monthly"}),g.slice(9,13).map((e=>(0,te.jsx)(bt,{value:e.value,children:e.label},e.value))),(0,te.jsx)("div",{className:"my-1 h-px bg-border"}),(0,te.jsx)("div",{className:"px-2 py-1.5 text-xs font-semibold text-muted-foreground",children:"Quarterly/Yearly"}),g.slice(13).map((e=>(0,te.jsx)(bt,{value:e.value,children:e.label},e.value)))]})]}),(0,te.jsxs)(Rs,{onClick:async()=>{try{a(!0),await Xg.exportTicketsCSV(u.startDate,u.endDate,h)}catch(e){alert("Failed to export tickets")}finally{a(!1)}},disabled:t,variant:"outline",children:[t?(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin mr-2"}):(0,te.jsx)(vo.A,{className:"h-4 w-4 mr-2"}),"Export CSV"]})]})]}),(0,te.jsxs)("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[(0,te.jsx)(jv,{title:"Total Tickets",value:(null==l?void 0:l.total_tickets)||0,description:`${(null==l?void 0:l.open_tickets)||0} open, ${(null==l?void 0:l.resolved_tickets)||0} resolved`,icon:mr.A,color:fv.primary}),(0,te.jsx)(jv,{title:"Avg Response Time",value:v(null==l?void 0:l.avg_response_time_hours),description:"First admin response",icon:St.A,color:fv.teal}),(0,te.jsx)(jv,{title:"Avg Resolution Time",value:v(null==l?void 0:l.avg_resolution_time_hours),description:"Time to resolve tickets",icon:Ed.A,color:fv.success}),(0,te.jsx)(jv,{title:"Pending Admin Response",value:(null==l?void 0:l.tickets_pending_admin_response)||0,description:`${(null==l?void 0:l.tickets_pending_user_response)||0} pending user response`,icon:Ke.A,color:fv.warning})]}),(0,te.jsxs)(lr,{defaultValue:"overview",className:"space-y-4",children:[(0,te.jsxs)(ir,{children:[(0,te.jsx)(or,{value:"overview",children:"Overview"}),(0,te.jsx)(or,{value:"trends",children:"AI Trend Analysis"}),(0,te.jsx)(or,{value:"performance",children:"Performance"})]}),(0,te.jsxs)(cr,{value:"overview",className:"space-y-4",children:[(0,te.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Tickets by Category"}),(0,te.jsx)(Gs,{children:"Distribution of support tickets across categories"})]}),(0,te.jsx)(Js,{children:(0,te.jsx)("div",{className:"h-[300px]",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)(hv.r,{children:[(0,te.jsx)(pv.F,{data:j,cx:"50%",cy:"50%",labelLine:!1,outerRadius:80,fill:"#8884d8",dataKey:"value",label:e=>{let{name:s,percent:t}=e;return`${s} ${(100*t).toFixed(0)}%`},children:j.map(((e,s)=>(0,te.jsx)(gv.f,{fill:vv[s%vv.length]},`cell-${s}`)))}),(0,te.jsx)(Od.m,{})]})})})})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Tickets by User Tier"}),(0,te.jsx)(Gs,{children:"Support requests by subscription tier"})]}),(0,te.jsx)(Js,{children:(0,te.jsx)("div",{className:"h-[300px]",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)($x.E,{data:b,children:[(0,te.jsx)(Dd.d,{strokeDasharray:"3 3"}),(0,te.jsx)(Pd.W,{dataKey:"name"}),(0,te.jsx)(Md.h,{}),(0,te.jsx)(Od.m,{}),(0,te.jsx)(Dx.y,{dataKey:"value",fill:fv.purple})]})})})})]})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Ticket Volume Over Time"}),(0,te.jsx)(Gs,{children:"Daily ticket creation trends"})]}),(0,te.jsx)(Js,{children:(0,te.jsx)("div",{className:"h-[300px]",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)($d.Q,{data:y,children:[(0,te.jsx)(Dd.d,{strokeDasharray:"3 3"}),(0,te.jsx)(Pd.W,{dataKey:"date",tickFormatter:e=>Bt()(e).format("MMM DD")}),(0,te.jsx)(Md.h,{}),(0,te.jsx)(Od.m,{labelFormatter:e=>Bt()(e).format("MMMM DD, YYYY")}),(0,te.jsx)(Rd.G,{type:"monotone",dataKey:"count",stroke:fv.primary,fill:fv.primary,fillOpacity:.3,name:"Tickets"})]})})})})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Tickets by Hour of Day"}),(0,te.jsx)(Gs,{children:"When support tickets are typically created"})]}),(0,te.jsx)(Js,{children:(0,te.jsx)("div",{className:"h-[300px]",children:(0,te.jsx)(Td.u,{width:"100%",height:"100%",children:(0,te.jsxs)($x.E,{data:N,children:[(0,te.jsx)(Dd.d,{strokeDasharray:"3 3"}),(0,te.jsx)(Pd.W,{dataKey:"label",angle:-45,textAnchor:"end",height:60}),(0,te.jsx)(Md.h,{}),(0,te.jsx)(Od.m,{labelFormatter:e=>`Hour: ${e}`,formatter:e=>[`${e} tickets`,"Count"]}),(0,te.jsx)(Dx.y,{dataKey:"count",fill:fv.teal,radius:[4,4,0,0]})]})})})})]})]}),(0,te.jsx)(cr,{value:"trends",className:"space-y-4",children:(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsxs)(Hs,{className:"flex items-center gap-2",children:[(0,te.jsx)(Ct.A,{className:"h-5 w-5 text-purple-500"}),"AI-Powered Trend Analysis"]}),(0,te.jsx)(Gs,{children:"Use AI to identify patterns and group similar tickets"})]}),(0,te.jsxs)(Js,{children:[(0,te.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,te.jsxs)(ut,{value:h||"all",onValueChange:e=>p("all"===e?null:e),children:[(0,te.jsx)(pt,{className:"w-[200px]",children:(0,te.jsx)(ht,{placeholder:"Filter by category"})}),(0,te.jsxs)(vt,{children:[(0,te.jsx)(bt,{value:"all",children:"All Categories"}),(0,te.jsx)(bt,{value:"authentication",children:"Authentication"}),(0,te.jsx)(bt,{value:"billing",children:"Billing"}),(0,te.jsx)(bt,{value:"bug_report",children:"Bug Reports"}),(0,te.jsx)(bt,{value:"integrations_and_backend_functions",children:"Integrations"}),(0,te.jsx)(bt,{value:"chat_issues",children:"Chat Issues"}),(0,te.jsx)(bt,{value:"security",children:"Security"}),(0,te.jsx)(bt,{value:"other",children:"Other"})]})]}),(0,te.jsx)(Rs,{onClick:async()=>{try{n(!0),c(null);const e=await Xg.runTrendAnalysis(u.startDate,u.endDate,h);c(e)}catch(e){alert("Failed to run trend analysis")}finally{n(!1)}},disabled:r,children:r?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin mr-2"}),"Analyzing..."]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(io.A,{className:"h-4 w-4 mr-2"}),"Run Analysis"]})})]}),o&&(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"bg-slate-50 p-4 rounded-lg",children:[(0,te.jsx)("h3",{className:"font-semibold mb-2",children:"Analysis Summary"}),(0,te.jsx)("p",{className:"text-sm text-muted-foreground",children:o.analysis_summary}),(0,te.jsxs)("p",{className:"text-xs text-muted-foreground mt-2",children:["Analyzed ",o.total_tickets_analyzed," tickets"]})]}),(0,te.jsxs)("div",{children:[(0,te.jsx)("h3",{className:"font-semibold mb-3",children:"Identified Ticket Classes"}),(0,te.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:o.ticket_classes.map(((e,s)=>(0,te.jsx)(bv,{ticketClass:e},s)))})]}),o.recommendations&&o.recommendations.length>0&&(0,te.jsxs)("div",{className:"bg-teal-50 p-4 rounded-lg",children:[(0,te.jsx)("h3",{className:"font-semibold mb-2 text-teal-900",children:"Strategic Recommendations"}),(0,te.jsx)("ul",{className:"space-y-2",children:o.recommendations.map(((e,s)=>(0,te.jsxs)("li",{className:"text-sm text-teal-800 flex items-start",children:[(0,te.jsx)("span",{className:"text-teal-600 mr-2",children:"\u2022"}),e]},s)))})]})]}),!o&&!r&&(0,te.jsxs)("div",{className:"text-center py-12 text-muted-foreground",children:[(0,te.jsx)(io.A,{className:"h-12 w-12 mx-auto mb-3 text-slate-300"}),(0,te.jsx)("p",{children:'Click "Run Analysis" to generate AI insights'})]})]})]})}),(0,te.jsx)(cr,{value:"performance",className:"space-y-4",children:(0,te.jsxs)("div",{className:"grid gap-4 md:grid-cols-2",children:[(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Tickets by Assignee"}),(0,te.jsx)(Gs,{children:"Workload distribution across team members"})]}),(0,te.jsx)(Js,{children:(0,te.jsx)("div",{className:"space-y-3",children:l&&Object.entries(l.tickets_by_assignee).map((e=>{let[s,t]=e;return(0,te.jsxs)("div",{className:"flex items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Wa.A,{className:"h-4 w-4 text-muted-foreground"}),(0,te.jsx)("span",{className:"text-sm",children:"unassigned"===s?"Unassigned":s})]}),(0,te.jsx)(qs,{variant:"unassigned"===s?"secondary":"default",children:t})]},s)}))})})]}),(0,te.jsxs)(Vs,{children:[(0,te.jsxs)(Ys,{children:[(0,te.jsx)(Hs,{children:"Response Status"}),(0,te.jsx)(Gs,{children:"Current pending responses breakdown"})]}),(0,te.jsx)(Js,{children:(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"flex items-center justify-between p-3 bg-orange-50 rounded-lg",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Ke.A,{className:"h-5 w-5 text-orange-600"}),(0,te.jsx)("span",{className:"font-medium",children:"Pending Admin"})]}),(0,te.jsx)("span",{className:"text-2xl font-bold text-orange-600",children:(null==l?void 0:l.tickets_pending_admin_response)||0})]}),(0,te.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(St.A,{className:"h-5 w-5 text-blue-600"}),(0,te.jsx)("span",{className:"font-medium",children:"Pending User"})]}),(0,te.jsx)("span",{className:"text-2xl font-bold text-blue-600",children:(null==l?void 0:l.tickets_pending_user_response)||0})]})]})})]})]})})]})]})}const Nv=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{className:"relative w-full overflow-auto",children:(0,te.jsx)("table",{ref:s,className:ns("w-full caption-bottom text-sm",t),...a})})}));Nv.displayName="Table";const wv=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("thead",{ref:s,className:ns("[&_tr]:border-b",t),...a})}));wv.displayName="TableHeader";const kv=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("tbody",{ref:s,className:ns("[&_tr:last-child]:border-0",t),...a})}));kv.displayName="TableBody";Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("tfoot",{ref:s,className:ns("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})})).displayName="TableFooter";const _v=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("tr",{ref:s,className:ns("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a})}));_v.displayName="TableRow";const Sv=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("th",{ref:s,className:ns("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})}));Sv.displayName="TableHead";const Cv=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("td",{ref:s,className:ns("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})}));Cv.displayName="TableCell";Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("caption",{ref:s,className:ns("mt-4 text-sm text-muted-foreground",t),...a})})).displayName="TableCaption";const Av=[{label:"English",value:"en"},{label:"Deutsch",value:"de"},{label:"Espa\xf1ol",value:"es"},{label:"Fran\xe7ais",value:"fr"},{label:"Italiano",value:"it"},{label:"\u65e5\u672c\u8a9e",value:"ja"},{label:"\u4e2d\u6587",value:"zh"},{label:"\u0939\u093f\u0928\u094d\u0926\u0940",value:"hi"},{label:"Portugu\xeas",value:"pt"},{label:"\u05e2\u05d1\u05e8\u05d9\u05ea",value:"he"},{label:"\u0627\u0644\u0639\u0631\u0628\u064a\u0629",value:"ar"},{label:"Bahasa Indonesia",value:"id"}];function Ev(){var e,s,t,a;const{user:r}=ne(),[n,l]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(""),[m,u]=(0,Y.useState)({key:"created_date",direction:"desc"}),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)({}),[f,v]=(0,Y.useState)({}),[j,b]=(0,Y.useState)(new Set),[y,N]=(0,Y.useState)("all"),[w,k]=(0,Y.useState)("en"),[_,S]=(0,Y.useState)("all"),[C,A]=(0,Y.useState)(""),[E,I]=(0,Y.useState)(""),[L,T]=(0,Y.useState)({isOpen:!1,action:null,item:null}),[$,D]=(0,Y.useState)(""),[P,M]=(0,Y.useState)("en"),[O,R]=(0,Y.useState)({isOpen:!1,imageUrl:"",imageAlt:""});(0,Y.useEffect)((()=>{F()}),[]),(0,Y.useEffect)((()=>(x&&clearTimeout(x),h(setTimeout((()=>{F()}),500)),()=>{x&&clearTimeout(x)})),[c,y,w,_,C,E]);const F=async()=>{o(!0);try{let e={limit:1e3};if(c&&(e.$or=[{name:{$regex:c,$options:"i"}},{description:{$regex:c,$options:"i"}},{categories:{$regex:c,$options:"i"}},{created_by:{$regex:c,$options:"i"}}]),y&&"all"!==y&&(e.status=y),w&&("en"===w?c?(e.$and=[e.$or?{$or:e.$or}:{},{$or:[{language:"en"},{language:{$exists:!1}},{language:null}]}],delete e.$or):e.$or=[{language:"en"},{language:{$exists:!1}},{language:null}]:e.language=w),"all"!==_){const s=Bt()();let t;switch(_){case"today":t=s.clone().startOf("day"),e.created_at={$gte:t.toISOString()};break;case"week":t=s.clone().subtract(7,"days").startOf("day"),e.created_at={$gte:t.toISOString()};break;case"month":t=s.clone().subtract(30,"days").startOf("day"),e.created_at={$gte:t.toISOString()};break;case"custom":C&&E?e.created_at={$gte:Bt()(C).startOf("day").toISOString(),$lte:Bt()(E).endOf("day").toISOString()}:C?e.created_at={$gte:Bt()(C).startOf("day").toISOString()}:E&&(e.created_at={$lte:Bt()(E).endOf("day").toISOString()})}}const s=await Ec.listCatalogItems(e),t=s.items||s;l(t)}catch(e){zn({title:"Error",description:"Failed to load catalog items",variant:"destructive"})}finally{o(!1)}},z=(e,s)=>{M(s.item.language||"en"),T({isOpen:!0,action:e,item:s})},U=()=>{T({isOpen:!1,action:null,item:null}),D("")},B=e=>{u({key:e,direction:m.key===e&&"asc"===m.direction?"desc":"asc"})},W=()=>"all"!==y||"en"!==w||"all"!==_||""!==c||""!==C||""!==E,q=e=>{const s=Av.find((s=>s.value===e));return s?s.label:e},V=e=>{switch(e){case"approved":return(0,te.jsxs)(Xp,{className:"bg-emerald-100 text-emerald-700 border-emerald-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,te.jsx)("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1.5"}),"Approved"]});case"pending":return(0,te.jsxs)(Xp,{className:"bg-amber-100 text-amber-700 border-amber-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,te.jsx)(St.A,{className:"w-3 h-3 mr-1.5"}),"Pending"]});case"rejected":return(0,te.jsxs)(Xp,{className:"bg-red-100 text-red-700 border-red-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,te.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"}),"Rejected"]});case"archived":return(0,te.jsxs)(Xp,{className:"bg-gray-100 text-gray-700 border-gray-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,te.jsx)(ig.A,{className:"w-3 h-3 mr-1.5"}),"Archived"]});default:return(0,te.jsx)(Xp,{variant:"secondary",className:"font-medium px-2.5 py-0.5 text-xs",children:e})}},H=n.sort(((e,s)=>{let t,a;return"usage"===m.key?(t=e.usage,a=s.usage):"item_creator"===m.key?(t=e.item_creator.full_name,a=s.item_creator.full_name):(t=e.item[m.key],a=s.item[m.key]),"created_date"!==m.key&&"updated_date"!==m.key||(t=new Date(t),a=new Date(a)),"asc"===m.direction?t>a?1:-1:a>t?1:-1}));return null!=r&&null!==(e=r.platform_role)&&void 0!==e&&e.includes("admin")?(0,te.jsxs)("div",{className:"container mx-auto py-10 px-4",children:[(0,te.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"App Templates Management"}),(0,te.jsxs)("div",{className:"mb-8 space-y-4",children:[(0,te.jsx)("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3 items-start lg:items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center flex-1",children:[(0,te.jsxs)("div",{className:"relative w-full sm:w-80",children:[(0,te.jsx)(Na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,te.jsx)(Qn,{placeholder:"Search apps, creators, categories...",className:"pl-10 h-9 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20 transition-all duration-200",value:c,onChange:e=>d(e.target.value)})]}),(0,te.jsxs)(pl,{value:y,onValueChange:N,children:[(0,te.jsx)(fl,{className:"w-36 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Ct.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,te.jsx)(gl,{placeholder:"Status"})]})}),(0,te.jsxs)(bl,{children:[(0,te.jsx)(yl,{value:"all",children:"All Status"}),(0,te.jsx)(yl,{value:"pending",children:"Pending"}),(0,te.jsx)(yl,{value:"approved",children:"Approved"}),(0,te.jsx)(yl,{value:"rejected",children:"Rejected"}),(0,te.jsx)(yl,{value:"archived",children:"Archived"})]})]}),(0,te.jsxs)(pl,{value:w,onValueChange:k,children:[(0,te.jsx)(fl,{className:"w-40 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Tt.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,te.jsx)(gl,{placeholder:"Language"})]})}),(0,te.jsx)(bl,{children:Av.map((e=>(0,te.jsx)(yl,{value:e.value,children:e.label},e.value)))})]}),W()&&(0,te.jsxs)(sl,{variant:"outline",size:"sm",onClick:()=>{N("all"),k("en"),S("all"),A(""),I(""),d("")},className:"h-9 px-3 text-gray-600 border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-all duration-200",children:[(0,te.jsx)(Ds.A,{className:"h-3.5 w-3.5 mr-1"}),"Clear"]})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-3 py-1.5 rounded-lg",children:[(0,te.jsx)(Jd.A,{className:"h-3.5 w-3.5"}),n.length," apps"]})]})}),"custom"===_&&(0,te.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:(0,te.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"From:"}),(0,te.jsx)(Qn,{type:"date",value:C,onChange:e=>A(e.target.value),className:"w-40 h-8 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"To:"}),(0,te.jsx)(Qn,{type:"date",value:E,onChange:e=>I(e.target.value),className:"w-40 h-8 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"})]})]})}),W()&&(0,te.jsxs)("div",{className:"flex flex-wrap gap-2 items-center p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:[(0,te.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[(0,te.jsx)(Yu.A,{className:"h-3.5 w-3.5"}),"Active filters:"]}),"all"!==y&&(0,te.jsxs)(Xp,{className:"bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Status: ",y,(0,te.jsx)("button",{onClick:()=>N("all"),className:"ml-1 hover:bg-blue-300 rounded-full p-0.5 transition-colors",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]}),"en"!==w&&(0,te.jsxs)(Xp,{className:"bg-teal-100 text-teal-800 hover:bg-teal-200 transition-colors",children:["Language: ",q(w),(0,te.jsx)("button",{onClick:()=>k("en"),className:"ml-1 hover:bg-teal-300 rounded-full p-0.5 transition-colors",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]}),"all"!==_&&(0,te.jsxs)(Xp,{className:"bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",children:["Date: ","custom"===_?"Custom":_,(0,te.jsx)("button",{onClick:()=>S("all"),className:"ml-1 hover:bg-purple-300 rounded-full p-0.5 transition-colors",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]}),c&&(0,te.jsxs)(Xp,{className:"bg-green-100 text-green-800 hover:bg-green-200 transition-colors",children:['Search: "',c,'"',(0,te.jsx)("button",{onClick:()=>d(""),className:"ml-1 hover:bg-green-300 rounded-full p-0.5 transition-colors",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]})]})]}),(0,te.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:(0,te.jsxs)(Nv,{children:[(0,te.jsx)(wv,{children:(0,te.jsxs)(_v,{children:[(0,te.jsx)(Sv,{className:"w-8"}),(0,te.jsx)(Sv,{className:"cursor-pointer",onClick:()=>B("name"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["App Name",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Sv,{className:"cursor-pointer w-24",onClick:()=>B("item_creator"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Creator",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Sv,{className:"cursor-pointer",onClick:()=>B("status"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Status",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Sv,{className:"cursor-pointer w-40",onClick:()=>B("created_date"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Created Date",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Sv,{className:"cursor-pointer",onClick:()=>B("usage"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["#Clones",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Sv,{className:"cursor-pointer",onClick:()=>B("is_private"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Privacy",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Sv,{className:"cursor-pointer",onClick:()=>B("language"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Language",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4"})]})}),(0,te.jsx)(Sv,{children:"Actions"})]})}),(0,te.jsx)(kv,{children:i?(0,te.jsx)(_v,{children:(0,te.jsx)(Cv,{colSpan:9,className:"text-center py-8",children:"Loading apps..."})}):0===H.length?(0,te.jsx)(_v,{children:(0,te.jsx)(Cv,{colSpan:9,className:"text-center py-8",children:"No apps found"})}):H.map((e=>{var s,t;return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)(_v,{className:"hover:bg-gray-50/80 transition-colors duration-200 group h-12",children:[(0,te.jsx)(Cv,{className:"py-2",children:(0,te.jsx)(sl,{variant:"ghost",size:"sm",onClick:()=>{return s=e.item.id,void b((e=>{const t=new Set(e);return t.has(s)?t.delete(s):t.add(s),t}));var s},className:"h-6 w-6 p-0 rounded hover:bg-gray-100 transition-all duration-200 group",children:j.has(e.item.id)?(0,te.jsx)(ct.A,{className:"h-3 w-3 text-gray-600 group-hover:text-gray-900 transition-colors"}):(0,te.jsx)(pr.A,{className:"h-3 w-3 text-gray-600 group-hover:text-gray-900 transition-colors"})})}),(0,te.jsx)(Cv,{className:"font-medium py-2 text-sm",children:e.item.name}),(0,te.jsx)(Cv,{className:"py-2 text-xs w-24 truncate",children:e.item_creator.full_name}),(0,te.jsx)(Cv,{className:"py-2",children:V(e.item.status)}),(0,te.jsx)(Cv,{className:"py-2 w-40",children:Bt().utc(e.item.created_date).fromNow()}),(0,te.jsx)(Cv,{className:"py-2",children:(0,te.jsxs)("div",{className:"flex items-center gap-1 text-sm",children:[(0,te.jsx)(Ha.A,{className:"h-3 w-3 text-gray-500"}),e.usage||0]})}),(0,te.jsx)(Cv,{className:"py-2",children:(0,te.jsx)("div",{className:"flex items-center gap-1",children:e.item.is_private?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Ls.A,{className:"h-3 w-3 text-gray-500"}),(0,te.jsx)("span",{className:"text-xs text-gray-600",children:"Private"})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Tt.A,{className:"h-3 w-3 text-green-500"}),(0,te.jsx)("span",{className:"text-xs text-green-600",children:"Public"})]})})}),(0,te.jsx)(Cv,{className:"py-2",children:(0,te.jsx)("span",{className:"text-xs text-gray-700",children:q(e.item.language||"en")})}),(0,te.jsx)(Cv,{className:"py-2",children:(0,te.jsxs)("div",{className:"flex gap-1",children:[(0,te.jsx)(sl,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-green-600 hover:text-green-700 hover:bg-green-50 rounded transition-all duration-200 group",onClick:s=>{s.stopPropagation(),z("approve",e)},disabled:p[e.item.id],title:"Approve",children:(0,te.jsx)(mt.A,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"})}),(0,te.jsx)(sl,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-red-600 hover:text-red-700 hover:bg-red-50 rounded transition-all duration-200 group",onClick:s=>{s.stopPropagation(),z("decline",e)},disabled:p[e.item.id],title:"Decline",children:(0,te.jsx)(Ds.A,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"})}),(0,te.jsx)(sl,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-gray-600 hover:text-gray-700 hover:bg-gray-100 rounded transition-all duration-200 group",onClick:s=>{s.stopPropagation(),z("archive",e)},disabled:p[e.item.id],title:"Archive",children:(0,te.jsx)(ig.A,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"})}),(0,te.jsx)(sl,{size:"sm",variant:"ghost",className:"h-7 w-7 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded transition-all duration-200 group",onClick:s=>{s.stopPropagation(),(async e=>{v((s=>({...s,[e]:!0})));try{const s=`https://${(await pe.getLoginInfoById(e)).slug}.base44.app`;window.open(s,"_blank")}catch(s){zn({title:"Error",description:"Failed to open app",variant:"destructive"})}finally{v((s=>({...s,[e]:!1})))}})(e.item.app_id)},disabled:f[e.item.app_id],title:"Open New Tab",children:(0,te.jsx)(ur.A,{className:"h-3.5 w-3.5 group-hover:scale-110 transition-transform"})})]})})]},e.item.id),j.has(e.item.id)&&(0,te.jsx)(_v,{children:(0,te.jsx)(Cv,{colSpan:9,className:"bg-gradient-to-br from-gray-50 to-gray-100/50 p-8 border-t border-gray-100",children:(0,te.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[(0,te.jsxs)("div",{className:"space-y-6",children:[(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-5 bg-blue-500 rounded-full"}),"Description"]}),(0,te.jsx)("div",{className:"text-sm text-gray-600 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:Oc(e.item.description||'<p class="text-gray-400 italic">No description available</p>')}})]}),(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-5 bg-green-500 rounded-full"}),"Technical Details"]}),(0,te.jsxs)("div",{className:"grid grid-cols-1 gap-3 text-sm",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,te.jsx)("span",{className:"font-medium text-gray-700",children:"App ID:"}),(0,te.jsx)("code",{className:"text-gray-600 bg-gray-100 px-2 py-1 rounded text-xs",children:e.item.app_id})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,te.jsx)("span",{className:"font-medium text-gray-700",children:"Organization:"}),(0,te.jsx)("code",{className:"text-gray-600 bg-gray-100 px-2 py-1 rounded text-xs",children:e.item.organization_id})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center py-2 border-b border-gray-100",children:[(0,te.jsx)("span",{className:"font-medium text-gray-700",children:"Created:"}),(0,te.jsx)("span",{className:"text-gray-600",children:Bt().utc(e.item.created_date).format("MMM DD, YYYY HH:mm")})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center py-2",children:[(0,te.jsx)("span",{className:"font-medium text-gray-700",children:"Updated:"}),(0,te.jsx)("span",{className:"text-gray-600",children:Bt().utc(e.item.updated_date).format("MMM DD, YYYY HH:mm")})]})]})]}),"rejected"===e.item.status&&e.item.rejected_reason&&(0,te.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg border border-red-200",children:[(0,te.jsxs)("h4",{className:"font-semibold text-red-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-5 bg-red-500 rounded-full"}),"Rejection Reason"]}),(0,te.jsx)("div",{className:"text-sm text-red-800 bg-white p-3 rounded border border-red-200",children:e.item.rejected_reason})]}),(null===(s=e.item.categories)||void 0===s?void 0:s.length)>0&&(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-5 bg-purple-500 rounded-full"}),"Categories"]}),(0,te.jsx)("div",{className:"flex flex-wrap gap-2",children:e.item.categories.map(((e,s)=>(0,te.jsx)(Xp,{className:"bg-purple-50 text-purple-700 border-purple-200 hover:bg-purple-100 transition-colors",children:e},s)))})]})]}),(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 h-fit",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-5 bg-orange-500 rounded-full"}),"Screenshots"]}),(null===(t=e.item.screenshot_urls)||void 0===t?void 0:t.length)>0?(0,te.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[e.item.screenshot_urls.slice(0,3).map(((s,t)=>(0,te.jsxs)("div",{className:"relative rounded-lg overflow-hidden border border-gray-200 group",children:[(0,te.jsx)("img",{src:s,alt:`Screenshot ${t+1}`,className:"w-full h-36 object-cover group-hover:scale-105 transition-all duration-300 cursor-pointer",onClick:a=>{var r,n;a.stopPropagation(),r=s,n=`${e.item.name} - Screenshot ${t+1}`,R({isOpen:!0,imageUrl:r,imageAlt:n})}}),(0,te.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 flex items-center justify-center",children:(0,te.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-white/90 backdrop-blur-sm rounded-full p-2",children:(0,te.jsx)(Jd.A,{className:"h-4 w-4 text-gray-700"})})})]},t))),e.item.screenshot_urls.length>3&&(0,te.jsx)("div",{className:"text-center py-2 bg-gray-50 rounded-lg border border-gray-200",children:(0,te.jsxs)("p",{className:"text-sm text-gray-600 font-medium",children:["+",e.item.screenshot_urls.length-3," more screenshots"]})})]}):(0,te.jsxs)("div",{className:"text-center py-8 text-gray-400 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[(0,te.jsx)(Jd.A,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,te.jsx)("p",{className:"text-sm",children:"No screenshots available"})]})]})]})})})]})}))})]})}),(0,te.jsx)(Bn,{open:O.isOpen,onOpenChange:()=>{R({isOpen:!1,imageUrl:"",imageAlt:""})},children:(0,te.jsxs)(Yn,{className:"max-w-4xl max-h-[90vh] p-0 overflow-hidden z-[100]",children:[(0,te.jsx)(Hn,{className:"p-6 pb-0",children:(0,te.jsx)(Jn,{className:"text-lg font-semibold text-gray-900",children:O.imageAlt})}),(0,te.jsx)("div",{className:"p-6 pt-4",children:(0,te.jsx)("div",{className:"relative rounded-lg overflow-hidden bg-gray-100",children:(0,te.jsx)("img",{src:O.imageUrl,alt:O.imageAlt,className:"w-full max-h-[70vh] object-contain"})})})]})}),(0,te.jsx)(Bn,{open:L.isOpen,onOpenChange:U,children:(0,te.jsxs)(Yn,{children:[(0,te.jsxs)(Hn,{children:[(0,te.jsxs)(Jn,{children:["approve"===L.action&&"Approve App Listing","decline"===L.action&&"Decline App Listing","archive"===L.action&&"Archive App Listing"]}),(0,te.jsxs)(Zn,{children:["approve"===L.action&&(0,te.jsxs)(te.Fragment,{children:["Are you sure you want to approve ",(0,te.jsx)("strong",{children:null===(s=L.item)||void 0===s?void 0:s.item.name}),"?",(0,te.jsx)("br",{}),"This will make the app publicly visible in the catalog.",(0,te.jsxs)("div",{className:"mt-4",children:[(0,te.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Language:"}),(0,te.jsxs)(pl,{value:P,onValueChange:M,children:[(0,te.jsx)(fl,{className:"w-full",children:(0,te.jsx)(gl,{placeholder:"Select language"})}),(0,te.jsx)(bl,{children:Av.map((e=>(0,te.jsx)(yl,{value:e.value,children:e.label},e.value)))})]})]})]}),"decline"===L.action&&(0,te.jsxs)(te.Fragment,{children:["Are you sure you want to decline ",(0,te.jsx)("strong",{children:null===(t=L.item)||void 0===t?void 0:t.item.name}),"?",(0,te.jsx)("br",{}),"This will remove the app from public visibility in the catalog.",(0,te.jsxs)("div",{className:"mt-4",children:[(0,te.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for decline (optional):"}),(0,te.jsx)("textarea",{placeholder:"Enter reason for declining this app listing...",value:$,onChange:e=>D(e.target.value),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),"archive"===L.action&&(0,te.jsxs)(te.Fragment,{children:["Are you sure you want to archive ",(0,te.jsx)("strong",{children:null===(a=L.item)||void 0===a?void 0:a.item.name}),"?",(0,te.jsx)("br",{}),"This will permanently remove the app from the catalog."]})]})]}),(0,te.jsxs)(Gn,{children:[(0,te.jsx)(sl,{variant:"outline",onClick:U,children:"Cancel"}),(0,te.jsxs)(sl,{onClick:async()=>{if(!L.action||!L.item)return;const{action:e,item:s}=L,t=s.item.id;g((e=>({...e,[t]:!0}))),U();try{switch(e){case"approve":await Ec.approveItem(t,P);break;case"decline":await Ec.declineItem(t,$||void 0);break;case"archive":await Ec.archiveItem(t)}zn({title:"Success",description:`Item ${e}d successfully`}),await F()}catch(a){zn({title:"Error",description:`Failed to ${e} item`,variant:"destructive"})}finally{g((e=>({...e,[t]:!1})))}},className:"approve"===L.action?"bg-green-600 hover:bg-green-700":"decline"===L.action?"bg-red-600 hover:bg-red-700":"bg-gray-600 hover:bg-gray-700",children:["approve"===L.action&&"Approve","decline"===L.action&&"Decline","archive"===L.action&&"Archive"]})]})]})})]}):(0,te.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)(gh.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,te.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,te.jsx)("p",{className:"text-gray-600",children:"You are not authorized to access this page"})]})})}function Iv(e){let{currentPage:s,totalPages:t,onPageChange:a}=e;return t<=1?null:(0,te.jsxs)("div",{className:"flex items-center justify-center space-x-2 mt-12",children:[(0,te.jsxs)(sl,{variant:"outline",size:"sm",onClick:()=>a(Math.max(1,s-1)),disabled:1===s,className:"h-9 px-3",children:[(0,te.jsx)($t.A,{className:"w-4 h-4 mr-1"}),"Previous"]}),(0,te.jsx)("div",{className:"flex items-center space-x-1",children:Array.from({length:Math.min(t,7)},((e,r)=>{let n;return n=t<=7||s<=4?r+1:s>=t-3?t-6+r:s-3+r,(0,te.jsx)(sl,{variant:s===n?"default":"outline",size:"sm",onClick:()=>a(n),className:"h-9 w-9 p-0",children:n},n)}))}),(0,te.jsxs)(sl,{variant:"outline",size:"sm",onClick:()=>a(Math.min(t,s+1)),disabled:s===t,className:"h-9 px-3",children:["Next",(0,te.jsx)(pr.A,{className:"w-4 h-4 ml-1"})]})]})}function Lv(){var e,s,t,a;const{user:r}=ne(),[n,l]=(0,Y.useState)([]),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(""),[m,u]=(0,Y.useState)({key:"created_date",direction:"desc"}),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)({}),[f,v]=(0,Y.useState)(new Set),[j,b]=(0,Y.useState)(1),[y,N]=(0,Y.useState)(20),[w,k]=(0,Y.useState)(0),[_,S]=(0,Y.useState)(1),[C,A]=(0,Y.useState)("all"),[E,I]=(0,Y.useState)("all"),[L,T]=(0,Y.useState)(""),[$,D]=(0,Y.useState)(""),[P,M]=(0,Y.useState)({isOpen:!1,action:null,item:null}),[O,R]=(0,Y.useState)("");(0,Y.useEffect)((()=>{F()}),[]),(0,Y.useEffect)((()=>(x&&clearTimeout(x),h(setTimeout((()=>{F()}),500)),()=>{x&&clearTimeout(x)})),[c,C,E,L,$,j,y]);const F=async()=>{o(!0);try{let e={limit:y,skip:(j-1)*y,sort_by:`${"desc"===m.direction?"-":""}${m.key}`};if(c&&(e.$or=[{name:{$regex:c,$options:"i"}},{description:{$regex:c,$options:"i"}},{categories:{$regex:c,$options:"i"}},{created_by:{$regex:c,$options:"i"}}]),C&&"all"!==C&&(e.status=C),"all"!==E){const s=Bt()();let t;switch(E){case"today":t=s.clone().startOf("day"),e.created_at={$gte:t.toISOString()};break;case"week":t=s.clone().subtract(7,"days").startOf("day"),e.created_at={$gte:t.toISOString()};break;case"month":t=s.clone().subtract(30,"days").startOf("day"),e.created_at={$gte:t.toISOString()};break;case"custom":L&&$?e.created_at={$gte:Bt()(L).startOf("day").toISOString(),$lte:Bt()($).endOf("day").toISOString()}:L?e.created_at={$gte:Bt()(L).startOf("day").toISOString()}:$&&(e.created_at={$lte:Bt()($).endOf("day").toISOString()})}}const s=await Bs.listCatalogItems(e),t=s.items||s,a=s.total||t.length;l(t),k(a),S(Math.ceil(a/y))}catch(e){zn({title:"Error",description:"Failed to load catalog items",variant:"destructive"})}finally{o(!1)}},z=(e,s)=>{M({isOpen:!0,action:e,item:s})},U=()=>{M({isOpen:!1,action:null,item:null}),R("")},B=e=>{u({key:e,direction:m.key===e&&"asc"===m.direction?"desc":"asc"}),b(1)},W=()=>"all"!==C||"all"!==E||""!==c||""!==L||""!==$,q=e=>{switch(e){case"approved":return(0,te.jsxs)(Xp,{className:"bg-emerald-100 text-emerald-700 border-emerald-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,te.jsx)("div",{className:"w-1.5 h-1.5 bg-emerald-500 rounded-full mr-1.5"}),"Approved"]});case"pending":return(0,te.jsxs)(Xp,{className:"bg-amber-100 text-amber-700 border-amber-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,te.jsx)(St.A,{className:"w-3 h-3 mr-1.5"}),"Pending"]});case"declined":return(0,te.jsxs)(Xp,{className:"bg-red-100 text-red-700 border-red-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,te.jsx)("div",{className:"w-1.5 h-1.5 bg-red-500 rounded-full mr-1.5"}),"Declined"]});case"archived":return(0,te.jsxs)(Xp,{className:"bg-gray-100 text-gray-700 border-gray-200 font-medium px-2.5 py-0.5 text-xs",children:[(0,te.jsx)(ig.A,{className:"w-3 h-3 mr-1.5"}),"Archived"]});default:return(0,te.jsx)(Xp,{variant:"secondary",className:"font-medium px-2.5 py-0.5 text-xs",children:e})}},V=n;return null!=r&&null!==(e=r.platform_role)&&void 0!==e&&e.includes("admin")?(0,te.jsxs)("div",{className:"container mx-auto py-10 px-4",children:[(0,te.jsx)("h1",{className:"text-3xl font-bold mb-6",children:"Integration Catalog Management"}),(0,te.jsxs)("div",{className:"mb-8 space-y-4",children:[(0,te.jsx)("div",{className:"bg-white p-4 rounded-xl border border-gray-100 shadow-sm",children:(0,te.jsxs)("div",{className:"flex flex-col lg:flex-row gap-3 items-start lg:items-center justify-between",children:[(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3 items-start sm:items-center flex-1",children:[(0,te.jsxs)("div",{className:"relative w-full sm:w-80",children:[(0,te.jsx)(Na.A,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,te.jsx)(Qn,{placeholder:"Search integrations, creators, categories...",className:"pl-10 h-9 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20 transition-all duration-200",value:c,onChange:e=>d(e.target.value)})]}),(0,te.jsxs)(pl,{value:C,onValueChange:A,children:[(0,te.jsx)(fl,{className:"w-36 h-9 border-gray-200 hover:border-gray-300 transition-colors",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)(Ct.A,{className:"h-3.5 w-3.5 text-gray-400"}),(0,te.jsx)(gl,{placeholder:"Status"})]})}),(0,te.jsxs)(bl,{children:[(0,te.jsx)(yl,{value:"all",children:"All Status"}),(0,te.jsx)(yl,{value:"pending",children:"Pending"}),(0,te.jsx)(yl,{value:"approved",children:"Approved"}),(0,te.jsx)(yl,{value:"declined",children:"Declined"}),(0,te.jsx)(yl,{value:"archived",children:"Archived"})]})]}),W()&&(0,te.jsxs)(sl,{variant:"outline",size:"sm",onClick:()=>{A("all"),I("all"),T(""),D(""),d(""),b(1)},className:"h-9 px-3 text-gray-600 border-gray-200 hover:bg-gray-50 hover:text-gray-900 transition-all duration-200",children:[(0,te.jsx)(Ds.A,{className:"h-3.5 w-3.5 mr-1"}),"Clear"]})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-500 bg-gray-50 px-3 py-1.5 rounded-lg",children:[(0,te.jsx)(Jd.A,{className:"h-3.5 w-3.5"}),w," total integrations"]})]})}),"custom"===E&&(0,te.jsx)("div",{className:"bg-blue-50 p-4 rounded-lg border border-blue-100",children:(0,te.jsxs)("div",{className:"flex gap-4 items-center",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"From:"}),(0,te.jsx)(Qn,{type:"date",value:L,onChange:e=>T(e.target.value),className:"w-40 h-8 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"})]}),(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"To:"}),(0,te.jsx)(Qn,{type:"date",value:$,onChange:e=>D(e.target.value),className:"w-40 h-8 border-gray-200 focus:border-blue-500 focus:ring-blue-500/20"})]})]})}),W()&&(0,te.jsxs)("div",{className:"flex flex-wrap gap-2 items-center p-3 bg-gradient-to-r from-blue-50 to-indigo-50 rounded-lg border border-blue-100",children:[(0,te.jsxs)("span",{className:"text-sm font-medium text-gray-700 flex items-center gap-1",children:[(0,te.jsx)(Yu.A,{className:"h-3.5 w-3.5"}),"Active filters:"]}),"all"!==C&&(0,te.jsxs)(Xp,{className:"bg-blue-100 text-blue-800 hover:bg-blue-200 transition-colors",children:["Status: ",C,(0,te.jsx)("button",{onClick:()=>A("all"),className:"ml-1 hover:bg-blue-300 rounded-full p-0.5 transition-colors",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]}),"all"!==E&&(0,te.jsxs)(Xp,{className:"bg-purple-100 text-purple-800 hover:bg-purple-200 transition-colors",children:["Date: ","custom"===E?"Custom":E,(0,te.jsx)("button",{onClick:()=>I("all"),className:"ml-1 hover:bg-purple-300 rounded-full p-0.5 transition-colors",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]}),c&&(0,te.jsxs)(Xp,{className:"bg-green-100 text-green-800 hover:bg-green-200 transition-colors",children:['Search: "',c,'"',(0,te.jsx)("button",{onClick:()=>d(""),className:"ml-1 hover:bg-green-300 rounded-full p-0.5 transition-colors",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})})]})]})]}),(0,te.jsx)("div",{className:"bg-white rounded-xl border border-gray-200 shadow-sm overflow-hidden",children:(0,te.jsxs)(Nv,{children:[(0,te.jsx)(wv,{children:(0,te.jsxs)(_v,{className:"hover:bg-transparent border-b",children:[(0,te.jsx)(Sv,{className:"w-8"}),(0,te.jsx)(Sv,{className:"cursor-pointer font-semibold py-3",onClick:()=>B("name"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Integration Name",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,te.jsx)(Sv,{className:"cursor-pointer font-semibold py-3 w-32",onClick:()=>B("status"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Status",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,te.jsx)(Sv,{className:"cursor-pointer font-semibold py-3 w-36",onClick:()=>B("created_date"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Created",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,te.jsx)(Sv,{className:"cursor-pointer font-semibold py-3 w-36",onClick:()=>B("updated_date"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Updated",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4 opacity-50"})]})}),(0,te.jsx)(Sv,{className:"font-semibold py-3 w-40",children:"Categories"}),(0,te.jsx)(Sv,{className:"cursor-pointer font-semibold py-3 w-24",onClick:()=>B("is_private"),children:(0,te.jsxs)("div",{className:"flex items-center",children:["Privacy",(0,te.jsx)(fh.A,{className:"ml-2 h-4 w-4 opacity-50"})]})})]})}),(0,te.jsx)(kv,{children:i?(0,te.jsx)(_v,{children:(0,te.jsx)(Cv,{colSpan:7,className:"text-center py-8",children:"Loading integrations..."})}):0===V.length?(0,te.jsx)(_v,{children:(0,te.jsx)(Cv,{colSpan:7,className:"text-center py-8",children:"No integrations found"})}):V.map((e=>{var s,t,a,r;return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)(_v,{className:"hover:bg-gray-50/60 transition-colors duration-150 group border-b border-gray-100",children:[(0,te.jsx)(Cv,{className:"py-3",children:(0,te.jsx)(sl,{variant:"ghost",size:"sm",onClick:()=>{return s=e.item.id,void v((e=>{const t=new Set(e);return t.has(s)?t.delete(s):t.add(s),t}));var s},className:"h-6 w-6 p-0 rounded-md hover:bg-gray-100 transition-all duration-150",children:f.has(e.item.id)?(0,te.jsx)(ct.A,{className:"h-3.5 w-3.5 text-gray-500"}):(0,te.jsx)(pr.A,{className:"h-3.5 w-3.5 text-gray-500"})})}),(0,te.jsx)(Cv,{className:"font-medium py-3 text-sm",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("span",{className:"truncate",children:e.item.name}),(0,te.jsxs)("div",{className:"flex gap-1",children:[(0,te.jsx)(sl,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 text-green-600 hover:text-green-700 hover:bg-green-50 rounded opacity-0 group-hover:opacity-100 transition-opacity",onClick:s=>{s.stopPropagation(),z("approve",e)},disabled:p[e.item.id],title:"Approve",children:(0,te.jsx)(mt.A,{className:"h-3 w-3"})}),(0,te.jsx)(sl,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 text-red-600 hover:text-red-700 hover:bg-red-50 rounded opacity-0 group-hover:opacity-100 transition-opacity",onClick:s=>{s.stopPropagation(),z("decline",e)},disabled:p[e.item.id],title:"Decline",children:(0,te.jsx)(Ds.A,{className:"h-3 w-3"})}),(0,te.jsx)(sl,{size:"sm",variant:"ghost",className:"h-6 w-6 p-0 text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded opacity-0 group-hover:opacity-100 transition-opacity",onClick:s=>{s.stopPropagation(),window.open(`/integrations-catalog/item/${e.item.id}`,"_blank")},title:"View Integration",children:(0,te.jsx)(Jd.A,{className:"h-3 w-3"})})]})]})}),(0,te.jsx)(Cv,{className:"py-3",children:q(e.item.status)}),(0,te.jsx)(Cv,{className:"py-3 text-sm text-gray-600",children:(0,te.jsxs)("div",{className:"flex items-center gap-1",children:[(0,te.jsx)(At.A,{className:"h-3 w-3 text-gray-400"}),Bt().utc(e.item.created_date).format("MMM DD")]})}),(0,te.jsx)(Cv,{className:"py-3 text-sm text-gray-600",children:(0,te.jsxs)("div",{className:"flex items-center gap-1",children:[(0,te.jsx)(St.A,{className:"h-3 w-3 text-gray-400"}),Bt().utc(e.item.updated_date).format("MMM DD")]})}),(0,te.jsx)(Cv,{className:"py-3",children:(0,te.jsx)("div",{className:"flex flex-wrap gap-1",children:(null===(s=e.item.categories)||void 0===s?void 0:s.length)>0?(0,te.jsxs)(te.Fragment,{children:[e.item.categories.slice(0,2).map(((e,s)=>(0,te.jsx)(Xp,{variant:"outline",className:"text-xs px-1.5 py-0 h-5",children:e},s))),e.item.categories.length>2&&(0,te.jsxs)(Xp,{variant:"outline",className:"text-xs px-1.5 py-0 h-5 bg-gray-50",children:["+",e.item.categories.length-2]})]}):(0,te.jsx)("span",{className:"text-gray-400 text-xs",children:"None"})})}),(0,te.jsx)(Cv,{className:"py-3",children:(0,te.jsx)("div",{className:"flex items-center gap-1.5",children:e.item.is_private?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Ls.A,{className:"h-3 w-3 text-amber-500"}),(0,te.jsx)("span",{className:"text-xs text-amber-600 font-medium",children:"Private"})]}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Tt.A,{className:"h-3 w-3 text-green-500"}),(0,te.jsx)("span",{className:"text-xs text-green-600 font-medium",children:"Public"})]})})})]},e.item.id),f.has(e.item.id)&&(0,te.jsx)(_v,{children:(0,te.jsx)(Cv,{colSpan:7,className:"bg-gradient-to-br from-gray-50 to-gray-100/50 p-6 border-t border-gray-100",children:(0,te.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-4 bg-blue-500 rounded-full"}),"Creator & Usage"]}),(0,te.jsxs)("div",{className:"space-y-3 text-sm",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"text-gray-600",children:"Creator:"}),(0,te.jsx)("span",{className:"font-medium text-gray-900",children:(null===(t=e.item_creator)||void 0===t?void 0:t.full_name)||(0,te.jsx)("span",{className:"text-gray-400 italic",children:"Unknown"})})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"text-gray-600",children:"Uses:"}),(0,te.jsxs)("div",{className:"flex items-center gap-1",children:[(0,te.jsx)(Ha.A,{className:"h-3 w-3 text-gray-500"}),(0,te.jsx)("span",{className:"font-medium text-gray-900",children:e.usage||0})]})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center",children:[(0,te.jsx)("span",{className:"text-gray-600",children:"Status:"}),q(e.item.status)]})]})]}),(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-4 bg-purple-500 rounded-full"}),"Admin Actions"]}),(0,te.jsxs)("div",{className:"flex gap-2",children:[(0,te.jsxs)(sl,{size:"sm",className:"bg-green-600 hover:bg-green-700 text-white",onClick:s=>{s.stopPropagation(),z("approve",e)},disabled:p[e.item.id],children:[(0,te.jsx)(mt.A,{className:"h-3 w-3 mr-1"}),"Approve"]}),(0,te.jsxs)(sl,{size:"sm",variant:"outline",className:"text-red-600 border-red-200 hover:bg-red-50",onClick:s=>{s.stopPropagation(),z("decline",e)},disabled:p[e.item.id],children:[(0,te.jsx)(Ds.A,{className:"h-3 w-3 mr-1"}),"Decline"]}),(0,te.jsxs)(sl,{size:"sm",variant:"outline",onClick:s=>{s.stopPropagation(),window.open(`/integrations-catalog/item/${e.item.id}`,"_blank")},children:[(0,te.jsx)(Jd.A,{className:"h-3 w-3 mr-1"}),"View"]})]})]})]}),(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-4 bg-emerald-500 rounded-full"}),"Description"]}),(0,te.jsx)("div",{className:"text-sm text-gray-600 prose prose-sm max-w-none",dangerouslySetInnerHTML:{__html:Oc(e.item.description||'<p class="text-gray-400 italic">No description available</p>')}})]}),(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 shadow-sm",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-4 bg-orange-500 rounded-full"}),"Technical Details"]}),(0,te.jsxs)("div",{className:"space-y-2 text-sm",children:[(0,te.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,te.jsx)("span",{className:"text-gray-600",children:"Integration ID:"}),(0,te.jsx)("code",{className:"text-gray-900 bg-gray-100 px-2 py-0.5 rounded text-xs font-mono",children:e.item.integration_id})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,te.jsx)("span",{className:"text-gray-600",children:"Organization:"}),(0,te.jsx)("code",{className:"text-gray-900 bg-gray-100 px-2 py-0.5 rounded text-xs font-mono",children:e.item.organization_id})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,te.jsx)("span",{className:"text-gray-600",children:"Created:"}),(0,te.jsx)("span",{className:"text-gray-900 font-medium",children:Bt().utc(e.item.created_date).format("MMM DD, YYYY")})]}),(0,te.jsxs)("div",{className:"flex justify-between items-center py-1",children:[(0,te.jsx)("span",{className:"text-gray-600",children:"Updated:"}),(0,te.jsx)("span",{className:"text-gray-900 font-medium",children:Bt().utc(e.item.updated_date).format("MMM DD, YYYY")})]})]})]}),(null===(a=e.item.categories)||void 0===a?void 0:a.length)>0&&(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-5 bg-purple-500 rounded-full"}),"Categories"]}),(0,te.jsx)("div",{className:"flex flex-wrap gap-2",children:e.item.categories.map(((e,s)=>(0,te.jsx)(Xp,{className:"bg-purple-50 text-purple-700 border-purple-200 hover:bg-purple-100 transition-colors",children:e},s)))})]})]}),(0,te.jsxs)("div",{className:"bg-white p-4 rounded-lg border border-gray-200 h-fit",children:[(0,te.jsxs)("h4",{className:"font-semibold text-gray-900 mb-3 flex items-center gap-2",children:[(0,te.jsx)("div",{className:"w-1 h-5 bg-orange-500 rounded-full"}),"Screenshots"]}),(null===(r=e.item.screenshot_urls)||void 0===r?void 0:r.length)>0?(0,te.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[e.item.screenshot_urls.slice(0,3).map(((e,s)=>(0,te.jsxs)("div",{className:"relative rounded-lg overflow-hidden border border-gray-200 group",children:[(0,te.jsx)("img",{src:e,alt:`Screenshot ${s+1}`,className:"w-full h-36 object-cover group-hover:scale-105 transition-all duration-300 cursor-pointer",onClick:()=>window.open(e,"_blank")}),(0,te.jsx)("div",{className:"absolute inset-0 bg-black/0 group-hover:bg-black/10 transition-colors duration-300 flex items-center justify-center",children:(0,te.jsx)("div",{className:"opacity-0 group-hover:opacity-100 transition-opacity duration-300 bg-white/90 backdrop-blur-sm rounded-full p-2",children:(0,te.jsx)(Jd.A,{className:"h-4 w-4 text-gray-700"})})})]},s))),e.item.screenshot_urls.length>3&&(0,te.jsx)("div",{className:"text-center py-2 bg-gray-50 rounded-lg border border-gray-200",children:(0,te.jsxs)("p",{className:"text-sm text-gray-600 font-medium",children:["+",e.item.screenshot_urls.length-3," more screenshots"]})})]}):(0,te.jsxs)("div",{className:"text-center py-8 text-gray-400 bg-gray-50 rounded-lg border-2 border-dashed border-gray-200",children:[(0,te.jsx)(Jd.A,{className:"h-8 w-8 mx-auto mb-2 opacity-50"}),(0,te.jsx)("p",{className:"text-sm",children:"No screenshots available"})]})]})]})})})]})}))})]})}),(0,te.jsxs)("div",{className:"mt-6 flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,te.jsxs)("div",{className:"flex items-center gap-4 text-sm text-gray-600",children:[(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsx)("span",{children:"Showing"}),(0,te.jsxs)("span",{className:"font-semibold text-gray-900",children:[Math.min((j-1)*y+1,w),"-",Math.min(j*y,w)]}),(0,te.jsx)("span",{children:"of"}),(0,te.jsx)("span",{className:"font-semibold text-gray-900",children:w}),(0,te.jsx)("span",{children:"integrations"})]}),(0,te.jsxs)(pl,{value:y.toString(),onValueChange:e=>{return s=parseInt(e),N(s),void b(1);var s},children:[(0,te.jsx)(fl,{className:"w-24 h-8 text-sm",children:(0,te.jsx)(gl,{})}),(0,te.jsxs)(bl,{children:[(0,te.jsx)(yl,{value:"10",children:"10"}),(0,te.jsx)(yl,{value:"20",children:"20"}),(0,te.jsx)(yl,{value:"50",children:"50"}),(0,te.jsx)(yl,{value:"100",children:"100"})]})]}),(0,te.jsx)("span",{className:"text-gray-500",children:"per page"})]}),(0,te.jsx)(Iv,{currentPage:j,totalPages:_,onPageChange:e=>{b(e)}})]}),(0,te.jsx)(Bn,{open:P.isOpen,onOpenChange:U,children:(0,te.jsxs)(Yn,{children:[(0,te.jsxs)(Hn,{children:[(0,te.jsxs)(Jn,{children:["approve"===P.action&&"Approve Integration","decline"===P.action&&"Decline Integration","archive"===P.action&&"Archive Integration"]}),(0,te.jsxs)(Zn,{children:["approve"===P.action&&(0,te.jsxs)(te.Fragment,{children:["Are you sure you want to approve ",(0,te.jsx)("strong",{children:null===(s=P.item)||void 0===s?void 0:s.item.name}),"?",(0,te.jsx)("br",{}),"This will make the integration publicly visible in the catalog."]}),"decline"===P.action&&(0,te.jsxs)(te.Fragment,{children:["Are you sure you want to decline ",(0,te.jsx)("strong",{children:null===(t=P.item)||void 0===t?void 0:t.item.name}),"?",(0,te.jsx)("br",{}),"This will remove the integration from public visibility in the catalog.",(0,te.jsxs)("div",{className:"mt-4",children:[(0,te.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Reason for decline (optional):"}),(0,te.jsx)("textarea",{placeholder:"Enter reason for declining this integration...",value:O,onChange:e=>R(e.target.value),className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]})]}),"archive"===P.action&&(0,te.jsxs)(te.Fragment,{children:["Are you sure you want to archive ",(0,te.jsx)("strong",{children:null===(a=P.item)||void 0===a?void 0:a.item.name}),"?",(0,te.jsx)("br",{}),"This will permanently remove the integration from the catalog."]})]})]}),(0,te.jsxs)(Gn,{children:[(0,te.jsx)(sl,{variant:"outline",onClick:U,children:"Cancel"}),(0,te.jsxs)(sl,{onClick:async()=>{if(!P.action||!P.item)return;const{action:e,item:s}=P,t=s.item.id;g((e=>({...e,[t]:!0}))),U();try{switch(e){case"approve":await Bs.approveItem(t);break;case"decline":await Bs.declineItem(t,O||void 0);break;case"archive":await Bs.archiveItem(t)}zn({title:"Success",description:`Integration ${e}d successfully`}),await F()}catch(a){zn({title:"Error",description:`Failed to ${e} integration`,variant:"destructive"})}finally{g((e=>({...e,[t]:!1})))}},className:"approve"===P.action?"bg-green-600 hover:bg-green-700":"decline"===P.action?"bg-red-600 hover:bg-red-700":"bg-gray-600 hover:bg-gray-700",children:["approve"===P.action&&"Approve","decline"===P.action&&"Decline","archive"===P.action&&"Archive"]})]})]})})]}):(0,te.jsx)("div",{className:"flex items-center justify-center h-screen",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)(gh.A,{className:"w-16 h-16 text-red-500 mx-auto mb-4"}),(0,te.jsx)("h2",{className:"text-2xl font-bold text-gray-800",children:"Access Denied"}),(0,te.jsx)("p",{className:"text-gray-600",children:"You are not authorized to access this page"})]})})}function Tv(){const{fileId:e}=(0,Z.g)();window.location.href=`${(0,bd.wE)()}/api/files/${e}`}function $v(e){let{url:s}=e;window.location.href=s}function Dv(e){let{urlChangeHandler:s}=e;const t=(0,Z.g)(),a=window.location.pathname,r=s(a,t);return r!==a&&(window.location.href=r),(0,te.jsx)("div",{children:"Loading..."})}const Pv=[{name:"Home",url:"/",component:(0,te.jsx)(ya,{}),icon:(0,te.jsx)(Fa.A,{})},{name:"Login",url:"/login",component:(0,te.jsx)(ep,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"Register",url:"/register",component:(0,te.jsx)(pp,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"VerifyEmail",url:"/verify-email",component:(0,te.jsx)(gp,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"ForgotPassword",url:"/forgot-password",component:(0,te.jsx)(fp,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"CheckEmail",url:"/check-email",component:(0,te.jsx)(vp,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"ResetPassword",url:"/reset-password",component:(0,te.jsx)(jp,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"PrivacyPolicy",url:"/privacy-policy",component:(0,te.jsx)($v,{url:"https://base44.com/privacy-policy"}),requiresAuth:!1,hide:!0},{name:"TermsOfService",url:"/terms-of-service",component:(0,te.jsx)($v,{url:"https://base44.com/terms-of-service"}),requiresAuth:!1,hide:!0},{name:"ResponsibleUse",url:"/responsible-use-policy",component:(0,te.jsx)(Mp,{}),requiresAuth:!1,hide:!0},{name:"File",url:"/api/files/:fileId",component:(0,te.jsx)(Tv,{}),requiresAuth:!1,usesLayout:!1,hide:!0},{name:"User Apps",url:"/user-apps/:appId/show/:pageName?",component:(0,te.jsx)(Dv,{urlChangeHandler:e=>e.replace("/user-apps/","/apps/")}),icon:(0,te.jsx)(za.A,{}),showInMenu:!1,requiresAuth:!1},{name:"User Apps",url:"/apps",component:(0,te.jsx)(Ra,{}),icon:(0,te.jsx)(za.A,{}),children:[{name:"User App Dashboard",url:"/apps/:appId",component:(0,te.jsx)(hh,{}),icon:(0,te.jsx)(za.A,{}),usesLayout:!1},{name:"App Show",url:"/apps-show/:appSlug/:pageName?",component:(0,te.jsx)(Dv,{urlChangeHandler:(e,s)=>{const t=s.appSlug,a=s.pageName;return`https://${t}.${window.location.host}/${a||""}`}}),icon:(0,te.jsx)(Ua.A,{}),usesLayout:!1,requiresAuth:!1},{name:"Edit User App",url:"/apps/:appId/editor/preview/:pageName",component:(0,te.jsx)(hh,{view:"preview"}),icon:(0,te.jsx)(Ba.A,{}),usesLayout:!1},{name:"Remix User App",url:"/remix-app/:appId",component:(0,te.jsx)(Mg,{}),icon:(0,te.jsx)(Ba.A,{})},{name:"Edit User App",url:"/apps/:appId/dashboard",component:(0,te.jsx)(hh,{view:"workspace"}),icon:(0,te.jsx)(Ba.A,{}),usesLayout:!1},{name:"Edit User App",url:"/apps/:appId/editor/preview",component:(0,te.jsx)(hh,{view:"preview"}),icon:(0,te.jsx)(Ba.A,{}),usesLayout:!1},{name:"Edit User App",url:"/apps/:appId/editor/workspace/:workspaceView",component:(0,te.jsx)(hh,{view:"workspace"}),icon:(0,te.jsx)(Ba.A,{}),usesLayout:!1},{name:"Create App",url:"/create-app",component:(0,te.jsx)(ph,{}),icon:(0,te.jsx)(ys.A,{})}]},{name:"Billing",url:"/billing",component:(0,te.jsx)(ql,{}),icon:(0,te.jsx)(Ze.A,{}),hide:!0},{name:"Support",url:"/support",component:(0,te.jsx)(Bg,{})},{name:"My Tickets",url:"/support/conversations",component:(0,te.jsx)(wf,{})},{name:"Admin Support Tickets",url:"/support/admin/conversations",component:(0,te.jsx)(Rf,{}),usesLayout:!1},{name:"Admin Support Docs",url:"/support/admin/agent-backoffice",component:(0,te.jsx)(Gf,{})},{name:"Admin Analytics",url:"/support/admin/analytics",component:(0,te.jsx)(yv,{})},{name:"User Management",url:"/user-management",component:(0,te.jsx)(Wh,{}),icon:(0,te.jsx)(Wa.A,{}),hide:!0},{name:"App Templates Management",url:"/app-templates-management",component:(0,te.jsx)(Ev,{}),icon:(0,te.jsx)(Wa.A,{}),hide:!0},{name:"Integration Management",url:"/integration-management",component:(0,te.jsx)(Lv,{}),icon:(0,te.jsx)(qa.A,{}),hide:!0},{name:"Integrations Catalog",url:"/integrations-catalog",component:(0,te.jsx)(ng,{}),icon:(0,te.jsx)(qa.A,{}),children:[{name:"Integrations Catalog Item",url:"/integrations-catalog/item/:itemId",component:(0,te.jsx)(dg,{})},{name:"Integration Editor",url:"/integrations-catalog/editor/:itemId?",component:(0,te.jsx)(vg,{})}]},{name:"App Templates",url:"/app-templates",component:(0,te.jsx)(Pg,{}),icon:(0,te.jsx)(za.A,{}),children:[{name:"Manage Listing",url:"/app-templates/manage-listing/:appId",component:(0,te.jsx)(Jc,{})}]},{name:"Analytics",url:"/admin/analytics",component:(0,te.jsx)(qh,{}),icon:(0,te.jsx)(Va.A,{}),hide:!0},{name:"Stripe",url:"/integrations/stripe",component:(0,te.jsx)(Pp,{}),icon:(0,te.jsx)(Ze.A,{}),hide:!0},{name:"Workspace Dashboard",url:"/workspace/:workspaceId",component:(0,te.jsx)(mv,{}),hide:!0},{name:"Create Workspace",url:"/create-workspace",component:(0,te.jsx)(uv,{}),hide:!0},{name:"Accept Invitation",url:"/invite/accept",component:(0,te.jsx)(xv,{}),hide:!0,usesLayout:!1,requiresAuth:!0},{name:"NotFound",url:"*",component:(0,te.jsx)(yp,{}),hide:!0,usesLayout:!1,requiresAuth:!1}];var Mv=t(30772);function Ov(e){let{isMobile:s=!1,onItemClick:t}=e;const{user:a}=ne(),r=(0,Z.Zp)(),{workspaces:n,isLoadingWorkspaces:l,activeWorkspace:i,switchActiveWorkspace:o}=xe(),c=e=>{o(e),t&&t()},d=e=>{r(`/workspace/${e.id}`),t&&t()},m=e=>{if(e.is_personal)return!1;const s=e.user_role||e.role||"member";return["owner","admin"].includes(s)},u=()=>{r("/create-workspace"),t&&t()};var x;return s?(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsx)("h2",{className:"text-lg font-semibold mb-4",children:"Workspaces"}),l?(0,te.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin text-slate-400"}),(0,te.jsx)("span",{className:"ml-2 text-sm text-slate-500",children:"Loading..."})]}):n.length>0?(0,te.jsx)("nav",{className:"flex flex-col space-y-2",children:n.map((e=>(0,te.jsxs)("button",{onClick:()=>c(e),className:"flex items-center justify-between text-base font-medium p-2 rounded-lg hover:bg-slate-100 transition-colors "+((null==i?void 0:i.id)===e.id?"bg-slate-100 border-l-2 border-teal-500":""),children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[e.is_personal?(0,te.jsx)(Mm.A,{className:"h-4 w-4 text-slate-400 flex-shrink-0"}):(0,te.jsx)(Wa.A,{className:"h-4 w-4 text-slate-400 flex-shrink-0"}),(0,te.jsxs)("div",{className:"min-w-0 flex-1 text-left",children:[(0,te.jsx)("div",{className:"font-medium text-slate-900 truncate",children:e.is_personal&&(null==a?void 0:a.full_name)||e.name}),e.domain&&!e.is_personal&&(0,te.jsx)("div",{className:"text-xs text-slate-500 truncate",children:e.domain})]})]}),(0,te.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.is_personal&&(0,te.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800",children:"Personal"}),m(e)&&(0,te.jsx)("button",{onClick:s=>{s.stopPropagation(),d(e)},className:"px-2 py-1 hover:bg-slate-200 rounded text-xs",title:"Manage Workspace",children:(0,te.jsx)("span",{className:"text-slate-500 font-medium",children:"Manage"})})]})]},e.id)))}):(0,te.jsx)("div",{className:"text-sm text-slate-500 text-center py-4",children:"No workspaces found"}),(null==a||null===(x=a.feature_flags)||void 0===x?void 0:x.includes("CreateTeam"))&&((n?n.filter((e=>!e.is_personal)).length:0)>=3?null:(0,te.jsxs)("button",{onClick:u,className:"flex items-center text-base p-2 rounded-lg hover:bg-slate-100 transition-colors w-full border-t border-slate-200 pt-4 mt-4",children:[(0,te.jsx)("div",{className:"flex items-center justify-center w-4 h-4 mr-2 bg-slate-100 rounded text-slate-500",children:(0,te.jsx)("span",{className:"text-xs font-bold",children:"+"})}),(0,te.jsx)("span",{className:"text-sm text-slate-600",children:"Create a Workspace"})]}))]}):(0,te.jsxs)("div",{className:"p-1",children:[(0,te.jsx)(Ar,{className:"px-4 py-2 text-xs font-semibold text-slate-500 uppercase tracking-wider",children:"Workspaces"}),l?(0,te.jsxs)("div",{className:"px-4 py-3 flex items-center justify-center",children:[(0,te.jsx)(Je.A,{className:"h-4 w-4 animate-spin text-slate-400"}),(0,te.jsx)("span",{className:"ml-2 text-sm text-slate-500",children:"Loading..."})]}):n.length>0?(0,te.jsx)("div",{children:n.map((e=>(0,te.jsxs)(_r,{onClick:()=>c(e),className:"cursor-pointer flex items-center justify-between px-4 py-2 hover:bg-slate-50 "+((null==i?void 0:i.id)===e.id?"bg-slate-50 border-l-2 border-teal-500":""),children:[(0,te.jsxs)("div",{className:"flex items-center gap-2 min-w-0",children:[(0,te.jsx)("div",{className:"flex-shrink-0",children:e.is_personal?(0,te.jsx)(Mm.A,{className:"h-4 w-4 text-slate-400"}):(0,te.jsx)(Wa.A,{className:"h-4 w-4 text-slate-400"})}),(0,te.jsxs)("div",{className:"min-w-0 flex-1",children:[(0,te.jsx)("div",{className:"text-sm font-medium text-slate-900 truncate",children:e.is_personal&&(null==a?void 0:a.full_name)||e.name}),e.domain&&!e.is_personal&&(0,te.jsx)("div",{className:"text-xs text-slate-500 truncate",children:e.domain})]})]}),(0,te.jsxs)("div",{className:"flex items-center gap-1 flex-shrink-0",children:[e.is_personal&&(0,te.jsx)("span",{className:"inline-flex items-center px-1.5 py-0.5 rounded text-xs font-medium bg-orange-100 text-orange-800",children:"Personal"}),m(e)&&(0,te.jsx)("button",{onClick:s=>{s.stopPropagation(),d(e)},className:"px-2 py-1 hover:bg-slate-200 rounded text-xs",title:"Manage Workspace",children:(0,te.jsx)("span",{className:"text-slate-500 font-medium",children:"Manage"})})]})]},e.id)))}):(0,te.jsx)("div",{className:"px-4 py-3",children:(0,te.jsx)("div",{className:"text-sm text-slate-500 text-center",children:"No workspaces found"})}),(n?n.filter((e=>!e.is_personal)).length:0)>=3?null:(0,te.jsxs)(_r,{onClick:u,className:"cursor-pointer flex items-center px-4 py-2 hover:bg-slate-50 border-t border-slate-100 mt-1",children:[(0,te.jsx)("div",{className:"flex items-center justify-center w-4 h-4 mr-2 bg-slate-100 rounded text-slate-500",children:(0,te.jsx)("span",{className:"text-xs font-bold",children:"+"})}),(0,te.jsx)("span",{className:"text-sm text-slate-600",children:"Create a Workspace"})]})]})}const Rv="text-gray-700 hover:text-gray-800",Fv="",zv=()=>(0,te.jsx)("img",{src:"/Logo_v5.png",alt:"Base44",width:"114",height:"28"});function Uv(){const{logout:e,user:s}=ne(),t=(0,Z.Zp)(),a=(0,Z.zy)(),{workspaces:r,isLoadingWorkspaces:n,activeWorkspace:l,switchActiveWorkspace:i}=xe(),[o,c]=(0,Y.useState)(!1),[d,m]=(0,Y.useState)(!1),u=()=>{c(!1)};(0,Y.useEffect)((()=>{!n&&r.length>0&&!l&&i(r[0])}),[r,n,l,i]);const x=e=>a.pathname===e,h=[{key:"settings",icon:(0,te.jsx)(Vi.A,{size:18,className:"mr-2"}),label:"Settings",onClick:()=>m(!0)},{key:"billing",icon:(0,te.jsx)(Ze.A,{size:18,className:"mr-2"}),label:"Billing",onClick:()=>{Se("User Clicked Billing",{source:"top_bar_user_menu",destination:"/billing"}),Fe({user_id:(null==s?void 0:s.id)||null,app_id:null,conversation_id:null},{cta:"billing",origin:"top_bar_user_menu",target_route:"/billing"}),t("/billing")}}],p=[{key:"affiliates",icon:(0,te.jsx)(gx.A,{size:18,className:"mr-2"}),label:"Become an Affiliate!",onClick:()=>window.open("https://base44.com/affiliates","_blank"),className:"text-slate-500"},{key:"logout",icon:(0,te.jsx)(jx.A,{size:18,className:"mr-2"}),label:"Sign Out",onClick:()=>{e(),t("/login")}}],g=[{href:"/apps",external:!1,label:"Apps"},{href:"/integrations-catalog",external:!1,label:"Integrations"},{href:"/app-templates",external:!1,label:"App Templates"},{href:"https://base44.com/affiliates",external:!0,label:"Affiliates"},{href:"https://app.base44.com/support",external:!0,label:"Docs & Support"}],f=[{href:"https://discord.gg/ThpYPZpVts",title:"Join our Discord",icon:(0,te.jsx)("svg",{className:"h-7 w-7",viewBox:"0 0 24 24",fill:"none",xmlns:"http://www.w3.org/2000/svg",children:(0,te.jsx)("path",{d:"M18.8943 4.34399C17.5183 3.71467 16.057 3.256 14.5317 3C14.3396 3.33067 14.1263 3.77866 13.977 4.13067C12.3546 3.89599 10.7439 3.89599 9.14391 4.13067C8.99457 3.77866 8.77056 3.33067 8.58922 3C7.05325 3.256 5.59191 3.71467 4.22552 4.34399C1.46286 8.41865 0.716188 12.3973 1.08952 16.3226C2.92418 17.6559 4.69486 18.4666 6.4346 19C6.86126 18.424 7.24527 17.8053 7.57594 17.1546C6.9466 16.92 6.34927 16.632 5.77327 16.2906C5.9226 16.184 6.07194 16.0667 6.21061 15.9493C9.68793 17.5387 13.4543 17.5387 16.889 15.9493C17.0383 16.0667 17.177 16.184 17.3263 16.2906C16.7503 16.632 16.153 16.92 15.5236 17.1546C15.8543 17.8053 16.2383 18.424 16.665 19C18.4036 18.4666 20.185 17.6559 22.01 16.3226C22.4687 11.7787 21.2836 7.83202 18.8943 4.34399ZM8.05593 13.9013C7.01058 13.9013 6.15725 12.952 6.15725 11.7893C6.15725 10.6267 6.98925 9.67731 8.05593 9.67731C9.11191 9.67731 9.97588 10.6267 9.95454 11.7893C9.95454 12.952 9.11191 13.9013 8.05593 13.9013ZM15.065 13.9013C14.0196 13.9013 13.1652 12.952 13.1652 11.7893C13.1652 10.6267 13.9983 9.67731 15.065 9.67731C16.121 9.67731 16.985 10.6267 16.9636 11.7893C16.9636 12.952 16.1317 13.9013 15.065 13.9013Z",stroke:"currentColor",strokeWidth:"1.5",strokeLinejoin:"round"})})},{href:"https://x.com/base_44",title:"Follow on X",icon:(0,te.jsx)(fa.A,{size:26})},{href:"https://www.linkedin.com/company/106589953",title:"Follow on LinkedIn",icon:(0,te.jsx)(ga.A,{size:26})}];return(0,te.jsxs)("header",{className:"sticky top-0 z-50",children:[(0,te.jsx)("div",{className:"mx-auto px-4 sm:px-6 lg:px-8",children:(0,te.jsxs)("div",{className:"flex items-center justify-between h-16",children:[(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)(J.Link,{to:"/",children:(0,te.jsx)(zv,{})}),(0,te.jsx)("nav",{className:"hidden md:flex items-center ml-6 sm:ml-8 space-x-4 sm:space-x-6",children:g.map(((e,s)=>e.external?(0,te.jsxs)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"relative flex font-base44 items-center text-sm font-medium text-gray-700 py-2 transition-colors duration-200 hover:text-orange-500 group",children:[e.icon,e.label,(0,te.jsx)("span",{className:"absolute bottom-1 left-0 w-full h-0.5 bg-orange-500 transform scale-x-0 transition-transform duration-200 group-hover:scale-x-100"})]},s):(0,te.jsxs)(J.Link,{to:e.href,className:"relative flex font-base44 items-center text-sm font-medium py-2 transition-colors duration-200 group "+(x(e.href)?"text-orange-500":"text-gray-700 hover:text-orange-500"),children:[e.icon,e.label,(0,te.jsx)("span",{className:"absolute bottom-1 left-0 w-full h-0.5 bg-orange-500 transform transition-transform duration-200 "+(x(e.href)?"scale-x-100":"scale-x-0 group-hover:scale-x-100")})]},s)))})]}),(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsx)("div",{className:"hidden md:flex items-center space-x-4 mr-5",children:f.map(((e,s)=>(0,te.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:`${Rv} ${Fv}`,title:e.title,children:e.icon},s)))}),(0,te.jsxs)("div",{className:"flex items-center",children:[(0,te.jsxs)(gr,{children:[(0,te.jsx)(fr,{className:"outline-none",children:(0,te.jsxs)("div",{className:"flex items-center gap-2",children:[(0,te.jsxs)("div",{className:`${Rv} ${Fv} cursor-pointer relative`,children:[(0,te.jsx)(Fx,{}),l&&!l.is_personal&&(0,te.jsx)("div",{className:"absolute -bottom-1 -right-1 w-3 h-3 bg-teal-500 border-2 border-white rounded-full"})]}),l&&!l.is_personal&&(0,te.jsxs)("div",{className:"hidden md:flex items-center text-sm text-slate-600",children:[(0,te.jsx)(Wa.A,{className:"w-4 h-4 mr-1 text-slate-400"}),(0,te.jsx)("span",{className:"font-medium max-w-24 truncate",children:l.name})]})]})}),(0,te.jsxs)(kr,{align:"end",className:"w-64 p-0 shadow-lg border border-slate-200 rounded-lg",children:[s&&(0,te.jsxs)("div",{className:"px-4 py-3 border-b border-slate-100",children:[(0,te.jsx)("div",{className:"font-medium",children:s.full_name}),(0,te.jsx)("div",{className:"text-xs text-muted-foreground truncate mt-0.5",children:s.email}),l&&!l.is_personal&&(0,te.jsxs)("div",{className:"flex items-center mt-2 px-2 py-1 bg-slate-50 rounded text-xs border border-slate-200",children:[(0,te.jsx)(Wa.A,{className:"w-3 h-3 text-slate-500 mr-2"}),(0,te.jsx)("span",{className:"text-slate-700 font-medium truncate",children:l.name})]})]}),(0,te.jsx)("div",{className:"p-1",children:h.map((e=>(0,te.jsxs)(_r,{onClick:e.onClick,className:"cursor-pointer flex items-center px-4 py-2 hover:bg-slate-50",children:[e.icon,(0,te.jsx)("span",{children:e.label})]},e.key)))}),(0,te.jsx)(Ov,{}),(0,te.jsx)(Er,{}),(0,te.jsx)("div",{className:"p-1",children:p.map((e=>(0,te.jsxs)(_r,{onClick:e.onClick,className:`cursor-pointer flex items-center px-4 py-2 hover:bg-slate-50 ${"logout"===e.key?"text-gray-800 hover:text-red-900":e.className||""}`,children:[e.icon,(0,te.jsx)("span",{children:e.label})]},e.key)))})]})]}),(0,te.jsx)("div",{className:"md:hidden ml-4 flex items-center",children:(0,te.jsxs)(dc,{open:o,onOpenChange:c,children:[(0,te.jsx)(mc,{asChild:!0,children:(0,te.jsx)("button",{className:`${Rv} ${Fv} flex items-center justify-center`,children:(0,te.jsx)(Mv.A,{size:24})})}),(0,te.jsx)(gc,{side:"right",className:"w-[80%] sm:w-[350px] p-0",children:(0,te.jsxs)("div",{className:"flex flex-col h-full",children:[(0,te.jsx)("div",{className:"flex-1 px-6 py-8",children:(0,te.jsx)("nav",{className:"space-y-1",children:g.map(((e,s)=>e.external?(0,te.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"block py-4 min-h-[44px] flex items-center text-lg font-medium text-gray-700 hover:text-orange-500 transition-colors",onClick:u,children:e.label},s):(0,te.jsx)(J.Link,{to:e.href,className:"py-4 min-h-[44px] flex items-center text-lg font-medium text-gray-700 hover:text-orange-500 transition-colors",onClick:u,children:e.label},s)))})}),(0,te.jsx)("div",{className:"px-6 py-8 border-t border-gray-100",children:(0,te.jsx)("div",{className:"flex justify-center space-x-8",children:f.map(((e,s)=>(0,te.jsx)("a",{href:e.href,target:"_blank",rel:"noopener noreferrer",className:"text-gray-600 hover:text-orange-500 transition-colors",title:e.title,"aria-label":e.title,children:e.icon},s)))})})]})})]})})]})]})]})}),(0,te.jsx)(Jx,{isOpen:d,onClose:()=>m(!1)})]})}const Bv=e=>{let{children:s}=e;return(0,te.jsxs)(ws,{children:[(0,te.jsx)(bm,{}),(0,te.jsx)("div",{className:"flex flex-col h-screen relative overflow-hidden",style:{background:"linear-gradient(148deg, rgba(242, 225, 208, 0.30) 3.86%, rgba(227, 232, 241, 0.30) 100%), #F8FAFC"},children:(0,te.jsxs)("div",{className:"flex flex-col h-full w-full relative z-10",children:[(0,te.jsx)(Uv,{}),(0,te.jsx)("div",{className:"flex-1 overflow-auto",children:(0,te.jsx)("main",{className:"w-full h-full",children:s})})]})})]})};var Wv=t(39330),qv=t(15441);const Vv=(0,Y.createContext)();class Yv extends K.y{getBaseURL(){return"/apps"}getCurrentUser(e){return this.axios.get(`/${e}/entities/User/me`)}}const Hv=new Yv,Gv=e=>{let{children:s,appId:t}=e;const[a,r]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(!1),[i,o]=(0,Y.useState)(!0),[c,d]=(0,Y.useState)(null),[m,u]=(0,Y.useState)(null);(0,Y.useEffect)((()=>{const e=(0,se.VO)(!0);if(e)(0,se.O5)(e),u("platform"),h();else{const e=se.b3.getSSOTokens();e&&e.access_token?(d(e),u("sso"),se.b3.setSSOTokens({sso_access_token:e.access_token,sso_token_type:e.token_type,sso_expires_at:e.expires_at,sso_scope:e.scope,sso_provider:e.provider,sso_id_token:e.id_token}),o(!1)):o(!1)}const s=se.b3.addListener(((e,s)=>{if("sso_tokens_updated"===e){const e=s.tokens;d(e);!(0,se.VO)(!1)&&e&&e.access_token&&u("sso")}else"sso_tokens_cleared"===e&&(d(null),"sso"===m&&(u(null),l(!1),r(null)))}));return()=>{s()}}),[]);const x=()=>{(0,se.QF)(),r(null),l(!1),o(!1),d(null),u(null),se.b3.clearSSOTokens()},h=async()=>{try{o(!0);const e=await Hv.getCurrentUser(t);return window.FS&&window.FS("setIdentity",{uid:e.id,properties:{displayName:e.full_name||e.email,email:e.email}}),r(e),l(!0),o(!1),e}catch(e){o(!1),x()}},p=()=>c||se.b3.getSSOTokens();return(0,te.jsx)(Vv.Provider,{value:{user:a,isAuthenticated:n,logout:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];if(x(),l(!1),r(null),e){const e=encodeURIComponent(window.location.href);window.location.href="/login?from_url="+e}},isLoadingAuth:i,updateUser:e=>{r(e)},ssoTokens:c,authMethod:m,loginWithSSO:function(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];const s=window.location.href,a=`/api/apps/${t}/auth/sso/login?from_url=${encodeURIComponent(s)}&include_external_tokens=${e}`;window.location.href=a},getSSOTokens:p,getSSOAuthHeader:()=>{const e=p();return e&&e.access_token?{Authorization:`${e.token_type} ${e.access_token}`}:null},fetchWithSSO:async function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return se.b3.fetchWithSSO(e,s)},clearSSOTokens:()=>{se.b3.clearSSOTokens(),d(null)}},children:s})},Jv=()=>(0,Y.useContext)(Vv);async function Zv(e,s){const t=(0,ee.Ay)(`https://base44.app/api/apps/${e}/integration-endpoints`,{"X-App-Id":e},!0,!0),a=await t.get("/schema");let r={};return(a.installed_packages||a).forEach((e=>{r[e.package_name]=function(e,s,t){const a={};return s.endpoints.forEach((r=>{a[r.name]=async a=>{if("create_checkout_session"===r.name&&window.parent!==window&&alert("Note - you're creating a stripe checkout session, but stripe does not allow this to be done inside an iframe. Please use the publish button to test the checkout flow."),"string"==typeof a)throw new Error(`Integration ${r.name} must receive an object with named parameters, received: ${a}`);try{let t,n;a instanceof FormData||a&&Object.values(a).some((e=>e instanceof File))?(t=new FormData,Object.keys(a).forEach((e=>{a[e]instanceof File?t.append(e,a[e],a[e].name):"object"==typeof a[e]&&null!==a[e]?t.append(e,JSON.stringify(a[e])):t.append(e,a[e])})),n="multipart/form-data"):(t=a,n="application/json");const l="Core"===s.package_name?`/Core/${r.name}`:`/${s.package_name}/${r.name}`,i=e.post(l,t||a,{headers:{"Content-Type":n}});return await i}catch(i){var n,l;throw t(`Error calling integration ${r.name}: ${(null===(n=i.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.detail)||i.message}`,`When using the app, the following integration call failed:\ninput parameters:\n${JSON.stringify(a,null,2)}`,null,i),i}}})),a}(t,e,s)})),r.getMissingPackages=()=>a.missing_packages||[],r}function Kv(e,s,t){class a extends K.y{getBaseURL(){return`https://base44.app/api/apps/${e}`}inviteUser(e,s){return this.axios.post("/users/invite-user",{user_email:e,role:s})}getMyUserInfo(){return this.axios.get("/entities/User/me")}updateMyUserData(e){return this.axios.put("/entities/User/me",e)}async logout(){t.logout(!1),window.location.reload()}async login(){const s=window.location.href,t=`${(0,bd.Zk)()}/apps/auth/login?from_url=${s}&app_id=${e}`;window.location.href=t}async loginWithRedirect(e){const s=window.location.href.substring(0,window.location.href.lastIndexOf("/")+1);window.location.href=`${s}login?from_url=${encodeURIComponent(e)}`}isUserAuthenticated(){return t.isUserAuthenticated()}register(e){return this.axios.post("/auth/register",e)}verifyOtp(e,s){return this.axios.post("/auth/verify-otp",{email:e,otp_code:s})}resendOtp(e){return this.axios.post("/auth/resend-otp",{email:e})}loginViaUsernamePassword(e,s){return this.axios.post("/auth/login",{email:e,password:s})}resetPasswordRequest(e){return this.axios.post("/auth/reset-password-request",{email:e})}resetPassword(e,s){return this.axios.post("/auth/reset-password",{reset_token:e,new_password:s})}changePassword(e,s,t){return this.axios.post("/auth/change-password",{user_id:e,current_password:s,new_password:t})}}return new a(s)}const Xv=(e,s,t)=>{const a=window.location.hostname;return!["localhost","base44.com","base44.app","app.base44.com","base44.onrender.com","apper-test.onrender.com","beta-base44.onrender.com","base44.io","ba11.me","ba22.me","ba33.me"].includes(a)||a.startsWith("app--")||a.startsWith("preview--")?t&&"object"==typeof t?`/${s}?${Object.keys(t).map((e=>`${e}=${t[e]}`)).join("&")}`:t&&"string"==typeof t?t.startsWith("?")?`/${s}${t}`:`/${s}?${t}`:`/${s}`:t&&"object"==typeof t?`/apps-show/${e.slug}/${s}?${Object.keys(t).map((e=>`${e}=${t[e]}`)).join("&")}`:t&&"string"==typeof t?t.startsWith("?")?`/apps-show/${e.slug}/${s}${t}`:`/apps-show/${e.slug}/${s}?${t}`:`/apps-show/${e.slug}/${s}`};async function Qv(e){const s=(0,ee.Ay)("https://base44.app/api/apps/public",{"X-App-Id":e.id,"X-App-Slug":e.slug});if(!e.id&&!e.slug)throw new Error("Either id or slug must be provided");let t;t=e.slug?await s.get(`/prod/by-slug/${e.slug}`):await s.get(`/prod/by-id/${e.id}`);const a={};a["api/base44Client.js"]=`import { createClient } from '@base44/sdk';\n\nexport const base44 = createClient({\n  appId: "${t.id}",\n  serverUrl: "https://base44.app",\n});\n`;const r=(s,a,r,n)=>{let l=r;if(a&&"string"==typeof a){const e=a.match(/at\s+(\w+)\s+/);if(e&&e[1]){const s=e[1];if(t.components&&t.components[s])l=s;else if(t.pages&&t.pages[s])l=s;else{for(const e in t.components||{})if(t.components[e].includes(`function ${s}`)){l=e;break}for(const e in t.pages||{})if(t.pages[e].includes(`function ${s}`)){l=e;break}}}}e.onError(s,a,l,n)},n=Kv(t.id,r,e.authProps),l=ps(t,r,n),i=await Zv(t.id,r),o=Hd(t,r),c=pu(t.id,void 0,r);return{appId:t.id,files:{...t,coreFiles:a},entities:l,integrations:i,functions:o,users:n,agents:c,getCurrentPage:()=>function(e){let s=window.location.pathname;s.endsWith("/")&&(s=s.slice(0,-1));let t=s.split("/").pop();return t.includes("?")&&(t=t.split("?")[0]),Object.keys(e.pages).map((e=>e.toLowerCase())).includes(t.toLowerCase())?{name:t,code:e.pages[t]}:t===e.slug||t===e.id||"preview"===t||""===t?{name:e.main_page,code:e.pages[e.main_page]}:null}(t),createPageUrl:(e,s)=>Xv(t,e,s),options:{...e,onError:r}}}var ej=t(21132);function sj(e){let s=!1;function t(e){!function(e){if(Xi.isJSXExpressionContainer(e)){const s=e.expression;if(Xi.isJSXEmptyExpression(s))return!1;if(!Xi.isLiteral(s))return!0}if(Xi.isTemplateLiteral(e)&&e.expressions.length>0)return!0;if(Xi.isMemberExpression(e))return!0;if(Xi.isCallExpression(e))return!0;if(Xi.isConditionalExpression(e))return!0;if(Xi.isIdentifier(e)&&["props","state","data","item","value","text","content"].some((s=>e.name.includes(s))))return!0;return!1}(e)?Object.keys(e).forEach((s=>{const a=e[s];Array.isArray(a)?a.forEach((e=>{e&&"object"==typeof e&&e.type&&t(e)})):a&&"object"==typeof a&&a.type&&t(a)})):s=!0}return e.children.forEach((e=>{s||t(e)})),s}function tj(e,s){const t=function(e,s){e.includes(".")&&(e=e.split(".")[0]);try{const t=(0,Ji.parse)(s,{sourceType:"module",plugins:["jsx","typescript","decorators-legacy","classProperties","objectRestSpread","functionBind","exportDefaultFrom","exportNamespaceFrom","dynamicImport","nullishCoalescingOperator","optionalChaining","asyncGenerators","bigInt","optionalCatchBinding","throwExpressions"]});return(0,Zi.default)(t,{JSXElement(s){var t;const a=s.node,r=a.openingElement;if(Xi.isJSXFragment(a))return;if(r.attributes.some((e=>Xi.isJSXAttribute(e)&&Xi.isJSXIdentifier(e.name)&&"data-source-location"===e.name.name)))return;const{line:n,column:l}=(null===(t=r.loc)||void 0===t?void 0:t.start)||{line:1,column:0},i=Xi.jsxAttribute(Xi.jsxIdentifier("data-source-location"),Xi.stringLiteral(`${e}:${n}:${l}`)),o=sj(a),c=Xi.jsxAttribute(Xi.jsxIdentifier("data-dynamic-content"),Xi.stringLiteral(o?"true":"false"));r.attributes.unshift(i,c)}}),{code:(0,Ki.default)(t,{retainLines:!0,compact:!1,concise:!1}).code,success:!0}}catch(t){return{code:s,success:!1,error:t instanceof Error?t.message:"Unknown error"}}}(e,s);return t.code}function aj(){const e="preview_";return{getItem:s=>localStorage.getItem(e+s),setItem:(s,t)=>localStorage.setItem(e+s,t),removeItem:s=>localStorage.removeItem(e+s)}}function rj(e){(e.startsWith("./")||e.startsWith("@/"))&&(e=e.substring(2));const s=e.split("/"),t=[];for(const r of s)".."===r?t.pop():"."!==r&&t.push(r);let a=t.join("/");return/\.\w+$/.test(a)||(a+=".js"),a}function nj(e,s){let t=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a={get(s,a){if(!s.hasOwnProperty(a)&&"PropTypes"!==a&&"__esModule"!==a&&a.charAt(0)===a.charAt(0).toUpperCase()){if("function"==typeof s&&a.charAt(0)===a.charAt(0).toUpperCase())return s;if(!t&&a===e.split("/").pop().split(".")[0]&&s.default)return s.default;throw new Error(`'${a}' does not exist in module: ${e}`)}return s[a]}};return new Proxy(s,a)}function lj(e,s,t){try{const a=crypto.randomUUID?crypto.randomUUID():Date.now().toString();window.parent.postMessage({type:"console-log",logId:a,data:{message:"object"==typeof e?JSON.stringify(e):e,severity:s,component:t}},"*")}catch(a){}}function ij(e,s){const t=`[${e}]`;return{log:function(){for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];window.console.log(t,...a);lj(a.map((e=>"object"==typeof e?JSON.stringify(e):String(e))).join(" "),"log",e)},error:function(){for(var a=arguments.length,r=new Array(a),n=0;n<a;n++)r[n]=arguments[n];window.console.error(t,...r);const l=r.find((e=>e instanceof Error)),i=r.map((e=>(null==e?void 0:e.message)||(null==e?void 0:e.toString()))).join(" - "),o={title:i,details:i,originalError:l,componentName:e};s(o.title,o.details,o.componentName,o.originalError),lj(i,"error",e)},warn:function(){for(var s=arguments.length,a=new Array(s),r=0;r<s;r++)a[r]=arguments[r];window.console.warn(t,...a);lj(a.map((e=>"object"==typeof e?JSON.stringify(e):String(e))).join(" "),"warn",e)}}}var oj=t(84079),cj=t(94048),dj=t(93204),mj=t(86991),uj=t(79476),xj=t(44472),hj=t(59019),pj=t(2527),gj=t(99603),fj=t(65604),vj=(t(55392),t(47810)),jj=t(32786);const bj=jj.bL,yj=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(jj.q7,{ref:s,className:ns("border-b",t),...a})}));yj.displayName="AccordionItem";const Nj=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsx)(jj.Y9,{className:"flex",children:(0,te.jsxs)(jj.l9,{ref:s,className:ns("flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180",t),...r,children:[a,(0,te.jsx)(ct.A,{className:"h-4 w-4 shrink-0 transition-transform duration-200"})]})})}));Nj.displayName=jj.l9.displayName;const wj=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsx)(jj.UC,{ref:s,className:"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down",...r,children:(0,te.jsx)("div",{className:ns("pb-4 pt-0",t),children:a})})}));wj.displayName=jj.UC.displayName;const kj=t(4687).b;var _j=t(55421);const Sj=Y.createContext(null);function Cj(){const e=Y.useContext(Sj);if(!e)throw new Error("useCarousel must be used within a <Carousel />");return e}const Aj=Y.forwardRef(((e,s)=>{let{orientation:t="horizontal",opts:a,setApi:r,plugins:n,className:l,children:i,...o}=e;const[c,d]=(0,_j.A)({...a,axis:"horizontal"===t?"x":"y"},n),[m,u]=Y.useState(!1),[x,h]=Y.useState(!1),p=Y.useCallback((e=>{e&&(u(e.canScrollPrev()),h(e.canScrollNext()))}),[]),g=Y.useCallback((()=>{null==d||d.scrollPrev()}),[d]),f=Y.useCallback((()=>{null==d||d.scrollNext()}),[d]),v=Y.useCallback((e=>{"ArrowLeft"===e.key?(e.preventDefault(),g()):"ArrowRight"===e.key&&(e.preventDefault(),f())}),[g,f]);return Y.useEffect((()=>{d&&r&&r(d)}),[d,r]),Y.useEffect((()=>{if(d)return p(d),d.on("reInit",p),d.on("select",p),()=>{null==d||d.off("select",p)}}),[d,p]),(0,te.jsx)(Sj.Provider,{value:{carouselRef:c,api:d,opts:a,orientation:t||("y"===(null==a?void 0:a.axis)?"vertical":"horizontal"),scrollPrev:g,scrollNext:f,canScrollPrev:m,canScrollNext:x},children:(0,te.jsx)("div",{ref:s,onKeyDownCapture:v,className:ns("relative",l),role:"region","aria-roledescription":"carousel",...o,children:i})})}));Aj.displayName="Carousel";const Ej=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;const{carouselRef:r,orientation:n}=Cj();return(0,te.jsx)("div",{ref:r,className:"overflow-hidden",children:(0,te.jsx)("div",{ref:s,className:ns("flex","horizontal"===n?"-ml-4":"-mt-4 flex-col",t),...a})})}));Ej.displayName="CarouselContent";const Ij=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;const{orientation:r}=Cj();return(0,te.jsx)("div",{ref:s,role:"group","aria-roledescription":"slide",className:ns("min-w-0 shrink-0 grow-0 basis-full","horizontal"===r?"pl-4":"pt-4",t),...a})}));Ij.displayName="CarouselItem";const Lj=Y.forwardRef(((e,s)=>{let{className:t,variant:a="outline",size:r="icon",...n}=e;const{orientation:l,scrollPrev:i,canScrollPrev:o}=Cj();return(0,te.jsxs)(Rs,{ref:s,variant:a,size:r,className:ns("absolute  h-8 w-8 rounded-full","horizontal"===l?"-left-12 top-1/2 -translate-y-1/2":"-top-12 left-1/2 -translate-x-1/2 rotate-90",t),disabled:!o,onClick:i,...n,children:[(0,te.jsx)(pi.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{className:"sr-only",children:"Previous slide"})]})}));Lj.displayName="CarouselPrevious";const Tj=Y.forwardRef(((e,s)=>{let{className:t,variant:a="outline",size:r="icon",...n}=e;const{orientation:l,scrollNext:i,canScrollNext:o}=Cj();return(0,te.jsxs)(Rs,{ref:s,variant:a,size:r,className:ns("absolute h-8 w-8 rounded-full","horizontal"===l?"-right-12 top-1/2 -translate-y-1/2":"-bottom-12 left-1/2 -translate-x-1/2 rotate-90",t),disabled:!o,onClick:i,...n,children:[(0,te.jsx)(Ht.A,{className:"h-4 w-4"}),(0,te.jsx)("span",{className:"sr-only",children:"Next slide"})]})}));Tj.displayName="CarouselNext";var $j=t(35802);const Dj=$j.bL,Pj=$j.l9,Mj=$j.YJ,Oj=$j.ZL,Rj=$j.Pb,Fj=$j.z6,zj=Y.forwardRef(((e,s)=>{let{className:t,inset:a,children:r,...n}=e;return(0,te.jsxs)($j.ZP,{ref:s,className:ns("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",a&&"pl-8",t),...n,children:[r,(0,te.jsx)(pr.A,{className:"ml-auto h-4 w-4"})]})}));zj.displayName=$j.ZP.displayName;const Uj=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)($j.G5,{ref:s,className:ns("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})}));Uj.displayName=$j.G5.displayName;const Bj=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)($j.ZL,{children:(0,te.jsx)($j.UC,{ref:s,className:ns("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})})}));Bj.displayName=$j.UC.displayName;const Wj=Y.forwardRef(((e,s)=>{let{className:t,inset:a,...r}=e;return(0,te.jsx)($j.q7,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",t),...r})}));Wj.displayName=$j.q7.displayName;const qj=Y.forwardRef(((e,s)=>{let{className:t,children:a,checked:r,...n}=e;return(0,te.jsxs)($j.H_,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...n,children:[(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)($j.VF,{children:(0,te.jsx)(mt.A,{className:"h-4 w-4"})})}),a]})}));qj.displayName=$j.H_.displayName;const Vj=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsxs)($j.hN,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)($j.VF,{children:(0,te.jsx)(nt.A,{className:"h-2 w-2 fill-current"})})}),a]})}));Vj.displayName=$j.hN.displayName;const Yj=Y.forwardRef(((e,s)=>{let{className:t,inset:a,...r}=e;return(0,te.jsx)($j.JU,{ref:s,className:ns("px-2 py-1.5 text-sm font-semibold text-foreground",a&&"pl-8",t),...r})}));Yj.displayName=$j.JU.displayName;const Hj=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)($j.wv,{ref:s,className:ns("-mx-1 my-1 h-px bg-border",t),...a})}));Hj.displayName=$j.wv.displayName;const Gj=e=>{let{className:s,...t}=e;return(0,te.jsx)("span",{className:ns("ml-auto text-xs tracking-widest text-muted-foreground",s),...t})};Gj.displayName="ContextMenuShortcut";const Jj=Uh.FormProvider,Zj=Y.createContext({}),Kj=e=>{let{...s}=e;return(0,te.jsx)(Zj.Provider,{value:{name:s.name},children:(0,te.jsx)(Uh.Controller,{...s})})},Xj=()=>{const e=Y.useContext(Zj),s=Y.useContext(Qj),{getFieldState:t,formState:a}=(0,Uh.useFormContext)(),r=t(e.name,a);if(!e)throw new Error("useFormField should be used within <FormField>");const{id:n}=s;return{id:n,name:e.name,formItemId:`${n}-form-item`,formDescriptionId:`${n}-form-item-description`,formMessageId:`${n}-form-item-message`,...r}},Qj=Y.createContext({}),eb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;const r=Y.useId();return(0,te.jsx)(Qj.Provider,{value:{id:r},children:(0,te.jsx)("div",{ref:s,className:ns("space-y-2",t),...a})})}));eb.displayName="FormItem";const sb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;const{error:r,formItemId:n}=Xj();return(0,te.jsx)(at,{ref:s,className:ns(r&&"text-destructive",t),htmlFor:n,...a})}));sb.displayName="FormLabel";const tb=Y.forwardRef(((e,s)=>{let{...t}=e;const{error:a,formItemId:r,formDescriptionId:n,formMessageId:l}=Xj();return(0,te.jsx)(Ms.DX,{ref:s,id:r,"aria-describedby":a?`${n} ${l}`:`${n}`,"aria-invalid":!!a,...t})}));tb.displayName="FormControl";const ab=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;const{formDescriptionId:r}=Xj();return(0,te.jsx)("p",{ref:s,id:r,className:ns("text-sm text-muted-foreground",t),...a})}));ab.displayName="FormDescription";const rb=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;const{error:n,formMessageId:l}=Xj(),i=n?String(null==n?void 0:n.message):a;return i?(0,te.jsx)("p",{ref:s,id:l,className:ns("text-sm font-medium text-destructive",t),...r,children:i}):null}));rb.displayName="FormMessage";var nb=t(87670);const lb=nb.bL,ib=nb.l9,ob=Y.forwardRef(((e,s)=>{let{className:t,align:a="center",sideOffset:r=4,...n}=e;return(0,te.jsx)(nb.UC,{ref:s,align:a,sideOffset:r,className:ns("z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...n})}));ob.displayName=nb.UC.displayName;var cb=t(24861);const db=cb.W1,mb=cb.YJ,ub=cb.ZL,xb=cb.Pb,hb=cb.z6,pb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(cb.bL,{ref:s,className:ns("flex h-10 items-center space-x-1 rounded-md border bg-background p-1",t),...a})}));pb.displayName=cb.bL.displayName;const gb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(cb.l9,{ref:s,className:ns("flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",t),...a})}));gb.displayName=cb.l9.displayName;const fb=Y.forwardRef(((e,s)=>{let{className:t,inset:a,children:r,...n}=e;return(0,te.jsxs)(cb.ZP,{ref:s,className:ns("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground",a&&"pl-8",t),...n,children:[r,(0,te.jsx)(pr.A,{className:"ml-auto h-4 w-4"})]})}));fb.displayName=cb.ZP.displayName;const vb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(cb.G5,{ref:s,className:ns("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...a})}));vb.displayName=cb.G5.displayName;const jb=Y.forwardRef(((e,s)=>{let{className:t,align:a="start",alignOffset:r=-4,sideOffset:n=8,...l}=e;return(0,te.jsx)(cb.ZL,{children:(0,te.jsx)(cb.UC,{ref:s,align:a,alignOffset:r,sideOffset:n,className:ns("z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...l})})}));jb.displayName=cb.UC.displayName;const bb=Y.forwardRef(((e,s)=>{let{className:t,inset:a,...r}=e;return(0,te.jsx)(cb.q7,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",a&&"pl-8",t),...r})}));bb.displayName=cb.q7.displayName;const yb=Y.forwardRef(((e,s)=>{let{className:t,children:a,checked:r,...n}=e;return(0,te.jsxs)(cb.H_,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...n,children:[(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)(cb.VF,{children:(0,te.jsx)(mt.A,{className:"h-4 w-4"})})}),a]})}));yb.displayName=cb.H_.displayName;const Nb=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsxs)(cb.hN,{ref:s,className:ns("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[(0,te.jsx)("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:(0,te.jsx)(cb.VF,{children:(0,te.jsx)(nt.A,{className:"h-2 w-2 fill-current"})})}),a]})}));Nb.displayName=cb.hN.displayName;const wb=Y.forwardRef(((e,s)=>{let{className:t,inset:a,...r}=e;return(0,te.jsx)(cb.JU,{ref:s,className:ns("px-2 py-1.5 text-sm font-semibold",a&&"pl-8",t),...r})}));wb.displayName=cb.JU.displayName;const kb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(cb.wv,{ref:s,className:ns("-mx-1 my-1 h-px bg-muted",t),...a})}));kb.displayName=cb.wv.displayName;const _b=e=>{let{className:s,...t}=e;return(0,te.jsx)("span",{className:ns("ml-auto text-xs tracking-widest text-muted-foreground",s),...t})};_b.displayname="MenubarShortcut";var Sb=t(14262);const Cb=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsxs)(Sb.bL,{ref:s,className:ns("relative z-10 flex max-w-max flex-1 items-center justify-center",t),...r,children:[a,(0,te.jsx)(Db,{})]})}));Cb.displayName=Sb.bL.displayName;const Ab=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Sb.B8,{ref:s,className:ns("group flex flex-1 list-none items-center justify-center space-x-1",t),...a})}));Ab.displayName=Sb.B8.displayName;const Eb=Sb.q7,Ib=(0,ts.cva)("group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[active]:bg-accent/50 data-[state=open]:bg-accent/50"),Lb=Y.forwardRef(((e,s)=>{let{className:t,children:a,...r}=e;return(0,te.jsxs)(Sb.l9,{ref:s,className:ns(Ib(),"group",t),...r,children:[a," ",(0,te.jsx)(ct.A,{className:"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180","aria-hidden":"true"})]})}));Lb.displayName=Sb.l9.displayName;const Tb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Sb.UC,{ref:s,className:ns("left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto ",t),...a})}));Tb.displayName=Sb.UC.displayName;const $b=Sb.N_,Db=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{className:ns("absolute left-0 top-full flex justify-center"),children:(0,te.jsx)(Sb.LM,{className:ns("origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]",t),ref:s,...a})})}));Db.displayName=Sb.LM.displayName;const Pb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Sb.C1,{ref:s,className:ns("top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in",t),...a,children:(0,te.jsx)("div",{className:"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md"})})}));Pb.displayName=Sb.C1.displayName;var Mb=t(6874);const Ob=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsxs)(Mb.bL,{ref:s,className:ns("relative flex w-full touch-none select-none items-center",t),...a,children:[(0,te.jsx)(Mb.CC,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,te.jsx)(Mb.Q6,{className:"absolute h-full bg-primary"})}),(0,te.jsx)(Mb.zi,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})}));Ob.displayName=Mb.bL.displayName;var Rb=t(11777);const Fb=(0,ts.cva)("inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground",{variants:{variant:{default:"bg-transparent",outline:"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground"},size:{default:"h-10 px-3",sm:"h-9 px-2.5",lg:"h-11 px-5"}},defaultVariants:{variant:"default",size:"default"}}),zb=Y.forwardRef(((e,s)=>{let{className:t,variant:a,size:r,...n}=e;return(0,te.jsx)(Rb.b,{ref:s,className:ns(Fb({variant:a,size:r,className:t})),...n})}));zb.displayName=Rb.b.displayName;var Ub=t(85162);const Bb=e=>{let{...s}=e;const{theme:t="system"}=(0,Ub.D)();return(0,te.jsx)(gu.Toaster,{theme:t,className:"toaster group",toastOptions:{classNames:{toast:"group toast group-[.toaster]:bg-background group-[.toaster]:text-foreground group-[.toaster]:border-border group-[.toaster]:shadow-lg",description:"group-[.toast]:text-muted-foreground",actionButton:"group-[.toast]:bg-primary group-[.toast]:text-primary-foreground",cancelButton:"group-[.toast]:bg-muted group-[.toast]:text-muted-foreground"}},...s})};function Wb(){for(var e=arguments.length,s=new Array(e),t=0;t<e;t++)s[t]=arguments[t];return(0,rs.QP)((0,as.$)(s))}const qb=Y.createContext(null);function Vb(){const e=Y.useContext(qb);if(!e)throw new Error("useSidebar must be used within a SidebarProvider.");return e}const Yb=Y.forwardRef(((e,s)=>{let{defaultOpen:t=!0,open:a,onOpenChange:r,className:n,style:l,children:i,...o}=e;const c=function(){const[e,s]=Y.useState(void 0);return Y.useEffect((()=>{const e=window.matchMedia("(max-width: 767px)"),t=()=>{s(window.innerWidth<768)};return e.addEventListener("change",t),s(window.innerWidth<768),()=>e.removeEventListener("change",t)}),[]),!!e}(),[d,m]=Y.useState(!1),[u,x]=Y.useState(t),h=null!=a?a:u,p=Y.useCallback((e=>{const s="function"==typeof e?e(h):e;r?r(s):x(s),document.cookie=`sidebar_state=${s}; path=/; max-age=604800`}),[r,h]),g=Y.useCallback((()=>c?m((e=>!e)):p((e=>!e))),[c,p,m]);Y.useEffect((()=>{const e=e=>{"b"===e.key&&(e.metaKey||e.ctrlKey)&&(e.preventDefault(),g())};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)}),[g]);const f=h?"expanded":"collapsed",v=Y.useMemo((()=>({state:f,open:h,setOpen:p,isMobile:c,openMobile:d,setOpenMobile:m,toggleSidebar:g})),[f,h,p,c,d,m,g]);return(0,te.jsx)(qb.Provider,{value:v,children:(0,te.jsx)(ws,{delayDuration:0,children:(0,te.jsx)("div",{style:{"--sidebar-width":"16rem","--sidebar-width-icon":"3rem",...l},className:Wb("group/sidebar-wrapper flex min-h-svh w-full has-[[data-variant=inset]]:bg-sidebar",n),ref:s,...o,children:i})})})}));Yb.displayName="SidebarProvider";const Hb=Y.forwardRef(((e,s)=>{let{side:t="left",variant:a="sidebar",collapsible:r="offcanvas",className:n,children:l,...i}=e;const{isMobile:o,state:c,openMobile:d,setOpenMobile:m}=Vb();return"none"===r?(0,te.jsx)("div",{className:Wb("flex h-full w-[--sidebar-width] flex-col bg-sidebar text-sidebar-foreground",n),ref:s,...i,children:l}):o?(0,te.jsx)(dc,{open:d,onOpenChange:m,...i,children:(0,te.jsxs)(gc,{"data-sidebar":"sidebar","data-mobile":"true",className:"w-[--sidebar-width] bg-sidebar p-0 text-sidebar-foreground [&>button]:hidden",style:{"--sidebar-width":"18rem"},side:t,children:[(0,te.jsxs)(fc,{className:"sr-only",children:[(0,te.jsx)(jc,{children:"Sidebar"}),(0,te.jsx)(bc,{children:"Displays the mobile sidebar."})]}),(0,te.jsx)("div",{className:"flex h-full w-full flex-col",children:l})]})}):(0,te.jsxs)("div",{ref:s,className:"group peer hidden text-sidebar-foreground md:block","data-state":c,"data-collapsible":"collapsed"===c?r:"","data-variant":a,"data-side":t,children:[(0,te.jsx)("div",{className:Wb("relative w-[--sidebar-width] bg-transparent transition-[width] duration-200 ease-linear","group-data-[collapsible=offcanvas]:w-0","group-data-[side=right]:rotate-180","floating"===a||"inset"===a?"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4))]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon]")}),(0,te.jsx)("div",{className:Wb("fixed inset-y-0 z-10 hidden h-svh w-[--sidebar-width] transition-[left,right,width] duration-200 ease-linear md:flex","left"===t?"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]":"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]","floating"===a||"inset"===a?"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)_+_theme(spacing.4)_+2px)]":"group-data-[collapsible=icon]:w-[--sidebar-width-icon] group-data-[side=left]:border-r group-data-[side=right]:border-l",n),...i,children:(0,te.jsx)("div",{"data-sidebar":"sidebar",className:"flex h-full w-full flex-col bg-sidebar group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:border-sidebar-border group-data-[variant=floating]:shadow",children:l})})]})}));Hb.displayName="Sidebar";const Gb=Y.forwardRef(((e,s)=>{let{className:t,onClick:a,...r}=e;const{toggleSidebar:n}=Vb();return(0,te.jsxs)(Rs,{ref:s,"data-sidebar":"trigger",variant:"ghost",size:"icon",className:Wb("h-7 w-7",t),onClick:e=>{null==a||a(e),n()},...r,children:[(0,te.jsx)(Ld.A,{}),(0,te.jsx)("span",{className:"sr-only",children:"Toggle Sidebar"})]})}));Gb.displayName="SidebarTrigger";const Jb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;const{toggleSidebar:r}=Vb();return(0,te.jsx)("button",{ref:s,"data-sidebar":"rail","aria-label":"Toggle Sidebar",tabIndex:-1,onClick:r,title:"Toggle Sidebar",className:Wb("absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] hover:after:bg-sidebar-border group-data-[side=left]:-right-4 group-data-[side=right]:left-0 sm:flex","[[data-side=left]_&]:cursor-w-resize [[data-side=right]_&]:cursor-e-resize","[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize","group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full group-data-[collapsible=offcanvas]:hover:bg-sidebar","[[data-side=left][data-collapsible=offcanvas]_&]:-right-2","[[data-side=right][data-collapsible=offcanvas]_&]:-left-2",t),...a})}));Jb.displayName="SidebarRail";const Zb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("main",{ref:s,className:Wb("relative flex w-full flex-1 flex-col bg-background","md:peer-data-[variant=inset]:m-2 md:peer-data-[state=collapsed]:peer-data-[variant=inset]:ml-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow",t),...a})}));Zb.displayName="SidebarInset";const Kb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Qs,{ref:s,"data-sidebar":"input",className:Wb("h-8 w-full bg-background shadow-none focus-visible:ring-2 focus-visible:ring-sidebar-ring",t),...a})}));Kb.displayName="SidebarInput";const Xb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,"data-sidebar":"header",className:Wb("flex flex-col gap-2 p-2",t),...a})}));Xb.displayName="SidebarHeader";const Qb=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,"data-sidebar":"footer",className:Wb("flex flex-col gap-2 p-2",t),...a})}));Qb.displayName="SidebarFooter";const ey=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)(Xs,{ref:s,"data-sidebar":"separator",className:Wb("mx-2 w-auto bg-sidebar-border",t),...a})}));ey.displayName="SidebarSeparator";const sy=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,"data-sidebar":"content",className:Wb("flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden",t),...a})}));sy.displayName="SidebarContent";const ty=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,"data-sidebar":"group",className:Wb("relative flex w-full min-w-0 flex-col p-2",t),...a})}));ty.displayName="SidebarGroup";const ay=Y.forwardRef(((e,s)=>{let{className:t,asChild:a=!1,...r}=e;const n=a?Ms.DX:"div";return(0,te.jsx)(n,{ref:s,"data-sidebar":"group-label",className:Wb("flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium text-sidebar-foreground/70 outline-none ring-sidebar-ring transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0",t),...r})}));ay.displayName="SidebarGroupLabel";const ry=Y.forwardRef(((e,s)=>{let{className:t,asChild:a=!1,...r}=e;const n=a?Ms.DX:"button";return(0,te.jsx)(n,{ref:s,"data-sidebar":"group-action",className:Wb("absolute right-3 top-3.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","group-data-[collapsible=icon]:hidden",t),...r})}));ry.displayName="SidebarGroupAction";const ny=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,"data-sidebar":"group-content",className:Wb("w-full text-sm",t),...a})}));ny.displayName="SidebarGroupContent";const ly=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("ul",{ref:s,"data-sidebar":"menu",className:Wb("flex w-full min-w-0 flex-col gap-1",t),...a})}));ly.displayName="SidebarMenu";const iy=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("li",{ref:s,"data-sidebar":"menu-item",className:Wb("group/menu-item relative",t),...a})}));iy.displayName="SidebarMenuItem";const oy=(0,ts.cva)("peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-none ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-[[data-sidebar=menu-action]]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:!size-8 group-data-[collapsible=icon]:!p-2 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0",{variants:{variant:{default:"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground",outline:"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]"},size:{default:"h-8 text-sm",sm:"h-7 text-xs",lg:"h-12 text-sm group-data-[collapsible=icon]:!p-0"}},defaultVariants:{variant:"default",size:"default"}}),cy=Y.forwardRef(((e,s)=>{let{asChild:t=!1,isActive:a=!1,variant:r="default",size:n="default",tooltip:l,className:i,...o}=e;const c=t?Ms.DX:"button",{isMobile:d,state:m}=Vb(),u=(0,te.jsx)(c,{ref:s,"data-sidebar":"menu-button","data-size":n,"data-active":a,className:Wb(oy({variant:r,size:n}),i),...o});return l?("string"==typeof l&&(l={children:l}),(0,te.jsxs)(ks,{children:[(0,te.jsx)(_s,{asChild:!0,children:u}),(0,te.jsx)(Ss,{side:"right",align:"center",hidden:"collapsed"!==m||d,...l})]})):u}));cy.displayName="SidebarMenuButton";const dy=Y.forwardRef(((e,s)=>{let{className:t,asChild:a=!1,showOnHover:r=!1,...n}=e;const l=a?Ms.DX:"button";return(0,te.jsx)(l,{ref:s,"data-sidebar":"menu-action",className:Wb("absolute right-1 top-1.5 flex aspect-square w-5 items-center justify-center rounded-md p-0 text-sidebar-foreground outline-none ring-sidebar-ring transition-transform hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 peer-hover/menu-button:text-sidebar-accent-foreground [&>svg]:size-4 [&>svg]:shrink-0","after:absolute after:-inset-2 after:md:hidden","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",r&&"group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 peer-data-[active=true]/menu-button:text-sidebar-accent-foreground md:opacity-0",t),...n})}));dy.displayName="SidebarMenuAction";const my=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("div",{ref:s,"data-sidebar":"menu-badge",className:Wb("pointer-events-none absolute right-1 flex h-5 min-w-5 select-none items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums text-sidebar-foreground","peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground","peer-data-[size=sm]/menu-button:top-1","peer-data-[size=default]/menu-button:top-1.5","peer-data-[size=lg]/menu-button:top-2.5","group-data-[collapsible=icon]:hidden",t),...a})}));my.displayName="SidebarMenuBadge";const uy=Y.forwardRef(((e,s)=>{let{className:t,showIcon:a=!1,...r}=e;const n=Y.useMemo((()=>`${Math.floor(40*Math.random())+50}%`),[]);return(0,te.jsxs)("div",{ref:s,"data-sidebar":"menu-skeleton",className:Wb("flex h-8 items-center gap-2 rounded-md px-2",t),...r,children:[a&&(0,te.jsx)(md,{className:"size-4 rounded-md","data-sidebar":"menu-skeleton-icon"}),(0,te.jsx)(md,{className:"h-4 max-w-[--skeleton-width] flex-1","data-sidebar":"menu-skeleton-text",style:{"--skeleton-width":n}})]})}));uy.displayName="SidebarMenuSkeleton";const xy=Y.forwardRef(((e,s)=>{let{className:t,...a}=e;return(0,te.jsx)("ul",{ref:s,"data-sidebar":"menu-sub",className:Wb("mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l border-sidebar-border px-2.5 py-0.5","group-data-[collapsible=icon]:hidden",t),...a})}));xy.displayName="SidebarMenuSub";const hy=Y.forwardRef(((e,s)=>{let{...t}=e;return(0,te.jsx)("li",{ref:s,...t})}));hy.displayName="SidebarMenuSubItem";const py=Y.forwardRef(((e,s)=>{let{asChild:t=!1,size:a="md",isActive:r,className:n,...l}=e;const i=t?Ms.DX:"a";return(0,te.jsx)(i,{ref:s,"data-sidebar":"menu-sub-button","data-size":a,"data-active":r,className:Wb("flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 text-sidebar-foreground outline-none ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0 [&>svg]:text-sidebar-accent-foreground","data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground","sm"===a&&"text-xs","md"===a&&"text-sm","group-data-[collapsible=icon]:hidden",n),...l})}));py.displayName="SidebarMenuSubButton";var gy=t(68803),fy=t(22164),vy=t(31815),jy=t(69504),by=t(13437),yy=t(11728),Ny=t(15061),wy=t(76131),ky=t(88141),_y=t(81052),Sy=t(35266);Bt().locale("en-US");class Cy{constructor(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:()=>{};this.appSDK=e;let H={...e.files.coreFiles};for(const a in e.files.pages)H["pages/"+a+".js"]=e.files.pages[a];for(const a in e.files.components)H["components/"+a+".js"]=e.files.components[a];e.files.layout&&(H["layout.js"]=e.files.layout),this.appFiles=H,this.packages={recharts:uj,"react-hot-toast":Ga,moment:Bt(),"moment/locale/he":mj,"moment/locale/ar":oj,"moment/locale/fr":cj,"moment/locale/es":dj,react:Y,"lucide-react":xj,"react-quill":Dc,"@hello-pangea/dnd":vj,"date-fns":gy,"date-fns/locale":fy,three:by,"three/addons/controls/OrbitControls.js":yy,"three/addons/loaders/GLTFLoader.js":Ny,sonner:gu,"@stripe/stripe-js":Bl,"@stripe/react-stripe-js":fj,"@radix-ui/react-toast":mm,"@radix-ui/react-dialog":ra,"class-variance-authority":ts,"@/components/ui/sidebar":V,"react-dom":Ql,"react-dom/client":G,"react-markdown":vy,"@tanstack/react-query":jy,lodash:es,jspdf:hj,"framer-motion":wy,"react-router-dom":J,"react-hook-form":Uh,"react-quill/dist/quill.snow.css":{},"react-leaflet":gj,leaflet:pj,"leaflet/dist/leaflet.css":{},"canvas-confetti":ky,html2canvas:_y,"@/lib/utils":a,"@/components/lib/utils":a,"./components/lib/utils":a,"@/components/ui/accordion":D,"@/components/ui/alert":r,"@/components/ui/alert-dialog":T,"@/components/ui/aspect-ratio":P,"@/components/ui/avatar":h,"@/components/ui/badge":i,"@/components/ui/button":l,"@/components/ui/calendar":_,"@/components/ui/card":o,"@/components/ui/checkbox":b,"@/components/ui/collapsible":w,"@/components/ui/carousel":M,"@/components/ui/command":k,"@/components/ui/context-menu":O,"@/components/ui/dialog":p,"@/components/ui/dropdown-menu":v,"@/components/ui/form":R,"@/components/ui/hover-card":F,"@/components/ui/input":d,"@/components/ui/label":m,"@/components/ui/menubar":z,"@/components/ui/navigation-menu":U,"@/components/ui/popover":S,"@/components/ui/progress":$,"@/components/ui/radio-group":u,"@/components/ui/scroll-area":N,"@/components/ui/select":x,"@/components/ui/separator":c,"@/components/ui/sheet":C,"@/components/ui/skeleton":E,"@/components/ui/slider":B,"@/components/ui/switch":A,"@/components/ui/table":g,"@/components/ui/tabs":f,"@/components/ui/textarea":y,"@/components/ui/toast":I,"@/hooks/use-toast":j,"@/components/ui/use-toast":j,"@/components/ui/toaster":L,"@/components/ui/toggle":W,"@/components/ui/tooltip":n,"@/components/ui/sonner":q,"@base44/sdk":Sy},this.globals=s,this.moduleCache={},this.compilingModules=new Set,this.importFile=this.importFile.bind(this),this.onError=t}_importAppSDK(e){let s=e;if(e.split("/").length>2&&(s=e.split("/").pop()),e.includes("/entities"))return s?{...this.appSDK.entities,default:this.appSDK.entities[s]}:this.appSDK.entities;if(e.includes("/functions"))return s?{...this.appSDK.functions,default:()=>alert="ok!!!"}:this.appSDK.functions;if(e.includes("/integrations")){if(s)return this.appSDK.integrations[s];let e={};return Object.keys(this.appSDK.integrations).forEach((s=>{e[`@/integrations/${s}`]=this.appSDK.integrations[s],e[`./integrations/${s}`]=this.appSDK.integrations[s]})),e}return"./utils"==e||"@/utils"==e?{createPageUrl:this.appSDK.createPageUrl}:e.includes("/agents")?{agentSDK:this.appSDK.agents,default:this.appSDK.agents}:void alert("importing "+e)}importAppSDK(e){return this._importAppSDK(e)}importFile(e,s){if(e.endsWith(".css"))return this.handleCSSImport(e);const t=rj(e);if(this.appFiles[t]&&!t.includes("use-toast"))return this.importAppFile(e,s);if(e.includes("components/ui/")||e.includes("@/components/ui/")){let s=e;if(e.startsWith("./")||e.startsWith("../")){const t=e.split("/");s=`@/components/ui/${t[t.length-1]}`}return this.importPackage(s)}return"@/lib/utils"===e?this.importPackage(e):e.startsWith("./")||e.startsWith("@/")||e.startsWith("../")?e.includes("/entities/")||e.includes("/functions/")||e.includes("/integrations/")||e.includes("/agents")||"./utils"==e||"@/utils"==e?this.importAppSDK(e):this.importAppFile(e,s):this.importPackage(e)}importPackage(e){if(!this.packages.hasOwnProperty(e)){const s=e.split("/");if(this.packages.hasOwnProperty(s[0])){let t=this.packages[s[0]];for(let a=1;a<s.length;a++){if(!t||!Object.prototype.hasOwnProperty.call(t,s[a]))throw new Error(`Module not found: '${e}'`);t=t[s[a]]}return nj(e,t,!0)}throw new Error(`Module not found: '${e}'`)}return nj(e,this.packages[e],!0)}importAppFile(e,s){const t=function(e,s,t){const a=rj(e);if(t[a])return a;if(e.startsWith("./")||e.startsWith("../")){const a=s.split("/").slice(0,-1).join("/"),r=e.split("/");let n=a?a.split("/"):[];for(const e of r)"."!==e&&(".."===e?n.length>0&&n.pop():e&&n.push(e));let l=n.join("/");if(l.startsWith("./")&&(l=l.substring(2)),l.startsWith("../")&&(l=l.substring(3)),l.startsWith("@/")&&(l=l.substring(2)),t[l])return l;if(t[l+".js"])return l+".js";const i=Object.keys(t).find((s=>s.endsWith(e)));if(i)return i}return a}(e,s,this.appFiles);if(this.moduleCache[t])return this.moduleCache[t];if(this.compilingModules.has(t))return{};this.compilingModules.add(t);const a=this.appFiles[t];if(!a)throw new Error(`Error in ${s}: can't import file ${e}, it doesn't exist.`);const r=function(e,s){e.includes(".")&&(e=e.split(".")[0]);const t=tj(e,s).split("\n"),a=/(<[A-Z][a-zA-Z]*|<[a-z][a-zA-Z0-9]*)(\s|>|\/>)/g;return t.map(((s,t)=>{const r=t+1;return a.test(s)?(a.lastIndex=0,s.replace(a,((t,a,n)=>{const l=s.substring(0,s.indexOf(a)).includes('"')?"'":'"';return n.includes(">")?(n.indexOf(">"),`${a} data-filename=${l}${e}${l} data-linenumber=${l}${r}${l} data-visual-selector-id=${l}${e}${r}${l}${n}`):`${a}${n}data-filename=${l}${e}${l} data-linenumber=${l}${r}${l} data-visual-selector-id=${l}${e}${r}${l} `}))):s})).join("\n")}(t,a);let n;try{n=this.compileJSXToJavascript(t,r,!1)}catch(i){n=this.compileJSXToJavascript(t,a,!0)}const l=this.evaluateJavascriptCode(t,n);return this.moduleCache[t]=l,this.compilingModules.delete(t),l}compileJSXToJavascript(e,s){let t=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];if(!s||"string"!=typeof s)throw new Error(`Invalid code content for "${e}"`);const a=s.trim();let r;try{r=(0,ej.pd)(a,{transforms:["jsx","imports"],production:!1,filePath:e})}catch(l){throw t&&this.onError(null==l?void 0:l.message,null==l?void 0:l.toString(),e,l),l}let n=r.code;n.startsWith('"use strict";')&&(n=n.substring(13));return`\n            // Initialize module objects\n            const module = { exports: {} };\n            const exports = module.exports;\n            \n            ${n}\n            \n            // No need for regex transforms - module.exports will naturally capture all exports\n        `}evaluateJavascriptCode(e,s){const t={React:Y,require:s=>this.importFile(s,e),console:ij(e,this.onError),...this.globals},a=Object.keys(t),r=a.map((e=>t[e]));try{const t=new Function(...a,s+"; return { moduleExports: module.exports, exportsObj: exports };")(...r),n=t.moduleExports&&Object.keys(t.moduleExports).length>0?t.moduleExports:t.exportsObj;return nj(e,n)}catch(n){return this.onError(`Error evaluating module ${e}: ${n.message}`,n.toString(),e,n),nj(e,{})}}render(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},t=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[];const a=this.importAppFile(e);if(!a)throw new Error(`[AppProjectCompiler] No exports found in "${e}"`);let r=null;if("function"==typeof a)r=a;else if(a.default&&"function"==typeof a.default)r=a.default;else for(const n of Object.keys(a))if("function"==typeof a[n]&&(n.includes("Component")||n.endsWith("Provider")||n.startsWith("App")||"Main"===n||n.charAt(0)===n.charAt(0).toUpperCase())){r=a[n];break}if(!r)throw new Error(`No component found in "${e}"`);return Y.createElement(r,s,...t)}handleCSSImport(e){const s=rj(e);if(this.constructor.injectedCSS||(this.constructor.injectedCSS=new Set),this.constructor.injectedCSS.has(s))return{};let t="";if(!this.appFiles[s])return this.packages[e],{};if(t=this.appFiles[s],t){const e=document.createElement("style");e.textContent=t,e.setAttribute("data-source",s),document.head.appendChild(e),this.constructor.injectedCSS.add(s)}return{}}}function Ay(){const[e,s]=(0,Y.useState)(!1),t=(0,Y.useRef)(!1),[a,r]=(0,Y.useState)(null),n=(0,Y.useRef)([]),l=(0,Y.useRef)([]),i=(0,Y.useRef)([]),o=(0,Y.useRef)(null),c=function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const s=document.createElement("div");return s.style.position="absolute",s.style.pointerEvents="none",s.style.transition="all 0.1s ease-in-out",s.style.zIndex="9999",e?s.style.border="2px solid #2563EB":(s.style.border="2px dotted #2563EB",s.style.backgroundColor="rgba(99, 102, 241, 0.05)"),s},d=function(e,s){let a=arguments.length>2&&void 0!==arguments[2]&&arguments[2];if(!s||!t.current)return;s.offsetWidth;const r=s.getBoundingClientRect();e.style.top=`${r.top+window.scrollY}px`,e.style.left=`${r.left+window.scrollX}px`,e.style.width=`${r.width}px`,e.style.height=`${r.height}px`;const n=document.createElement("div");n.textContent=s.tagName.toLowerCase(),n.style.position="absolute",n.style.top="-27px",n.style.left="-2px",n.style.padding="2px 6px",n.style.fontSize="14px",n.style.fontWeight=a?"500":"400",n.style.color=a?"#ffffff":"#2563EB",n.style.backgroundColor=a?"#2563EB":"#DBEAFE",n.style.borderRadius="6px 6px 0px 0px",n.style.boxShadow="none",n.style.minWidth="24px",n.style.textAlign="center",e.appendChild(n)},m=e=>{if(!e)return[];const s=[...document.querySelectorAll(`[data-source-location="${e}"]`)];return s.length>0?s:[...document.querySelectorAll(`[data-visual-selector-id="${e}"]`)]},u=()=>{n.current.forEach((e=>{e&&e.parentNode&&e.remove()})),n.current=[],i.current=[]},x=e=>{if(!t.current)return;const s=e.target.closest("[data-source-location], [data-visual-selector-id]");if(!s)return void u();const a=s.dataset.sourceLocation||s.dataset.visualSelectorId;s.dataset.sourceLocation;if(o.current===a)return void u();const r=m(a);u(),r.forEach((e=>{const s=c(!1);document.body.appendChild(s),n.current.push(s),d(s,e)})),i.current=r},h=()=>{u()},p=e=>{var s;if(!t.current)return;e.preventDefault(),e.stopPropagation(),e.stopImmediatePropagation();const a=e.target.closest("[data-source-location], [data-visual-selector-id]");if(!a)return;const n=a.dataset.sourceLocation||a.dataset.visualSelectorId;a.dataset.sourceLocation;l.current.forEach((e=>{e&&e.parentNode&&e.remove()})),l.current=[];m(n).forEach((e=>{const s=c(!0);document.body.appendChild(s),l.current.push(s),d(s,e,!0)})),r(a),o.current=n,u();const i={type:"element-selected",tagName:a.tagName,classes:(null===(s=a.className)||void 0===s?void 0:s.baseVal)||a.className||"",visualSelectorId:n,content:a.innerText,dataSourceLocation:a.dataset.sourceLocation,isDynamicContent:"true"===a.dataset.dynamicContent,linenumber:a.dataset.linenumber,filename:a.dataset.filename};window.parent.postMessage(i,"*")};return(0,Y.useEffect)((()=>{document.querySelectorAll("[data-visual-selector-id]");document.querySelectorAll("[data-linenumber]:not([data-visual-selector-id])").forEach(((e,s)=>{const t=`visual-id-${e.dataset.filename}-${e.dataset.linenumber}-${s}`;e.dataset.visualSelectorId=t}));const e=e=>{const a=e.data;switch(a.type){case"toggle-visual-edit-mode":c=a.data.enabled,s(c),t.current=c,c?(document.body.style.cursor="crosshair",document.addEventListener("mouseover",x),document.addEventListener("mouseout",h),document.addEventListener("click",p,!0)):(u(),l.current.forEach((e=>{e&&e.parentNode&&e.remove()})),l.current=[],i.current=[],r(null),o.current=null,document.body.style.cursor="default",document.removeEventListener("mouseover",x),document.removeEventListener("mouseout",h),document.removeEventListener("click",p,!0));break;case"update-classes":a.data&&void 0!==a.data.classes&&((e,s)=>{const t=m(e);0!==t.length&&(t.forEach((e=>{var t;const a=(null===(t=e.className)||void 0===t?void 0:t.baseVal)||e.className||"";e.className=(0,rs.QP)(a,s)})),setTimeout((()=>{var s,a;(o.current===e&&l.current.forEach(((e,s)=>{s<t.length&&d(e,t[s])})),i.current.length>0)&&((null===(s=i.current[0])||void 0===s||null===(a=s.dataset)||void 0===a?void 0:a.visualSelectorId)===e&&n.current.forEach(((e,s)=>{s<i.current.length&&d(e,i.current[s])})))}),50))})(a.data.visualSelectorId,a.data.classes);break;case"unselect-element":l.current.forEach((e=>{e&&e.parentNode&&e.remove()})),l.current=[],r(null),o.current=null;break;case"refresh-page":window.location.reload();break;case"update-content":a.data&&void 0!==a.data.content&&((e,s)=>{const t=m(e);0!==t.length&&(t.forEach((e=>{e.innerText=s})),setTimeout((()=>{o.current===e&&l.current.forEach(((e,s)=>{s<t.length&&d(e,t[s])}))}),50))})(a.data.visualSelectorId,a.data.content)}var c};return window.addEventListener("message",e),window.parent.postMessage({type:"visual-edit-agent-ready"},"*"),()=>{window.removeEventListener("message",e),document.removeEventListener("mouseover",x),document.removeEventListener("mouseout",h),document.removeEventListener("click",p,!0),u(),l.current.forEach((e=>{e&&e.parentNode&&e.remove()}))}}),[]),(0,Y.useEffect)((()=>{t.current=e}),[e]),(0,Y.useEffect)((()=>{const e=()=>{if(o.current){const e=m(o.current);l.current.forEach(((s,t)=>{t<e.length&&d(s,e[t])}))}i.current.length>0&&n.current.forEach(((e,s)=>{s<i.current.length&&d(e,i.current[s])}))},s=new MutationObserver((s=>{s.some((e=>{const s=e=>{if(e.nodeType===Node.ELEMENT_NODE){if(e.dataset&&e.dataset.visualSelectorId)return!0;for(let t=0;t<e.children.length;t++)if(s(e.children[t]))return!0}return!1};return"attributes"===e.type&&("style"===e.attributeName||"class"===e.attributeName||"width"===e.attributeName||"height"===e.attributeName)&&s(e.target)}))&&setTimeout(e,50)}));return s.observe(document.body,{attributes:!0,childList:!0,subtree:!0,attributeFilter:["style","class","width","height"]}),window.addEventListener("resize",e),window.addEventListener("scroll",e),()=>{window.removeEventListener("resize",e),window.removeEventListener("scroll",e),s.disconnect()}}),[]),null}function Ey(e){let{appId:s}=e;const[t,a]=(0,Y.useState)(!1),[r,n]=(0,Y.useState)(!0);(0,Y.useEffect)((()=>{"true"===new URLSearchParams(window.location.search).get("hide_badge")&&n(!1)}),[]);return r?(0,te.jsxs)("div",{dir:"ltr",className:"fixed z-50 text-white bottom-4 right-4 flex items-center gap-2 bg-black pt-2 pb-2 pl-3 pr-3 rounded-md shadow-lg cursor-pointer transition-all hover:shadow-xl border border-neutral-800",onClick:async()=>{a(!0);const e=Gt();window.open(`${e}/remix-app/${s}`,"_blank"),a(!1)},children:[(0,te.jsx)("img",{src:"https://base44.app/logo_v3.png",alt:"base44",className:"w-5 h-5"}),(0,te.jsx)("span",{className:"whitespace-nowrap text-xs",children:t?(0,te.jsxs)("div",{className:"flex items-center gap-1.5",children:[(0,te.jsx)(Je.A,{className:"w-3 h-3 animate-spin"}),(0,te.jsx)("span",{children:"Cloning..."})]}):(0,te.jsxs)("div",{className:"flex items-center gap-1.5 align-middle justify-center text-sm",children:[(0,te.jsx)("span",{children:"Edit with "}),(0,te.jsx)("span",{className:"mb-0.5",children:(0,te.jsx)("img",{src:"/base44_text.png",alt:"Base44",height:18,width:56})})]})}),(0,te.jsx)("button",{className:"p-0.5 ml-0.5 rounded-full hover:bg-neutral-700 transition-colors","aria-label":"Close badge",onClick:e=>{e.stopPropagation(),n(!1)},children:(0,te.jsx)(Ds.A,{className:"w-3.5 h-3.5"})})]}):null}function Iy(e){let{}=e;const{user:s,isAuthenticated:t}=Jv(),{pageName:a}=(0,Z.g)();return(0,te.jsx)("div",{className:"min-h-screen flex items-center justify-center p-6 bg-slate-50",children:(0,te.jsx)("div",{className:"max-w-md w-full",children:(0,te.jsxs)("div",{className:"text-center space-y-6",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("h1",{className:"text-7xl font-light text-slate-300",children:"404"}),(0,te.jsx)("div",{className:"h-0.5 w-16 bg-slate-200 mx-auto"})]}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)("h2",{className:"text-2xl font-medium text-slate-800",children:"Page Not Found"}),(0,te.jsxs)("p",{className:"text-slate-600 leading-relaxed",children:["The page ",(0,te.jsxs)("span",{className:"font-medium text-slate-700",children:['"',a,'"']})," could not be found in this application."]})]}),t&&"admin"===(null==s?void 0:s.role)&&(0,te.jsx)("div",{className:"mt-8 p-4 bg-slate-100 rounded-lg border border-slate-200",children:(0,te.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,te.jsx)("div",{className:"flex-shrink-0 w-5 h-5 rounded-full bg-orange-100 flex items-center justify-center mt-0.5",children:(0,te.jsx)("div",{className:"w-2 h-2 rounded-full bg-orange-400"})}),(0,te.jsxs)("div",{className:"text-left space-y-1",children:[(0,te.jsx)("p",{className:"text-sm font-medium text-slate-700",children:"Admin Note"}),(0,te.jsx)("p",{className:"text-sm text-slate-600 leading-relaxed",children:"This could mean that the AI hasn't implemented this page yet. Ask it to implement it in the chat."})]})]})}),(0,te.jsx)("div",{className:"pt-6",children:(0,te.jsxs)("button",{onClick:()=>window.location.href="/",className:"inline-flex items-center px-4 py-2 text-sm font-medium text-slate-700 bg-white border border-slate-200 rounded-lg hover:bg-slate-50 hover:border-slate-300 transition-colors duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-slate-500",children:[(0,te.jsx)("svg",{className:"w-4 h-4 mr-2",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,te.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"})}),"Go Home"]})})]})})})}const Ly=()=>(0,te.jsx)("div",{className:"flex flex-col items-center justify-center min-h-screen bg-gradient-to-b from-white to-gray-50",children:(0,te.jsx)("div",{className:"max-w-md w-full p-8 bg-white rounded-lg shadow-lg border border-gray-100",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("div",{className:"inline-flex items-center justify-center w-16 h-16 mb-6 rounded-full bg-red-100",children:(0,te.jsx)("svg",{className:"w-8 h-8 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:(0,te.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),(0,te.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Access Restricted"}),(0,te.jsx)("p",{className:"text-gray-600 mb-8",children:"You are not registered to use this application. Please contact the app administrator to request access."}),(0,te.jsxs)("div",{className:"p-4 bg-gray-50 rounded-md text-sm text-gray-600",children:[(0,te.jsx)("p",{children:"If you believe this is an error, you can:"}),(0,te.jsxs)("ul",{className:"list-disc list-inside mt-2 space-y-1",children:[(0,te.jsx)("li",{children:"Verify you are logged in with the correct account"}),(0,te.jsx)("li",{children:"Contact the app administrator for access"}),(0,te.jsx)("li",{children:"Try logging out and back in again"})]})]})]})})});function Ty(e){var s,t,a,r;let{appId:n}=e;const{isAuthenticated:l,isLoadingAuth:i,logout:o}=Jv(),c=(0,Z.zy)(),d=(0,Z.Zp)(),{appId:m,pageName:u}=(0,Z.g)(),[x,h]=(0,Y.useState)(null),[p,g]=(0,Y.useState)(null),[f,v]=(0,Y.useState)(!0),j=e=>{const s=new Cy(e,{cn:ns,localStorage:aj()},((s,t,a,r)=>{e.options.onError(s,t,a,r)})),t=e.getCurrentPage();if(!t)return void g((0,te.jsx)(Iy,{}));const a=s.render("pages/"+t.name);if(e.files.layout){const e=s.render("layout",{currentPageName:null==t?void 0:t.name},[a]);g(e)}else g(a)};(0,Y.useEffect)((()=>{Qv({id:n||m,onError:b,authProps:{isLoadingAuth:i,logout:o,isUserAuthenticated:()=>l}}).then((e=>{h(e)})).catch((e=>{var s,t,a,r,n,l,i,o;e.response&&403===e.response.status&&null!==(s=e.response.data)&&void 0!==s&&null!==(t=s.extra_data)&&void 0!==t&&t.reason?"auth_required"===(null===(a=e.response.data)||void 0===a||null===(r=a.extra_data)||void 0===r?void 0:r.reason)?w(null===(i=e.response.data)||void 0===i||null===(o=i.extra_data)||void 0===o?void 0:o.app_id):"user_not_registered"===(null===(n=e.response.data)||void 0===n||null===(l=n.extra_data)||void 0===l?void 0:l.reason)&&v(!1):b("Failed to load app "+e.message,"none","general",e)}))}),[]);const b=(e,s,t,a)=>{var r,n;402!==(null==a||null===(r=a.response)||void 0===r?void 0:r.status)&&(null===(n=window.parent)||void 0===n||n.postMessage({type:"app_error",error:{title:e.toString(),details:null==s?void 0:s.toString(),componentName:null==t?void 0:t.toString()}},"*"))};(0,Y.useEffect)((()=>{window.parent.postMessage({type:"app_changed_url",url:window.location.href},"*"),x&&j(x)}),[c,u,x]);const y=e=>{var s;const t=null===(s=e.reason.stack.match(/at\s+(\w+)\s+\(eval/))||void 0===s?void 0:s[1],a=t?`Error in ${t}: ${e.reason.toString()}`:e.reason.toString();b(a,e.reason.toString(),t,e.reason)},N=e=>{var s,t;let a=null===(t=(null===(s=e.error)||void 0===s?void 0:s.stack).match(/at\s+(\w+)\s+\(eval/))||void 0===t?void 0:t[1];"eval"===a&&(a=null);const r=a?`in ${a}: ${e.error.toString()}`:e.error.toString();b(r,e.error.toString(),a,e.error)};(0,Y.useEffect)((()=>(window.addEventListener("unhandledrejection",y),window.addEventListener("error",N),()=>{window.removeEventListener("unhandledrejection",y),window.removeEventListener("error",N)})),[]);const w=e=>{d(`/login?from_url=${window.location.href}&app_id=${e}`)};return(0,Y.useEffect)((()=>{let e=null==x?void 0:x.getCurrentPage();l&&null!=x&&x.appId&&null!=e&&e.name&&ta.logUserInApp(x.appId,e.name)}),[l,null==x?void 0:x.appId,null==x||null===(s=x.getCurrentPage())||void 0===s?void 0:s.name]),f?x?i?(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,te.jsx)("div",{className:"w-8 h-8 border-4 border-gray-200 border-t-black rounded-full animate-spin"})}):(0,te.jsxs)("div",{className:"min-h-screen w-full relative app-preview",children:[(0,te.jsx)(Ay,{}),(null==x||null===(t=x.files)||void 0===t?void 0:t.is_remixable)&&(null==x||null===(a=x.files)||void 0===a||null===(r=a.public_settings)||void 0===r?void 0:r.includes("public"))&&(0,te.jsx)(Ey,{appId:n}),(0,te.jsx)("div",{className:"flex flex-col w-full h-full",id:"app-demo",children:(0,te.jsx)("div",{className:"bg-white w-full min-h-full overflow-auto",children:(0,te.jsx)("div",{id:"component-preview-container",children:p})})})]}):(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,te.jsx)("div",{className:"flex flex-col items-center space-y-4",children:(0,te.jsx)("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-black rounded-full animate-spin"})})}):(0,te.jsx)(Ly,{})}function $y(e){let{appId:s,appPlatformVersion:t,authSDK:a,onSuccess:r,onSwitchToRegister:n,onSwitchToResetPassword:l}=e;const[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(""),[m,u]=(0,Y.useState)(""),[x,h]=(0,Y.useState)(!1);return(0,te.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(""),h(!0);try{if(3===t){const e=(0,Sy.createClient)({appId:s,serverUrl:(0,bd.wE)()}),t=await e.auth.loginViaEmailPassword(i,c);t&&r(t.user)}else{const e=await a.loginViaUsernamePassword(i,c);e&&((0,se.O5)(e.access_token),r(e.user))}}catch(o){var n,l;u((null===(n=o.response)||void 0===n||null===(l=n.data)||void 0===l?void 0:l.detail)||"Invalid email or password")}finally{h(!1)}},className:"space-y-4 sm:space-y-5",children:[(0,te.jsxs)("div",{className:"space-y-3 sm:space-y-4",children:[(0,te.jsxs)("div",{className:"space-y-1.5",children:[(0,te.jsx)(at,{htmlFor:"email",className:"text-sm font-medium text-slate-700",children:"Email"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(tc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,te.jsx)(Qs,{id:"email",type:"email",placeholder:"you@example.com",value:i,onChange:e=>o(e.target.value),required:!0,disabled:x,className:"pl-10 h-11 sm:h-12 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400"})]})]}),(0,te.jsxs)("div",{className:"space-y-1.5",children:[(0,te.jsx)(at,{htmlFor:"password",className:"text-sm font-medium text-slate-700",children:"Password"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Ls.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,te.jsx)(Qs,{id:"password",type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",value:c,onChange:e=>d(e.target.value),required:!0,disabled:x,className:"pl-10 h-11 sm:h-12 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400"})]})]})]}),m&&(0,te.jsx)(is,{className:"bg-red-50/70 border-red-200 rounded-xl",children:(0,te.jsx)(cs,{className:"text-red-700 text-sm",children:m})}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)(Rs,{type:"submit",disabled:x,className:"w-full h-11 sm:h-12 bg-slate-900 hover:bg-slate-800 text-white font-medium shadow-sm rounded-xl transition-all duration-200",children:x?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Signing in..."]}):"Sign in"}),(0,te.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-2 sm:gap-0",children:[(0,te.jsx)("button",{type:"button",onClick:l,className:"text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:"Forgot password?"}),(0,te.jsxs)("button",{type:"button",onClick:n,className:"text-sm text-slate-500 hover:text-slate-700 transition-colors",children:["Need an account? ",(0,te.jsx)("span",{className:"font-medium text-slate-700",children:"Sign up"})]})]})]})]})}function Dy(e){let{authSDK:s,onSuccess:t,onSwitchToLogin:a,onSwitchToOtpVerification:r}=e;const[n,l]=(0,Y.useState)({email:"",password:"",confirmPassword:""}),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(!1),m=(e,s)=>{l((t=>({...t,[e]:s})))};return(0,te.jsxs)("div",{className:"space-y-4",children:[(0,te.jsxs)("button",{type:"button",onClick:a,className:"flex items-center gap-2 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors -mb-2",children:[(0,te.jsx)(pi.A,{className:"h-4 w-4"}),"Back to sign in"]}),(0,te.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:"Create your account"}),(0,te.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),o(""),n.password===n.confirmPassword)if(n.password.length<8)o("Password must be at least 8 characters long");else{d(!0);try{await s.register({email:n.email,password:n.password})&&r(n.email)}catch(l){var t,a;o((null===(t=l.response)||void 0===t||null===(a=t.data)||void 0===a?void 0:a.detail)||"Registration failed. Please try again.")}finally{d(!1)}}else o("Passwords do not match")},className:"space-y-3 sm:space-y-4",children:[(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsxs)("div",{className:"space-y-1.5",children:[(0,te.jsx)(at,{htmlFor:"email",className:"text-sm font-medium text-slate-700",children:"Email"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(tc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,te.jsx)(Qs,{id:"email",type:"email",placeholder:"you@example.com",value:n.email,onChange:e=>m("email",e.target.value),required:!0,disabled:c,className:"pl-10 h-10 sm:h-11 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400 text-sm sm:text-base"})]})]}),(0,te.jsxs)("div",{className:"space-y-1.5",children:[(0,te.jsx)(at,{htmlFor:"password",className:"text-sm font-medium text-slate-700",children:"Password"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Ls.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,te.jsx)(Qs,{id:"password",type:"password",placeholder:"Min. 8 characters",value:n.password,onChange:e=>m("password",e.target.value),required:!0,disabled:c,className:"pl-10 h-10 sm:h-11 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400 text-sm sm:text-base"})]})]}),(0,te.jsxs)("div",{className:"space-y-1.5",children:[(0,te.jsx)(at,{htmlFor:"confirmPassword",className:"text-sm font-medium text-slate-700",children:"Confirm Password"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Ls.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,te.jsx)(Qs,{id:"confirmPassword",type:"password",placeholder:"Re-enter password",value:n.confirmPassword,onChange:e=>m("confirmPassword",e.target.value),required:!0,disabled:c,className:"pl-10 h-10 sm:h-11 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400 text-sm sm:text-base"})]})]})]}),i&&(0,te.jsx)(is,{className:"bg-red-50/70 border-red-200 rounded-xl",children:(0,te.jsx)(cs,{className:"text-red-700 text-sm",children:i})}),(0,te.jsx)(Rs,{type:"submit",disabled:c,className:"w-full h-10 sm:h-11 bg-slate-900 hover:bg-slate-800 text-white font-medium shadow-sm rounded-xl transition-all duration-200",children:c?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Creating account..."]}):"Create account"})]})]})}function Py(e){let{authSDK:s,email:t,onSuccess:a,onSwitchToLogin:r}=e;const[n,l]=(0,Y.useState)(["","","","","",""]),[i,o]=(0,Y.useState)(""),[c,d]=(0,Y.useState)(""),[m,u]=(0,Y.useState)(!1),[x,h]=(0,Y.useState)(!1),p=(0,Y.useRef)([]);(0,Y.useEffect)((()=>{var e;null===(e=p.current[0])||void 0===e||e.focus()}),[]);const g=e=>{e.preventDefault();const s=e.clipboardData.getData("text").slice(0,6),t=[...n];for(let n=0;n<s.length;n++)/^\d$/.test(s[n])&&(t[n]=s[n]);l(t);const a=t.findIndex((e=>!e));var r,i;-1!==a?null===(r=p.current[a])||void 0===r||r.focus():null===(i=p.current[5])||void 0===i||i.focus()};return(0,te.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,te.jsxs)("button",{type:"button",onClick:r,className:"flex items-center gap-2 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors -mb-2",children:[(0,te.jsx)(pi.A,{className:"h-4 w-4"}),"Back to sign in"]}),(0,te.jsxs)("div",{className:"text-center space-y-2",children:[(0,te.jsx)("div",{className:"mx-auto w-14 h-14 sm:w-16 sm:h-16 bg-slate-100 rounded-full flex items-center justify-center mb-3 sm:mb-4",children:(0,te.jsx)(Dl.A,{className:"h-7 w-7 sm:h-8 sm:w-8 text-slate-700"})}),(0,te.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:"Verify your email"}),(0,te.jsxs)("p",{className:"text-slate-600 text-sm sm:text-base",children:["We've sent a 6-digit code to",(0,te.jsx)("br",{}),(0,te.jsx)("span",{className:"font-medium text-slate-900",children:t})]})]}),(0,te.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),o(""),d("");const a=n.join("");if(6===a.length){u(!0);try{await s.verifyOtp(t,a)&&(d("Email verified successfully! Redirecting to login..."),setTimeout((()=>{r()}),2e3))}catch(c){var l,i;o((null===(l=c.response)||void 0===l||null===(i=l.data)||void 0===i?void 0:i.detail)||"Invalid verification code")}finally{u(!1)}}else o("Please enter all 6 digits")},className:"space-y-4 sm:space-y-6",children:[(0,te.jsxs)("div",{children:[(0,te.jsx)("div",{className:"flex gap-2 justify-center",children:n.map(((e,s)=>(0,te.jsx)(Qs,{ref:e=>p.current[s]=e,type:"text",inputMode:"numeric",pattern:"\\d{1}",maxLength:1,value:e,onChange:e=>((e,s)=>{if(s.length>1)return;const t=[...n];var a;t[e]=s,l(t),s&&e<5&&(null===(a=p.current[e+1])||void 0===a||a.focus())})(s,e.target.value),onKeyDown:e=>((e,s)=>{var t;"Backspace"===s.key&&!n[e]&&e>0&&(null===(t=p.current[e-1])||void 0===t||t.focus())})(s,e),onPaste:0===s?g:void 0,disabled:m||x,className:"w-11 h-11 sm:w-12 sm:h-12 text-center text-lg font-semibold bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl"},s)))}),(0,te.jsx)("p",{className:"text-xs text-slate-500 text-center mt-3",children:"Enter the verification code sent to your email"})]}),i&&(0,te.jsx)(is,{className:"bg-red-50/70 border-red-200 rounded-xl",children:(0,te.jsx)(cs,{className:"text-red-700 text-sm",children:i})}),c&&(0,te.jsx)(is,{className:"bg-green-50/70 border-green-200 rounded-xl",children:(0,te.jsx)(cs,{className:"text-green-700 text-sm",children:c})}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)(Rs,{type:"submit",disabled:m||x,className:"w-full h-10 sm:h-11 bg-slate-900 hover:bg-slate-800 text-white font-medium shadow-sm rounded-xl transition-all duration-200",children:m?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):"Verify email"}),(0,te.jsx)("div",{className:"text-center",children:(0,te.jsxs)("p",{className:"text-sm text-slate-600",children:["Didn't receive the code?"," ",(0,te.jsx)("button",{type:"button",onClick:async()=>{o(""),d(""),h(!0);try{var e;await s.resendOtp(t),d("New verification code sent to your email"),l(["","","","","",""]),null===(e=p.current[0])||void 0===e||e.focus()}catch(n){var a,r;o((null===(a=n.response)||void 0===a||null===(r=a.data)||void 0===r?void 0:r.detail)||"Failed to resend code")}finally{h(!1)}},disabled:x||m,className:"font-medium text-slate-700 hover:text-slate-900 disabled:opacity-50 transition-colors",children:x?"Sending...":"Resend"})]})})]})]})]})}function My(e){let{authSDK:s,onSwitchToLogin:t}=e;const[a,r]=(0,Y.useState)(""),[n,l]=(0,Y.useState)(""),[i,o]=(0,Y.useState)(!1),[c,d]=(0,Y.useState)(!1);return i?(0,te.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,te.jsxs)("div",{className:"text-center space-y-3 sm:space-y-4",children:[(0,te.jsx)("div",{className:"mx-auto w-14 h-14 sm:w-16 sm:h-16 bg-slate-100 rounded-full flex items-center justify-center",children:(0,te.jsx)(tc.A,{className:"h-7 w-7 sm:h-8 sm:w-8 text-slate-700"})}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:"Check your email"}),(0,te.jsxs)("p",{className:"text-slate-600 text-sm sm:text-base",children:["We've sent password reset instructions to",(0,te.jsx)("br",{}),(0,te.jsx)("span",{className:"font-medium text-slate-900",children:a})]})]})]}),(0,te.jsx)(is,{className:"bg-green-50/70 border-green-200 rounded-xl",children:(0,te.jsx)(cs,{className:"text-green-700 text-sm",children:"Please check your email for the password reset link. It may take a few minutes to arrive."})}),(0,te.jsxs)("button",{onClick:t,className:"w-full flex items-center justify-center gap-2 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors",children:[(0,te.jsx)(pi.A,{className:"h-4 w-4"}),"Back to sign in"]})]}):(0,te.jsxs)("div",{className:"space-y-4 sm:space-y-6",children:[(0,te.jsxs)("button",{type:"button",onClick:t,className:"flex items-center gap-2 text-sm text-slate-500 hover:text-slate-700 font-medium transition-colors -mb-2",children:[(0,te.jsx)(pi.A,{className:"h-4 w-4"}),"Back to sign in"]}),(0,te.jsxs)("div",{className:"text-center space-y-2",children:[(0,te.jsx)("h2",{className:"text-xl sm:text-2xl font-bold text-slate-900",children:"Reset your password"}),(0,te.jsx)("p",{className:"text-slate-600 text-sm sm:text-base",children:"Enter your email and we'll send you a link to reset your password"})]}),(0,te.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),l(""),o(!1),d(!0);try{await s.resetPasswordRequest(a),o(!0)}catch(n){var t,r;l((null===(t=n.response)||void 0===t||null===(r=t.data)||void 0===r?void 0:r.detail)||"Failed to send reset email")}finally{d(!1)}},className:"space-y-4 sm:space-y-5",children:[(0,te.jsxs)("div",{className:"space-y-1.5",children:[(0,te.jsx)(at,{htmlFor:"email",className:"text-sm font-medium text-slate-700",children:"Email"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(tc.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-slate-400"}),(0,te.jsx)(Qs,{id:"email",type:"email",placeholder:"you@example.com",value:a,onChange:e=>r(e.target.value),required:!0,disabled:c,className:"pl-10 h-10 sm:h-11 bg-slate-50/50 border-slate-200 focus:border-slate-400 focus:ring-slate-400 rounded-xl placeholder:text-slate-400"})]})]}),n&&(0,te.jsx)(is,{className:"bg-red-50/70 border-red-200 rounded-xl",children:(0,te.jsx)(cs,{className:"text-red-700 text-sm",children:n})}),(0,te.jsx)(Rs,{type:"submit",disabled:c,className:"w-full h-10 sm:h-11 bg-slate-900 hover:bg-slate-800 text-white font-medium shadow-sm rounded-xl transition-all duration-200",children:c?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending..."]}):"Send reset link"})]})]})}const Oy=()=>(0,te.jsxs)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,te.jsx)("path",{d:"M22.56 12.25c0-.78-.07-1.53-.2-2.25H12v4.26h5.92c-.26 1.37-1.04 2.53-2.21 3.31v2.77h3.57c2.08-1.92 3.28-4.74 3.28-8.09z",fill:"#4285F4"}),(0,te.jsx)("path",{d:"M12 23c2.97 0 5.46-.98 7.28-2.66l-3.57-2.77c-.98.66-2.23 1.06-3.71 1.06-2.86 0-5.29-1.93-6.16-4.53H2.18v2.84C3.99 20.53 7.7 23 12 23z",fill:"#34A853"}),(0,te.jsx)("path",{d:"M5.84 14.09c-.22-.66-.35-1.36-.35-2.09s.13-1.43.35-2.09V7.07H2.18C1.43 8.55 1 10.22 1 12s.43 3.45 1.18 4.93l2.85-2.22.81-.62z",fill:"#FBBC05"}),(0,te.jsx)("path",{d:"M12 5.38c1.62 0 3.06.56 4.21 1.64l3.15-3.15C17.45 2.09 14.97 1 12 1 7.7 1 3.99 3.47 2.18 7.07l3.66 2.84c.87-2.6 3.3-4.53 6.16-4.53z",fill:"#EA4335"})]}),Ry=()=>(0,te.jsxs)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:[(0,te.jsx)("path",{fill:"#F25022",d:"M1 1h10v10H1z"}),(0,te.jsx)("path",{fill:"#00A4EF",d:"M13 1h10v10H13z"}),(0,te.jsx)("path",{fill:"#7FBA00",d:"M1 13h10v10H1z"}),(0,te.jsx)("path",{fill:"#FFB900",d:"M13 13h10v10H13z"})]}),Fy=()=>(0,te.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,te.jsx)("path",{fill:"#1877F2",d:"M24 12.073c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.99 4.388 10.954 10.125 11.854v-8.385H7.078v-3.47h3.047V9.43c0-3.007 1.792-4.669 4.533-4.669 1.312 0 2.686.235 2.686.235v2.953H15.83c-1.491 0-1.956.925-1.956 1.874v2.25h3.328l-.532 3.47h-2.796v8.385C19.612 23.027 24 18.062 24 12.073z"})}),zy={google:{name:"Google",icon:Oy},microsoft:{name:"Microsoft",icon:Ry},github:{name:"GitHub",icon:()=>(0,te.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,te.jsx)("path",{fill:"#181717",d:"M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"})})},okta:{name:"Okta",icon:()=>(0,te.jsx)("svg",{className:"h-5 w-5",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:(0,te.jsx)("path",{fill:"#007DC1",d:"M12 0C5.383 0 0 5.383 0 12s5.383 12 12 12 12-5.383 12-12S18.617 0 12 0zm0 4.8c3.971 0 7.2 3.229 7.2 7.2s-3.229 7.2-7.2 7.2S4.8 15.971 4.8 12 8.029 4.8 12 4.8z"})})}};function Uy(e){var s;let{appId:t}=e;const a=(0,Z.zy)(),r=Kv(t,(()=>{}),{}),[n,l]=(0,Y.useState)(!0),[i,o]=(0,Y.useState)(null),[c,d]=(0,Y.useState)(null),[m,u]=(0,Y.useState)("login"),[x,h]=(0,Y.useState)(""),p=new URLSearchParams(a.search),g=e=>{const s=p.get("from_url")||"/",a=p.get("app_id")||t;let r;r="google"===e?`${(0,bd.Zk)()}/apps/auth/login?from_url=${s}`:`${(0,bd.Zk)()}/apps/auth/${e}/login?from_url=${s}`,a&&(r+=`&app_id=${a}`),window.location.href=r},f=()=>{const e=p.get("from_url")||"/",s=p.get("app_id")||t;let a=`${(0,bd.Zk)()}/apps/${s}/auth/sso/login?from_url=${e}`;s&&(a+=`&app_id=${s}`),window.location.href=a},v=e=>{const s=p.get("from_url")||"/";window.location.href=s},j=e=>{h(e),u("otp")},b=pd(c),y=[{id:"google",name:"Google",enabled:!1!==b.enable_google_login,handler:()=>g("google"),icon:Oy},{id:"microsoft",name:"Microsoft",enabled:b.enable_microsoft_login,handler:()=>g("microsoft"),icon:Ry},{id:"facebook",name:"Facebook",enabled:b.enable_facebook_login,handler:()=>g("facebook"),icon:Fy}],N=b.enable_sso_login?[]:y.filter((e=>e.enabled)),w=e=>{const s=e.icon;return(0,te.jsxs)("button",{onClick:e.handler,className:"w-full flex items-center justify-center gap-3 bg-white text-slate-700 px-5 py-3.5 rounded-xl border border-slate-200 hover:bg-slate-50 hover:border-slate-300 hover:shadow-sm transition-all duration-200 font-medium text-[16px] group",children:[(0,te.jsx)("div",{className:" transition-transform duration-200 "+("google"===e.id?"-ml-4":""),children:(0,te.jsx)(s,{})}),(0,te.jsxs)("span",{children:["Continue with ",e.name]})]},e.id)},k=()=>{if(!b.sso_provider_name||!1===b.enable_sso_login)return null;const e=zy[b.sso_provider_name],s=e?`Continue with ${e.name}`:"Continue with SSO",t=null==e?void 0:e.icon;return(0,te.jsxs)("button",{onClick:f,className:"w-full flex items-center justify-center gap-3 bg-white text-slate-700 px-5 py-3.5 rounded-xl border border-slate-200 hover:bg-slate-50 hover:border-slate-300 hover:shadow-sm transition-all duration-200 font-medium text-[15px] group",children:[t&&(0,te.jsx)("div",{className:"group-hover:scale-110 transition-transform duration-200",children:(0,te.jsx)(t,{})}),(0,te.jsx)("span",{children:s})]})};if((0,Y.useEffect)((()=>{(async()=>{try{const e=await pe.getLoginInfoById(t);d(e),l(!1)}catch(i){o(i),l(!1)}})()}),[t]),n)return(0,te.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100",children:(0,te.jsx)("div",{className:"p-8",children:(0,te.jsx)(Je.A,{className:"h-10 w-10 animate-spin text-slate-400"})})});if(i)return(0,te.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100",children:(0,te.jsx)("div",{className:"p-8 text-base font-medium text-red-600 bg-white rounded-2xl shadow-sm border border-red-100",children:"An error occurred while loading the app"})});return(0,te.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-50 to-slate-100 p-4",children:(0,te.jsxs)("div",{className:"w-full max-w-md",children:[(0,te.jsxs)(Vs,{className:"relative overflow-hidden border-0 shadow-2xl bg-white/95 backdrop-blur-sm rounded-2xl",children:[(0,te.jsx)("div",{className:"absolute top-0 left-0 right-0 h-1 bg-gradient-to-r from-slate-200 via-slate-300 to-slate-200"}),(0,te.jsx)(Js,{className:"p-8 sm:p-10 md:pt-12 md:pb-10 md:px-10",children:(0,te.jsxs)("div",{className:"flex flex-col items-center text-center space-y-6 sm:space-y-8",children:[(null==c?void 0:c.logo_url)&&"login"===m&&(0,te.jsxs)("div",{className:"relative group",children:[(0,te.jsx)("div",{className:"absolute inset-0 bg-gradient-to-br from-slate-200 to-slate-300 rounded-full blur-xl opacity-30 group-hover:opacity-40 transition-opacity duration-300"}),(0,te.jsxs)(qt,{className:"relative h-20 w-20 sm:h-24 sm:w-24 shadow-lg ring-4 ring-white/50 group-hover:shadow-xl transition-all duration-300",children:[(0,te.jsx)(Vt,{src:c.logo_url,alt:`${c.name} logo`,className:"object-cover"}),(0,te.jsx)(Yt,{className:"bg-gradient-to-br from-slate-100 to-slate-200 text-xl sm:text-2xl font-bold text-slate-700",children:null===(s=c.name)||void 0===s?void 0:s[0]})]})]}),"login"===m&&(0,te.jsxs)("div",{className:"space-y-2 sm:space-y-3",children:[(0,te.jsxs)("h1",{className:"text-2xl sm:text-3xl font-bold text-slate-900 tracking-tight",children:["Welcome to ",null==c?void 0:c.name]}),(0,te.jsx)("p",{className:"text-slate-500 text-sm sm:text-base font-medium",children:"Sign in to continue"})]}),(0,te.jsx)("div",{className:"w-full",children:(()=>{if(b.enable_username_password)switch(m){case"register":return(0,te.jsx)(Dy,{authSDK:r,onSuccess:v,onSwitchToLogin:()=>u("login"),onSwitchToOtpVerification:j});case"otp":return(0,te.jsx)(Py,{authSDK:r,email:x,onSuccess:v,onSwitchToLogin:()=>u("login")});case"reset":return(0,te.jsx)(My,{authSDK:r,onSwitchToLogin:()=>u("login")});default:return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsxs)("div",{className:"space-y-3",children:[N.map((e=>w(e))),k()]}),(N.length>0||k())&&(0,te.jsxs)("div",{className:"relative my-6",children:[(0,te.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,te.jsx)(Xs,{className:"w-full bg-slate-200"})}),(0,te.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,te.jsx)("span",{className:"bg-white px-3 text-slate-400 font-medium tracking-wider",children:"or"})})]}),(0,te.jsx)($y,{appId:t,appPlatformVersion:null==c?void 0:c.platform_version,authSDK:r,onSuccess:v,onSwitchToRegister:()=>u("register"),onSwitchToResetPassword:()=>u("reset")})]})}return(0,te.jsxs)("div",{className:"space-y-3",children:[N.map((e=>w(e))),k()]})})()})]})})]}),(0,te.jsx)("div",{className:"mt-8 text-center text-xs text-slate-400 sm:hidden",children:(0,te.jsx)("p",{children:"\xa0"})})]})})}function By(e){let{appId:s}=e;const t=(0,Z.zy)(),a=(0,Z.Zp)(),r=Kv(s,(()=>{}),{}),n=new URLSearchParams(t.search).get("token"),[l,i]=(0,Y.useState)({password:"",confirmPassword:""}),[o,c]=(0,Y.useState)(""),[d,m]=(0,Y.useState)(!1),[u,x]=(0,Y.useState)(!1),[h,p]=(0,Y.useState)(null),[g,f]=(0,Y.useState)(!0);(0,Y.useEffect)((()=>{(async()=>{try{const e=await pe.getLoginInfoById(s);p(e)}catch(o){}finally{f(!1)}})(),n||c("Invalid reset link. Please request a new password reset.")}),[n,s]);const v=(e,s)=>{i((t=>({...t,[e]:s})))};return g?(0,te.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50",children:(0,te.jsx)("div",{className:"p-8",children:(0,te.jsx)(Je.A,{className:"h-10 w-10 animate-spin text-gray-600"})})}):u?(0,te.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,te.jsx)(Vs,{className:"max-w-md w-full overflow-hidden border-0 shadow-lg bg-white",children:(0,te.jsxs)(Js,{className:"pt-12 pb-10 px-12 text-center space-y-6",children:[(0,te.jsx)("div",{className:"mx-auto w-20 h-20 bg-gray-100 rounded-full flex items-center justify-center",children:(0,te.jsx)(Ed.A,{className:"h-10 w-10 text-green-600"})}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Password reset successful!"}),(0,te.jsx)("p",{className:"text-gray-600",children:"Your password has been reset. Redirecting to login..."})]}),(null==h?void 0:h.name)&&(0,te.jsxs)("p",{className:"text-sm text-gray-500",children:["You can now sign in to ",h.name," with your new password"]})]})})}):n?(0,te.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,te.jsxs)(Vs,{className:"relative max-w-md w-full overflow-hidden border-0 shadow-lg bg-white",children:[(0,te.jsx)("div",{className:"absolute top-0 left-0 right-0 h-0.5 bg-gray-900"}),(0,te.jsxs)(Js,{className:"pt-12 pb-10 px-12 space-y-8",children:[(0,te.jsxs)("div",{className:"text-center space-y-2",children:[(0,te.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Set new password"}),(0,te.jsx)("p",{className:"text-gray-600",children:null!=h&&h.name?`Enter your new password for ${h.name}`:"Please enter your new password below"})]}),(0,te.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),c(""),l.password===l.confirmPassword)if(l.password.length<8)c("Password must be at least 8 characters long");else{m(!0);try{await r.resetPassword(n,l.password),x(!0),setTimeout((()=>{a("/login")}),3e3)}catch(i){var s,t;c((null===(s=i.response)||void 0===s||null===(t=s.data)||void 0===t?void 0:t.detail)||"Failed to reset password. The link may have expired.")}finally{m(!1)}}else c("Passwords do not match")},className:"space-y-6",children:[(0,te.jsxs)("div",{className:"space-y-5",children:[(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"password",className:"text-sm font-medium text-gray-700",children:"New Password"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Ls.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,te.jsx)(Qs,{id:"password",type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",value:l.password,onChange:e=>v("password",e.target.value),required:!0,disabled:d,className:"pl-10 h-11 bg-gray-50/50 border-gray-200 focus:border-gray-400 focus:ring-gray-400"})]}),(0,te.jsx)("p",{className:"text-xs text-gray-500",children:"Must be at least 8 characters"})]}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)(at,{htmlFor:"confirmPassword",className:"text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,te.jsxs)("div",{className:"relative",children:[(0,te.jsx)(Ls.A,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),(0,te.jsx)(Qs,{id:"confirmPassword",type:"password",placeholder:"\u2022\u2022\u2022\u2022\u2022\u2022\u2022\u2022",value:l.confirmPassword,onChange:e=>v("confirmPassword",e.target.value),required:!0,disabled:d,className:"pl-10 h-11 bg-gray-50/50 border-gray-200 focus:border-gray-400 focus:ring-gray-400"})]})]})]}),o&&(0,te.jsx)(is,{className:"bg-red-50/50 border-red-200",children:(0,te.jsx)(cs,{className:"text-red-800 text-sm",children:o})}),(0,te.jsxs)("div",{className:"space-y-3",children:[(0,te.jsx)(Rs,{type:"submit",disabled:d,className:"w-full h-11 bg-gray-900 hover:bg-gray-800 text-white font-medium shadow-sm",children:d?(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(Je.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Resetting password..."]}):"Reset password"}),(0,te.jsx)("button",{type:"button",onClick:()=>a("/login"),className:"w-full text-sm text-gray-600 hover:text-gray-700",children:"Back to login"})]})]})]})]})}):(0,te.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 p-4",children:(0,te.jsx)(Vs,{className:"max-w-md w-full overflow-hidden border-0 shadow-lg bg-white",children:(0,te.jsxs)(Js,{className:"pt-12 pb-10 px-12 text-center space-y-6",children:[(0,te.jsx)("div",{className:"mx-auto w-20 h-20 bg-red-100 rounded-full flex items-center justify-center",children:(0,te.jsx)(Ke.A,{className:"h-10 w-10 text-red-600"})}),(0,te.jsxs)("div",{className:"space-y-2",children:[(0,te.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Invalid Reset Link"}),(0,te.jsx)("p",{className:"text-gray-600",children:"This password reset link is invalid or has expired."})]}),(0,te.jsx)(Rs,{onClick:()=>a("/login"),className:"w-full h-11 bg-gray-900 hover:bg-gray-800 text-white font-medium shadow-sm",children:"Back to Login"})]})})})}function Wy(e){let{}=e;const[s,t]=(0,Y.useState)(null),[a,r]=(0,Y.useState)(null),[n,l]=(0,Y.useState)(!0),i=window.location.host.includes("localhost")?window.location.host:window.location.hostname,[o]=(0,Y.useState)((()=>new Wv.E));return(0,Y.useEffect)((()=>{pe.getDomainAppId(i).then((e=>{t(e),window.appId=e,l(!1)})).catch((e=>{r(!0),l(!1)}))}),[]),n?(0,te.jsx)("div",{className:"fixed inset-0 flex items-center justify-center",children:(0,te.jsx)("div",{className:"w-12 h-12 border-4 border-gray-200 border-t-black rounded-full animate-spin"})}):a?(0,te.jsx)("div",{className:"flex items-center justify-center min-h-screen p-4",children:(0,te.jsxs)("div",{className:"text-center",children:[(0,te.jsx)("h1",{className:"text-2xl font-bold mb-4",children:"Domain Not Recognized"}),(0,te.jsx)("p",{className:"mb-2",children:"This domain is not associated with any Base44 app."}),(0,te.jsxs)("p",{children:["Please contact support at ",(0,te.jsx)("button",{type:"button",onClick:()=>window.open("/support","_blank"),className:"underline text-primary hover:text-orange-500 transition-colors",children:"support system"})," for assistance."]})]})}):(0,te.jsxs)(J.BrowserRouter,{children:[(0,te.jsx)("div",{children:(0,te.jsx)(Ga.Toaster,{})}),(0,te.jsx)("div",{children:(0,te.jsx)(Bb,{})}),(0,te.jsx)("div",{children:(0,te.jsx)(Ga.Toaster,{})}),(0,te.jsx)(Gv,{appId:s,children:(0,te.jsx)(qv.Ht,{client:o,children:(0,te.jsxs)(Z.BV,{children:[(0,te.jsx)(Z.qh,{path:"/login",element:(0,te.jsx)(Uy,{appId:s})}),(0,te.jsx)(Z.qh,{path:"/reset-password",element:(0,te.jsx)(By,{appId:s})}),(0,te.jsx)(Z.qh,{path:"/:pageName?",element:(0,te.jsx)(Ty,{appId:s})})]})})})]})}var qy=t(12055);let Vy=!1;const Yy=[],Hy=async e=>{var s;if(!Vy&&e)for(await(s=e.email,new Promise((e=>{var t,a,r,n,l,i;window.fbq||(t=window,a=document,r="script",t.fbq||(n=t.fbq=function(){n.callMethod?n.callMethod.apply(n,arguments):n.queue.push(arguments)},t._fbq||(t._fbq=n),n.push=n,n.loaded=!0,n.version="2.0",n.queue=[],(l=a.createElement(r)).async=!0,l.src="https://connect.facebook.net/en_US/fbevents.js",(i=a.getElementsByTagName(r)[0]).parentNode.insertBefore(l,i)),window.fbq("init","2102574843552117",s?{em:s}:{})),e()}))),Vy=!0;Yy.length>0;){Yy.shift()()}};function Gy(){const{user:e,isLoadingAuth:s}=ne(),t=(0,Z.zy)(),a="true"===new URLSearchParams(t.search).get("is_new_user"),r=(0,Y.useRef)(!1);return(0,Y.useEffect)((()=>{!s&&e&&(Hy(e),a&&!r.current&&(r.current=!0,Se("Registration Completed",{}),cl("registration_completed",{email:ul()(e.email),user_id:e.id,registration_method:"google"}),we(e.id),(0,qy.V)("is_new_user")))}),[s,e,a]),null}let Jy=!1;function Zy(){return(0,Y.useEffect)((()=>{new Promise((e=>{if(window.turnstile||Jy)return void e();const s=document.createElement("script");s.src="https://challenges.cloudflare.com/turnstile/v0/api.js",s.async=!0,s.defer=!0,s.onload=()=>{Jy=!0,e()},s.onerror=()=>{e()},document.head.appendChild(s)}))}),[]),null}function Ky(e){let{page:s}=e;const t=!(!1===s.requiresAuth),a=!(!1===s.usesLayout),r=Pv.filter((e=>!1!==e.showInMenu));let n=a?(0,te.jsx)(Bv,{pages:r,children:s.component}):s.component;return t&&(n=(0,te.jsx)(Xy,{children:n})),n}const Xy=e=>{let{children:s}=e;const{isAuthenticated:t,isLoadingAuth:a}=ne();if(a)return(0,te.jsx)("div",{className:"flex justify-center items-center h-screen",children:(0,te.jsx)(Je.A,{className:"h-8 w-8 animate-spin"})});if(!t){const e=encodeURIComponent(window.location.href);return Jt(window.location.host)||(window.location.href=`https://app.base44.com/login?from_url=${e}`),(0,te.jsx)(Z.C5,{to:`/login?from_url=${e}`,replace:!0})}return s},Qy=()=>{(0,Y.useEffect)((()=>{(()=>{try{const e=new URLSearchParams(window.location.search),s={};let t=!1;if(je.forEach((a=>{const r=e.get(a);r&&(s[a]=r,t||(t=!0))})),t){const e=be();return e.params&&0!==Object.keys(e.params).length?e.params:(localStorage.setItem(fe,JSON.stringify(s)),localStorage.setItem(ve,Date.now().toString()),s)}return{}}catch(e){return{}}})()}),[]);const e=ss().flatMapDeep(Pv,(e=>[e,...e.children||[]]));return(0,te.jsx)(J.BrowserRouter,{children:(0,te.jsx)(re,{children:(0,te.jsxs)(ue,{children:[(0,te.jsx)(Z.BV,{children:e.map((e=>(0,te.jsx)(Z.qh,{path:e.url,element:(0,te.jsx)(Ky,{page:e})},e.url)))}),(0,te.jsx)(Gy,{}),(0,te.jsx)(Ce,{}),(0,te.jsx)(dl,{}),(0,te.jsx)(Zy,{})]})})})},eN=()=>{const e=window.location.host;let s=(0,te.jsx)(Qy,{});return Jt(e)||(s=(0,te.jsx)(Wy,{})),(0,te.jsxs)("div",{className:"font-sans",children:[(0,te.jsx)("div",{children:(0,te.jsx)(bm,{})}),(0,te.jsx)("div",{children:(0,te.jsx)(Bb,{})}),(0,te.jsx)("div",{children:(0,te.jsx)(Ga.Toaster,{})}),(0,te.jsx)(ws,{children:s})]})},sN=e=>{e&&e instanceof Function&&t.e(96).then(t.bind(t,88206)).then((s=>{let{getCLS:t,getFID:a,getFCP:r,getLCP:n,getTTFB:l}=s;t(e),a(e),r(e),n(e),l(e)}))};H.createRoot(document.getElementById("root")).render((0,te.jsx)(eN,{})),sN()},91903:()=>{},24394:()=>{}},r={};function n(e){var s=r[e];if(void 0!==s)return s.exports;var t=r[e]={id:e,loaded:!1,exports:{}};return a[e].call(t.exports,t,t.exports,n),t.loaded=!0,t.exports}n.m=a,n.amdO={},e=[],n.O=(s,t,a,r)=>{if(!t){var l=1/0;for(d=0;d<e.length;d++){t=e[d][0],a=e[d][1],r=e[d][2];for(var i=!0,o=0;o<t.length;o++)(!1&r||l>=r)&&Object.keys(n.O).every((e=>n.O[e](t[o])))?t.splice(o--,1):(i=!1,r<l&&(l=r));if(i){e.splice(d--,1);var c=a();void 0!==c&&(s=c)}}return s}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[t,a,r]},n.n=e=>{var s=e&&e.__esModule?()=>e.default:()=>e;return n.d(s,{a:s}),s},t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__,n.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var r=Object.create(null);n.r(r);var l={};s=s||[null,t({}),t([]),t(t)];for(var i=2&a&&e;"object"==typeof i&&!~s.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach((s=>l[s]=()=>e[s]));return l.default=()=>e,n.d(r,l),r},n.d=(e,s)=>{for(var t in s)n.o(s,t)&&!n.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:s[t]})},n.e=()=>Promise.resolve(),n.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),n.o=(e,s)=>Object.prototype.hasOwnProperty.call(e,s),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),n.p="/",(()=>{var e={792:0};n.O.j=s=>0===e[s];var s=(s,t)=>{var a,r,l=t[0],i=t[1],o=t[2],c=0;if(l.some((s=>0!==e[s]))){for(a in i)n.o(i,a)&&(n.m[a]=i[a]);if(o)var d=o(n)}for(s&&s(t);c<l.length;c++)r=l[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},t=self.webpackChunkfrontend=self.webpackChunkfrontend||[];t.forEach(s.bind(null,0)),t.push=s.bind(null,t.push.bind(t))})(),n.nc=void 0;var l=n.O(void 0,[96],(()=>n(44644)));l=n.O(l)})();